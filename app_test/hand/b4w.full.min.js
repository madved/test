var b4w=function(a){var p={};a.module=p;var c={};a.register=function(a,b){if(p[a])throw Error('Module "'+a+'" already registered');p[a]=b};a.require=function(a,b){if(!p[a])throw Error('Module "'+a+'" not found');b=b||"__B4W_DEF_NS";c[b]||(c[b]=function(a){return function(b){var d=p[b];if(!d)throw Error('Module "'+b+'" not found');d.Di||(d.Di={});d.Di[a]||(d.Di[a]={},d(d.Di[a],c[a]));return d.Di[a]}}(b));return c[b](a)};a.module_check=function(a){return p[a]?!0:!1};return a}({});"object"==typeof module&&module.bn&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function p(){var a=c,d=a.getDate(),d=10>d?"0"+String(d):String(d),l=a.getMonth()+1,l=10>l?"0"+String(l):String(l),m=String(a.getFullYear()),h=a.getHours(),h=10>h?"0"+String(h):String(h),n=a.getMinutes(),n=10>n?"0"+String(n):String(n),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return d+"."+l+"."+m+" "+h+":"+n+":"+a}var c=new Date(2015,7,6,17,56,57),d=[15,7];a.version=function(){return d};a.version_str=function(){for(var a="",c=0;c<d.length;c++)a=1==c?a+(10>d[c]?
"0"+d[c]:d[c]):a+d[c],c!=d.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.date=function(){return c};a.date_str=p;a.timestamp=function(){var a=p(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.bn&&b4w.module.__version(exports);b4w.module.__config=function(a,p){function c(){return b4w.module_check(a.bc.tk)}function d(){for(var c=a.bc,d=null,e=document.getElementsByTagName("script"),n=0;n<e.length;n++){for(var f=e[n].src,k=0;k<c.cs.length;k++)if(0<=f.indexOf(c.cs[k])){d=f;break}if(null!==d)break}d||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),d=document.location.href);c=d.indexOf("?");0<=c&&(d=d.substring(0,c));return d.substring(0,d.lastIndexOf("/")+1)}var b=p("__print"),
e=p("__util");a.P_LOW=1;a.P_HIGH=2;a.P_ULTRA=3;a.P_CUSTOM=4;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.rx=e.pa(a.context);a.r={alpha_sort:!0,alpha_sort_threshold:.1,fm:!1,Cg:[5,5],od:1E4,console_verbose:!1,do_not_load_resources:!1,Pl:!1,hr:1.5,Iy:10,background_color:[0,0,0,0],yg:.01,render_resolution_factor:1,canvas_resolution_factor:1,Kl:3,allow_cors:!1,jn:!1,jk:!0,show_hud_debug_info:!1,JE:!0,Lj:!0,anaglyph_use:!1,zl:!0,mc:!0,De:!0,vh:!0,Ch:!0,mh:!0,Sh:!0,qh:!0,antialiasing:!0,smaa:!1,
wireframe_debug:!1,qu:!1,zh:!0,Aj:!0,Bb:!0,ul:!0,water_dynamic:!0,shore_smoothing:!0,di:!0,Sb:1024,Bg:512,du:!0,precision:"highp",quality:a.P_HIGH,cm:!0,EA:!1,nt:!1,Uq:!1,ku:!1,rg:!1,Cm:!1,Hq:!1,Rr:!1,Dm:!1,VF:!1,cd:!1,allow_hidpi:!1,gyro_use:!1,er:!1,fo:!1,In:!1,enable_selectable:!0,enable_outlining:!0,df:!0,ns:128,Fn:!1,Tr:!1,qA:!1,Yn:[0,0]};a.fy=e.pa(a.r);a.Zd={Ra:-1,ir:!1,kg:1};a.controls={CA:1/120};a.$d={dir:"ASSETS=../../assets/",xA:15,Qs:!0,co:!1,Sm:!1};a.uw=e.pa(a.$d);a.bc={shaders_dir:"",
WB:"include/",SF:"postprocessing/",tk:"built_in_data",cs:["b4w.min.js","b4w.full.min.js","src/b4w.js","USER_DEFINED_MODULE"],dt:"./",smaa_search_texture_path:"",smaa_area_texture_path:""};a.q={enabled:!0,od:60,Tj:"",xm:!1,ping:!1};a.NA=e.pa(a.q);a.ai={Qk:1024,Dk:384,Oq:32,Zx:128,Yx:256,Ks:.25,QA:.5,PA:1};a.vB=e.pa(a.ai);a.o={rp:!0,fl:!1,aq:!1,yq:!1,Vq:!1};a.VB=e.pa(a.o);a.Lb={outlining_overview_mode:!1,pf:[1,.4,.05],qd:1,ml:.2,nl:3.8,ol:1};a.Tm={enabled:!1,AC:"MAIN_OPAQUE",zC:0,ZB:"COLOR"};a.by=e.pa(a.Tm);
a.pw=function(){var b=a.r,c=a.q,d=a.ai;switch(b.quality){case a.P_ULTRA:b.Lj=!0;b.shore_smoothing=!0;b.De=!0;b.vh=!0;b.Ch=!0;b.mh=!0;b.zl=!0;b.mc=!0;b.zh=!0;b.Aj=!0;b.Bb=!0;b.ul=!0;b.render_resolution_factor=1.75;d.Qk=2048;b.Kl=3;b.jk=!0;b.Pl=!1;b.precision="highp";b.water_dynamic=!0;b.di=!0;b.antialiasing=!0;b.smaa=!0;b.qh=!0;b.Sh=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.df=!0;c.od=120;break;case a.P_HIGH:b.Lj=!0;b.shore_smoothing=!0;b.De=!0;b.vh=!0;b.Ch=!0;b.mh=!0;b.zl=!0;b.mc=!0;b.zh=!0;b.Aj=
!0;b.Bb=!0;b.ul=!0;b.render_resolution_factor=1;d.Qk=1024;b.Kl=3;b.jk=!0;b.Pl=!1;b.precision="highp";b.water_dynamic=!0;b.di=!0;b.antialiasing=!0;b.smaa=!1;b.qh=!0;b.Sh=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.df=!0;c.od=60;break;case a.P_LOW:b.Lj=!1,b.shore_smoothing=!1,b.De=!1,b.vh=!1,b.Ch=!1,b.mh=!1,b.zl=!1,b.mc=!1,b.zh=!1,b.Aj=!1,b.Bb=!1,b.ul=!1,b.render_resolution_factor=1,d.Qk=512,b.Kl=2,b.jk=!1,b.Pl=!0,b.precision="mediump",b.water_dynamic=!1,b.di=!1,b.antialiasing=!1,b.smaa=!1,b.qh=!1,
b.Sh=!1,b.allow_hidpi=!1,b.enable_outlining=!1,b.df=!1,c.od=60}};a.set=function(c,d){switch(c){case "allow_cors":a.r.allow_cors=d;break;case "allow_hidpi":a.r.allow_hidpi=d;break;case "alpha":a.context.alpha=d;break;case "alpha_sort":a.r.alpha_sort=d;break;case "alpha_sort_threshold":a.r.alpha_sort_threshold=d;break;case "anaglyph_use":a.r.anaglyph_use=d;break;case "animation_framerate":a.Zd.Ra=d;break;case "antialiasing":a.r.antialiasing=d;break;case "assets_dds_available":a.$d.Sm=d;break;case "assets_min50_available":a.$d.co=
d;break;case "audio":a.o.rp=d;break;case "background_color":a.r.background_color=d;break;case "built_in_module_name":a.bc.tk=d;break;case "canvas_resolution_factor":a.r.canvas_resolution_factor=d;break;case "console_verbose":a.r.console_verbose=d;break;case "do_not_load_resources":a.r.do_not_load_resources=d;break;case "gyro_use":a.r.gyro_use=d;break;case "physics_enabled":a.q.enabled=d;break;case "physics_uranium_path":a.q.Tj=d;break;case "physics_calc_fps":a.q.xm=d;break;case "precision":a.r.precision=
d;break;case "quality":a.r.quality=d;break;case "render_resolution_factor":a.r.render_resolution_factor=d;break;case "sfx_mix_mode":a.o.fl=d;break;case "shaders_dir":a.bc.shaders_dir=d;break;case "show_hud_debug_info":a.r.show_hud_debug_info=d;break;case "smaa":a.r.smaa=d;break;case "smaa_search_texture_path":a.bc.smaa_search_texture_path=d;break;case "smaa_area_texture_path":a.bc.smaa_area_texture_path=d;break;case "wireframe_debug":a.r.wireframe_debug=d;break;case "enable_selectable":a.r.enable_selectable=
d;break;case "enable_outlining":a.r.enable_outlining=d;break;case "outlining_overview_mode":a.Lb.outlining_overview_mode=d;break;case "glow_materials":a.r.df=d;break;default:b.error("Unknown config property: "+c)}};a.get=function(c){switch(c){case "allow_cors":return a.r.allow_cors;case "allow_hidpi":return a.r.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.r.alpha_sort;case "alpha_sort_threshold":return a.r.alpha_sort_threshold;case "anaglyph_use":return a.r.anaglyph_use;
case "animation_framerate":return a.Zd.Ra;case "antialiasing":return a.r.antialiasing;case "assets_dds_available":return a.$d.Sm;case "assets_min50_available":return a.$d.co;case "audio":return a.o.rp;case "background_color":return a.r.background_color;case "built_in_module_name":return a.bc.tk;case "canvas_resolution_factor":return a.r.canvas_resolution_factor;case "console_verbose":return a.r.console_verbose;case "do_not_load_resources":return a.r.do_not_load_resources;case "gyro_use":return a.r.gyro_use;
case "physics_enabled":return a.q.enabled;case "physics_uranium_path":return a.q.Tj;case "physics_calc_fps":return a.q.xm;case "precision":return a.r.precision;case "quality":return a.r.quality;case "render_resolution_factor":return a.r.render_resolution_factor;case "sfx_mix_mode":return a.o.fl;case "shaders_dir":return a.bc.shaders_dir;case "show_hud_debug_info":return a.r.show_hud_debug_info;case "smaa":return a.r.smaa;case "smaa_search_texture_path":return a.bc.smaa_search_texture_path;case "smaa_area_texture_path":return a.bc.smaa_area_texture_path;
case "wireframe_debug":return a.r.wireframe_debug;case "enable_selectable":return a.r.enable_selectable;case "enable_outlining":return a.r.enable_outlining;case "outlining_overview_mode":return a.Lb.outlining_overview_mode;case "glow_materials":return a.r.df;default:b.error("Unknown config property: "+c)}};a.reset=function(){a.context=e.pa(a.rx);a.r=e.pa(a.fy);a.$d=e.pa(a.uw);a.q=e.pa(a.NA);a.ai=e.pa(a.vB);a.o=e.pa(a.VB);a.Tm=e.pa(a.by)};a.Wz=c;a.LB=function(){var b=a.bc,e=a.q;c()||""!=b.shaders_dir||
(b.shaders_dir=d()+"../shaders/");if(c())b.smaa_search_texture_path="smaa_search_texture.png",b.smaa_area_texture_path="smaa_area_texture.png";else if(""==b.smaa_search_texture_path||""==b.smaa_area_texture_path){var h=d()+b.dt;b.smaa_search_texture_path=b.smaa_search_texture_path||h+"smaa_search_texture.png";b.smaa_area_texture_path=b.smaa_area_texture_path||h+"smaa_area_texture.png"}e.enabled&&""==e.Tj&&(h=d()+b.dt,e.Tj=h+"uranium.js")};a.get_std_assets_path=function(){return a.$d.dir.replace("ASSETS=",
"")}};b4w.module.__anchors=function(a,p){function c(a,g){var c=document.createElement("div"),k=c.style;k.position="absolute";k.backgroundColor="black";k.borderRadius="20px 20px 20px 0px";k.boxShadow="0px 0px 10px rgb(180, 180, 200)";k.opacity=1;k.padding="8px 12px";k.lineHeight="15px";k.visibility="hidden";k.fontSize="12px";var m=n.get_container();m.appendChild(c);var h=f.get_meta_tags(a),l=document.createElement("span"),r=l.style;l.innerHTML=h.title||a.name;r.fontWeight="bold";r.fontSize="12px";r.lineHeight=
"15px";r.color="#fff";r.fontFamily="Arial";e(l);c.appendChild(l);var t=h.description;if(t){var h=document.createElement("div"),I=h.style;I.position="absolute";I.bottom="0px";I.left="0px";I.backgroundColor="#000";I.borderRadius="20px 20px 20px 0px";I.boxShadow="0px 0px 10px rgb(180, 180, 200)";I.visibility="hidden";I.padding="8px 12px";I.overflow="hidden";I.lineHeight="15px";I.fontSize="12px";I.zIndex="2";c.appendChild(h);var v=document.createElement("span"),H=v.style;v.innerHTML=t;H.fontSize="12px";
H.fontFamily="Arial";H.fontWeight="bold";H.lineHeight="15px";H.color="#fff";H.visibility="hidden";h.appendChild(v);var P=!1,x=!1;m.addEventListener("click",function(a){if(!(P||x||C))if(a.target!=l&&a.target!=c||"hidden"!=I.visibility||1!=k.opacity)"visible"==I.visibility&&(k.visibility="visible",r.visibility="visible",I.visibility="hidden",H.visibility="hidden");else{k.visibility="hidden";r.visibility="hidden";I.visibility="visible";P=x=!0;a=c.offsetWidth-24;var v=c.offsetHeight-16,f=Math.min(g,d(t)),
u=b(t,f);u==v&&(I.height=u+"px");f!=a?w.animate(a,f,200,function(a){a==f&&("visible"==I.visibility&&(H.visibility="visible"),P=!1);I.width=a+"px"}):P=!1;u!=v?w.animate(v,u,200,function(a){a==u&&("visible"==I.visibility&&(H.visibility="visible"),x=!1);I.height=a+"px"}):x=!1;x||P||(H.visibility="visible")}},!1)}return c}function d(a){var b=document.createElement("div"),c=document.createElement("span"),d=b.style;c.innerHTML=a;c.style.fontSize="12px";c.style.fontFamily="Arial";c.style.fontWeight="bold";
c.style.color="#fff";c.style.visibility="hidden";d.lineHeight="15px";b.appendChild(c);d.position="absolute";d.visibility="hidden";d.fontSize="12px";d.display="inline-block";d.lineHeight="15px";document.body.appendChild(b);a=b.offsetWidth+1;document.body.removeChild(b);return a}function b(a,b){var c=document.createElement("div"),d=document.createElement("span"),f=c.style;d.innerHTML=a;d.style.fontSize="12px";d.style.fontFamily="Arial";d.style.fontWeight="bold";d.style.color="#fff";d.style.visibility=
"hidden";f.lineHeight="15px";c.appendChild(d);f.position="absolute";f.visibility="hidden";f.fontSize="12px";f.display="inline-block";f.width=b+"px";f.lineHeight="15px";document.body.appendChild(c);d=c.offsetHeight;document.body.removeChild(c);return d}function e(a){a.style["-webkit-touch-callout"]="none";a.style["-webkit-user-select"]="none";a.style["-khtml-user-select"]="none";a.style["-moz-user-select"]="none";a.style["-ms-user-select"]="none";a.style["user-select"]="none";a.style.cursor="default"}
function l(){for(var a=0,b=0;b<D.length;b++)D[b].Vm&&a++;G=new Float32Array(3*a)}var m=p("__batch"),h=p("__camera"),n=p("__container"),f=p("__objects"),k=p("__print"),r=p("__renderer"),y=p("__scenes"),w=p("__time");p("__util");p("__config");var C=!1,D=[],G=new Float32Array(0),t=new Uint8Array(16),A=new Float32Array(2),x=new Float32Array(3);a.append=function(a){var b=a.c,d;a:{for(d=0;d<D.length;d++)if(D[d].obj==b){d=!0;break a}d=!1}if(!d){d=a.b4w_anchor.detect_visibility&&Boolean(y.da(y.lj(),"ANCHOR_VISIBILITY"));
b={type:a.b4w_anchor.type,obj:b,x:0,y:0,depth:0,jh:"out",Vm:d,element:null,Th:null,Xv:a.b4w_anchor.max_width,Sp:0,sy:a.b4w_anchor.element_id};switch(b.type){case "ANNOTATION":b.element=c(a,b.Xv);b.Sp=b.element.offsetHeight;break;case "ELEMENT":b.element=document.getElementById(a.b4w_anchor.element_id),b.element||(k.warn("Anchor HTML element was not found, making it generic"),b.type="GENERIC")}D.push(b);l()}};a.remove=function(a){for(var b=0;b<D.length;b++){var c=D[b];if(c.obj==a){"ANNOTATION"==c.type&&
(a=c,n.get_container().removeChild(a.element));D.splice(b,1);l();break}}};a.update=function(){for(var a=0,b=D.length;b--;){var c=D[b];c.Vm&&(G.set(c.obj.g.i,3*a),a++);var d,f=c,k=x;d=y.kj(y.lj());d=k=h.project_point(d,f.obj.g.i,k);f=d[0];k=d[1];d=d[2];if(f!=c.x||k!=c.y||d!=c.depth){switch(c.type){case "ANNOTATION":var e=c.element;e.style.left=Math.floor(f)+"px";e.style.top=Math.floor(k-c.Sp)+"px";break;case "ELEMENT":var e=c.element,l=e.getBoundingClientRect();e.style.cssText+="left:"+Math.floor(f-
l.width/2)+"px;top:"+Math.floor(k-l.height/2)+"px;"}c.x=f;c.y=k;c.depth=d;c.Th&&c.Th(f,k,c.jh,c.obj,e)}}0<a&&(a=y.da(y.lj(),"ANCHOR_VISIBILITY").s[0].D,m.MC(a,G))};a.iD=function(){for(var a=n.get_container(),b=D.length;b--;){var c=D[b],d=c.obj,f=c.x,k=c.y,e=c.depth,e=0>f||0>k||0>e||1<e||y.is_hidden(d)||f>=a.clientWidth||k>=a.clientHeight?"out":"visible";if(c.Vm&&"out"!=e){var e=c,h=y.da(y.lj(),"ANCHOR_VISIBILITY").k,m=n.Am(e.x,e.y,A,h);r.Ys(h.ne,m[0],h.height-m[1],2,2,t);e=1020==t[0]+t[4]+t[8]+t[12]?
"visible":"out"==e.jh||0==t[0]+t[4]+t[8]+t[12]?"covered":e.jh}if(e!=c.jh){switch(c.type){case "ANNOTATION":case "ELEMENT":var I=c.element;if(!I)break;"out"==e?(I.style.visibility="hidden",I.children.length&&(I.children[0].style.visibility="hidden"),"ANNOTATION"==c.type&&1<I.children.length&&(h=I.children[1],h.style.visibility="hidden",h.children.length&&(h.children[0].style.visibility="hidden"))):"visible"==e?(I.style.visibility="visible",I.children.length&&(I.children[0].style.visibility="visible"),
I.style.opacity=1):(I.style.visibility="visible",I.style.opacity=.1,I.children.length&&(I.children[0].style.visibility="visible"),"ANNOTATION"==c.type&&1<I.children.length&&(h=I.children[1],h.style.visibility="hidden",h.children.length&&(h.children[0].style.visibility="hidden")))}c.jh=e;c.Th&&c.Th(f,k,c.jh,d,I)}}};a.attach_move_cb=function(a,b){for(var c=0;c<D.length;c++)D[c].obj==a&&(D[c].Th=b)};a.detach_move_cb=function(a){for(var b=0;b<D.length;b++)D[b].obj==a&&(D[b].Th=null)};a.cleanup=function(){for(var a=
0;a<D.length;a++){var b=D[a];"ANNOTATION"==b.type&&n.get_container().removeChild(b.element)}D.length=0};a.is_anchor=function(a){for(var b=0;b<D.length;b++)if(D[b].obj==a)return!0;return!1};a.get_element_id=function(a){for(var b=0;b<D.length;b++)if(D[b].obj==a)return D[b].sy;return!1};a.pause=function(){C=!0};a.resume=function(){C=!1}};b4w.module.__boundings=function(a,p){function c(a,b){for(var c=a[0],d=a[1],f=a[2],k=a[0],e=a[1],h=a[2],m=3;m<a.length;m+=3)var u=a[m],g=a[m+1],l=a[m+2],c=Math.max(c,u),d=Math.max(d,g),f=Math.max(f,l),k=Math.min(k,u),e=Math.min(e,g),h=Math.min(h,l);b.max_x=c;b.max_y=d;b.max_z=f;b.min_x=k;b.min_y=e;b.min_z=h;return b}function d(a,b){b||(b=new Float32Array(24));var c=a.max_x,d=a.max_y,f=a.max_z,k=a.min_x,e=a.min_y,h=a.min_z;b[0]=k;b[1]=e;b[2]=h;b[3]=c;b[4]=e;b[5]=h;b[6]=c;b[7]=d;b[8]=h;b[9]=k;b[10]=
d;b[11]=h;b[12]=k;b[13]=e;b[14]=f;b[15]=c;b[16]=e;b[17]=f;b[18]=c;b[19]=d;b[20]=f;b[21]=k;b[22]=d;b[23]=f;return b}function b(a,b,c){m.add(b,c,a.F);m.scale(a.F,.5,a.F);a.Ia=m.distance(a.F,b);return a}var e=p("__util"),l=p("__tsr"),m=p("vec3"),h=new Float32Array(24),n=new Float32Array(3),f=new Float32Array(3),k=new Float32Array(3);a.zk=function(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z};a.qE=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,
min_y:-1E12,max_z:1E12,min_z:-1E12}};a.ed=function(a){a||(a={});a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0;return a};a.Zq=function(a,b){var c=a.max_y,d=a.max_z,f=a.min_x,k=a.min_y,e=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,f);a.min_y=Math.min(b.min_y,k);a.min_z=Math.min(b.min_z,e)};a.Bw=c;a.tm=function(b,f,k){k||(k=a.ed());b=d(b,h);e.sf(b,f,b);return c(b,k)};a.Ay=d;a.UF=function(b,c,d){d||(d=a.ed());
var f=c.min_x,k=c.max_x,e=c.min_y,h=c.max_y,m=c.min_z;c=c.max_z;if(f>=b.max_x||k<=b.min_x||e>=b.max_y||h<=b.min_y||m>=b.max_z||c<=b.min_z)return d.min_x=-.1,d.max_x=.1,d.min_y=-.1,d.max_y=.1,d.min_z=-.2,d.max_z=-.1,d;d.min_x=Math.max(b.min_x,f);d.max_x=Math.min(b.max_x,k);d.min_y=Math.max(b.min_y,e);d.max_y=Math.min(b.max_y,h);d.min_z=Math.max(b.min_z,m);d.max_z=Math.min(b.max_z,c);return d};a.YF=function(b,c,d){d||(d=a.ed());var f=b.max_x-b.min_x,k=b.max_y-b.min_y,e=b.max_z-b.min_z;d.min_x=b.min_x-
.5*(c-1)*f;d.max_x=b.max_x+.5*(c-1)*f;d.min_y=b.min_y-.5*(c-1)*k;d.max_y=b.max_y+.5*(c-1)*k;d.min_z=b.min_z-.5*(c-1)*e;d.max_z=b.max_z+.5*(c-1)*e;return d};a.vm=function(b,c,d){d||(d=a.Yj());m.transformMat4(b.F,c,d.F);d.Ia=b.Ia*e.ao(c);return d};a.um=function(a,b,c){c||(c={Qe:new Float32Array(3),Re:new Float32Array(3),Se:new Float32Array(3),F:new Float32Array([0,0,0])});l.transform_vec3(a.F,b,c.F);m.copy(a.Qe,c.Qe);m.copy(a.Re,c.Re);m.copy(a.Se,c.Se);l.transform_dir_vec3(c.Qe,b,c.Qe);l.transform_dir_vec3(c.Re,
b,c.Re);l.transform_dir_vec3(c.Se,b,c.Se);return c};a.Bk=function(a,b){return{Ia:a,F:new Float32Array(b)}};a.Yj=function(){return{F:new Float32Array([0,0,0]),Ia:0}};a.Ak=function(a,b,c,d){return{Qe:new Float32Array(a),Re:new Float32Array(b),Se:new Float32Array(c),F:new Float32Array([d[0],d[1],d[2]])}};a.Dw=function(){return{F:new Float32Array([0,0,0]),Ia:1E12}};a.wy=function(a,b){var c=m.subtract(b.F,a.F,m.create());0==m.length(c)&&m.set(1,0,0,c);var d=m.normalize(c,m.create()),c=m.scale(d,a.Ia,m.create());
m.add(c,a.F,c);var f=m.scale(d,-a.Ia,m.create());m.add(f,a.F,f);var k=m.scale(d,b.Ia,m.create());m.add(k,b.F,k);var e=m.scale(d,-b.Ia,m.create());m.add(e,b.F,e);c=[c,f,k,e];d=m.normalize(d,m.create());f=c[0];k=c[0];for(e=1;e<c.length;e++){var h=m.dot(c[e],d);h<m.dot(f,d)&&(f=c[e]);h>m.dot(k,d)&&(k=c[e])}d=[f,k];c=d[0];d=d[1];a.F=m.scale(m.add(c,d,m.create()),.5,m.create());a.Ia=m.length(m.subtract(d,c,m.create()))/2};a.Iq=function(a,b){var c=b.max_y,d=b.min_y,f=Math.max(0,c-d-2*a);return{Ia:a,height:f,
F:new Float32Array([0,(c+d)/2,0])}};a.Kq=function(a,b){var c=b.max_y,d=b.min_y,f=Math.max(0,c-d);return{Ia:a,height:f,F:new Float32Array([0,(c+d)/2,0])}};a.Jq=function(a,b){var c=b.max_y,d=b.min_y,f=Math.max(0,c-d);return{Ia:a,height:f,F:new Float32Array([0,(c+d)/2,0])}};a.uE=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.bB=function(a){for(var b=0,c=0,d=0,f=0,k=0,e=0,h=0,m=0,u=0;u<a.submeshes.length;u++){var g=
a.submeshes[u];if(g.position.length){b=f=g.position[0];c=k=g.position[1];d=e=g.position[2];break}}for(u=0;u<a.submeshes.length;u++)for(var g=a.submeshes[u],g=g.position,l=0;l<g.length/3;l++)var n=g[3*l],J=g[3*l+1],E=g[3*l+2],b=Math.max(n,b),c=Math.max(J,c),d=Math.max(E,d),f=Math.min(n,f),k=Math.min(J,k),e=Math.min(E,e),h=Math.max(Math.sqrt(n*n+J*J+E*E),h),m=Math.max(Math.sqrt(n*n+E*E),m);a.b4w_bounding_box.max_x=b;a.b4w_bounding_box.min_x=f;a.b4w_bounding_box.max_y=c;a.b4w_bounding_box.min_y=k;a.b4w_bounding_box.max_z=
d;a.b4w_bounding_box.min_z=e;a.b4w_bounding_box_source.max_x=b;a.b4w_bounding_box_source.min_x=f;a.b4w_bounding_box_source.max_y=c;a.b4w_bounding_box_source.min_y=k;a.b4w_bounding_box_source.max_z=d;a.b4w_bounding_box_source.min_z=e;a.b4w_bounding_sphere_radius=h;a.b4w_bounding_cylinder_radius=m};a.sz=function(c){var d=c.subarray(0,3),h=c.subarray(6,9),l=c.subarray(12,15),D=c.subarray(18,21);c=m.subtract(h,d,n);m.normalize(c,c);var G=e.vz(d,h,l,f),G=m.cross(G,c,G);m.normalize(G,G);var t=m.create(),
A=m.create();m.subtract(h,d,k);A[0]=m.dot(k,c);A[1]=m.dot(k,G);h=m.create();m.subtract(l,d,k);h[0]=m.dot(k,c);h[1]=m.dot(k,G);l=m.create();m.subtract(D,d,k);l[0]=m.dot(k,c);l[1]=m.dot(k,G);D=a.Yj();l=[t,A,h,l];t=b(D,l[0],l[1]);for(D=2;D<l.length;D++)if(m.distance(t.F,l[D])>t.Ia){for(var x=t,t=l,A=l[D],h=D-1,x=b(x,A,t[0]),u=1;u<=h;u++)if(m.distance(x.F,t[u])>x.Ia){for(var g=x,x=t,q=A,L=t[u],J=u-1,g=b(g,q,L),E=0;E<=J;E++)if(m.distance(g.F,x[E])>g.Ia){var M=q,K=L,Q=x[E],I=m.subtract(K,Q,k),I=m.squaredLength(I),
v=m.subtract(M,Q,k),H=m.squaredLength(v),v=m.subtract(M,K,k),P=m.squaredLength(v),v=I*(H+P-I),Z=H*(P+I-H),I=P*(I+H-P),H=v+Z+I;m.copy(M,g.F);m.scale(g.F,v/H,g.F);m.scaleAndAdd(g.F,K,Z/H,g.F);m.scaleAndAdd(g.F,Q,I/H,g.F);g.Ia=m.distance(g.F,M)}x=g}t=x}D=t;c=m.scale(c,D.F[0],k);m.scaleAndAdd(c,G,D.F[1],c);m.add(c,d,D.F);return D}};b4w.module.__compat=function(a,p){function c(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function d(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var e=p("__config"),l=p("__extensions"),m=p("__print");
p("__util");a.ky=function(a){a.getError()==a.INVALID_ENUM&&m.warn("Possible Tegra invalid enum issue detected, ignoring")};a.EB=function(a){var n=e.Zd,f=e.r,k=e.context,r=e.ai,y=e.o;f.ns=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS);f.Sb=a.getParameter(a.MAX_TEXTURE_SIZE);f.Bg=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE);var w=Boolean(l.nz());c("Firefox/28.0")&&(c("Linux")||c("Macintosh"))&&(m.warn("Firefox 28 detected, applying depth hack"),w=!1);c("iPad")||c("iPhone")?(m.warn("iOS detected, applying alpha hack, applying vertex animation mix normals hack, applying ios depth hack and disable smaa. Disable ssao for performance. Disable video textures. Initialize WebAudio context with empty sound."),
k.alpha||(f.background_color[3]=1),f.ku=!0,f.smaa=!1,f.De=!1,f.precision="highp",f.Rr=!0,f.Tr=!0):c("Mac OS X")&&c("Safari")&&!c("Chrome")&&(m.warn("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures."),y.aq=!0,y.yq=!0);c("Windows")&&(c("Chrome/40")||c("Firefox/33")||c("Firefox/34")||c("Firefox/35")||c("Firefox/36"))&&(m.warn("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),f.Dm=!0);d()&&(m.warn("Mobile detected, applying various hacks for video textures."),
f.rg=!0,c("iPad")||c("iPhone")||(m.warn("Mobile (not iOS) detected, disable playback rate for video textures."),y.Vq=!0));(c("Firefox/35.0")||c("Firefox/36.0"))&&c("Windows")&&(m.warn("Windows/Firefox 35/36 detected, applying shadows slink hack"),f.er=!0);if(c("iPhone")||b())m.warn("iPhone or IE11 detected. Enable sequential video fallback for video textures."),f.cd=!0;10>a.getParameter(a.MAX_VARYING_VECTORS)&&(m.warn("Not enough varyings, disable shadows on blend objects"),f.Uq=!0);if(k=l.xr())c("Macintosh")&&
-1<a.getParameter(k.UNMASKED_RENDERER_WEBGL).indexOf("Intel HD Graphics 3000")&&(m.warn("OS X / Intel HD 3000 detected, applying depth hack"),w=!1),c("Windows")&&c("Chrome")&&-1<a.getParameter(k.UNMASKED_RENDERER_WEBGL).indexOf("Intel")&&(m.warn("Chrome / Windows / Intel GPU detected, applying cubemap mipmap/rgb hack"),f.In=!0),-1<a.getParameter(k.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(k.UNMASKED_RENDERER_WEBGL).indexOf("Mali-400")&&(m.warn("ARM Mali-400 detected, applying depth and frames blending hacks"),
w=!1,n.ir=!0),-1<a.getParameter(k.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(k.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T604")&&(m.warn('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),f.precision="highp",f.Lj=!1),-1<a.getParameter(k.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(k.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T760")&&(m.warn('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),f.precision="highp",f.De=!1),-1<a.getParameter(k.UNMASKED_VENDOR_WEBGL).indexOf("Qualcomm")&&
-1<a.getParameter(k.UNMASKED_RENDERER_WEBGL).indexOf("Adreno")&&(m.warn("Qualcomm Adreno detected, applying shader constants hack."),f.nt=!0,-1<a.getParameter(k.UNMASKED_RENDERER_WEBGL).indexOf("305")&&(m.warn('Qualcomm Adreno305 detected, set "highp" precision.'),f.precision="highp"),-1<a.getParameter(k.UNMASKED_RENDERER_WEBGL).indexOf("330")&&(m.warn('Qualcomm Adreno330 detected, set "highp" precision.'),f.precision="highp")),-1<a.getParameter(k.UNMASKED_VENDOR_WEBGL).indexOf("NVIDIA")&&-1<a.getParameter(k.UNMASKED_RENDERER_WEBGL).indexOf("Tegra 3")&&
(m.warn("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),f.jn=!0),c("Windows")&&c("Chrome")&&a.getParameter(k.UNMASKED_RENDERER_WEBGL).match(/NVIDIA GeForce 8..0/)&&(m.warn("Chrome / Windows / NVIDIA GeForce 8000 series detected, setting max cubemap size to 256."),f.Bg=256);0==a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&(m.warn("Vertex textures are not allowed. Disabling vertex textures"),f.cm=!1);f.allow_hidpi&&1<window.devicePixelRatio&&(m.log("%cENABLE HIDPI MODE",
"color: #00a"),f.render_resolution_factor=1,f.smaa=!1);w||(f.zh=!1,f.Aj=!1,f.Bb=!1,f.water_dynamic=!1,f.shore_smoothing=!1,f.di=!1,f.smaa=!1);f.du=Boolean(l.yr());f.Xi=w;0===a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision&&(f.precision="mediump");b()&&(m.warn("IE11 detected. Set sky cubemap texture size to 512 (power of two)."),r.Dk=512);b()&&c("Touch")&&(m.warn("IE11 and touchscreen detected. Behaviour of the mouse move sensor will be changed."),f.Fn=!0);128>=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS)&&
(m.warn("Not enough fragment uniforms, force low quality for B4W_LEVELS_OF_QUALITY nodes."),f.jn=!0);c("Chrome")&&(m.log("Chrome detected. Some of deprecated functions related to the Doppler effect won't be called."),f.Cm=!0,f.Hq=!0);if(b()||c("iPad"))m.warn("iPad or Internet Explorer detected. Applying alpha clip hack."),f.fm=!0;d()&&c("Firefox")&&(m.log("Mobile firefox detected. Applying autoplay media hack."),f.fo=!0)};a.detect_mobile=d;a.nw=function(){c("Firefox/35.0")&&c("Windows")&&(m.warn("Windows/Firefox 35 detected, forcing context's alpha"),
e.context.alpha=!0)};a.Ln=b};b4w.module.__constraints=function(a,p){function c(a){var b={};b.type=a;return b}function d(a,c){a.c.Pa&&a.c.Pa.W&&e(a.c.Pa.W,a);c.W&&b(c.W,a);a.c.Pa=c}function b(a,b){if(-1==a.c.kd.indexOf(b))a.c.kd.push(b);else throw"Descendant object override is forbidden";}function e(a,b){var v=a.c.kd.indexOf(b);if(-1!=v)a.c.kd.splice(v,1);else throw"No descendant object";}function l(a,b,v){switch(b.type){case 1:var c=a.c.g.quat,d=b.W.c.g.Z;v=b.W.c.g.quat;b.nc?(w.copy(b.nc,c),w.multiply(v,c,c)):w.copy(v,c);y.transformMat4(b.offset,
d,a.c.g.i);a.c.g.scale=b.Al*b.W.c.g.scale;break;case 9:var e=a.c.g.i,c=a.c.g.quat,d=b.W.c.g.Z;v=b.W.c.g.quat;w.multiply(w.invert(b.Lg,b.Lg),c,c);w.multiply(v,c,c);y.transformMat4(b.offset,d,e);w.copy(v,b.Lg);break;case 10:e=a.c.g.i;c=a.c.g.quat;d=b.W.c.g.Z;v=b.W.c.g.quat;w.multiply(w.invert(b.Lg,b.Lg),c,c);w.multiply(v,c,c);y.transformMat4(b.offset,d,e);w.copy(v,b.Lg);e=a.c.g.quat;c=w.multiply(b.W.c.g.quat,b.nc,g);c=r.qr(c,D);e=r.qr(e,G);r.rotate_eye_camera(a,k.Ue(e[0],c[0]+b.hx,c[0]+b.gx),k.Ue(e[1],
c[1]+b.fx,c[1]+b.ix));break;case 12:var e=a.c.g.i,c=a.c.g.quat,d=b.W.c.g.Z,l=b.W.c.g.i,x=b.bC,q=t,A=g;y.transformMat4(b.offset,d,q);k.smooth_v(q,e,v,x,e);d=t;y.sub(l,e,d);y.normalize(d,d);var J=c,e=E,l=e.subarray(0,3),q=e.subarray(3,6),p=e.subarray(6,9);y.copy(d,q);y.negate(q,q);y.normalize(q,q);Boolean(.999999<Math.abs(y.dot(d,k.AXIS_Y)))?(d=C.fromQuat(w.normalize(J,A),M),y.copy(d.subarray(0,3),l)):y.cross(k.AXIS_Y,q,l);y.normalize(l,l);y.cross(l,q,p);y.normalize(p,p);w.fromMat3(e,A);w.normalize(A,
A);k.yt(A,c,v,.16*x,c);break;case 2:c=a.c.g.quat;e=u;v=g;n(b.W,b.Jw,!0,e,v);b.nc?(w.copy(b.nc,c),w.multiply(v,c,c)):w.copy(v,c);a.c.g.scale=b.Al*e[3];k.transform_vec3(b.offset,e[3],v,e,a.c.g.i);break;case 3:e=a.c.g.i;c=a.c.g.quat;v=b.W.c.g.i;m(e,c,v);break;case 4:e=a.c.g.i;c=a.c.g.quat;v=b.target;m(e,c,v);break;case 5:e=a.c.g.i;c=a.c.g.quat;v=b.W.c.g.i;m(e,c,v);c=y.dist(e,v);if(c=c>b.dist_max?c-b.dist_max:c<b.Yi?c-b.Yi:0)y.sub(v,e,t),y.normalize(t,t),y.scale(t,c,t),y.add(e,t,e);break;case 6:e=a.c.g.i;
c=a.c.g.quat;v=b.target;m(e,c,v);c=y.dist(e,v);if(c=c>b.dist_max?c-b.dist_max:c<b.Yi?c-b.Yi:0)y.sub(v,e,t),y.normalize(t,t),y.scale(t,c,t),y.add(e,t,e);break;case 7:d=b.W.c.g.Z;y.transformMat4(b.offset,d,a.c.g.i);break;case 8:l=b.W.c.g.i;e=a.c.g.i;y.add(l,b.offset,e);break;case 13:c=a.c.g.quat;d=b.W.c.g.Z;v=b.W.c.g.quat;b.nc?(w.copy(b.nc,c),w.multiply(v,c,c)):w.copy(v,c);y.transformMat4(b.offset,d,a.c.g.i);break;case 11:e=b.W.c.g;v=f.create_sep(e.i,e.scale,e.quat,L);f.multiply(v,b.Vt,v);e=a.c.g.i;
e[0]=v[0];e[1]=v[1];e[2]=v[2];a.c.g.scale=v[3];c=a.c.g.quat;c[0]=v[4];c[1]=v[5];c[2]=v[6];c[3]=v[7];break;case 14:v=b.W,c=r.qz(v),e=a.c.g.i,x=r.Nk(c,"TOP"),A=r.Nk(c,"BOTTOM"),d=x-A,b.gs?(l=r.Nk(c,"LEFT"),e[0]=l+d*b.Sn):(l=r.Nk(c,"RIGHT"),e[0]=l-d*b.Sn),e[2]=b.Tt?-(x-d*b.cp):-(A+d*b.cp),r.eA(c)?e[1]=-b.distance:(e[1]=-1,y.normalize(e,e),y.scale(e,b.distance/Math.abs(e[1]),e)),f.transform_dir_vec3(e,v.c.g.Fb,e),y.add(v.c.g.i,e,e),c=a.c.g.quat,b.nc?(w.copy(b.nc,c),w.multiply(v.c.g.quat,c,c)):w.copy(v.c.g.quat,
c)}"CAMERA"==a.c.g.type&&(e=k.AXIS_Y,10==b.type&&(v=b.W.c.g.quat,e=y.transformQuat(e,v,K)),r.ip(a),h(a,e))}function m(a,b,c){var d=t;k.quat_to_dir(b,k.AXIS_MY,d);y.normalize(d,d);var g=A;y.subtract(c,a,g);y.normalize(g,g);a=k.rB(d,g,u);w.multiply(a,b,b);w.normalize(b,b)}function h(a,b){var c=a.c.g,d=c.quat,f=k.quat_to_dir(c.quat,k.AXIS_Y,t);y.normalize(f,f);if(.999999<Math.abs(y.dot(b,f)))f=w.identity(g);else{var e=y.cross(b,f,A);y.normalize(e,e);if(c.Aa==r.MS_TARGET_CONTROLS)c.Zo&&y.negate(e,e);
else{var m=k.quat_to_dir(c.quat,k.AXIS_Z,x);0<y.dot(m,b)&&y.negate(e,e)}c=k.quat_to_dir(c.quat,k.AXIS_X,x);y.normalize(c,c);var m=k.clamp(y.dot(c,e),-1,1),l=Math.acos(m),f=-.999999>=m?w.setAxisAngle(f,l,g):w.rotationTo(c,e,g);w.normalize(f,f)}w.multiply(f,d,d);r.ip(a)}function n(a,b,c,d,e){var k=a.c.g,m=k.jg,l=k.Sc[b];b=l.Vi;a=a.pose.bones[l.so];var l=a.Kp,h=u,x=k.Oc,t=k.Nc,K=k.Gc,E=k.Fc,n=x[4*b+1],r=x[4*b+2],y=x[4*b+3],A=t[4*b+1],M=t[4*b+2],G=t[4*b+3];h[0]=(1-m)*x[4*b]+m*t[4*b];h[1]=(1-m)*n+m*A;
h[2]=(1-m)*r+m*M;h[3]=(1-m)*y+m*G;x=g;t=q;x[0]=K[4*b];x[1]=K[4*b+1];x[2]=K[4*b+2];x[3]=K[4*b+3];t[0]=E[4*b];t[1]=E[4*b+1];t[2]=E[4*b+2];t[3]=E[4*b+3];w.slerp(x,t,m,x);m=L;f.set_transcale(h,m);f.set_quat(x,m);c?(c=J,f.translate(l,a.Tv,c),f.multiply(m,c,m)):f.multiply(m,l,m);f.multiply(k.Fb,m,m);d[0]=m[0];d[1]=m[1];d[2]=m[2];d[3]=m[3];e&&(e[0]=m[4],e[1]=m[5],e[2]=m[6],e[3]=m[7])}var f=p("__tsr"),k=p("__util"),r=p("__camera"),y=p("vec3");p("vec4");var w=p("quat"),C=p("mat3");p("mat4");a.RD=1;a.QD=2;
a.VD=3;a.WD=4;a.LD=5;a.MD=6;a.SD=7;a.KD=8;a.PD=9;a.OD=10;a.Ud=11;a.ND=12;a.TD=13;a.UD=14;var D=new Float32Array(2),G=new Float32Array(2),t=new Float32Array(3),A=new Float32Array(3),x=new Float32Array(3),u=new Float32Array(4),g=new Float32Array(4),q=new Float32Array(4),L=new Float32Array(16),J=new Float32Array(16),E=new Float32Array(9),M=new Float32Array(9),L=new Float32Array(8),K=new Float32Array(3);a.gm=function(a,b,v,g,f){var e=c(1);e.W=b;e.offset=new Float32Array(v);e.nc=g?new Float32Array(g):
null;e.Al=f;d(a,e);l(a,e,0)};a.Tp=function(a,b,v,g,f,e){var k=c(2);k.W=b;k.Jw=v;k.offset=new Float32Array(g);k.nc=f?new Float32Array(f):null;k.Al=e;d(a,k);l(a,k,0)};a.fw=function(a,b,v,g){var f=c(9),e=a.c.g.quat,k=b.c.g.quat;f.W=b;f.offset=new Float32Array(v);f.Lg=new Float32Array(k);g&&(w.copy(g,e),w.multiply(k,e,e));d(a,f);l(a,f,0)};a.ew=function(a,b,v,g,f,e,m,h){var u=c(10),x=a.c.g.quat,t=b.c.g.quat;u.W=b;u.offset=new Float32Array(v);u.Lg=new Float32Array(t);u.gx=k.angle_wrap_0_2pi(f);u.hx=k.angle_wrap_0_2pi(e);
u.ix=k.angle_wrap_periodic(m,-Math.PI,Math.PI);u.fx=k.angle_wrap_periodic(h,-Math.PI,Math.PI);g?(u.nc=new Float32Array(g),w.copy(g,x),w.multiply(t,x,x)):u.nc=w.create();d(a,u);l(a,u,0)};a.dw=function(a,b,v,g){var f=c(12);f.W=b;f.offset=new Float32Array(v);f.bC=g;d(a,f);l(a,f,0)};a.hw=function(a,b,v,g){var f=c(13);f.W=b;f.offset=new Float32Array(v);f.Al=1;f.nc=g?new Float32Array(g):null;d(a,f);l(a,f,0)};a.kE=b;a.NF=e;a.jw=function(a,b){var v=c(3);v.W=b;d(a,v);l(a,v,0)};a.kw=function(a,b){var v=c(4);
v.target=new Float32Array(b);d(a,v);l(a,v,0)};a.aw=function(a,b,v,g){var f=c(5);f.W=b;f.Yi=v;f.dist_max=g;d(a,f);l(a,f,0)};a.bw=function(a,b,v,g){var f=c(6);f.target=new Float32Array(b);f.Yi=v;f.dist_max=g;d(a,f);l(a,f,0)};a.gw=function(a,b,v){var g=c(7);g.W=b;g.offset=new Float32Array(v);d(a,g);l(a,g,0)};a.$v=function(a,b,v){var g=c(8);g.W=b;g.offset=new Float32Array(v);d(a,g);l(a,g,0)};a.Zv=function(a,b,v){var g=c(11);g.W=b;g.Vt=new Float32Array(v);d(a,g);l(a,g,0)};a.append_stiff_viewport=function(a,
b,v){var g=c(14);g.W=b;if("left"in v)g.gs=!0,g.Sn=v.left;else if("right"in v)g.gs=!1,g.Sn=v.right;else{m_print.error("append_stiff_viewport: Wrong positioning params");return}if("top"in v)g.Tt=!0,g.cp=v.top;else if("bottom"in v)g.Tt=!1,g.cp=v.bottom;else{m_print.error("append_stiff_viewport: Wrong positioning params");return}"distance"in v?(g.distance=v.distance,g.nc="rotation"in v?new Float32Array(v.rotation):null,d(a,g),l(a,g,0)):m_print.error("append_stiff_viewport: Wrong positioning params")};
a.WC=function(a,b){a.c.Pa&&l(a,a.c.Pa,b)};a.qB=m;a.correct_up=h;a.Yw=function(a){return a.c.Pa?!0:!1};a.remove=function(a){a.c.Pa.W&&e(a.c.Pa.W,a);a.c.Pa=null};a.pe=function(a){return a.c.Pa?a.c.Pa.type:null};a.get_parent=function(a){return a.c.Pa&&a.c.Pa.W?a.c.Pa.W:null};a.oe=function(a){return a.c.Pa&&11==a.c.Pa.type?a.c.Pa.Vt:null};a.iz=n};b4w.module.__container=function(a,p){var c,d,b,e,l;function m(a,b){c=a;d=b}function h(){var a=k.getBoundingClientRect();m(a.left,a.top)}var n=p("__print"),f=p("__util"),k=null,r=null,y=!1;e=b=0;l=1;c=d=0;a.get_canvas=function(){return k};a.get_container=function(){return r};a.init=function(a){a&&a.parentNode?(k=a,r=a.parentNode):f.ha("canvas container is not available")};a.insert_to_container=function(a,b){b=b||"LAST";switch(b){case "FIRST":r.insertBefore(a,r.firstElementChild);break;case "JUST_BEFORE_CANVAS":r.insertBefore(a,
k);break;case "JUST_AFTER_CANVAS":k.nextElementSibling?r.insertBefore(a,k.nextElementSibling):r.appendChild(a,k);break;case "LAST":r.appendChild(a,k);break;default:n.error(b+" invalid stack order")}};a.Fz=function(){return b};a.Ez=function(){return e};a.set_canvas_offsets=m;a.update_canvas_offsets=h;a.UB=function(a,c,d){b=a;e=c;l=d;h()};a.force_offsets_updating=function(){y=!0};a.client_to_canvas_coords=function(a,b,f){f||(f=new Float32Array(2));var e=f;y&&(h(),y=!1);e[0]=a-c;a=f;y&&(h(),y=!1);a[1]=
b-d;return f};a.Am=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a*l;d[1]=c*l;f&&(a=f.width/b,d[0]*=a,d[1]*=a);return d};a.AD=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a/l;d[1]=c/l;f&&(a=f.width/b,d[0]/=a,d[1]/=a)};a.Vr=function(b){return b&&b.parentNode?b.parentNode==r?!0:a.Vr(b.parentNode):!1}};b4w.module.__controls=function(a,p){function c(a){return{type:a,value:0,ga:null,ld:!1,key:0,Va:"",Ad:!1,Gm:null,Fm:function(){},Em:null,Aq:function(){},Be:null,V:new Float32Array(3),ua:new Float32Array(3),Ur:!1,Uk:!1,Xs:0,Ws:function(){},axis:"",Mc:0,si:new Float32Array(3),vl:new Float32Array(4),threshold:0,Ts:new Float32Array(4),nk:0,mk:0,ft:0,ok:0,ad:0,repeat:!1,bq:!1,Tk:0,Sk:0,Rk:0,Bn:0,An:0,zn:0}}function d(a,b){a.value=Number(b)}function b(a){for(var b=a.sd,z=a.AB,c=0;c<b.length;c++)z[c]=b[c].value;
return a.pA(z)}function e(a){a=I.indexOf(a);-1<a?I.splice(a,1):u.error("Wrong object")}function l(a,b){for(var z=0,c=0;c<b.length;c++)for(var v=b[c].Me,d=0;d<v.length;d++)for(var g=v[d].sd,F=0;F<g.length;F++)g[F]===a&&z++;return z}function m(a,b){switch(a.type){case 80:g.remove_collision_test(a.Gm,a.Va,a.Fm);a.ld=!0;break;case 90:g.clear_collision_impulse_test(a.Em);a.ld=!0;break;case 100:g.remove_ray_test(a.Xs);a.ld=!0;break;case 130:a.ld=!0}var z=b.indexOf(a);-1<z&&b.splice(z,1)}function h(a){for(var b=
0;b<v.length;b++){var z=v[b];20==z.type&&a.keyCode==z.key&&d(z,1)}N&&a.preventDefault();sa&&sa(a)}function n(a){for(var b=0;b<v.length;b++){var z=v[b];20==z.type&&0==a.keyCode&&16==z.key&&d(z,0);20==z.type&&a.keyCode==z.key&&d(z,0)}N&&a.preventDefault();sa&&sa(a)}function f(a){var b=!1,c=null;ba=!0;R=a.clientX;W=a.clientY;Z=a.clientX;aa=a.clientY;for(var g=0;g<v.length;g++){var F=v[g];50==F.type&&(d(F,1),F.ga=a.which);160==F.type&&(b||(b=x.client_to_canvas_coords(a.clientX,a.clientY,X),c=q.pick_object(b[0],
b[1]),b=!0),F.value=c==F.Be?1:0)}ia&&a.preventDefault();z&&z(a)}function k(a){for(var b=0;b<v.length;b++){var c=v[b];50==c.type&&d(c,0);160==c.type&&c.bq&&(c.value=0)}ba=!1;ia&&!ja&&a.preventDefault();z&&z(a)}function r(a){var b=a.clientX,c=a.clientY;Z=b;aa=c;if(!Q.Fn||ba)for(var g=b-R,F=c-W,I=Math.sqrt(g*g+F*F),f=0;f<v.length;f++){var H=v[f];if(40===H.type)switch(H.axis){case "X":d(H,g);H.ga=b;break;case "Y":d(H,F);H.ga=c;break;case "XY":d(H,I),H.ga[0]=b,H.ga[1]=c}}ia&&!ja&&a.preventDefault();z&&
z(a)}function y(a){x.Vr(a.relatedTarget)||k(a)}function w(a){var b=a.wheelDelta||-40*a.detail,b=b*K.CA;P+=b;for(b=0;b<v.length;b++){var z=v[b];30===z.type&&d(z,P)}ta&&a.preventDefault();F&&F(a)}function C(a){var b=a.targetTouches;if(1==b.length){for(var z=b[0],b=z.clientX,z=z.clientY,c=!1,d=null,g=0;g<v.length;g++){var F=v[g];160==F.type&&(c||(c=x.client_to_canvas_coords(b,z,X),d=q.pick_object(c[0],c[1]),c=!0),F.value=d==F.Be)}S[0]=b;S[1]=-1;oa[0]=z;oa[1]=-1}else 1<b.length&&(ea=fa=t(b),S[0]=b[0].clientX,
S[1]=b[1].clientX,oa[0]=b[0].clientY,oa[1]=b[1].clientY);U.set(S);ca.set(oa);ka&&ka(a)}function D(b){var z=b.targetTouches;if(0!==z.length){if(1===z.length){U[0]=z[0].clientX;U[1]=-1;ca[0]=z[0].clientY;ca[1]=-1;var z=U[0]-S[0],c=ca[0]-oa[0],g=Math.sqrt(z*z+c*c);if(-1!=S[1]&&-1!=oa[1]){var F=U[0]-S[1],I=ca[0]-oa[1],f=Math.sqrt(F*F+I*I);f<g&&(z=F,c=I,g=f)}for(f=0;f<v.length;f++){var H=v[f];if(60===H.type)switch(H.ga=a.PL_SINGLE_TOUCH_MOVE,H.axis){case "X":d(H,z);break;case "Y":d(H,c);break;case "XY":d(H,
g)}}}else if(1<z.length){U[0]=z[0].clientX;U[1]=z[1].clientX;ca[0]=z[0].clientY;ca[1]=z[1].clientY;ea=t(z);g=ea-fa;F=X;F[0]=(U[0]+U[1])/2;F[1]=(ca[0]+ca[1])/2;I=da;I[0]=(S[0]+S[1])/2;I[1]=(oa[0]+oa[1])/2;var e,z=F[0],c=F[1],f=I[0],H=I[1];e=Math.sqrt((z-f)*(z-f)+(c-H)*(c-H));for(f=0;f<v.length;f++)if(H=v[f],70===H.type&&Math.abs(e)<Math.abs(g)&&(H.ga=a.PL_MULTITOUCH_MOVE_ZOOM,d(H,g)),60===H.type&&Math.abs(e)>Math.abs(g))switch(H.ga=a.PL_MULTITOUCH_MOVE_PAN,H.axis){case "X":z=F[0]-I[0];d(H,z);break;
case "Y":c=F[1]-I[1];d(H,c);break;case "XY":d(H,e)}}Y&&b.preventDefault();ka&&ka(b)}}function G(a){for(var b=0;b<v.length;b++){var z=v[b];if(170==z.type||180==z.type)z.Sk=a.beta,z.Tk=a.gamma,z.Rk=a.alpha,z.value||(z.Bn=a.gamma,z.An=a.beta,z.zn=a.alpha,d(z,1))}}function t(a){var b=a[0],z=a[1];a=b.clientX;var b=b.clientY,c=z.clientX,z=z.clientY;return Math.sqrt((a-c)*(a-c)+(b-z)*(b-z))}var A=p("__config"),x=p("__container"),u=p("__print"),g=p("__physics"),q=p("__scenes"),L=p("__time"),J=p("__util"),
E=p("vec3"),M=p("quat"),K=A.controls,Q=A.r,I=[],v=[],H={},P=0,Z=0,aa=0,R=0,W=0,ba=!1,U=new Float32Array(2),ca=new Float32Array(2),S=new Float32Array(2),oa=new Float32Array(2),X=new Float32Array(2),da=new Float32Array(2),ea=0,fa=0,ga=!1,B=0,N=!1,ia=!1,ta=!1,Y=!1,ja=!1,sa=null,z=null,F=null,ka=null;a.CT_CONTINUOUS=10;a.CT_TRIGGER=20;a.CT_SHOT=30;a.CT_LEVEL=40;a.CT_CHANGE=50;a.PL_SINGLE_TOUCH_MOVE=0;a.PL_MULTITOUCH_MOVE_ZOOM=1;a.PL_MULTITOUCH_MOVE_PAN=2;a.update=function(z,c){for(var g=0;g<v.length;g++){var F=
v[g],f=z,e=c;if(e)switch(F.type){case 110:var k=F.Be,m=k.c.g.i,k=k.c.g.quat,l=E.dist(F.si,m),h=F.Ts;M.invert(F.vl,h);M.multiply(k,h,h);M.normalize(h,h);h=Math.abs(2*Math.acos(h[3]));l/=e;F.nk=J.smooth(l,F.nk,e,.3);F.ga[0]=l;l=h/e;F.mk=J.smooth(l,F.mk,e,.3);F.ga[1]=l;F.nk>=F.threshold||F.mk>=F.ft?d(F,1):d(F,0);E.copy(m,F.si);M.copy(k,F.vl);F.Mc=f;break;case 120:k=F.Be;m=k.c.g.i;k=Math.abs(m[1]-F.si[1])/e;F.ok=J.smooth(k,F.ok,e,.3);F.ga=k;F.ok>=F.threshold?d(F,1):d(F,0);E.copy(m,F.si);F.Mc=f;break;
case 130:!F.ld&&0<=F.ad&&f-F.Mc>=F.ad&&(d(F,1),F.repeat?F.Mc=f:F.ad=-F.ad);break;case 140:F.Mc||(F.Mc=f);d(F,f-F.Mc);F.Mc=f;break;case 150:d(F,f);break;case 170:F.ga[0]=Math.PI*(F.Tk-F.Bn)/180;F.ga[1]=Math.PI*(F.Sk-F.An)/180;F.ga[2]=Math.PI*(F.Rk-F.zn)/180;F.Bn=F.Tk;F.An=F.Sk;F.zn=F.Rk;break;case 180:F.ga[0]=Math.PI*F.Tk/180,F.ga[1]=Math.PI*F.Sk/180,F.ga[2]=Math.PI*F.Rk/180}}for(g=0;g<I.length;g++)for(e=I[g],F=e.Me,f=0;f<F.length;f++)if(m=F[f],m.Xt!=B){m.Xt=B;h=m;k=0;switch(h.type){case a.CT_CONTINUOUS:k=
h.se;(l=b(h))?(k=1,h.se=1):1==k?(k=-1,h.se=-1):k=0;break;case a.CT_TRIGGER:k=h.se;(l=b(h))&&-1==k?(k=1,h.se=1):l||1!=k?k=0:(k=-1,h.se=-1);break;case a.CT_SHOT:k=h.se;(l=b(h))&&-1==k?(k=1,h.se=1):l||1!=k?k=0:(k=0,h.se=-1);break;case a.CT_LEVEL:l=b(h);h.ds!=l?(k=1,h.ds=l):k=0;break;case a.CT_CHANGE:for(var l=h.sd,h=h.kA,u=0;u<l.length;u++){var x=l[u].value;k||x==h[u]||(k=1);h[u]=x}break;default:J.ha("Wrong sensor manifold type: "+h.type)}if(k&&(l=e==H?null:e,ga=!1,m.callback(l,m.id,k,m.Ow),ga)){g=-1;
break}}for(g=0;g<I.length;g++)for(e=I[g],F=e.Me,f=0;f<F.length;f++)for(m=F[f],e=m.sd,m=0;m<e.length;m++)switch(k=e[m],k.type){case 30:d(k,0);break;case 40:d(k,0);break;case 60:d(k,0);break;case 70:d(k,0);break;case 130:d(k,0)}P=0;R=Z;W=aa;S.set(U);oa.set(ca);fa=ea;B++};a.create_custom_sensor=function(a){var b=c(10);d(b,a);return b};a.create_keyboard_sensor=function(a){var b=c(20);b.key=a;return b};a.create_collision_sensor=function(a,b,z){if(!a||!g.K(a))return u.error("Wrong collision object"),null;
var v=c(80);v.Gm=a;v.Va=b;v.Ad=z;v.ga={coll_obj:null,coll_pos:z?new Float32Array(3):null,coll_norm:z?new Float32Array(3):null,coll_dist:0};v.Fm=function(a,b,z,c,F){d(v,a);a=v.ga;a.coll_obj=b;v.Ad&&(a.coll_pos.set(z),a.coll_norm.set(c),a.coll_dist=F)};v.ld=!0;return v};a.create_collision_impulse_sensor=function(a){if(!a||!a.c.q)return u.error("Wrong collision impulse object"),null;var b=c(90);b.Em=a;b.Aq=function(a){d(b,a)};b.ld=!0;return b};a.create_ray_sensor=function(a,b,z,v,F,g,I){var f=c(100);
f.Be=a;f.V=b;f.ua=z;f.Va=v;f.Ur=F;f.Ad=g;f.Uk=I;f.ga={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3)};f.Ws=function(a,b,z,c,v,F){f.Ur?d(f,-1==b?0:1):d(f,b);f.ga.hit_fract=b;f.ga.obj_hit=z;f.ga.hit_time=c;f.Ad&&(f.ga.hit_pos.set(v),f.ga.hit_norm.set(F))};f.ld=!0;return f};a.create_mouse_click_sensor=function(){return c(50)};a.create_mouse_wheel_sensor=function(){return c(30)};a.create_mouse_move_sensor=function(a){var b=c(40);b.axis=a||"XY";b.ga="XY"==
b.axis?new Float32Array(2):0;return b};a.create_touch_move_sensor=function(a){var b=c(60);b.axis=a||"XY";b.ga=0;return b};a.create_touch_zoom_sensor=function(){var a=c(70);a.ga=0;return a};a.create_motion_sensor=function(a,b,z){if(!a)return u.error("Wrong collision object"),null;var v=c(110);v.Be=a;var d=a.c.g.i;a=a.c.g.quat;v.Ts=new Float32Array(4);v.si=new Float32Array(d);v.vl=new Float32Array(a);v.nk=0;v.mk=0;v.threshold=b||.1;v.ft=z||.1;v.Mc=0;v.ga=new Float32Array([0,0]);return v};a.create_vertical_velocity_sensor=
function(a,b){if(!a)return u.error("Wrong collision object"),null;var z=c(120);z.Be=a;var v=a.c.g.quat;z.si=new Float32Array(a.c.g.i);z.vl=new Float32Array(v);z.ok=0;z.threshold=b||1;z.Mc=0;z.ga=0;return z};a.create_timer_sensor=function(a,b){var z=c(130);z.ad=a;z.repeat=b;z.ld=!0;return z};a.reset_timer_sensor=function(a,b,z,c){a=a||H;a=a.fd;if(!a||!a[b])return u.error("reset_timer_sensor(): wrong object"),null;b=a[b].sd[z];if(!b)return u.error("reset_timer_sensor(): sensor not found"),null;b.Mc=
L.get_timeline();b.ad=c};a.create_elapsed_sensor=function(){var a=c(140);a.Mc=0;return a};a.create_gyro_delta_sensor=function(){var a=c(170);a.ga=new Float32Array(3);return a};a.create_gyro_angles_sensor=function(){var a=c(180);a.ga=new Float32Array(3);return a};a.create_timeline_sensor=function(){return c(150)};a.create_selection_sensor=function(a,b){var z=c(160);z.Be=a;z.bq=b;return z};a.zB=d;a.get_sensor_value=function(a,b,z){a=a||H;a=a.fd;if(!a||!a[b])return u.error("get_sensor_value(): wrong object"),
null;b=a[b].sd[z];return b?b.value:(u.error("get_sensor_value(): sensor not found"),null)};a.get_sensor_payload=function(a,b,z){a=a||H;a=a.fd;if(!a||!a[b])return u.error("get_sensor_payload(): wrong object"),null;b=a[b].sd[z];return b?b.ga:(u.error("get_sensor_payload(): sensor not found"),null)};a.cleanup=function(){I=[];v=[];H={}};a.check_sensor_manifold=function(a,b){a=a||H;if(!a.fd)return!1;if(b&&a.fd[b])return!0;if(!b)for(var z in a.fd)return!0;return!1};a.remove_sensor_manifold=function(a,b){a=
a||H;var z=a.fd;if(z){var c=a.Me;if(b){var d=z[b];if(d){for(var F=d.sd,g=0;g<F.length;g++)1===l(F[g],I)&&m(F[g],v);delete z[b];d=c.indexOf(d);-1<d?c.splice(d,1):J.ha("Incorrect manifolds array");Object.getOwnPropertyNames(z).length||e(a)}}else{for(b in z){d=z[b];F=d.sd;for(g=0;g<F.length;g++)1===l(F[g],I)&&m(F[g],v);delete z[b];d=c.indexOf(d);-1<d?c.splice(d,1):J.ha("Incorrect manifolds array")}e(a);ga=!0}}};a.create_sensor_manifold=function(a,b,z,c,d,F,f){a=a||H;a.fd=a.fd||{};a.Me=a.Me||[];var e=
a.fd,k=a.Me,h=e[b];if(h){c=h.sd;for(var u=0;u<c.length;u++)1===l(c[u],I)&&m(c[u],v);h=k.indexOf(h);-1<h?k.splice(h,1):J.ha("Incorrect manifolds array")}z={id:b,type:z,sd:c.slice(0),pA:d,AB:Array(c.length),callback:F,Ow:f,se:-1,ds:0,kA:Array(c.length),Xt:-1};e[b]=z;k.push(z);-1==I.indexOf(a)&&I.push(a);a=z.sd;for(b=0;b<a.length;b++){e=a[b];if(e.ld){switch(e.type){case 80:g.append_collision_test(e.Gm,e.Va,e.Fm,e.Ad);break;case 90:g.apply_collision_impulse_test(e.Em,e.Aq);break;case 100:e.Xs=g.append_ray_test(e.Be,
e.V,e.ua,e.Va,e.Ws,!1,!1,e.Ad,e.Uk);break;case 130:e.Mc=L.get_timeline(),0>e.ad&&(e.ad=-e.ad)}e.ld=!1}-1==v.indexOf(e)&&v.push(e)}ga=!0};a.Tq=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.ey=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.reset=function(){for(var a=0;a<I.length;a++){var b=I[a],z=b.fd,b=b.Me,c;for(c in z)delete z[c];b.splice(0,b.length)}for(a=0;a<v.length;a++)m(v[a],v),a--;I.splice(0,I.length)};a.debug=function(){u.log(String(I.length)+
" objects with manifolds",I);u.log(String(v.length)+" sensors",v);for(var a=[],b=[],z=0;z<v.length;z++){var c=v[z];80==c.type&&a.push(c);100==c.type&&b.push(c)}u.log(String(a.length)+" collision sensors",a);u.log(String(b.length)+" ray sensors",b)};a.register_keyboard_events=function(a,b){a.addEventListener("keydown",h,!1);a.addEventListener("keyup",n,!1);N=b};a.register_mouse_events=function(a,b,z){if(z)var c=window;else c=a,c.addEventListener("mouseout",y,!1);a.addEventListener("mousedown",f,!1);
c.addEventListener("mousemove",r,!1);c.addEventListener("mouseup",k,!1);ia=b;ja=z};a.register_wheel_events=function(a,b){a.addEventListener("mousewheel",w,!1);a.addEventListener("DOMMouseScroll",w,!1);ta=b};a.register_touch_events=function(a,b){a.addEventListener("touchstart",C,!1);a.addEventListener("touchmove",D,!1);document.addEventListener("touchstart",function(){});Y=b};a.register_device_orientation=function(){window.DeviceOrientationEvent&&Q.gyro_use&&window.addEventListener("deviceorientation",
G,!1)};a.unregister_keyboard_events=function(a){a.removeEventListener("keydown",h,!1);a.removeEventListener("keyup",n,!1)};a.unregister_mouse_events=function(a){a.removeEventListener("mousedown",f,!1);a.removeEventListener("mousemove",r,!1);a.removeEventListener("mouseout",y,!1);a.removeEventListener("mouseup",k,!1)};a.unregister_wheel_events=function(a){a.removeEventListener("mousewheel",w,!1);a.removeEventListener("DOMMouseScroll",w,!1)};a.unregister_touch_events=function(a){a.removeEventListener("touchstart",
C,!1);a.removeEventListener("touchmove",D,!1);document.removeEventListener("touchstart",function(){})};a.unregister_device_orientation=function(){window.DeviceOrientationEvent&&Q.gyro_use&&window.removeEventListener("deviceorientation",G,!1)};a.iE=function(a){sa=a};a.jE=function(a){z=a};a.mE=function(a){F=a};a.lE=function(a){ka=a}};b4w.module.__curve=function(a,p){function c(a,b,c,d,f){var e=d.length;f||(f=new Float32Array(e));for(var r=e+a,y=new Float32Array(r),w=1;w<=r-1;w++)y[w-1]=b>=c[w-1]&&b<c[w+1-1]?1:0;for(var C=2;C<=a;C++)for(w=1;w<=r-C;w++)y[w-1]=(0!=y[w-1]?(b-c[w-1])*y[w-1]/(c[w+C-1-1]-c[w-1]):0)+(0!=y[w+1-1]?(c[w+C-1]-b)*y[w+1-1]/(c[w+C-1]-c[w+1-1]):0);b==c[r-1]&&(y[e-1]=1);a=0;for(w=1;w<=e;w++)a+=y[w-1]*d[w-1];for(w=1;w<=e;w++)f[w-1]=0!=a?y[w-1]*d[w-1]/a:0;return f}function d(a){a=a.bl;return a[a.length-1]}function b(a){a=
a.Pq;return a[a.length-1]}var e=p("__util");a.Qx=function(a){var b={},d=a.data;a=d.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var e=a.order_u;b.of=e;a=a.points;var f=a.length/5,k=[],r=f+e,f=f+2;k[0]=0;for(var y=2;y<=r;y++)k[y-1]=y>e&&y<f?k[y-2]+1:k[y-2];b.bl=k;if("2D"==d.dimensions)b.jf=!1;else if("3D"==d.dimensions)b.jf=!0;else throw"Wrong curve dimensions";e=[];k=[];for(d=0;d<a.length;d+=5)e.push(a[d]),e.push(a[d+1]),e.push(a[d+2]),b.jf&&e.push(a[d+3]),k.push(a[d+4]);b.Km=
e;b.sp=k;a=[];for(var d=b.Km,e=b.jf?4:3,k=b.sp,r=b.bl,f=b.of,y=d.length/e,w=y+f,C=0,D=r[w-1]/999,G=0;1E3>G;G++){5E-6>r[w-1]-C&&(C=r[w-1]);for(var t=c(f,C,r,k),A=0;A<e;A++)for(var x=a[e*G+A]=0;x<y;x++)a[e*G+A]+=t[x]*d[e*x+A];C+=D}e=b.jf?4:3;k=new Float32Array(1E3);k[0]=0;for(d=1;1E3>d;d+=1)r=a[(d-1)*e],f=a[(d-1)*e+1],y=a[(d-1)*e+2],w=a[d*e],C=a[d*e+1],D=a[d*e+2],k[d]=k[d-1]+Math.sqrt((w-r)*(w-r)+(C-f)*(C-f)+(D-y)*(D-y));b.Pq=k;return b};a.oC=function(a,b,e){e||(e=[]);var n=b,f=Math.max(n,0);b=f=Math.min(n,
d(a));var n=a.Km,f=a.jf?4:3,k=a.sp,r=a.bl,y=a.of;a=n.length/f;var w=a+y;5E-6>r[w-1]-b&&(b=r[w-1]);w=new Float32Array(a);c(y,b,r,k,w);for(b=0;b<f;b++)for(k=e[b]=0;k<a;k++)e[b]+=w[k]*n[f*k+b]};a.lC=function(a,b,c){c||(c=[]);var d=a.Km,f=a.jf?4:3,e=a.sp,r=a.bl,y=a.of;a=d.length/f;var w=a+y;5E-6>r[w-1]-b&&(b=r[w-1]);var w=new Float32Array(a),C=b;b=w;var D=e.length;b||(b=new Float32Array(D));var G=new Float32Array(D),t=new Float32Array(D),A=G,x=t;A||(A=new Float32Array(D));x||(x=new Float32Array(D));for(var u=
D+y,g=new Float32Array(u),q=new Float32Array(u),L=1;L<=u-1;L++)g[L-1]=C>=r[L-1]&&C<r[L+1-1]?1:0;C==r[u-1]&&(g[D-1]=1);for(var J=2;J<=y;J++)for(L=1;L<=u-J;L++){var E=0!=g[L-1]?g[L-1]/(r[L+J-1-1]-r[L-1]):0,M=0!=g[L+1-1]?-g[L+1-1]/(r[L+J-1]-r[L+1-1]):0,K=0!=q[L-1]?(C-r[L-1])*q[L-1]/(r[L+J-1-1]-r[L-1]):0,Q=0!=q[L+1-1]?(r[L+J-1]-C)*q[L+1-1]/(r[L+J-1]-r[L+1-1]):0;g[L-1]=(0!=g[L-1]?(C-r[L-1])*g[L-1]/(r[L+J-1-1]-r[L-1]):0)+(0!=g[L+1-1]?(r[L+J-1]-C)*g[L+1-1]/(r[L+J-1]-r[L+1-1]):0);q[L-1]=E+M+K+Q}for(L=1;L<=
D;L++)A[L-1]=g[L-1],x[L-1]=q[L-1];r=0;for(y=1;y<=D;y++)r+=G[y-1]*e[y-1];C=0;for(y=1;y<=D;y++)C+=t[y-1]*e[y-1];for(y=1;y<=D;y++)b[y-1]=0!=r?t[y-1]*e[y-1]/r+G[y-1]*e[y-1]*C/(r*r):0;for(e=0;e<f;e++)for(r=c[e]=0;r<a;r++)c[e]+=w[r]*d[f*r+e]};a.WF=d;a.nC=b;a.mC=function(a,c){if(0>=c)return 0;var h=d(a);if(c>=b(a))return h;var n=a.Pq,f=e.qk(n,c,0,n.length-1);return h*(f+(c-n[f])/(n[f+1]-n[f]))/1E3}};b4w.module.__dds=function(a,p){function c(a,b,c,d){var f=new Uint16Array(4),e=new Uint16Array(c*d),m=0,h=0,l=0,x=h=m=0,u=0,g=0,q=0,n=c/4;d/=4;for(var J=0;J<d;J++)for(var E=0;E<n;E++)l=b+4*(J*n+E),f[0]=a[l],f[1]=a[l+1],m=f[0]&31,h=f[0]&2016,x=f[0]&63488,u=f[1]&31,g=f[1]&2016,q=f[1]&63488,f[2]=5*m+3*u>>3|5*h+3*g>>3&2016|5*x+3*q>>3&63488,f[3]=5*u+3*m>>3|5*g+3*h>>3&2016|5*q+3*x>>3&63488,m=a[l+2],h=4*J*c+4*E,e[h]=f[m&3],e[h+1]=f[m>>2&3],e[h+2]=f[m>>4&3],e[h+3]=f[m>>6&3],h+=c,e[h]=f[m>>8&3],e[h+1]=f[m>>
10&3],e[h+2]=f[m>>12&3],e[h+3]=f[m>>14],m=a[l+3],h+=c,e[h]=f[m&3],e[h+1]=f[m>>2&3],e[h+2]=f[m>>4&3],e[h+3]=f[m>>6&3],h+=c,e[h]=f[m>>8&3],e[h+1]=f[m>>10&3],e[h+2]=f[m>>12&3],e[h+3]=f[m>>14];return e}function d(a,b,d,e){var C=new Int32Array(d,0,31),D,G,t,A,x,u;if(542327876!=C[0])return m.error("Invalid magic number in DDS header"),0;if(!C[20]&4)return m.error("Unsupported format, must contain a FourCC code"),0;D=C[21];switch(D){case h:G=8;t=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case n:G=16;t=
b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case f:G=16;t=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return m.error("Unsupported FourCC code:",l(D)),null}u=1;C[2]&131072&&!1!==e&&(u=Math.max(1,C[7]));A=C[4];x=C[3];C=C[1]+4;if(b)for(D=0;D<u;++D)e=Math.max(4,A)/4*Math.max(4,x)/4*G,b=new Uint8Array(d,C,e),a.compressedTexImage2D(a.TEXTURE_2D,D,t,A,x,0,b),C+=e,A=Math.max(.5*A,1),x=Math.max(.5*x,1);else if(D==h)Math.max(4,A),Math.max(4,x),b=new Uint16Array(d),d=c(b,C/2,A,x),a.texImage2D(a.TEXTURE_2D,
0,a.RGB,A,x,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,d),e&&a.generateMipmap(a.TEXTURE_2D);else return m.error("No manual decoder for",l(D),"and no native support"),0;return u}function b(a,b,c,f,e,m){var h=new XMLHttpRequest;h.open("GET",c,!0);h.responseType="arraybuffer";h.onload=function(){if(200==h.status){a.bindTexture(a.TEXTURE_2D,f);var c=d(a,b,h.response,e);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<c?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}m&&
m(f)};h.send(null);return f}function e(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function l(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var m=p("__print"),h=e("DXT1"),n=e("DXT3"),f=e("DXT5");a.ME=c;a.jD=d;a.Br=function(a){a=new Int32Array(a,0,31);return{width:a[4],height:a[3]}};a.lz=function(a){var b=1;a=(new Int32Array(a,0,31))[21];switch(a){case h:b=6;break;case n:case f:b=4;break;default:m.error("Unsupported FourCC code:",l(a))}return b};
a.DF=b;a.CF=function(a,c,d,f){var e=a.createTexture();b(a,c,d,e,!0,f);return e}};b4w.module.__debug=function(a,p){function c(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function d(a,b){typeof a!=typeof b&&m.ha("Structure assertion failed: incompatible types");for(var c in a)c in b||m.ha("Structure assertion failed: missing key in the first object: "+c);for(c in b)c in a||m.ha("Structure assertion failed: missing key in the second object: "+c),typeof a[c]!=typeof b[c]&&m.ha("Structure assertion failed: incompatible types for key "+c)}var b=
p("__extensions"),e=p("__print"),l=p("__textures"),m=p("__util"),h=null,n={},f=!1,k={},r=[],y=-1,w=null,C=!1;a.Fp={WM_OPAQUE_WIREFRAME:0,WM_TRANSPARENT_WIREFRAME:1,WM_FRONT_BACK_VIEW:2,WM_DEBUG_SPHERES:3};a.td=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;for(c in b){var d=b[c];d in a&&(n[a[d]]=d)}h=a};a.$w=function(a){if(f){var b=h.getError();b!=h.NO_ERROR&&(b in n?m.ha("GL Error: "+b+", gl."+n[b]+" ("+
a+")"):m.ha("Unknown GL error: "+b+" ("+a+")"))}};a.Ww=function(){if(f)switch(h.checkFramebufferStatus(h.FRAMEBUFFER)){case h.FRAMEBUFFER_COMPLETE:break;case h.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case h.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case h.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");
break;case h.FRAMEBUFFER_UNSUPPORTED:e.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;default:e.error("FRAMEBUFFER CHECK FAILED")}};a.uq=function(){if(-1!=y)return y;h.bindFramebuffer(h.FRAMEBUFFER,h.createFramebuffer());var a=l.Ck("DEBUG",l.Ci);l.resize(a,1,1);h.framebufferTexture2D(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,a.Wb,a.fb,0);h.checkFramebufferStatus(h.FRAMEBUFFER)!=h.FRAMEBUFFER_COMPLETE?(y=!0,e.warn("depth-only issue was found")):y=!1;h.bindFramebuffer(h.FRAMEBUFFER,null);return y};
a.ax=function(a,b,d){if(f&&!h.getShaderParameter(a,h.COMPILE_STATUS))throw d=c(d),e.error("shader compilation failed:\n"+d+"\n"+h.getShaderInfoLog(a)+" ("+b+")"),"Engine failed: see above for error messages";};a.bx=function(a,d,k,m,u,g){if(f&&!h.getProgramParameter(a,h.LINK_STATUS)){var l=b.sr();l&&(u=l.getTranslatedShaderSource(k),g=l.getTranslatedShaderSource(m));u=c(u);g=c(g);e.error("shader linking failed:\n"+u+"\n\n\n"+g+"\n"+h.getProgramInfoLog(a)+" ("+d+")");throw"Engine failed: see above for error messages";
}};a.set_check_gl_errors=function(a){f=a};a.NE=function(a){k[a]=a in k?k[a]+1:1};a.update=function(){for(var a in k)e.log(a,k[a]),k[a]=0};a.fbmsg=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(m.is_vector(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(arguments[b])}r.push(a)};a.msg=function(){for(var a=1,b=0;b<r.length;b++){var c=r[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],m.is_vector(a))for(var d=0;d<a.length;d++)c.push(a[d]);
else c.push(arguments[b]);r.push(c)};var D=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.print_telemetry=function(a){a||(a=1);for(var b=0,c={},d=Math.max(0,performance.now()-1E3*a),f=0;f<r.length;f++){var g=r[f];a=g[0];if(!(a<d)){var k=String(g[1]);c[k]||(c[k]=D[b++%D.length]);a=["%c"+(a/1E3).toFixed(6),c[k],k];for(k=2;k<g.length;k++)a.push(g[k]);e.log.apply(this,a)}}r.splice(0)};a.plot_telemetry=function(a){a||(a=1);for(var b={},c=Math.max(0,performance.now()-
1E3*a),d=0;d<r.length;d++){var f=r[d];a=f[0];if(!(a<c))for(var g=2;g<f.length;g++){var k=String(f[1]);3<f.length&&(k+="_"+String(g-2));b[k]||(b[k]=k+"\n");b[k]+=String(a)+" "+f[g]+"\n"}}a="";for(k in b)a+=b[k]+"\n\n";e.log(a);r.splice(0)};a.vE=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&
b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.check_finite=function(a){if(m.is_vector(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.fE=function(a,b){a.constructor!=b&&m.ha("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.gE=d;a.hE=function(a){C?d(a,w):C=!0;w=a}};b4w.module.__extensions=function(a,p){function c(a){if(a in e)return e[a];var c=b.getExtension(a)||null;e[a]=c;d.log("%cGET EXTENSION","color: #"+(c?"0a0":"a00"),a);return c}var d=p("__print"),b=null,e={};a.td=function(a){b=a};a.yr=function(){return c("WEBGL_compressed_texture_s3tc")||c("WEBKIT_WEBGL_compressed_texture_s3tc")||c("MOZ_WEBGL_compressed_texture_s3tc")};a.nz=function(){return c("WEBGL_depth_texture")||c("WEBKIT_WEBGL_depth_texture")||c("MOZ_WEBGL_depth_texture")};a.fz=function(){return c("EXT_texture_filter_anisotropic")||
c("WEBKIT_EXT_texture_filter_anisotropic")||c("MOZ_EXT_texture_filter_anisotropic")};a.sr=function(){return c("WEBGL_debug_shaders")};a.xr=function(){return c("WEBGL_debug_renderer_info")};a.tr=function(){return c("OES_element_index_uint")};a.Az=function(){return c("OES_standard_derivatives")};a.cleanup=function(){e={}}};b4w.module.__graph=function(a,p){function c(a,b,c){c||(c=null);if(d(a,b))throw"Graph already has node with given ID";a.U.push(b,c)}function d(a,b){for(var c=a.U,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function b(a,b,c,g){g||(g=null);if(d(a,b)&&d(a,c))a.Y.push(b,c,g);else throw"Wrong node IDs";}function e(a,b){if(!d(a,b))throw"Node not found";for(var c=a.U,g=0;g<c.length;g+=2)c[g]==b&&(c.splice(g,2),g-=2)}function l(a,b,c,d){if(!L(a,b,c))throw"Edge not found";a=a.Y;for(var g=0,f=0;f<a.length;f+=
3)if(a[f]==b&&a[f+1]==c){if(-1==d)a.splice(f,3);else{if(d==g){a.splice(f,3);break}g++}f-=3}}function m(a){a=a.U;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function h(a,b){for(var c=a.U,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function n(a){var b=[],c={};f(a,c);for(var d=a.U,g=0;g<d.length;g+=2)0==u(a,d[g])&&k(a,d[g],c,b);return{U:b,Y:a.Y.slice(0)}}function f(a,b){for(var c=a.U,d=0;d<c.length;d+=2)b[c[d]]=!1}function k(a,b,c,d){if(!c[b]){c[b]=!0;for(var f=0;f<x(a,b);f++)k(a,
g(a,b,f),c,d);d.unshift(b,A(a,b))}}function r(a,b,c,d){if(!c[b]){c[b]=!0;if(10==d||30==d)for(var f=0;f<x(a,b);f++){var e=g(a,b,f);r(a,e,c,d)}if(20==d||30==d)for(f=0;f<u(a,b);f++)e=q(a,b,f),r(a,e,c,d)}}function y(a){for(var b=[],c=a.U,d=0;d<c.length;d+=2){var g=c[d];x(a,g)||b.push(g)}return b}function w(a){var b=a.U;a=a.Y;for(var c=[],d=[],g=[],f=0;f<b.length;f++)g[b[2*f]]=f,c.push(f,b[2*f+1]);for(f=0;f<a.length;f+=3)d.push(g[a[f]],g[a[f+1]],a[f+2]);return{U:c,Y:d}}function C(a,b,c){if(c.Bd==c.nf){for(var d=
0,f=0;d<c.nf;d++)-1!=c.fe[d]&&(a[f]=d,b[f]=c.fe[d],f++);return!0}if(c.nf>c.Uh||c.Df>c.Ef||c.pi>c.ri||c.oi>c.qi)return!1;for(var f=d=-1,e=!1;!e&&D(c,Q,d,f);)if(d=Q[0],f=Q[1],G(c,d,f)){var k;k=c;e={};e.hj=k.hj;e.ij=k.ij;e.ko=k.ko;e.Ik=k.Ik;e.nf=k.nf;e.Uh=k.Uh;e.of=k.of;e.Bd=e.jl=k.Bd;e.oi=k.oi;e.pi=k.pi;e.Df=k.Df;e.qi=k.qi;e.ri=k.ri;e.Ef=k.Ef;e.Gi=-1;e.fe=k.fe;e.bg=k.bg;e.pg=k.pg;e.qg=k.qg;e.Hg=k.Hg;e.Ig=k.Ig;e.El=k.El;k.El[0]+=1;var e=k=e,m=d,h=f,l=e.hj,K=e.ij,E=e.nf,n=e.Uh,r=e.fe,y=e.bg,A=e.pg,w=
e.qg,M=e.Hg,B=e.Ig;t(m<E);t(h<n);t(e.Bd<E);t(e.Bd<n);E=++e.Bd;e.Gi=m;A[m]||(A[m]=E,e.oi++,M[m]&&e.Df++);M[m]||(M[m]=E,e.pi++,A[m]&&e.Df++);w[h]||(w[h]=E,e.qi++,B[h]&&e.Ef++);B[h]||(B[h]=E,e.ri++,w[h]&&e.Ef++);r[m]=h;y[h]=m;for(r=0;r<u(l,m);r++)y=q(l,m,r),A[y]||(A[y]=E,e.oi++,M[y]&&e.Df++);for(r=0;r<x(l,m);r++)y=g(l,m,r),M[y]||(M[y]=E,e.pi++,A[y]&&e.Df++);for(r=0;r<u(K,h);r++)y=q(K,h,r),w[y]||(w[y]=E,e.qi++,B[y]&&e.Ef++);for(r=0;r<x(K,h);r++)y=g(K,h,r),B[y]||(B[y]=E,e.ri++,w[y]&&e.Ef++);e=C(a,b,k);
t(1>=k.Bd-k.jl);t(-1!=k.Gi);y=k.hj;m=k.ij;h=k.Bd;l=k.Gi;K=k.fe;A=k.bg;E=k.pg;w=k.qg;n=k.Hg;M=k.Ig;if(k.jl<h){E[l]==h&&(E[l]=0);for(B=0;B<u(y,l);B++)r=q(y,l,B),E[r]==h&&(E[r]=0);n[l]==h&&(n[l]=0);for(B=0;B<x(y,l);B++)r=g(y,l,B),n[r]==h&&(n[r]=0);y=K[l];w[y]==h&&(w[y]=0);for(B=0;B<u(m,y);B++)r=q(m,y,B),w[r]==h&&(w[r]=0);M[y]==h&&(M[y]=0);for(B=0;B<x(m,y);B++)r=g(m,y,B),M[r]==h&&(M[r]=0);K[l]=-1;A[y]=-1;k.Bd=k.jl;k.Gi=-1}}return e}function D(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var g=a.Df,e=a.Ef,f=a.pi,
k=a.ri,m=a.oi,h=a.qi,u=a.Bd,l=a.nf,x=a.Uh,E=a.fe,K=a.bg,q=a.pg,n=a.qg,t=a.Hg,B=a.Ig;if(g>u&&e>u)for(;c<l&&(-1!=E[c]||0==t[c]||0==q[c]);)c++,d=0;else if(f>u&&k>u)for(;c<l&&(-1!=E[c]||0==t[c]);)c++,d=0;else if(m>u&&h>u)for(;c<l&&(-1!=E[c]||0==q[c]);)c++,d=0;else if(0==c&&0!=a.of){for(q=0;q<l&&-1!=E[c=a.of[q]];)q++;q==l&&(c=l)}else for(;c<l&&-1!=E[c];)c++,d=0;if(g>u&&e>u)for(;d<x&&(-1!=K[d]||0==B[d]||0==n[d]);)d++;else if(f>u&&k>u)for(;d<x&&(-1!=K[d]||0==B[d]);)d++;else if(m>u&&h>u)for(;d<x&&(-1!=K[d]||
0==n[d]);)d++;else for(;d<x&&-1!=K[d];)d++;return c<l&&d<x?(b[0]=c,b[1]=d,!0):!1}function G(a,b,c){var d=a.hj,e=a.ij,f=a.Uh,k=a.fe,m=a.bg,h=a.pg,l=a.qg,E=a.Hg,K=a.Ig;t(b<a.nf);t(c<f);t(-1==k[b]);t(-1==m[c]);if(!(0,a.ko)(A(d,b),A(e,c)))return!1;for(var n=f=0,r=0,y=0,w=0,Q=0,M=0;M<x(d,b);M++){var B=g(d,b,M);if(-1!=k[B]){var N=k[B];if(!L(e,c,N)||!J(a.Ik,d,b,B,e,c,N))return!1}else h[B]&&r++,E[B]&&f++,h[B]||E[B]||w++}for(M=0;M<u(d,b);M++)if(B=q(d,b,M),-1!=k[B]){if(N=k[B],!L(e,N,c)||!J(a.Ik,d,B,b,e,N,c))return!1}else h[B]&&
r++,E[B]&&f++,h[B]||E[B]||w++;for(M=0;M<x(e,c);M++)if(N=g(e,c,M),-1!=m[N]){if(B=m[N],!L(d,b,B))return!1}else l[N]&&y++,K[N]&&n++,l[N]||K[N]||Q++;for(M=0;M<u(e,c);M++)if(N=q(e,c,M),-1!=m[N]){if(B=m[N],!L(d,B,b))return!1}else l[N]&&y++,K[N]&&n++,l[N]||K[N]||Q++;return r<=y&&f<=n&&w<=Q}function t(a){if(!a)throw"Assertion failed";}function A(a,b){for(var c=a.U,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}function x(a,b){for(var c=a.Y,d=0,g=0;g<c.length;g+=3)c[g]==b&&d++;return d}function u(a,
b){for(var c=a.Y,d=0,g=0;g<c.length;g+=3)c[g+1]==b&&d++;return d}function g(a,b,c){a=a.Y;for(var d=0,g=0;g<a.length;g+=3)if(a[g]==b){if(d==c)return a[g+1];d++}return-1}function q(a,b,c){a=a.Y;for(var d=0,g=0;g<a.length;g+=3)if(a[g+1]==b){if(d==c)return a[g];d++}return-1}function L(a,b,c){a=a.Y;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;return!1}function J(a,b,c,d,g,e,f){for(var k=E(b,c,d),m=E(g,e,f),h=0;h<k;h++){for(var u=!1,l=0;l<m;l++)if(a(M(b,c,d,h),M(g,e,f,l))){u=!0;break}if(!u)return!1}return!0}
function E(a,b,c){var d=0;a=a.Y;for(var g=0;g<a.length;g+=3)a[g]==b&&a[g+1]==c&&d++;return d}function M(a,b,c,d){a=a.Y;for(var g=0,e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c){if(g==d)return a[e+2];g++}return null}var K=p("__util"),Q=[-1,-1];a.Ap=-1;a.YD=10;a.Ul=20;a.aE=30;a.create=function(){for(var a=arguments,b=[],c=[],d=0;d<a.length;d++){var g=a[d];switch(g.length){case 2:b.push(g[0],g[1]);break;case 3:c.push(g[0],g[1],g[2]);break;default:throw"Wrong graph constructor params";}}return{U:b,Y:c}};
a.clone=function(a,b,c){if(b)for(var d=Array(a.U.length),g=0;g<a.U.length;g+=2)d[g]=a.U[g],d[g+1]=b(a.U[g+1]);else d=K.pa(a.U);if(c)for(b=Array(a.Y.length),g=0;g<a.Y.length;g+=3)b[g]=a.Y[g],b[g+1]=a.Y[g+1],b[g+2]=c(a.Y[g+2]);else b=K.pa(a.Y);return a={U:d,Y:b}};a.DE=function(a,b){for(var c=[],d=[],g=0;g<a.length;g++)c.push(a[g][0],a[g][1]);for(g=0;g<b.length;g++)d.push(b[g][0],b[g][1],b[g][2]);return{U:c,Y:d}};a.kk=c;a.jF=d;a.gd=b;a.$h=e;a.Qg=l;a.bt=function(a,b,c,d){if(!L(a,b,c))throw"Edge not found";
a=a.Y;for(var g=0;g<a.length;g+=3)if(a[g]==b&&a[g+1]==c&&a[g+2][0]==d[0]&&a[g+2][1]==d[1]){a.splice(g,3);break}};a.w=function(a,b){if(-1==h(a,b)){var d=m(a);c(a,d,b);return d}throw"Non-unique attribute";};a.lB=function(a,b,c,d,g){a=a.Y;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&a[e+2]==d&&(a[e+2]=g)};a.lr=m;a.Dg=h;a.n=function(a,c,d,g){c=h(a,c);d=h(a,d);if(-1!=c&&-1!=d)b(a,c,d,g);else throw"Attributes not found";};a.X=function(a,b){for(var c=a.U,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};a.Pd=function(a,
b){for(var c=a.Y,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=3);};a.Ge=function(a,b,c){for(var d=a.Y,g=0;g<d.length;g+=3)if(d[g+1]==b){var e=d[g];if(c(e,A(a,e),d[g+2]))break}};a.Gf=function(a,b,c){for(var d=a.Y,g=0;g<d.length;g+=3)if(d[g]==b){var e=d[g+1];if(c(e,A(a,e),d[g+2]))break}};a.dp=n;a.EC=function(a){a=n(a).U;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.tF=function(){};a.So=function(a,b,c){if(!d(a,b))throw"No such node";var g={};f(a,g);r(a,b,g,c);b=[];for(var e in g)g[e]&&(e=
Number(e),b.push(e,A(a,e)));a={U:b,Y:a.Y.slice(0)};g=a.Y;for(e=0;e<g.length;e+=3)b=g[e+1],d(a,g[e])&&d(a,b)||(g.splice(e,3),e-=3);return a};a.zz=function(a){for(var b=[],c=a.U,d=0;d<c.length;d+=2){var g=c[d];u(a,g)||b.push(g)}return b};a.Ar=y;a.match=function(a,b,c,d){var g={};g.hj=w(a);g.ij=w(b);g.ko=c||function(a,b){return a==b};g.Ik=d||function(a,b){return a==b};d=a.U.length/2;var e=b.U.length/2;g.nf=d;g.Uh=e;g.of=0;g.Bd=g.jl=0;g.Df=g.oi=g.pi=0;g.Ef=g.qi=g.ri=0;g.Gi=-1;g.fe=Array(d);g.bg=Array(e);
g.pg=Array(d);g.qg=Array(e);g.Hg=Array(d);g.Ig=Array(e);g.El=[1];for(c=0;c<d;c++)g.fe[c]=-1,g.pg[c]=0,g.Hg[c]=0;for(c=0;c<e;c++)g.bg[c]=-1,g.qg[c]=0,g.Ig[c]=0;e=Array(d);d=Array(d);if(C(e,d,g)){for(c=0;c<e.length;c++)e[c]=a.U[2*e[c]],d[c]=b.U[2*d[c]];return[e,d]}return null};a.Za=A;a.Jg=x;a.Qr=u;a.ng=g;a.Ok=q;a.cF=E;a.mg=M;a.replace=function(a,b,d){for(var g=a.Y,f=m(a),k=0;k<b.length;k++){var h=b[k];e(a,h);for(var u=0;u<g.length;u+=3)g[u]==h&&(g[u]=f),g[u+1]==h&&(g[u+1]=f),g[u]==g[u+1]&&(g.splice(u,
3),u-=3)}c(a,f,d)};a.cB=function(a,b,c,d,g){if(!L(a,b,c))throw"Edge not found";a=a.Y;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&(a[e]=d,a[e+1]=g)};a.uy=function(a,b){function c(a,b){if(-1!=k.indexOf(a)){var d=k.slice(k.indexOf(a));if(-1!=g[d[d.length-1]].indexOf(d[0])){h.push([a,d[d.length-1]]);return}}k.push(a);for(d=0;d<b.length;d++)b[d]in g&&c(b[d],g[b[d]])}b||(b=y(a)[0]);var d=a.Y;if(d.length){for(var g={},e=0,f=0;f<d.length;f+=3)d[f+1]in g?g[d[f+1]].push(d[f]):g[d[f+1]]=[d[f]],e++;var k=
[],h=[];c(b,g[b]);for(f=0;f<h.length;f++)for(var m=e=0;m<d.length;m+=3)h[f][1]==d[m+1]&&h[f][0]==d[m]&&l(a,d[m],d[m+1],e),e++}};a.FE=function(a,b){var c=a.U,d=a.Y,g;g="digraph debug {\n    node [shape=box];\n";for(var e=0;e<c.length;e+=2){var f=c[e],k=c[e+1],k=b?b(f,k):String(f);g+="    ";g+=String(f)+' [label="'+k.replace(/\"/g,'\\"')+'"];\n'}for(e=0;e<d.length;e+=3)c=d[e],f=d[e+1],g+="    ",g+=String(c)+" -> "+String(f)+";\n";return g+="}"}};b4w.module.__ipc=function(a){function p(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,e;for(e in c){var f=c[e];switch(f.constructor){case Float32Array:d+=f.length;break;case Number:d+=1}}--d;c.len=d}}a.Fu=0;var c=a.xu=1,d=a.zu=2;a.yu=3;a.Bu=4;a.Cu=5;a.Du=6;a.Gu=7;var b=a.Iu=8,e=a.zp=9,l=a.Ju=10;a.Ku=11;var m=a.Lu=12;a.Mu=13;a.Hu=14;a.Eu=15;a.Au=16;a.mv=100;a.Ou=101;a.Pu=102;a.Qu=103;a.Ru=104;a.Tu=105;a.Su=106;a.Uu=107;a.Vu=108;a.Wu=109;a.Xu=110;a.Yu=111;a.Zu=112;a.av=113;a.bv=114;a.pv=115;a.cv=116;
a.dv=117;a.ev=118;a.gv=119;a.hv=120;a.iv=121;a.kv=122;a.lv=123;a.nv=124;a.$u=125;a.rv=126;a.fv=127;a.Cp=128;a.qv=129;a.sv=130;a.tv=131;a.uv=132;a.vv=133;a.wv=134;a.xv=135;a.yv=136;a.zv=137;a.Av=138;a.Bv=139;a.Dp=140;var h=a.ck=141;a.Cv=142;a.Bp=143;a.Dv=144;a.Ev=145;a.ov=146;a.jv=147;var n=null,f=[],k={Dc:m,L:0,time:0,i:new Float32Array(3),quat:new Float32Array(4),Gd:new Float32Array(3),zd:new Float32Array(3),len:0},r={Dc:b,Bm:0,uo:0,i:new Float32Array(3),quat:new Float32Array(4),len:0},y={Dc:e,id:0,
nh:0,hit_fract:0,hit_time:0,len:0},w={Dc:l,id:0,nh:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},C={Dc:c,Wf:0,Xf:0,result:0,len:0},D={Dc:d,Wf:0,Xf:0,result:0,$f:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},G={Dc:h,L:0,i:new Float32Array(3),quat:new Float32Array(4),len:0},t=[k,r,y,w,C,D,G];a.init=function(a,f){function u(a){if(a.constructor==ArrayBuffer)a=new Float32Array(a);else if(a[0].constructor==ArrayBuffer){for(var q=0;q<a.length;q++)u(a[q]);
return}q=a[0]|0;switch(q){case m:var n=k;n.L=a[1]|0;n.time=a[2];n.i[0]=a[3];n.i[1]=a[4];n.i[2]=a[5];n.quat[0]=a[6];n.quat[1]=a[7];n.quat[2]=a[8];n.quat[3]=a[9];n.Gd[0]=a[10];n.Gd[1]=a[11];n.Gd[2]=a[12];n.zd[0]=a[13];n.zd[1]=a[14];n.zd[2]=a[15];break;case b:n=r;n.Bm=a[1]|0;n.uo=a[2]|0;n.i[0]=a[3];n.i[1]=a[4];n.i[2]=a[5];n.quat[0]=a[6];n.quat[1]=a[7];n.quat[2]=a[8];n.quat[3]=a[9];break;case e:n=y;n.id=a[1]|0;n.nh=a[2]|0;n.hit_fract=a[3];n.hit_time=a[4];break;case l:n=w;n.id=a[1]|0;n.nh=a[2]|0;n.hit_fract=
a[3];n.hit_time=a[4];n.hit_pos[0]=a[5];n.hit_pos[1]=a[6];n.hit_pos[2]=a[7];n.hit_norm[0]=a[8];n.hit_norm[1]=a[9];n.hit_norm[2]=a[10];break;case c:n=C;n.Wf=a[1]|0;n.Xf=a[2]|0;n.result=!!a[3];break;case d:n=D;n.Wf=a[1]|0;n.Xf=a[2]|0;n.result=!!a[3];n.$f[0]=a[4];n.$f[1]=a[5];n.$f[2]=a[6];n.coll_norm[0]=a[7];n.coll_norm[1]=a[8];n.coll_norm[2]=a[9];n.coll_dist=a[10];break;case h:n=G;n.L=a[1]|0;n.i[0]=a[2];n.i[1]=a[3];n.i[2]=a[4];n.quat[0]=a[5];n.quat[1]=a[6];n.quat[2]=a[7];n.quat[3]=a[8];break;default:n=
a}f(q,n)}p(t);a.addEventListener("message",function(a){u(a.data)},!1);n=a};a.cleanup=function(){n=null;f.length=0};a.B=function(a){if(n)switch(a){case m:var x=k,u=new Float32Array(x.len);u[0]=x.Dc;u[1]=x.L;u[2]=x.time;u[3]=x.i[0];u[4]=x.i[1];u[5]=x.i[2];u[6]=x.quat[0];u[7]=x.quat[1];u[8]=x.quat[2];u[9]=x.quat[3];u[10]=x.Gd[0];u[11]=x.Gd[1];u[12]=x.Gd[2];u[13]=x.zd[0];u[14]=x.zd[1];u[15]=x.zd[2];f.push(u.buffer);break;case b:x=r;u=new Float32Array(x.len);u[0]=x.Dc;u[1]=x.Bm;u[2]=x.uo;u[3]=x.i[0];u[4]=
x.i[1];u[5]=x.i[2];u[6]=x.quat[0];u[7]=x.quat[1];u[8]=x.quat[2];u[9]=x.quat[3];f.push(u.buffer);break;case e:x=y;u=new Float32Array(x.len);u[0]=x.Dc;u[1]=x.id;u[2]=x.nh;u[3]=x.hit_fract;u[4]=x.hit_time;f.push(u.buffer);break;case l:x=w;u=new Float32Array(x.len);u[0]=x.Dc;u[1]=x.id;u[2]=x.nh;u[3]=x.hit_fract;u[4]=x.hit_time;u[5]=x.hit_pos[0];u[6]=x.hit_pos[1];u[7]=x.hit_pos[2];u[8]=x.hit_norm[0];u[9]=x.hit_norm[1];u[10]=x.hit_norm[2];f.push(u.buffer);break;case c:x=C;u=new Float32Array(x.len);u[0]=
x.Dc;u[1]=x.Wf;u[2]=x.Xf;u[3]=x.result;f.push(u.buffer);break;case d:x=D;u=new Float32Array(x.len);u[0]=x.Dc;u[1]=x.Wf;u[2]=x.Xf;u[3]=x.result;u[4]=x.$f[0];u[5]=x.$f[1];u[6]=x.$f[2];u[7]=x.coll_norm[0];u[8]=x.coll_norm[1];u[9]=x.coll_norm[2];u[10]=x.coll_dist;f.push(u.buffer);break;case h:x=G;u=new Float32Array(x.len);u[0]=x.Dc;u[1]=x.L;u[2]=x.i[0];u[3]=x.i[1];u[4]=x.i[2];u[5]=x.quat[0];u[6]=x.quat[1];u[7]=x.quat[2];u[8]=x.quat[3];f.push(u.buffer);break;default:u=[];for(x=0;x<arguments.length;x++)u.push(arguments[x]);
n.postMessage(u)}};a.TA=function(){f.length&&(n.postMessage(f),f.length=0)};a.wr=function(a){switch(a){case m:return k;case b:return r;case e:return y;case l:return w;case c:return C;case d:return D;case h:return G;default:return null}}};b4w.module.__hud=function(a,p){function c(a){a.font="bold 15px Courier";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function d(a){b(' SCENE "'+a.name+'"');if(a.l){var c=0,d=0;h.X(a.l.jb,function(a,e){if("SINK"==e.type)b(" (F)",e.type);else{var f=e.type,k=Math.round(e.k.width)+"x"+Math.round(e.k.height),m=e.s.length,h=e.Ui,l=e.enqueue&&e.Wa;l?b(" (A)",f,e.Fg,k,h,"of",m):b(" (P)",f,e.Fg,k,h,"of",m);e.Ui=0;l&&(c+=m,d+=h)}});return[c,d]}b("No INFO")}function b(){for(var a=80+20*f[0],b=[5,
18,3,10,4,3,5],c=arguments[0],d=1;d<arguments.length;d++){for(var e="",m=0;m<b[d]-String(arguments[d]).length;m++)e+=" ";c+=e+arguments[d]}f[0]++;n.fillText(c,30,a)}function e(a,b,c){b*=a.Ja;c.x=a.x+b;c.y=a.y;c.Ja=a.Ja-2*b;c.Fa=a.Fa}function l(a){return a.x+a.Ja/2}function m(a){var b=n,c={x:0,y:0,Ja:0,Fa:0},d=b.canvas.width,b=b.canvas.height;c.x=0;c.y=0;c.Ja=d;c.Fa=b;e(c,.01,c);d=.02*c.Fa;c.x=c.x;c.y+=d;c.Ja=c.Ja;c.Fa-=2*d;d=c.Ja/8;c.x+=d*a;c.y=c.y;c.Ja=d;c.Fa=c.Fa;e(c,.02,c);return c}var h=p("__graph"),
n=null,f=[0,0];a.init=function(a){a=a.getContext("2d");c(a);return n=a};a.ti=function(){n&&c(n)};a.reset=function(){var a=n;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),f[0]=0,f[1]=0)};a.YB=function(a,c){var e=n;if(e){e.textAlign="left";e.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/c).toFixed(2));f[0]++;for(var m=e=0,h=0;h<a.length;h++){var l=d(a[h]),e=e+l[0],m=m+l[1];f[0]++}b(" ---------------------------------------------");
b("    ","TOTAL ACTIVE","","",m,"of",e)}};a.print=function(){var a=n;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.plot_array=function(a,b,c,d,e,f,h){var t=n;if(t){b=m(b);var A=b.Fa/5;b.x=b.x;b.y+=4*A;b.Ja=b.Ja;b.Fa=A;t.textAlign="center";t.fillStyle="#00FF00";n.fillText(a,l(b),b.y-10);t.strokeStyle="#00FF00";t.lineWidth=.5;t.beginPath();t.moveTo(b.x,b.y);t.lineTo(b.x+b.Ja,b.y);t.lineTo(b.x+b.Ja,b.y+b.Fa);t.lineTo(b.x,b.y+b.Fa);t.closePath();t.stroke();if(!f&&
!h)for(f=1E6,h=-1E6,a=0;a<c.length;a++)f=Math.min(f,c[a]),h=Math.max(h,c[a]);t.textAlign="right";n.fillText(String(f),b.x-10,b.y+b.Fa);n.fillText(String(h),b.x-10,b.y);t.textAlign="center";n.fillText(String(d),b.x,b.y+b.Fa+15);n.fillText(String(e),b.x+b.Ja,b.y+b.Fa+15);t.strokeStyle="#FF0000";t.lineWidth=1.5;t.beginPath();d=b.Ja/(c.length-1);h=b.Fa/(h-f);for(a=0;a<c.length;a++)e=b.x+d*a,A=b.y+b.Fa-(c[a]-f)*h,0==a?t.moveTo(e,A):t.lineTo(e,A);t.stroke()}};a.draw_mixer_strip=function(a,b,c,d,e,f,h){var t=
n;if(t)for(t.textAlign="center",t.fillStyle="#00FF00",t.font="bold 12px Courier",c=m(c),n.fillText(b?"["+a+"]":a,l(c),c.y),0<=f&&n.fillText(f?"[M]":"[ ]",l(c)-15,c.y+30),0<=h&&n.fillText(h?"[S]":"[ ]",l(c)+15,c.y+30),a={x:0,y:0,Ja:0,Fa:0},b=0;b<d.length;b++){f=d[b];var A="VOLUME"==f[0];if(A){h=c.y+350;var x=c.Ja,u=a;u.x=c.x;u.y=h;u.Ja=x;u.Fa=250}else{h=c.y+10+50*b;var x=c.Ja,u=c.Fa,g=a;g.x=c.x;g.y=h;g.Ja=x;g.Fa=u}h=t;var x=a,g=b==e,q=f[0],u=f[1],L=f[2],J=f[3],E=(J-L)/f[4],E=1>E?Math.floor(1/E-1E-5).toFixed(0).length:
0;f=f[5]?Math.log(u/L)/Math.log(J/L):(u-L)/(J-L);h.textAlign="center";g?h.fillText("["+q+"]",l(x),x.y):h.fillText(q,l(x),x.y);h.strokeStyle="#00FF00";h.lineWidth=A?3:1;A?(h.textAlign="right",h.fillText(J.toFixed(E),l(x)-10,x.y+15),h.textAlign="right",h.fillText(L.toFixed(E),l(x)-10,x.y+x.Fa-15)):(h.textAlign="right",h.fillText(L.toFixed(E),x.x+28,x.y+15),h.textAlign="left",h.fillText(J.toFixed(E),x.x+x.Ja-28,x.y+15));h.beginPath();if(A){var M=x.y+15+(x.Fa-30)*(1-f);h.moveTo(l(x),x.y+15);h.lineTo(l(x),
x.y+x.Fa-15);h.moveTo(l(x)-5,x.y+15);h.lineTo(l(x)+5,x.y+15);h.moveTo(l(x)-5,x.y+x.Fa-15);h.lineTo(l(x)+5,x.y+x.Fa-15);h.moveTo(l(x)-5,M);h.lineTo(l(x)+5,M)}else{var K=x.x+30+(x.Ja-60)*f;h.moveTo(x.x+30,x.y+15);h.lineTo(x.x+x.Ja-30,x.y+15);h.moveTo(x.x+30,x.y+15-5);h.lineTo(x.x+30,x.y+15+5);h.moveTo(x.x+x.Ja-30,x.y+15-5);h.lineTo(x.x+x.Ja-30,x.y+15+5);h.moveTo(K,x.y+15-5);h.lineTo(K,x.y+15+5)}h.stroke();"EQ_Q"==q?(f=Math.log(1+1/(2*u*u)+Math.sqrt((2+1/(u*u))*(2+1/(u*u))/4-1))/Math.log(2),A?(h.textAlign=
"left",h.fillText(u.toFixed(E),l(x)+10,M),h.textAlign="left",h.fillText("("+f.toFixed(E+1)+")",l(x)+10,M+10)):(h.textAlign="right",h.fillText(u.toFixed(E),K,x.y+30),h.textAlign="left",h.fillText("("+f.toFixed(E+1)+")",K,x.y+30))):A?(h.textAlign="left",h.fillText(u.toFixed(E),l(x)+10,M)):(h.textAlign="center",h.fillText(u.toFixed(E),K,x.y+30))}}};b4w.module.__renderer=function(a,p){function c(a){for(var c=a.k,d=a.s,f=0;f<d.length;f++){var h=d[f];if(h.Wa){var k=a,m=c,l=h.pd,n=h.D,y=n.ec;t.useProgram(y.Ej);for(var h=n.P,I=n.$p,v=y.Ut,H=v.length;H--;){var P=v[H];P.on(t,P.xg,k,l,n,m)}m=n.Eq;t.colorMask(m,m,m,m);t.depthMask(n.ba);n.Oa?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE);m=n.S;for(n=0;n<m.length;n++)v=m[n],t.activeTexture(t.TEXTURE0+n),t.bindTexture(v.Wb,v.fb);if("SKY"==k.type){m=k;y=y.Qj;n=m.k.nb.fb;v=m.Ti;for(H=0;6>H;H++)if(P=e(H),r.Dm?
(t.bindTexture(t.TEXTURE_CUBE_MAP,n),t.texImage2D(P,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,G)):(t.uniformMatrix4fv(y.u_cube_view_matrix,!1,v[H]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,P,n,0),b(h,I,l.lp)),m.gl&&3!=H){var P=m,w=H,C=A;r.Dm?C.set(G):(t.readPixels(191,191,1,1,t.RGBA,t.UNSIGNED_BYTE,C),255!=C[0]&&255!=C[1]&&255!=C[2]||t.readPixels(191,220,1,1,t.RGBA,t.UNSIGNED_BYTE,C));var R=C[0],p=C[1],C=C[2],R=R/255,p=p/255,C=C/255;2===w?(P.wc[3]=R,P.wc[7]=p,P.wc[11]=C):2>w?(P.wc[4*w]=
R,P.wc[4*w+1]=p,P.wc[4*w+2]=C):(P.wc[4*(w-2)]=R,P.wc[4*(w-2)+1]=p,P.wc[4*(w-2)+2]=C)}k.Ui+=6}else b(h,I,l.lp),k.Ui++}}}function d(a){if(a){var b=(a.ja?t.COLOR_BUFFER_BIT:0)|(a.oa?t.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case "MAIN_GLOW":a=D;break;case "SHADOW_CAST":a=y;break;case "DEPTH":a=w;break;case "COLOR_PICKING":case "COLOR_PICKING_XRAY":case "ANCHOR_VISIBILITY":a=C;break;case "OUTLINE_MASK":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_EDGE_DETECTION":a=D;break;default:a=r.background_color}}else b=
t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT,a=r.background_color;t.colorMask(!0,!0,!0,!0);t.depthMask(!0);t.clearColor(a[0],a[1],a[2],a[3]);t.clear(b)}function b(a,b,c){t.bindBuffer(t.ARRAY_BUFFER,a.If);for(var d=0;d<b.length;d++){var e=b[d];t.enableVertexAttribArray(e.xg);t.vertexAttribPointer(e.xg,e.Hd,t.FLOAT,!1,0,e.zw+e.Jy*c)}a.qe?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a.qe),t.drawElements(a.mode,a.count,a.En,0)):t.drawArrays(a.mode,0,a.count);for(d=0;d<b.length;d++)e=b[d],t.disableVertexAttribArray(e.xg)}
function e(a){switch(a){case 0:return t.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return t.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return t.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return t.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return t.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return t.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function l(a){var b=a.Qj,c=[],d=[],e={},f;for(f in b){var h=!1;switch(f){case "u_proj_matrix":var k=function(a,b,c,d,e,g){a.uniformMatrix4fv(b,!1,g.xa)},h=!0;break;case "u_view_matrix":case "u_view_matrix_frag":k=
function(a,b,c,d,e,g){a.uniformMatrix4fv(b,!1,g.va)};h=!0;break;case "u_shadow_cast_billboard_view_matrix":k=function(a,b,c,d,e,g){a.uniformMatrix4fv(b,!1,g.ot)};h=!0;break;case "u_view_proj_prev":k=function(a,b,c,d,e,g){a.uniformMatrix4fv(b,!1,g.ZA)};h=!0;break;case "u_view_proj_inverse":k=function(a,b,c,d,e,g){a.uniformMatrix4fv(b,!1,g.wi)};h=!0;break;case "u_sky_vp_inverse":k=function(a,b,c,d,e,g){a.uniformMatrix4fv(b,!1,g.Jd)};h=!0;break;case "u_camera_eye":case "u_camera_eye_frag":k=function(a,
b,c,d,e,g){a.uniform3fv(b,g.cf)};h=!0;break;case "u_camera_eye_last":k=function(a,b,c,d,e,g){a.uniform3fv(b,g.dr)};h=!0;break;case "u_camera_quat":k=function(a,b,c,d,e,g){a.uniform4fv(b,g.quat)};h=!0;break;case "u_view_max_depth":k=function(a,b,c,d,g,e){a.uniform1f(b,e.Xa)};h=!0;break;case "u_camera_range":k=function(a,b,c,d,e,g){a.uniform2f(b,g.bb,g.Xa)};break;case "u_csm_center_dists":k=function(a,b,c,d,g,e){a.uniform4fv(b,e.Nq)};break;case "u_cam_water_depth":k=function(a,b,c){a.uniform1f(b,c.zm)};
h=!0;break;case "u_waves_height":k=function(a,b,c){a.uniform1f(b,c.Nf)};break;case "u_waves_length":k=function(a,b,c){a.uniform1f(b,c.gh)};break;case "u_fog_color_density":k=function(a,b,c){a.uniform4fv(b,c.Yb)};break;case "u_fog_params":k=function(a,b,c){a.uniform4fv(b,c.Lk)};break;case "u_underwater_fog_color_density":k=function(a,b,c){a.uniform4fv(b,c.wd)};break;case "u_bloom_key":k=function(a,b,c){a.uniform1f(b,c.bloom_key)};break;case "u_bloom_edge_lum":k=function(a,b,c){a.uniform1f(b,c.bloom_edge_lum)};
break;case "u_time":k=function(a,b,c){a.uniform1f(b,c.time)};h=!0;break;case "u_wind":k=function(a,b,c){a.uniform3fv(b,c.Of)};break;case "u_sky_tex_dvar":k=function(a,b,c){a.uniform1f(b,c.ut)};break;case "u_sky_tex_fac":k=function(a,b,c){a.uniform4fv(b,c.vt)};break;case "u_sky_tex_color":k=function(a,b,c){a.uniform3fv(b,c.tt)};break;case "u_horizon_color":k=function(a,b,c){a.uniform3fv(b,c.ff)};break;case "u_zenith_color":k=function(a,b,c){a.uniform3fv(b,c.Pf)};break;case "u_environment_energy":k=
function(a,b,c){a.uniform1f(b,c.bf)};break;case "u_sky_color":k=function(a,b,c){a.uniform3fv(b,c.fi)};break;case "u_rayleigh_brightness":k=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":k=function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":k=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":k=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":k=function(a,b,c){a.uniform1f(b,
c.rayleigh_strength)};break;case "u_mie_strength":k=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":k=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":k=function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":k=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":k=function(a,b,c){a.uniform3fv(b,c.kf)};break;case "u_light_directions":k=function(a,b,c){a.uniform3fv(b,
c.ug)};break;case "u_light_color_intensities":k=function(a,b,c){a.uniform3fv(b,c.tg)};break;case "u_light_factors":k=function(a,b,c){a.uniform4fv(b,c.vg)};break;case "u_sun_quaternion":k=function(a,b,c){a.uniform4fv(b,c.Nt)};break;case "u_sun_intensity":k=function(a,b,c){a.uniform3fv(b,c.Mt)};break;case "u_sun_direction":k=function(a,b,c){a.uniform3fv(b,c.Uo)};break;case "u_height":k=function(a,b,c,d,g,e){a.uniform1f(b,e.height)};h=!0;break;case "u_model_matrix":k=function(a,b,c,d){a.uniformMatrix4fv(b,
!1,d.Z)};h=!0;break;case "u_transb":k=function(a,b,c,d){a.uniform4fv(b,d.Oc)};h=!0;break;case "u_transa":k=function(a,b,c,d){a.uniform4fv(b,d.Nc)};h=!0;break;case "u_arm_rel_trans":k=function(a,b,c,d){a.uniform4fv(b,d.im)};h=!0;break;case "u_arm_rel_quat":k=function(a,b,c,d){a.uniform4fv(b,d.hm)};h=!0;break;case "u_quat":k=function(a,b,c,d){a.uniform4fv(b,d.quat)};h=!0;break;case "u_quatsb":k=function(a,b,c,d){a.uniform4fv(b,d.Gc)};h=!0;break;case "u_quatsa":k=function(a,b,c,d){a.uniform4fv(b,d.Fc)};
h=!0;break;case "u_frame_factor":k=function(a,b,c,d){a.uniform1f(b,d.jg)};h=!0;break;case "au_center_pos":k=function(){};h=!0;break;case "au_wind_bending_amp":k=function(a,b,c,d){a.uniform1f(b,d.Sd)};h=!0;break;case "au_wind_bending_freq":k=function(a,b,c,d){a.uniform1f(b,d.He)};h=!0;break;case "au_detail_bending_freq":k=function(a,b,c,d){a.uniform1f(b,d.he)};h=!0;break;case "au_detail_bending_amp":k=function(a,b,c,d){a.uniform1f(b,d.ge)};h=!0;break;case "au_branch_bending_amp":k=function(a,b,c,d){a.uniform1f(b,
d.be)};h=!0;break;case "u_node_values":k=function(a,b,c,d){a.uniform1fv(b,d.ue)};h=!0;break;case "u_node_rgbs":k=function(a,b,c,d){a.uniform3fv(b,d.Cc)};h=!0;break;case "u_diffuse_color":k=function(a,b,c,d,e){a.uniform4fv(b,e.Wc)};h=!0;break;case "u_diffuse_intensity":k=function(a,b,c,d,e){a.uniform1f(b,e.Ze)};h=!0;break;case "u_diffuse_params":k=function(a,b,c,d,e){a.uniform2fv(b,e.yc)};h=!0;break;case "u_emit":k=function(a,b,c,d,e){a.uniform1f(b,e.me)};h=!0;break;case "u_ambient":k=function(a,b,
c,d,e){a.uniform1f(b,e.Yd)};h=!0;break;case "u_specular_color":k=function(a,b,c,d,e){a.uniform3fv(b,e.Kd)};h=!0;break;case "u_specular_alpha":k=function(a,b,c,d,e){a.uniform1f(b,e.Mo)};h=!0;break;case "u_specular_params":k=function(a,b,c,d,e){a.uniform3fv(b,e.qc)};h=!0;break;case "u_reflect_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.reflect_factor)};h=!0;break;case "u_mirror_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.eo)};h=!0;break;case "u_grass_map_dim":k=function(a,b,c,d,e){a.uniform3fv(b,
e.ic)};h=!0;break;case "u_grass_size":k=function(a,b,c,d,e){a.uniform1f(b,e.yn)};h=!0;break;case "u_scale_threshold":k=function(a,b,c,d,e){a.uniform1f(b,e.Cr)};h=!0;break;case "u_cube_fog":k=function(a,b,c,d,e){a.uniformMatrix4fv(b,!1,e.wc)};break;case "u_jitter_amp":k=function(a,b,c,d,e){a.uniform1f(b,e.as)};h=!0;break;case "u_jitter_freq":k=function(a,b,c,d,e){a.uniform1f(b,e.bs)};h=!0;break;case "u_wireframe_mode":k=function(a,b,c,d,e){a.uniform1i(b,e.wireframe_mode)};break;case "u_wireframe_edge_color":k=
function(a,b,c,d,e){a.uniform3fv(b,e.wireframe_edge_color)};break;case "u_subpixel_jitter":k=function(a,b,c){a.uniform2fv(b,c.fA)};h=!0;break;case "u_subsample_indices":k=function(a,b,c){a.uniform4fv(b,c.gA)};h=!0;break;case "u_refr_bump":k=function(a,b,c,d,e){a.uniform1f(b,e.$s)};h=!0;break;case "u_lamp_light_positions":k=function(a,b,c,d,e){a.uniform3fv(b,e.Pn)};break;case "u_lamp_light_directions":k=function(a,b,c,d,e){a.uniform3fv(b,e.Nn)};break;case "u_lamp_light_color_intensities":k=function(a,
b,c,d,e){a.uniform3fv(b,e.Mn)};break;case "u_lamp_light_factors":k=function(a,b,c,d,e){a.uniform4fv(b,e.On)};break;case "u_halo_size":k=function(a,b,c,d,e){a.uniform1f(b,e.Ir)};h=!0;break;case "u_halo_hardness":k=function(a,b,c,d,e){a.uniform1f(b,e.Fr)};h=!0;break;case "u_halo_rings_color":k=function(a,b,c,d,e){a.uniform3fv(b,e.Hr)};h=!0;break;case "u_halo_lines_color":k=function(a,b,c,d,e){a.uniform3fv(b,e.Gr)};h=!0;break;case "u_halo_stars_blend":k=function(a,b,c,d,e){a.uniform1f(b,e.Jr)};h=!0;
break;case "u_halo_stars_height":k=function(a,b,c,d,e){a.uniform1f(b,e.Kr)};h=!0;break;case "u_fresnel_params":k=function(a,b,c,d,e){a.uniform4fv(b,e.nd)};h=!0;break;case "u_texture_scale":k=function(a,b,c,d,e){a.uniform3fv(b,e.Ff)};h=!0;break;case "u_parallax_scale":k=function(a,b,c,d,e){a.uniform1f(b,e.parallax_scale)};h=!0;break;case "u_color_id":k=function(a,b,c,d){a.uniform3fv(b,d.xk)};h=!0;break;case "u_line_points":k=function(a,b,c,d,e){a.uniform3fv(b,e.BF)};h=!0;break;case "u_diffuse_color_factor":k=
function(a,b,c,d,e){a.uniform1f(b,e.Ye)};h=!0;break;case "u_alpha_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.Ne)};h=!0;break;case "u_specular_color_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.Bt)};h=!0;break;case "u_normal_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.vs)};h=!0;break;case "u_normalmap0_scale":k=function(a,b,c,d,e){a.uniform2fv(b,e.Eg[0])};h=!0;break;case "u_normalmap1_scale":k=function(a,b,c,d,e){a.uniform2fv(b,e.Eg[1])};h=!0;break;case "u_normalmap2_scale":k=function(a,b,c,
d,e){a.uniform2fv(b,e.Eg[2])};h=!0;break;case "u_normalmap3_scale":k=function(a,b,c,d,e){a.uniform2fv(b,e.Eg[3])};h=!0;break;case "u_foam_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.foam_factor)};h=!0;break;case "u_foam_uv_freq":k=function(a,b,c,d,e){a.uniform2fv(b,e.gr)};h=!0;break;case "u_foam_mag":k=function(a,b,c,d,e){a.uniform2fv(b,e.fr)};h=!0;break;case "u_foam_scale":k=function(a,b,c,d,e){a.uniform2fv(b,e.hn)};h=!0;break;case "u_water_norm_uv_velocity":k=function(a,b,c,d,e){a.uniform1f(b,
e.zi)};h=!0;break;case "u_shallow_water_col":k=function(a,b,c,d,e){a.uniform3fv(b,e.shallow_water_col)};h=!0;break;case "u_shore_water_col":k=function(a,b,c,d,e){a.uniform3fv(b,e.shore_water_col)};h=!0;break;case "u_water_shallow_col_fac":k=function(a,b,c,d,e){a.uniform1f(b,e.shallow_water_col_fac)};h=!0;break;case "u_water_shore_col_fac":k=function(a,b,c,d,e){a.uniform1f(b,e.shore_water_col_fac)};h=!0;break;case "u_p_length":k=function(a,b,c,d,e){a.uniform1f(b,e.la.Rt)};h=!0;break;case "u_p_cyclic":k=
function(a,b,c,d,e){a.uniform1i(b,e.la.cyclic)};h=!0;break;case "u_p_max_lifetime":k=function(a,b,c,d,e){a.uniform1f(b,e.la.hs)};h=!0;break;case "u_p_fade_in":k=function(a,b,c,d,e){a.uniform1f(b,e.la.xh)};h=!0;break;case "u_p_fade_out":k=function(a,b,c,d,e){a.uniform1f(b,e.la.Xc)};h=!0;break;case "u_p_size":k=function(a,b,c,d,e){a.uniform1f(b,e.la.size)};h=!0;break;case "u_p_alpha_start":k=function(a,b,c,d,e){a.uniform1f(b,e.la.Rp)};h=!0;break;case "u_p_alpha_end":k=function(a,b,c,d,e){a.uniform1f(b,
e.la.Qp)};h=!0;break;case "u_p_nfactor":k=function(a,b,c,d,e){a.uniform1f(b,e.la.jo)};h=!0;break;case "u_p_gravity":k=function(a,b,c,d,e){a.uniform1f(b,e.la.Dr)};h=!0;break;case "u_p_mass":k=function(a,b,c,d,e){a.uniform1f(b,e.la.Mh)};h=!0;break;case "u_p_size_ramp":k=function(a,b,c,d,e){a.uniform2fv(b,e.la.pt)};h=!0;break;case "u_p_color_ramp":k=function(a,b,c,d,e){a.uniform4fv(b,e.la.Fq)};h=!0;break;case "u_p_wind":k=function(a,b,c,d,e){a.uniform3fv(b,e.la.Of)};h=!0;break;case "u_texel_size":k=
function(a,b,c){a.uniform2fv(b,c.ap)};h=!0;break;case "u_p_time":k=function(a,b,c,d,e){a.uniform1f(b,e.la.time)};h=!0;break;case "u_position":k=function(a,b,c,d,e){a.uniform3fv(b,e.Xh)};h=!0;break;case "u_va_frame_factor":k=function(a,b,c,d){a.uniform1f(b,d.hu)};h=!0;break;case "u_perspective_cast_far_bound":k=function(a,b,c){a.uniform1f(b,c.MA)};break;case "u_normal_offset":k=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_pcf_blur_radii":k=function(a,b,c,d,e,g){a.uniform4fv(b,
g.sl)};break;case "u_v_light_matrix":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.gu)};h=!0;break;case "u_b_light_matrix":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.eq)};break;case "u_p_light_matrix0":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Kg[0])};h=!0;break;case "u_p_light_matrix1":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Kg[1])};h=!0;break;case "u_p_light_matrix2":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Kg[2])};h=!0;break;case "u_p_light_matrix3":k=function(a,b,c){a.uniformMatrix4fv(b,
!1,c.Kg[3])};h=!0;break;case "u_motion_blur_exp":k=function(a,b,c){a.uniform1f(b,c.ps)};h=!0;break;case "u_motion_blur_decay_threshold":k=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};h=!0;break;case "u_refl_plane":k=function(a,b,c,d){a.uniform4fv(b,d.cc)};h=!0;break;case "u_radial_blur_step":k=function(a,b,c){a.uniform1f(b,c.xl)};break;case "u_god_rays_intensity":k=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":k=function(a,b,c){a.uniform1f(b,c.ii)};
break;case "u_ssao_blur_discard_value":k=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};h=!0;break;case "u_ssao_influence":k=function(a,b,c){a.uniform1f(b,c.hi)};break;case "u_ssao_dist_factor":k=function(a,b,c){a.uniform1f(b,c.gi)};break;case "u_dof_dist":k=function(a,b,c,d,e,g){a.uniform1f(b,g.dof_distance)};h=!0;break;case "u_dof_front":k=function(a,b,c,d,e,g){a.uniform1f(b,g.dof_front)};h=!0;break;case "u_dof_rear":k=function(a,b,c,d,e,g){a.uniform1f(b,g.dof_rear)};h=!0;break;case "u_outline_intensity":k=
function(a,b,c,d){a.uniform1f(b,d.qd)};h=!0;break;case "u_outline_color":k=function(a,b,c){a.uniform3fv(b,c.pf)};break;case "u_draw_outline":k=function(a,b,c){a.uniform1f(b,c.Xm)};h=!0;break;case "u_glow_mask_small_coeff":k=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};h=!0;break;case "u_glow_mask_large_coeff":k=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};h=!0;break;case "u_brightness":k=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":k=function(a,b,c){a.uniform1f(b,
c.contrast)};break;case "u_exposure":k=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":k=function(a,b,c){a.uniform1f(b,c.saturation)};break;default:k=null}k&&(k={name:f,on:k,xg:b[f]},h?c.push(k):(d.push(k),e[f]=k))}a.Ut=c;a.Bj=d;a.ro=e}var m=p("__config"),h=p("__debug"),n=p("__textures"),f=p("__util"),k=p("__camera");p("mat4");var r=m.r,y=[1,1,1,1],w=[1,1,1,1],C=[0,0,0,1],D=[0,0,0,0],G=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,
.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var t=null,A=new Uint8Array(4);a.td=function(a){var b=r.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);t=a};a.Zi=function(a){if(a.Wa){var b=a.k;t.bindFramebuffer(t.FRAMEBUFFER,b.ne);if(a.jm){var g=b.nb;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,
g.Wb,g.fb,0)}t.viewport(0,0,b.width,b.height);"MAIN_CUBE_REFLECT"!=a.type&&d(a);a.Ha?t.enable(t.BLEND):t.disable(t.BLEND);a.Kb?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST);if(a.sa){for(var b=a.k,g=a.s,f=0;f<g.length;f++){var m=g[f],n=m.D,E=n.ec;t.useProgram(E.Ej);m=m.pd;E.Bj.length||l(E);for(var E=E.Bj,y=E.length;y--;){var A=E[y];A.on(t,A.xg,a,m,n,b)}}a.sa=!1}switch(a.type){case "DEPTH":r.Tr?(t.enable(t.POLYGON_OFFSET_FILL),t.polygonOffset(5,5)):t.disable(t.POLYGON_OFFSET_FILL);t.cullFace(t.BACK);
break;case "SHADOW_CAST":t.enable(t.POLYGON_OFFSET_FILL);t.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);t.cullFace(t.BACK);break;case "MAIN_PLANE_REFLECT":t.disable(t.POLYGON_OFFSET_FILL);t.cullFace(t.FRONT);break;default:t.disable(t.POLYGON_OFFSET_FILL),t.cullFace(t.BACK)}if("MAIN_CUBE_REFLECT"==a.type)for(b=a.k,g=b.nb.fb,f=0;6>f;f++){n=e(f);b.va=a.Ti[f];k.ym(b);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,n,g,0);d(a);n=a.s;for(m=0;m<n.length;m++)n[m].Wa=n[m].Wm[f];
c(a)}else c(a);h.$w("draw subscene: "+a.type);t.bindFramebuffer(t.FRAMEBUFFER,null)}};a.clear=function(a){t.bindFramebuffer(t.FRAMEBUFFER,a.k.ne);d(a)};a.Vp=function(a){var b=a.$p;b.length=0;var c=a.P;a=a.ec;c&&a||f.ha("Incomplete batch");c=c.Mb;a=a.attributes;for(var d in a){var e=c[d];b.push({xg:a[d],zw:4*e.offset,Jy:1<e.frames?4*e.length:0,Hd:e.Hd})}};a.yw=l;a.Xp=function(a){var b=a.ec,c=a.S;a=a.Nb;t.useProgram(b.Ej);for(var d=0;d<c.length;d++)t.uniform1i(b.Qj[a[d]],d)};a.Ys=function(a,b,c,d,e,
k){d||(d=1);e||(e=1);k||(k=new Uint8Array(4*d*e));k.length!=4*d*e&&f.ha("read_pixels(): Wrong storage");t.bindFramebuffer(t.FRAMEBUFFER,a);t.readPixels(b,c,d,e,t.RGBA,t.UNSIGNED_BYTE,k);t.bindFramebuffer(t.FRAMEBUFFER,null);return k};a.QC=function(a){var b=a.ec;t.useProgram(b.Ej);b.Bj.length||l(b);b=b.ro.u_cube_fog;b.on(t,b.xg,null,null,a,null)};a.kB=function(a,b){var c=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,c);if(a){var d=a,e=d.fb,d=d.Wb==t.TEXTURE_CUBE_MAP?t.TEXTURE_CUBE_MAP_NEGATIVE_Z:
d.Wb;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,d,e,0)}n.Xr(b)?t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,b.Kf):n.sj(b)&&(d=b,e=d.fb,d=d.Wb,t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,d,e,0));h.Ww();t.bindFramebuffer(t.FRAMEBUFFER,null);return c};a.jB=function(a,b,c,d,e){null==a?(t.bindFramebuffer(t.FRAMEBUFFER,a),t.viewport(0,0,d,e),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)):(n.sj(b)&&t.deleteTexture(b.fb),n.Xr(c)?t.deleteRenderbuffer(c.Kf):
n.sj(c)&&t.deleteTexture(c.fb),t.deleteFramebuffer(a))};a.mF=function(){};a.cleanup=function(){}};b4w.module.__shaders=function(a,p){function c(a,b,c){var e=a.$e;"string"==typeof c&&(a=d(a,c))&&(c=a[1]);for(a=0;a<e.length;a++)if(e[a][0]==b){e[a][1]=c;return}e.push([b,c])}function d(a,b){for(var c=a.$e,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function b(a,b){var c=a+b;if(t[c])return t[c];if(A){var d=A[b];if(!d)return null;d=p("__gpp_parser").KF.parse(d)}else if(d=p("shader_texts")[b],!d)return null;return t[c]=d}function e(a,c,d){function e(c){c=c.a;for(var d=0;d<c.length;d++){var t=
c[d];switch(t.type){case "condition":a:for(var t=t.a,E=0;E<t.length;E++){var w=t[E];switch(w.type){case "if":case "elif":if(g(w.d)){e(w.group);break a}break;case "else":e(w.group);break a;case "ifdef":w.name in u&&e(w.group);break;case "ifndef":w.name in u||e(w.group)}}break;case "include":t=b(D.shaders_dir,D.WB+t.file);e(t);break;case "var":case "export":case "import":break;case "define":E=t.name;u[E]=t.b;t.T&&(x[E]=t.T);break;case "error":throw"Shader error: #error "+t.b.join(" ");case "line":break;
case "pragma":m.push("#pragma "+t.name+" "+t.b.join(" "));break;case "undef":t=t.name;delete u[t];delete x[t];break;case "warning":r.warn("Shader warning: #warning "+t.b.join(" "));break;case "extension":t=l(t.b,u,x,!1);m.push("#extension "+t.join(" "));break;case "#":break;case "node":q[t.name]=t;break;case "nodes_global":t=k;for(E=0;E<t.length;E++){var w=t[E],B=q[w.id];if(B)for(var N=0,J=0;J<B.j.length;J++){var C=B.j[J];"node_param"==C.type&&(C=C.qualifier.join(" ")+" ","vert"==a?C+=w.yi[N]:"frag"==
a&&(C+=w.T[N],null!==w.pl[N]&&(C+=" = "+w.pl[N])),C+=";",m.push(C),N++)}}break;case "nodes_main":t=k;for(E=0;E<t.length;E++)if(w=t[E],B=q[w.id]){N={};J={};for(C=0;C<w.ie.length;C++)J[w.ie[C][0]]=[w.ie[C][1]];oa=G=p=0;for(var C=w,Z=B.j,U=N,sa=J,z=0;z<Z.length;z++){var F=Z[z];switch(F.type){case "node_in":var ka=C.J[p];if(null!==C.Hn[p]){if(("MATERIAL"==C.id&&3===p||"MATERIAL_EXT"==C.id&&3===p||"TEXTURE_COLOR"==C.id||"TEXTURE_NORMAL"==C.id)&&F.f){U[F.name]=C.Hn[p];p++;continue}var ra=F.qualifier.join(" ")+
" ",ra=ra+ka,ra=ra+(" = "+C.Hn[p]),ra=ra+";";m.push(ra)}U[F.name]=ka;p++;break;case "node_out":ka=C.Ba[G];if(!F.f||-1<A.indexOf(ka))ra=F.qualifier.join(" ")+" ",ra+=ka,ra+=";",m.push(ra),U[F.name]=ka;-1<A.indexOf(ka)&&(sa["USE_OUT_"+F.name]=[1]);G++;break;case "node_param":"vert"==a?ka=C.yi[oa]:"frag"==a&&(ka=C.T[oa]),U[F.name]=ka,oa++}}m.push("{");f(w,B.h,N,J);m.push("}")}break;case "lamp":y[t.name]=t;break;case "lamps_main":t=h;for(E=0;E<t.length;E++)if(w=t[E],w.dA){m.push("{");B=y[w.type].h;for(N=
0;N<B.length;N++){J=B[N];C=[];for(Z=0;Z<J.b.length;Z++){U=J.b[Z];switch(U){case "LAMP_IND":U=w.index;break;case "LAMP_LIGHT_FACT_IND":U=w.mA;break;case "LAMP_FAC_CHANNELS":U=w.lA;break;case "LAMP_SPOT_SIZE":U=n(w.ud);break;case "LAMP_SPOT_BLEND":U=n(w.Wg||.01);break;case "LAMP_LIGHT_DIST":U=n(w.distance);break;case "LAMP_SHADOW_MAP_IND":U=w.Py?1:0}C.push(U)}m.push(C.join(" "))}m.push("}")}break;case "textline":t=l(t.b,u,x,!1);m.push(t.join(" "));break;default:throw"Unknown element type: "+t.type;
}}}function g(a,b){var c;c=l(a,u,x,!0,b);for(var d=[],e=0;e<c.length;e++)if(c[e]instanceof Object)switch(c[e].type){case "conditional_expr":var f=d.pop(),k=d.pop();d.pop()?d.push(k):d.push(f);break;case "logical_or_expr":f=d.pop();for(k=0;k<c[e].e-1;k++)h=d.pop(),f=f||h;d.push(f);break;case "logical_and_expr":f=d.pop();for(k=0;k<c[e].e-1;k++)h=d.pop(),f=f&&h;d.push(f);break;case "logical_bitor_expr":f=d.pop();for(k=0;k<c[e].e-1;k++)f|=d.pop();d.push(f);break;case "logical_bitxor_expr":f=d.pop();for(k=
0;k<c[e].e-1;k++)f^=d.pop();d.push(f);break;case "logical_bitand_expr":f=d.pop();for(k=0;k<c[e].e-1;k++)f&=d.pop();d.push(f);break;case "equal_expr":f=d.pop();k=d.pop();d.push(k==f);break;case "non_equal_expr":f=d.pop();k=d.pop();d.push(k!=f);break;case "le_expr":f=d.pop();k=d.pop();d.push(k<=f);break;case "ge_expr":f=d.pop();k=d.pop();d.push(k>=f);break;case "l_expr":f=d.pop();k=d.pop();d.push(k<f);break;case "g_expr":f=d.pop();k=d.pop();d.push(k>f);break;case "left_shift_expr":k=d.pop();f=d.pop();
d.push(k<<f);break;case "right_shift_expr":k=d.pop();f=d.pop();d.push(k>>f);break;case "add_expr":k=d.pop();f=d.pop();d.push(k+f);break;case "sub_expr":k=d.pop();f=d.pop();d.push(k-f);break;case "mul_expr":k=d.pop();f=d.pop();d.push(k*f);break;case "div_expr":k=d.pop();f=d.pop();d.push(k/f);break;case "mod_expr":k=d.pop();f=d.pop();d.push(k%f);break;case "pre_inc_expr":case "post_inc_expr":h=d.pop();d.push(++h);break;case "pre_dec_expr":case "post_dec_expr":h=d.pop();d.push(--h);break;case "positive_expr":h=
d.pop();d.push(+h);break;case "negative_expr":h=d.pop();d.push(-h);break;case "one_compl_expr":h=d.pop();d.push(~h);break;case "logic_negative_expr":h=d.pop();d.push(!h);break;default:C.ha("Unknown operation type: "+c[e].type)}else{var h=c[e];/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(h)?d.push(0):d.push(parseFloat(c[e]))}1==d.length?c=d[0]:(C.ha("Incorrect expression: "+c.join(" ")),c=void 0);return c}function f(a,b,c,d){for(var e=0;e<b.length;e++){var k=b[e];switch(k.type){case "node_condition":a:for(var h=
a,k=k.a,v=c,n=d,t=0;t<k.length;t++){var I=k[t];switch(I.type){case "node_if":case "node_elif":if(g(I.d,n)){f(h,I.h,v,n);break a}break;case "node_else":f(h,I.h,v,n);break a;case "node_ifdef":(I.name in u||I.name in n)&&f(h,I.h,v,n);break;case "node_ifndef":I.name in u||I.name in n||f(h,I.h,v,n)}}break;case "textline":h=[];for(v=0;v<k.b.length;v++)n=k.b[v],n in c?h.push(c[n]):h.push(n);h=l(h,u,x,!0,d);m.push(h.join(" "))}}}var k=d.lo,h=d.Un;d=d.$e||[];for(var m=[],u={},t=0;t<d.length;t++)u[d[t][0]]=
[d[t][1]];for(t=0;t<k.length;t++)u["USE_NODE_"+k[t].id]=[1];var x={},q={},y={},A=[];for(t in k)for(var w in k[t].J)A.push(k[t].J[w]);e(c);var p=0,G=0,oa=0;return m.join("\n")}function l(a,b,c,d,e){var g=[];m(a,b,c,d,g,e);return g}function m(a,b,c,d,e,g){for(var f=0;f<a.length;f++){var k=a[f];k in b||g&&k in g?(k=g&&g[k]||b[k],0==k.length&&d?e.push(0):m(k,b,c,d,e,g)):e.push(k)}}function h(a,b,c,d){d=a.createShader(d);a.shaderSource(d,c);a.compileShader(d);y.ax(d,b,c);return d}function n(a,b){!b&&a.length?
b=a.length:b||(b=1);switch(b){case 1:return f(a);case 2:return"vec2("+f(a[0])+","+f(a[1])+")";case 3:return"vec3("+f(a[0])+","+f(a[1])+","+f(a[2])+")";case 4:return"vec4("+f(a[0])+","+f(a[1])+","+f(a[2])+","+f(a[3])+")";case 9:return"mat3("+f(a[0])+","+f(a[1])+","+f(a[2])+","+f(a[3])+","+f(a[4])+","+f(a[5])+","+f(a[6])+","+f(a[7])+","+f(a[8])+")";case 16:return"mat4("+f(a[0])+","+f(a[1])+","+f(a[2])+","+f(a[3])+","+f(a[4])+","+f(a[5])+","+f(a[6])+","+f(a[7])+","+f(a[8])+","+f(a[9])+","+f(a[10])+","+
f(a[11])+","+f(a[12])+","+f(a[13])+","+f(a[14])+","+f(a[15])+")";default:throw"Wrong glsl value dimension";}}function f(a){return a%1?String(a):String(a)+".0"}var k=p("__config"),r=p("__print"),y=p("__debug"),w=p("__assets"),C=p("__util"),D=k.bc,G={},t={},A=null,x="anchors.glslf anchors.glslv color_id.glslf color_id.glslv depth.glslf depth.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv main.glslf main.glslv particles_color.glslf particles_color.glslv particles_texture.glslf particles_texture.glslv procedural_skydome.glslf procedural_skydome.glslv special_lens_flares.glslf special_lens_flares.glslv special_skydome.glslf special_skydome.glslv special_water.glslf special_water.glslv wireframe.glslf wireframe.glslv postprocessing/anaglyph.glslf postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf include/blending.glslf include/caustics.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/gamma.glslf include/lighting.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/std_enums.glsl include/to_world.glslv include/wind_bending.glslv".split(" "),
u=[],g=null,q=!1;a.td=function(a){g=a};a.I=c;a.oz=d;a.uF=function(a,b){for(var c=a.$e,d=0;d<c.length;d++)if(c[d][0]==b&&1==c[d][1])return!0;return!1};a.CB=function(a){a.$e=[];for(var b="ALPHA ALPHA_CLIP BEND_CENTER_ONLY BILLBOARD_PRES_GLOB_ORIENTATION CAUSTICS CSM_BLEND_BETWEEEN_CASCADES CSM_FADE_LAST_CASCADE CSM_SECTION0 CSM_SECTION1 CSM_SECTION2 CSM_SECTION3 DEBUG_SPHERE DEBUG_SPHERE_DYNAMIC DEPTH_RGBA DISABLE_FOG DOUBLE_SIDED_LIGHTING DYNAMIC DYNAMIC_GRASS DYNAMIC_GRASS_COLOR DYNAMIC_GRASS_SIZE FOAM FRAMES_BLENDING BILLBOARD_JITTERED BILLBOARD_SPHERICAL HAIR_BILLBOARD SHADOW_TEX_RES MAIN_BEND_COL MAX_BONES NODES_GLOW NUM_NORMALMAPS PARALLAX PARALLAX_STEPS PERSPECTIVE_SHADOW_CAST PROCEDURAL_FOG PROCEDURAL_SKYDOME REFLECTION REFLECTION_PASS REFLECTION_TYPE REFRACTIVE USE_REFRACTION USE_REFRACTION_CORRECTION SHORE_SMOOTHING SKINNED SKY_COLOR SKY_TEXTURE SSAO_HEMISPHERE SSAO_BLUR_DEPTH SSAO_ONLY SSAO_WHITE STATIC_BATCH TEXTURE_COLOR TEXTURE_NORM TEXTURE_SPEC TEXTURE_STENCIL_ALPHA_MASK VERTEX_ANIM VERTEX_ANIM_MIX_NORMALS_FACTOR VERTEX_COLOR WATER_EFFECTS WIND_BEND DETAIL_BEND SHORE_PARAMS ALPHA_AS_SPEC DEPTH_RGBA MTEX_NEGATIVE MTEX_RGBTOINT NUM_LIGHTS NUM_LFACTORS NUM_LAMP_LIGHTS MAX_STEPS BILLBOARD_ALIGN SHADOW_USAGE POST_EFFECT SSAO_QUALITY TEXTURE_BLEND_TYPE TEXTURE_COORDS AA_METHOD AU_QUALIFIER BILLBOARD BILLBOARD_RANDOM PRECISION EPSILON USE_ENVIRONMENT_LIGHT USE_FOG WO_SKYBLEND WO_SKYPAPER WO_SKYREAL WO_SKYTEX WOMAP_BLEND WOMAP_HORIZ WOMAP_ZENUP WOMAP_ZENDOWN WIREFRAME_QUALITY SIZE_RAMP_LENGTH COLOR_RAMP_LENGTH PARTICLES_SHADELESS".split(" "),
d=0;d<b.length;d++){var e=b[d],g;switch(e){case "ALPHA":case "ALPHA_CLIP":case "BILLBOARD_PRES_GLOB_ORIENTATION":case "CAUSTICS":case "CSM_SECTION0":case "CSM_SECTION1":case "CSM_SECTION2":case "CSM_SECTION3":case "DEBUG_SPHERE":case "DEBUG_SPHERE_DYNAMIC":case "DEPTH_RGBA":case "DISABLE_FOG":case "DOUBLE_SIDED_LIGHTING":case "DYNAMIC":case "DYNAMIC_GRASS":case "DYNAMIC_GRASS_COLOR":case "DYNAMIC_GRASS_SIZE":case "FOAM":case "FRAMES_BLENDING":case "BILLBOARD_JITTERED":case "MAIN_BEND_COL":case "MAX_BONES":case "MTEX_NEGATIVE":case "MTEX_RGBTOINT":case "NODES_GLOW":case "NUM_LIGHTS":case "NUM_LFACTORS":case "NUM_NORMALMAPS":case "PARALLAX":case "PARALLAX_STEPS":case "PERSPECTIVE_SHADOW_CAST":case "PROCEDURAL_FOG":case "PROCEDURAL_SKYDOME":case "REFLECTION":case "REFLECTION_PASS":case "REFLECTION_TYPE":case "REFRACTIVE":case "USE_REFRACTION":case "USE_REFRACTION_CORRECTION":case "SHORE_SMOOTHING":case "SKINNED":case "SKY_COLOR":case "SKY_TEXTURE":case "SSAO_HEMISPHERE":case "SSAO_BLUR_DEPTH":case "SSAO_ONLY":case "SSAO_WHITE":case "STATIC_BATCH":case "TEXTURE_COLOR":case "TEXTURE_NORM":case "TEXTURE_SPEC":case "TEXTURE_STENCIL_ALPHA_MASK":case "VERTEX_ANIM":case "VERTEX_COLOR":case "WATER_EFFECTS":case "WIND_BEND":case "DETAIL_BEND":case "SHORE_PARAMS":case "BILLBOARD":case "BILLBOARD_RANDOM":case "HAIR_BILLBOARD":case "USE_ENVIRONMENT_LIGHT":case "USE_FOG":case "WO_SKYBLEND":case "WO_SKYPAPER":case "WO_SKYREAL":case "WO_SKYTEX":case "WOMAP_BLEND":case "WOMAP_HORIZ":case "WOMAP_ZENUP":case "WOMAP_ZENDOWN":case "WIREFRAME_QUALITY":case "SIZE_RAMP_LENGTH":case "COLOR_RAMP_LENGTH":case "PARTICLES_SHADELESS":case "SMAA_JITTER":g=
0;break;case "ALPHA_AS_SPEC":case "BEND_CENTER_ONLY":case "CSM_BLEND_BETWEEEN_CASCADES":case "CSM_FADE_LAST_CASCADE":case "DEPTH_RGBA":case "BILLBOARD_SPHERICAL":case "NUM_LAMP_LIGHTS":case "MAX_STEPS":g=1;break;case "SHADOW_TEX_RES":g=n(2048);break;case "AA_METHOD":g="AA_METHOD_FXAA_QUALITY";break;case "AU_QUALIFIER":g="NOT_ASSIGNED";break;case "BILLBOARD_ALIGN":g="BILLBOARD_ALIGN_VIEW";break;case "POST_EFFECT":g="POST_EFFECT_NONE";break;case "SHADOW_USAGE":g="NO_SHADOWS";break;case "SSAO_QUALITY":g=
"SSAO_QUALITY_32";break;case "TEXTURE_BLEND_TYPE":g="TEXTURE_BLEND_TYPE_MIX";break;case "TEXTURE_COORDS":g="TEXTURE_COORDS_UV_ORCO";break;case "PRECISION":g=k.r.precision;break;case "EPSILON":g="highp"==k.r.precision?1E-6:1E-4;break;case "VERTEX_ANIM_MIX_NORMALS_FACTOR":g="u_va_frame_factor";break;default:r.error("Unknown directive ("+a.Vj+", "+a.ej+"): "+e)}c(a,e,g)}};a.hF=function(a){return a.Vj};a.ur=function(a){return a.ej};a.nF=function(a,b){for(var e=b.$e,g=0;g<e.length;g++){var f=e[g][0],k=
e[g][1];d(a,f)&&c(a,f,k)}};a.kz=function(a){var c=JSON.stringify(a),d=G[c];if(d)return d;var f=a.ej,d=b(D.shaders_dir,a.Vj),f=b(D.shaders_dir,f);if(!d||!f)return null;var k=e("vert",d,a),m=e("frag",f,a),d=g,l=h(d,c,k,d.VERTEX_SHADER),v=h(d,c,m,d.FRAGMENT_SHADER),f=d.createProgram();d.attachShader(f,l);d.attachShader(f,v);d.linkProgram(f);d.validateProgram(f);d.getProgramParameter(f,d.VALIDATE_STATUS)==d.XD&&r.error("shader program is not valid",c);y.bx(f,c,l,v,k,m);a={qp:l,jr:v,Ej:f,attributes:{},
Qj:{},Bj:[],ro:{},Ut:[],Eb:a};m=d.getProgramParameter(f,d.ACTIVE_ATTRIBUTES);for(k=0;k<m;k++)l=d.getActiveAttrib(f,k).name,a.attributes[l]=d.getAttribLocation(f,l);m=d.getProgramParameter(f,d.ACTIVE_UNIFORMS);for(k=0;k<m;k++)l=d.getActiveUniform(f,k).name.split("[0]").join(""),a.Qj[l]=d.getUniformLocation(f,l);return G[c]=d=a};a.oA=function(){q=!1;if(b4w.module_check("shader_texts"))q=!0;else{for(var a=[],b=w.AT_TEXT,c=0;c<x.length;c++){var d=C.il(D.shaders_dir+x[c]);a.push([x[c],b,d])}b=function(a,
b){A||(A={});A[b]=a};a.length?w.enqueue(a,b,function(){q=!0}):r.error("Shaders have not been found.")}};a.cx=function(){return q};a.GE=function(){return u};a.rr=function(){return G};a.cleanup=function(){for(var a in G){var b=G[a];g.deleteProgram(b.Ej);g.deleteShader(b.qp);g.deleteShader(b.jr);delete G[a]}for(var c in t)delete t[c];for(var d in u)delete u[d]};a.HE=function(a){var b=a.$e;r.log("Shader: "+a.Vj+" "+a.ej+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)r.log("  "+b[a][0],
b[a][1])};a.v=n;a.xq=function(a,b){return b in a.Qj?!0:!1};a.Dz=function(a){return(g.getShaderSource(a).match(/(?:^|\s)varying(?=\s)/g)||[]).length}};b4w.module.__geometry=function(a,p){function c(a){return 65536<a.O?L.tr()?!1:!0:!1}function d(a){return 0<a.ka.length?!0:!1}function b(a,b,c){if(!d(a))return a;c||u.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.O*(b||1)+", will use drawArrays","color: #aa0");b=a.ka;c=a.O;var g=a.N,f=a.C,k;for(k in g){var h=g[k],m=w(h,c);g[k]=e(b,h,m)}for(g=0;g<f.length;g++){var l=f[g];for(k in l)h=l[k],m=w(h,c),l[k]=e(b,h,m)}for(g=0;g<a.aa.length;g++){k=a.aa[g].Zb;for(var n in k)h=k[n],
m=w(h,c),k[n]=e(b,h,m)}a.O=b.length;a.ka=new Uint16Array(0);return a}function e(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),e=0;e<a.length;e++)for(var g=a[e],f=0;f<c;f++)d[c*e+f]=b[c*g+f];return d}function l(a,b){var c=a.Pc,d=a.Mb[b];if(d)return c.subarray(d.offset,d.offset+d.length);throw"extract_array() failed; invalid name: "+b;}function m(b,c){var d,e;switch(c){case a.Bi:case a.bk:d=Q.TRIANGLES;e=Q.STATIC_DRAW;break;case a.yp:d=Q.POINTS;e=Q.STATIC_DRAW;
break;case a.ak:d=Q.TRIANGLES;e=Q.DYNAMIC_DRAW;break;case a.xp:d=Q.POINTS;e=Q.DYNAMIC_DRAW;break;case a.uu:d=Q.LINES;e=Q.STATIC_DRAW;break;default:throw"Wrong draw_mode";}b.mode=d;b.Uj=e}function h(a){a.gf?(a.qe||(a.qe=Q.createBuffer()),Q.bindBuffer(Q.ELEMENT_ARRAY_BUFFER,a.qe),Q.bufferData(Q.ELEMENT_ARRAY_BUFFER,a.gf,a.Uj),a.Ek=a.gf.byteLength):a.Ek=0;a.If||(a.If=Q.createBuffer());Q.bindBuffer(Q.ARRAY_BUFFER,a.If);Q.bufferData(Q.ARRAY_BUFFER,a.Pc,a.Uj);a.Sq=a.Pc.byteLength}function n(a){for(var b=
q.sb("JOIN_"+a.length+"_SUBMESHES"),c=0,d=0;d<a.length;d++)c+=a[d].ka.length;b.ka=new Uint32Array(c);var e=c=0,g=0;if(0<a[0].aa.length)for(var f=0;f<a[0].aa.length;f++){for(d=0;d<a.length;d++)c+=a[d].aa[f].Zb.a_position.length,e+=a[d].aa[f].Zb.a_normal.length,g+=a[d].aa[f].Zb.a_tangent.length;d={a_position:new Float32Array(c),a_normal:new Float32Array(e),a_tangent:new Float32Array(g)};b.aa.push({Xk:a[0].aa[f].Xk,Zb:d})}for(d=c=0;d<a.length;d++)c+=a[d].O;b.O=c;var e=a[0],k;for(k in e.N){for(d=c=0;d<
a.length;d++)c+=a[d].N[k].length;b.N[k]=new Float32Array(c)}for(k in e.C[0]){for(d=c=0;d<a.length;d++)c+=a[d].C[0][k].length;for(d=0;d<e.C.length;d++)b.C[d]=b.C[d]||{},b.C[d][k]=new Float32Array(c)}for(k=e=c=0;k<a.length;k++){for(var g=a[k],h=g.ka,f=g.O,m=g.N,d=0;d<h.length;d++)b.ka[c+d]=h[d]+e;var c=c+h.length,l;for(l in m){var h=m[l],u=e*w(h,f);b.N[l].set(h,u)}for(d=0;d<g.C.length;d++){var m=g.C[d],n=b.C[d];for(l in m)h=m[l],u=e*w(h,f),n[l].set(h,u)}e+=f}if(0<b.aa.length)for(k=0;k<b.aa.length;k++)for(l=
b.aa[k].Zb,d=g=e=c=0;d<a.length;d++)f=a[d].aa[k].Zb,l.a_position.set(f.a_position,c),l.a_normal.set(f.a_normal,e),l.a_tangent.set(f.a_tangent,g),c+=f.a_position.length,e+=f.a_normal.length,g+=f.a_tangent.length;return b}function f(a,c,d,e,g,f){var h=q.sb("SUBMESH_"+a.name+"_"+c),m=a.submeshes[c],l=m.base_length,n=a.materials[c];h.O=l;var x=!1;if(r(d,"a_texcoord")){var w=null,A=a.materials[c];c=a.submeshes[c];if(A.texture_slots.length)switch(A=A.texture_slots[0],A.texture_coords){case "UV":A=a.uv_textures.indexOf(A.uv_layer);
0==A||-1==A?w=new Float32Array(c.texcoord):1==A&&(w=new Float32Array(c.texcoord2));break;case "ORCO":for(var E=a.b4w_bounding_box_source,w=new Float32Array(2*c.base_length),A=(E.max_x+E.min_x)/2,C=(E.max_z+E.min_z)/2,J=E.max_x-E.min_x,E=E.max_z-E.min_z,K=0,p=0;p<c.position.length;p+=3)w[K++]=(c.position[p]-A)/J+.5,w[K++]=(C-c.position[p+2])/E+.5}null===w&&(w=new Float32Array(c.texcoord));c=w}else c=new Float32Array(0);if(r(d,"a_orco_tex_coord")){w=a.b4w_bounding_box_source;A=new Float32Array(3*m.base_length);
C=w.max_x-w.min_x;J=w.max_z-w.min_z;E=w.max_y-w.min_y;for(p=K=0;p<m.position.length;p+=3)0==C?A[K++]=-1:A[K++]=parseFloat(((m.position[p]-w.min_x)/C).toFixed(3)),0==J?A[K++]=-1:A[K++]=parseFloat(((-w.min_z-m.position[p+2])/J).toFixed(3)),0==E?A[K++]=-1:A[K++]=parseFloat(((m.position[p+1]-w.min_y)/E).toFixed(3));w=A}else w=new Float32Array(0);var B,A=m.group;if(r(d,"a_influence")&&e){C=new Float32Array(4*l);J=A.length/l;E=new Float32Array(J);for(K=0;K<J;K++)for(B in E[K]=-1,e)if(p=e[B],p.lu===K){E[K]=
p.Vi;break}var N=3<J?J:4;e=new Float32Array(N);B=new Uint32Array(N);for(var K=new Float32Array(4),p=new Float32Array(N),N=new Uint32Array(N),ia=new Float32Array(4),M=0;M<l;M++)e.set(p),B.set(N),K.set(ia),C.set(y(A,J,M,l,E,e,B,K),4*M)}else C=new Float32Array(0);B=C;e=g?q.pa(g):{};e.a_color={lg:!0};e.a_color.src=r(d,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,Zc:7}]:[];g={a_texcoord:c,a_influence:B,a_orco_tex_coord:w};B=m.vertex_colors;c=m.color;w=a.name;A=[];for(C=0;C<B.length;C++)A.push(B[C].name);
for(var G in e)if(C=e[G].src,C.length){for(E=J=0;E<C.length;E++)J+=q.Rg(C[E].Zc);g[G]=new Float32Array(J*l);for(E=K=0;E<C.length;E++){var D=C[E].name,p=C[E].Zc,N=q.et(p),L=A.indexOf(D);-1==L&&q.ha('vertex color "'+D+'" for mesh "'+w+'" not found.');ia=B[L].mask;M=q.Rg(ia);(p&ia)!==p&&u.error("Wrong color extraction from "+D+" to "+G+".");for(var z=D=0;z<L;z++)D+=q.Rg(B[z].mask);L=D*l;for(D=0;D<l;D++)for(z=0;3>z;z++)N[z]&&(g[G][D*J+(K+q.Jj(p,z))]=c[L+D*M+q.Jj(ia,z)]);K+=M}}else g[G]=new Float32Array(0);
G=a.uv_textures;e=m.texcoord;B=m.texcoord2;c=a.name;if(f)for(var F in f){w=G.indexOf(F);-1==w&&q.ha('uv map "'+F+'" for mesh "'+c+'" not found');if(0==w)var ka=new Float32Array(e);else 1==w&&(ka=new Float32Array(B));g[f[F]]=ka}h.N=g;h.ka=new Uint32Array(m.indices);f=m.position.length/l/3;ka=(F=r(d,"a_normal")&&m.normal.length?!0:!1)&&r(d,"a_tangent")&&m.tangent.length?!0:!1;G=n.texture_slots[0];G=F&&n.texture_slots.length&&r(d,"a_tangent")&&"ORCO"==G.texture_coords&&G.use_map_normal?!0:!1;0<a.b4w_shape_keys.length&&
(x=!0);for(g=0;g<f;g++){n=k(m,d,l,F,ka,G,g,a.name);if(x)if(e={},e.name=a.b4w_shape_keys[g].name,h.aa.push(e),0!=g){e.Zb=n;e.Xk=a.b4w_shape_keys[g].value;continue}else e.Zb=k(m,d,l,F,ka,G,g,a.name),e.Xk=1;h.C.push(n)}if(1<f&&!x){a=h.C[0];var n={},ra;for(ra in a)n[ra]=new Float32Array(a[ra]);h.C.push(n)}r(d,"a_polyindex")&&(b(h,1,!0),h.N.a_polyindex=t(h));return h}function k(a,b,c,d,e,g,f,k){var h={},m=new Float32Array(3*c),l=new Float32Array(d?3*c:0),n=new Float32Array(e||g?4*c:0),t=f*c*3;m.set(a.position.subarray(t,
t+3*c),0);d&&(t=f*c*3,l.set(a.normal.subarray(t,t+3*c),0));if(e)t=f*c*4,n.set(a.tangent.subarray(t,t+4*c),0);else if(g)for(a=n,u.warn('Not precise tangents calculation for normalmap using GENERATED texture coordinates in mesh: "'+k+'". Please add a UV-map.'),k=0;k<c;k++)b=E,d=M,b[0]=l[3*k],b[1]=l[3*k+1],b[2]=l[3*k+2],J.cross(b,q.AXIS_Z,d),0==J.length(d)&&J.cross(b,q.AXIS_X,d),J.normalize(d,d),a[4*k]=d[0],a[4*k+1]=d[1],a[4*k+2]=d[2],a[4*k+3]=1;else if(d&&r(b,"a_tangent"))for(n=new Float32Array(4*c),
c=0;c<n.length;c++)n[c]=1;h.a_position=m;h.a_normal=l;h.a_tangent=n;return h}function r(a,b){return-1<a.indexOf(b)?!0:!1}function y(b,c,d,e,g,f,k,h){for(var m=!0,l=0;l<c;l++){var u=b[l*e+d];if(-1!==u){var n=g[l];-1!==n&&(f[l]=u,k[l]=n,m=!1)}}if(m)return h;C(f,k,a.Xl,!1);for(l=b=0;4>l;l++)b+=f[l];if(.01>b)return h;for(l=0;4>l;l++)f[l]/=b;if(.01>Math.abs(f[0]-1))h[0]=k[0]+1;else for(l=0;4>l;l++)h[l]=k[l]+f[l];return h}function w(a,b){if(0==b)return 0;var c=a.length,d=c/b;if(d!=Math.floor(d))throw"Array size mismatch during geometry calculation: array length="+
c+", base length="+b;return d}function C(b,c,d,e){for(var g=b.length,f=g,k=!1,h=e?-1:1;1<f||k;){1<f&&(f=Math.floor(f/1.247330950103979));for(var k=!1,m=0;f+m<g;m++)if(d==a.Xl?0>h*(b[m]-b[m+f]):b[m]<b[m+f]&&e)k=b[m],b[m]=b[m+f],b[m+f]=k,k=c[m],c[m]=c[m+f],c[m+f]=k,k=!0}}function D(a,b,c){var d=[],e=[];J.subtract(b,a,d);J.subtract(c,a,e);J.normalize(d,d);J.normalize(e,e);return Math.acos(J.dot(d,e))}function G(a,b,c){b||(b=[]);c=c?a.C[0].a_normal:a.C[0].a_position;if(d(a)){a=a.ka;for(var e=a.length/
3,g=0;g<e;g++){var f=new Float32Array(9),k=a[3*g];f[0]=c[3*k];f[1]=c[3*k+1];f[2]=c[3*k+2];k=a[3*g+1];f[3]=c[3*k];f[4]=c[3*k+1];f[5]=c[3*k+2];k=a[3*g+2];f[6]=c[3*k];f[7]=c[3*k+1];f[8]=c[3*k+2];b[g]=f}}else for(g=0;g<c.length;g++)f=new Float32Array(9),f[0]=c[9*g],f[1]=c[9*g+1],f[2]=c[9*g+2],f[3]=c[9*g+3],f[4]=c[9*g+4],f[5]=c[9*g+5],f[6]=c[9*g+6],f[7]=c[9*g+7],f[8]=c[9*g+8],b[g]=f;return b}function t(a){for(var b=new Float32Array(a.O),c=0;c<a.O;c++)b[c]=c%3;return b}function A(a,b,c){var d=J.dist(a,
b);a=J.dist(a,c);b=J.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function x(a,b,c,d,e){c-=b;for(var g=0;g<c;g+=d)g%d==e&&vec3.normalize(a.subarray(g+b-e,g+b+1),a.subarray(g+b-e,g+b+1))}var u=p("__print"),g=p("__tsr"),q=p("__util"),L=p("__extensions"),J=p("vec3"),E=new Float32Array(3),M=new Float32Array(3),K=new Float32Array(3);a.Wd=10;a.Gp=20;a.bE=30;a.bk=10;a.yp=20;a.ak=30;a.xp=40;a.uu=50;a.Xl=0;a.Gv=1;a.Bi=a.bk;var Q=null;a.td=function(a){Q=a};a.IE=function(a){var b=_buffers[a];Q.deleteBuffer(b.qe);
Q.deleteBuffer(b.If);delete _buffers[a]};a.xC=function(e,g,f,k){c(e)&&b(e);var l=e.ka,u=e.O,n=e.C,t={},x;for(x in e.N)x in k&&!k[x].lg||(t[x]=e.N[x]);k={gf:null,Pc:null,En:0,count:0,Mb:{},mode:0,Uj:0,Ek:0,Sq:0,If:null,qe:null,Vk:null,aa:null};if(0<e.aa.length){x=n[0];for(var q=1;q<e.aa.length;q++){for(var A=e.aa[q].Zb,r=A.a_position,y=A.a_normal,E=x.a_position,C=x.a_normal,K=r.length,J=e.aa[q].Xk,p=0;p<K;p++)E[p]+=J*r[p],C[p]+=J*y[p];A=A.a_tangent;r=x.a_tangent;y=A.length;for(p=0;p<y;p++)r[p]+=J*
A[p]}}if(l.length)if(x=l.length,65536>=u)var q=new Uint16Array(l),B=Q.UNSIGNED_SHORT;else q=new Uint32Array(l),B=Q.UNSIGNED_INT;else x=u,q=null;var J=0,p=n.length,N;for(N in n[0])A=n[0][N],J+=A.length*p;for(N in t)A=t[N],J+=A.length;N=new Float32Array(J);var J=0,p={},ia;for(ia in t)if(r=t[ia],A=r.length)N.set(r,J),p[ia]={nE:ia,Hd:w(r,u),offset:J,frames:1,length:A},J+=A;t=n.length;for(ia in n[0])if(r=n[0][ia],A=r.length,r=w(r,u),A)for(p[ia]={Hd:r,offset:J,frames:t,length:A},1<t&&(p[ia+"_next"]={Hd:r,
offset:J+A,frames:t,length:A}),y=0;y<t;y++)r=n[y][ia],N.set(r,J),J+=A;k.count=x;k.gf=q;k.Pc=N;k.En=B;k.Mb=p;m(k,f);h(k);g!=a.Wd&&d(e)&&(k.Vk={zA:new Float32Array(l.length),AA:new Float32Array(l.length),ny:new Float32Array(l.length/3),type:g});k.aa=e.aa;return k};a.aA=c;a.$z=d;a.Jl=b;a.SC=function(a,b,c){m(a,b);a.count=c.length;a.gf=c;a.En=c instanceof Uint16Array?Q.UNSIGNED_SHORT:Q.UNSIGNED_INT};a.Ml=function(a,b,c,d){var e=a.Pc,g=a.Mb,f=g[b];f?(c&&f.Hd!=c&&q.ha('invalid num_comp for "'+b+'"'),e.set(d,
f.offset)):(e=e.length,f=new Float32Array(e+d.length),f.set(a.Pc),f.set(d,e),a.Pc=f,g[b]={Hd:c,offset:e});h(a)};a.zy=l;a.GF=function(a){a.Uj=Q.STATIC_DRAW};a.tA=function(a){a.Uj=Q.DYNAMIC_DRAW};a.$t=h;a.zq=function(a){a.qe&&Q.deleteBuffer(a.qe);a.If&&Q.deleteBuffer(a.If)};a.Lr=function(a,b){return a.submeshes[b].base_length?!1:!0};a.Lt=function(a,b){for(var c=0;c<a.C.length;c++){var d=a.C[c].a_position;g.transform_vectors(d,b,d,0);d=a.C[c].a_normal;0<d.length&&g.transform_dir_vectors(d,b,d,0);d=a.C[c].a_tangent;
0<d.length&&g.transform_tangents(d,b,d,0)}(c=a.N.au_center_pos)&&c.length&&g.transform_vectors(c,b,c,0);return a};a.vC=function(a,b){var c=a.N.au_center_pos;if(c&&c.length){var d=new Float32Array(c);g.transform_vectors(d,b,d,0);for(var e=0;e<a.C.length;e++)for(var f=0;f<d.length;f++)a.C[e].a_position[f]+=d[f]-c[f];c.set(d)}else throw'Attribute "au_center_pos" is missing in particle submesh';};a.uC=function(a,b){var c=a.O,d;for(d in b){var e=b[d].length;a.N[d]=new Float32Array(e*c);for(var g=0;g<c;g++)for(var f=
0;f<e;f++)a.N[d][g*e+f]=b[d][f]}};a.wC=n;a.sA=function(a,c,d){if(!a.O)return q.sb("EMPTY");var e=d.length;65536<a.O*e&&!L.tr()&&b(a,e);var f=a.ka,k=a.O,h=a.N;a=a.C;for(var m in c){var l=c[m].length,u=l*k;h[m]=new Float32Array(u);for(var n=0;n<k;n++)for(u=0;u<l;u++)h[m][n*l+u]=c[m][u]}c=q.sb("CLONE_"+e+"_SUBMESHES");c.O=k*e;c.ka=new Uint32Array(f.length*e);for(n=0;n<e;n++)for(l=f.length*n,m=k*n,u=0;u<f.length;u++)c.ka[l+u]=f[u]+m;for(var t in h)for(f=h[t],u=f.length*e,l=w(f,k),c.N[t]=new Float32Array(u),
n=0;n<e;n++)m=k*l*n,c.N[t].set(f,m);for(t in a[0])for(n=0;n<a.length;n++)for(f=a[n][t],u=f.length*e,l=w(f,k),c.C[n]=c.C[n]||{},c.C[n][t]=new Float32Array(u),u=0;u<e;u++)switch(h=d[u],m=k*l*u,t){case "a_position":g.transform_vectors(f,h,c.C[n][t],m);break;case "a_normal":g.transform_dir_vectors(f,h,c.C[n][t],m);break;case "a_tangent":g.transform_tangents(f,h,c.C[n][t],m);break;default:throw"Wrong attribute name: "+t;}return c};a.br=f;a.Cy=function(a){var b=a.O,c=a.C[0].a_position,d=new Float32Array(12*
b),e=new Float32Array(8*b);a=new Uint16Array(4*a.ka.length);for(var f=0;f<b;f++)d[12*f]=c[3*f],d[12*f+1]=c[3*f+1],d[12*f+2]=c[3*f+2],d[12*f+3]=c[3*f],d[12*f+4]=c[3*f+1],d[12*f+5]=c[3*f+2],d[12*f+6]=c[3*f],d[12*f+7]=c[3*f+1],d[12*f+8]=c[3*f+2],d[12*f+9]=c[3*f],d[12*f+10]=c[3*f+1],d[12*f+11]=c[3*f+2],e[8*f]=-.5,e[8*f+1]=-.5,e[8*f+2]=-.5,e[8*f+3]=.5,e[8*f+4]=.5,e[8*f+5]=.5,e[8*f+6]=.5,e[8*f+7]=-.5,a[6*f]=4*f+2,a[6*f+1]=4*f+1,a[6*f+2]=4*f,a[6*f+3]=4*f+2,a[6*f+4]=4*f,a[6*f+5]=4*f+3;c=q.sb("HALO");c.C=
[];c.C[0]={};c.O=4*b;c.C[0].a_position=d;c.N.a_halo_bb_vertex=e;c.ka=a;return c};a.Lz=r;a.cr=function(a,b,c){for(var d=[],e=0;e<a.submeshes.length;e++){var g=f(a,e,b,null,c,null);g.O&&d.push(g)}return 0==d.length?q.sb("EMPTY"):1==d.length?d[0]:n(d)};a.RC=function(a,b,c){for(var d=a.gf,e=l(a,"a_position"),f=a.Vk,g=f.zA,k=f.AA,f=f.ny,h=d,m=h.length/3,u=0;u<m;u++){var n=h[3*u],t=h[3*u+1],x=h[3*u+2],A=e[3*n+1],w=e[3*n+2],r=e[3*t+1],y=e[3*t+2],B=e[3*x+1],E=e[3*x+2];g[3*u]=(e[3*n]+e[3*t]+e[3*x])/3;g[3*
u+1]=(A+r+B)/3;g[3*u+2]=(w+y+E)/3}q.sf(g,b,k);b=k.length/3;for(e=0;e<b;e++)g=k[3*e]-c[0],h=k[3*e+1]-c[1],m=k[3*e+2]-c[2],f[e]=g*g+h*h+m*m;c=d;d=f.length;if(!(2>d))for(k=d,e=!1;1<k||e;)for(1<k&&(k=Math.floor(k/1.247330950103979)),e=!1,b=0;k+b<d;b++)0>f[b]-f[b+k]&&(e=f[b],f[b]=f[b+k],f[b+k]=e,e=c,g=b,h=b+k,m=e[3*g],u=e[3*g+1],n=e[3*g+2],e[3*g]=e[3*h],e[3*g+1]=e[3*h+1],e[3*g+2]=e[3*h+2],e[3*h]=m,e[3*h+1]=u,e[3*h+2]=n,e=!0);d=c;Q.bindBuffer(Q.ELEMENT_ARRAY_BUFFER,a.qe);Q.bufferData(Q.ELEMENT_ARRAY_BUFFER,
d,Q.DYNAMIC_DRAW)};a.zt=C;a.lq=function(a,b,c){for(var d=b.length/3,e=a.length/3,f=[],g=Array(3),k=Array(3),h=Array(3),m=0;m<e;m++){for(var l=a[3*m],u=a[3*m+1],n=a[3*m+2],t=0;3>t;t++)g[t]=b[3*l+t],k[t]=b[3*u+t],h[t]=b[3*n+t];if(c)var t=D(g,k,h),x=D(k,h,g),q=Math.PI-t-x;else q=x=t=1;var A=f,w;w=g;var B=h,r=[],y=[],E=[];J.subtract(k,w,r);J.subtract(B,w,y);J.cross(r,y,E);J.normalize(E,E);w=E;for(B=0;3>B;B++)r=3*u+B,y=3*n+B,A[3*l+B]=t*w[B],A[r]=x*w[B],A[y]=q*w[B]}if(c)for(var C in c)for(m=c[C],a=0;3>
a;a++){b=3*m[0]+a;for(e=1;e<m.length;e++)g=3*m[e]+a,f[b]+=f[g];for(e=1;e<m.length;e++)g=3*m[e]+a,f[g]=f[b]}for(m=0;m<d;m++){c=m;C=f;a=new Float32Array(3);for(b=0;3>b;b++)e=3*c+b,a[b]=C[e];J.normalize(a,a);for(b=0;3>b;b++)e=3*c+b,C[e]=a[b]}return f};a.nq=function(a,b,c){for(var d={},e=b.length/3,f=0;f<e;f++){var g=String(b[3*f])+String(b[3*f+1])+String(b[3*f+2]);d[g]=[]}e=a.length;for(f=0;f<e;f++)b=a[f],g=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),g in d&&d[g].push(b);return d};a.qn=function(a,
b,c,d){var e=G(a,null,!1);if(c)var f=G(a,null,!0);var g=e.length,k=new Float32Array(g),h=E,m=M;for(a=0;a<g;a++){var l=e[a];h.set(l.subarray(0,3));m.set(l.subarray(3,6));K.set(l.subarray(6));k[a]=Math.sqrt(A(h,m,K))}h=new Float32Array(g);h[0]=k[0];for(a=1;a<g;a++)h[a]=h[a-1]+k[a];g=h[k.length-1];k=[];for(a=0;a<b;a++){var m=g*q.bd(d),m=q.qk(h,m,0,h.length-1),l=c?f[m]:e[m],m=a,u=l,n=d,l=void 0,l=new Float32Array(3),t=u[0],x=u[1],w=u[2],r=u[3],y=u[4],B=u[5],C=u[6],J=u[7],p=u[8],u=q.bd(n),n=q.bd(n);1<
u+n&&(u=1-u,n=1-n);var D=1-u-n,x=D*x+u*y+n*J,w=D*w+u*B+n*p;l[0]=D*t+u*r+n*C;l[1]=x;l[2]=w;k[m]=l}return k};a.OE=G;a.en=t;a.aG=A;a.gt=function(a,b,c){a=a.C[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.qw=function(a,b,c){var d=a.c.p;a=a.c.g.yf;for(var e=1;e<a.length;e++)a[e].name==b&&(a[e].value=c);for(e=0;e<d.length;e++)if(!d[e].ig&&d[e].Qd&&!d[e].dg){var f=d[e].P.Mb;b=d[e].P.Pc;Q.bindBuffer(Q.ARRAY_BUFFER,d[e].P.If);
if(f.a_position){var g=f.a_position.offset,k=f.a_position.length+g,h=d[e].P.aa[0].Zb.a_position;for(c=g;c<k;c++)b[c]=h[c-g];for(h=1;h<d[e].P.aa.length;h++){var m=d[e].P.aa[h].Zb.a_position,l=a[h].value;if(l)for(c=g;c<k;c++)b[c]+=l*m[c-g]}Q.bufferSubData(Q.ARRAY_BUFFER,4*g,b.subarray(g))}if(f.a_normal){g=f.a_normal.offset;k=f.a_normal.length+g;h=d[e].P.aa[0].Zb.a_normal;for(c=g;c<k;c++)b[c]=h[c-g];for(h=1;h<d[e].P.aa.length;h++)if(m=d[e].P.aa[h].Zb.a_normal,l=a[h].value)for(c=g;c<k;c++)b[c]+=l*m[c-
g];x(b,g,k,3,2);Q.bufferSubData(Q.ARRAY_BUFFER,4*g,b.subarray(g))}if(f.a_tangent){g=f.a_tangent.offset;f=f.a_tangent.length+g;h=d[e].P.aa[0].Zb.a_tangent;for(c=g;c<f;c++)b[c]=h[c-g];for(h=1;h<d[e].P.aa.length;h++)if(k=d[e].P.aa[h].Zb.a_tangent,l=a[h].value)for(c=g;c<f;c++)b[c]+=l*k[c-g];x(b,g,f,4,3);Q.bufferSubData(Q.ARRAY_BUFFER,4*g,b.subarray(g))}}};a.check_shape_keys=function(a){return a.c.g.Qd};a.get_shape_keys_names=function(a){var b=[];if(a.c.g)for(var c=1;c<a.c.g.yf.length;c++)b.push(a.c.g.yf[c].name);
return b};a.get_shape_key_value=function(a,b){if(a.c.g)for(var c=1;c<a.c.g.yf.length;c++)if(b==a.c.g.yf[c].name)return a.c.g.yf[c].value;return 0};a.Nr=function(a,b){var c=a.c.g.yf;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.Dh=function(a){return a&&a.c.g&&a.c.g.Cd?!0:!1}};b4w.module.__objects=function(a,p){function c(a){var b=a.parent;if(b&&b.Pv)return!0;switch(a.type){case "MESH":var c=h.kq(a),d=a.b4w_do_not_batch,e=a.b4w_collision,f=a.b4w_vehicle,g=a.b4w_floating,b=a.b4w_character,k=t.Nz(a),m=G.Mr(a),l=0<a.data.b4w_shape_keys.length,u=a.b4w_dynamic_geometry;if(!(c=c||d||e||f||l||g))a:{a=a.data;for(c=0;c<a.materials.length;c++)if("LENS_FLARES"===a.materials[c].name){c=!0;break a}c=!1}return c||k||b||m||u;case "EMPTY":return b=h.kq(a),k=G.Mr(a),a=a.b4w_do_not_batch,
b||k||a;default:return!0}}function d(a,c,f,g,k,h,m,l,u){for(var n=0;n<a.nodes.length;n++){var v=a.nodes[n];if("VALUE"==v.type){var t=e(c,v.name);g.push(v.outputs[0].default_value);k.push(t,k.length/2)}else"RGB"==v.type?(t=e(c,v.name),v=v.outputs[0].default_value.slice(0,3),m.push(v[0],v[1],v[2]),l.push(t,l.length/2)):"GROUP"==v.type&&(t=v.node_group.node_tree,d(t,e(c,v.name),t.animation_data,g,k,h,m,l,u))}if(f)for((a=f.action)&&b(a,c,h,k,u,l),f=f.nla_tracks,g=0;g<f.length;g++)for(m=f[g].strips,n=
0;n<f[g].strips.length;n++)(a=m[n].action)&&b(a,c,h,k,u,l)}function b(a,b,c,d,f,g){var k=a.l.T,h;for(h in k){var m=e(b,h.match(/"(.*?)"/)[1]),k=l(d,m);null!=k?(m=e(a.name,h),c.push(m,k)):(k=l(g,m),null!=k&&(m=e(a.name,h),f.push(m,k)))}}function e(a,b){return a+"%join%"+b}function l(a,b){for(var c=0;c<a.length;c+=2)if(a[c]==b)return a[c+1];return null}function m(a){return a instanceof Array?a.slice():a}var h=p("__animation"),n=p("__batch"),f=p("__boundings"),k=p("__camera"),r=p("__config"),y=p("__constraints"),
w=p("__curve"),C=p("__geometry"),D=p("__lights"),G=p("__nla"),t=p("__particles"),A=p("__print"),x=p("__scenes"),u=p("__transform"),g=p("__tsr"),q=p("__util"),L=p("__obj_util"),J=p("__primitives"),E=p("quat"),M=p("vec3"),K=p("mat4"),Q=r.r,I=r.Lb,v=0,H=0,P=[],Z=new Float32Array(4),aa={ALL:[]};a.Nl=function(a){var b=L.Lm(a.name,a.type);aa[b.type]||(aa[b.type]=[]);aa.ALL.push(a);aa[b.type].push(a);a.c=b;a.Pv=b.ab=c(a);a.Ip=!0;a.Hp&&(a.c.Ka=a.Hp);if("MESH"==a.type)for(var e=0;e<a.data.b4w_vertex_anim.length;e++){var m=
a.data.b4w_vertex_anim[e];b.Ob.push({name:m.name,H:m.frame_start,R:m.frame_end,oE:m.averaging,pE:m.averaging_interval,Vv:m.allow_nla})}b.Bc=a.b4w_vehicle;b.is_character=a.b4w_character;b.Ih=a.b4w_floating;if(e=a.b4w_vehicle_settings)b.rc={name:e.name,kc:e.part,BC:e.suspension_rest_length,Vo:e.suspension_compression,Xo:e.suspension_stiffness,Wo:e.suspension_damping,tp:e.wheel_friction,Co:e.roll_influence,bo:e.max_suspension_travel_cm,dj:e.force_max,Li:e.brake_max,ki:e.steering_max,Qh:e.max_speed_angle,
Wi:e.delta_tach_angle,Mj:e.speed_ratio,Oj:e.steering_ratio,nj:e.inverse_control,hg:e.floating_factor,eh:e.water_lin_damp,fh:e.water_rot_damp,Ot:e.synchronize_position};if(e=a.b4w_floating_settings)b.yh={name:e.name,kc:e.part,hg:e.floating_factor,eh:e.water_lin_damp,fh:e.water_rot_damp,Ot:e.synchronize_position};if(e=a.b4w_character_settings)b.tq={DD:e.walk_speed,sB:e.run_speed,rC:e.step_height,hA:e.jump_strength,FD:e.waterline};e=b.g=L.sh("MESH"===b.type?b.ab?"DYNAMIC":"STATIC":b.type);"MESH"==a.type&&
(b.g.lh=n.Aw(a.data.b4w_bounding_box));b.Tg=a.c.Tg||[];var m=a.location,l=a.scale[0];q.vo(a.rotation_quaternion,Z);u.set_translation(a,m);u.set_rotation(a,Z);u.set_scale(a,l);switch(a.type){case "ARMATURE":m=a.pose.bones;for(b=0;b<m.length;b++){var l=m[b],t=l.bone,x=new Float32Array(t.matrix_local),r=new Float32Array(16);K.invert(x,r);var y=new Float32Array(l.matrix_basis),H=new Float32Array(3);M.subtract(t.tail_local,t.head_local,H);q.xD(H,r,H);l.Tv=H;l.Nv=[l].concat(l.parent_recursive);l.Kp=g.from_mat4(x,
g.create());l.Jp=g.from_mat4(y,g.create());l.$l=g.create();l.gk=!1}m=h.Nw(a);e.Sc=m;m=h.mq(a,m);a.b4w_animation_mixing?(e.Gc=new Float32Array(m.Ga),e.Fc=new Float32Array(m.Ga),e.Oc=new Float32Array(m.i),e.Nc=new Float32Array(m.i)):(e.Gc=m.Ga,e.Fc=m.Ga,e.Oc=m.i,e.Nc=m.i);e.Ls=m;e.jg=0;e.Pe=a.b4w_animation_mixing;break;case "MESH":e.Ug=I.outlining_overview_mode||a.b4w_selectable;e.ll=a.b4w_selectable;e.Lb=I.outlining_overview_mode||a.b4w_outlining;e.kl=a.b4w_outlining;e.Ds=I.outlining_overview_mode||
a.b4w_outline_on_select;e.hd=a.b4w_billboard;e.qm=a.b4w_pres_glob_orientation;e.Ji="BASIC";e.Ii="SPHERICAL"==a.b4w_billboard_geometry;e.wj={ml:a.b4w_outline_settings.outline_duration,nl:a.b4w_outline_settings.outline_period,ol:a.b4w_outline_settings.outline_relapses};e.Ug&&(a.c.g.xk=q.kr(v),v++);e.Ob=b.Ob.length?!0:!1;if("MESH"!=a.type)throw"Wrong object type: "+a.name;b=a.c.g;if(a.data.b4w_shape_keys.length)for(b.Qd=!0,m=0;m<a.data.b4w_shape_keys.length;m++)l={},l.value=a.data.b4w_shape_keys[m].value,
l.name=a.data.b4w_shape_keys[m].name,b.yf.push(l);else b.Qd=!1;if(b=h.get_first_armature_object(a)){a.c.Up=b;m=a.c.g;t=a.data.vertex_groups;if(t.length){x=b.data.bones;r=b.pose.bones;y=0;l={};for(H=0;H<x.length;H++){var C=x[H].name,J=q.keysearch("name",C,t);if(J){var B=q.un(r,"name",C);l[C]={jq:H,Vi:y++,so:B,lu:J.index}}}t=y;m.Sc=l;l=h.vr();m.ve=t;t>2*l?(m.Jh=!1,A.error('too many bones for "'+a.name+'" / '+m.ve+" bones (max "+l+" with blending, "+2*l+" without blending). Skinning will be disabled.")):
m.Jh=!0}m=a.c.g.Sc;m=h.mq(b,m);b.b4w_animation_mixing?(e.Gc=new Float32Array(m.Ga),e.Fc=new Float32Array(m.Ga),e.Oc=new Float32Array(m.i),e.Nc=new Float32Array(m.i)):(e.Gc=m.Ga,e.Fc=m.Ga,e.Oc=m.i,e.Nc=m.i);e.im=new Float32Array(4);e.hm=E.create();e.Ls=m;e.jg=0}b=a.c.g;m=a.data.materials;l=[];t=[];x=[];r=[];y=[];H=[];for(C=0;C<m.length;C++)J=m[C],(B=J.node_tree)&&d(B,J.name,B.animation_data,l,t,x,r,y,H);b.ue=l;b.Ag=t;b.dl=x;b.Cc=r;b.zg=y;b.el=H;e.Jc=a.b4w_shadow_cast;e.pc=a.b4w_shadow_receive;e.oc=
a.b4w_shadow_cast_only&&e.Jc;e.dc=a.b4w_reflexible;e.Ub=a.b4w_reflexible_only&&e.dc;e.Hc=a.b4w_reflective;e.uf=a.b4w_reflection_type;e.de=a.b4w_caustics;e.Qc=a.b4w_wind_bending;e.Xj=a.b4w_wind_bending_angle;b=n.GD(a.b4w_wind_bending_angle,e.lh,a.scale[0]);e.Sd=b;e.He=a.b4w_wind_bending_freq;e.he=a.b4w_detail_bending_freq;e.ge=a.b4w_detail_bending_amp;e.be=a.b4w_branch_bending_amp;e.Fh=!1;e.te=a.b4w_main_bend_stiffness_col;b=a.b4w_detail_bend_colors;e.Rb={};e.Rb.fs=b.leaves_stiffness_col;e.Rb.es=b.leaves_phase_col;
e.Rb.Fs=b.overall_stiffness_col;e.uh=a.b4w_do_not_cull;e.Gk=a.b4w_disable_fogging;e.Cd=a.b4w_dynamic_geometry;if("MESH"!==a.type)throw"Wrong object";b=a.data.materials[0];e.gj=b.physics.friction;e.aj=b.physics.elasticity;e.uj=0;e.lf=1E4;e.yg=a.b4w_lod_transition;e.cl=!0;break;case "CAMERA":k.Pw(a);k.vw(a);break;case "LAMP":D.iA(a);break;case "CURVE":a.c.Et=w.Qx(a);break;case "EMPTY":e.Hb=f.ed(),b=f.Yj(),e.Tc=b}if(b=a.dupli_group)for(m=b.objects,b=0;b<m.length;b++)m[b].Hp=a;e.Ol=a.game.use_collision_compound;
e.Js=a.game.physics_type};a.Yp=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];L.lk(d,b)}var e=aa.EMPTY;if(e)for(c=0;c<e.length;c++)for(var f=e[c],d=f.c,g=0;g<d.Pg.length;g++)L.Pk(d.Pg[g],b)&&!L.Pk(f,b)&&L.lk(f,b)};a.$C=function(b){var c=b.c.g;if(b.parent&&"OBJECT"==b.parent_type){var d=c.i,e=c.quat,f=c.scale;y.gm(b,b.parent,d,e,f)}else b.parent&&"BONE"==b.parent_type&&"ARMATURE"==b.parent.type?(d=c.i,e=c.quat,f=c.scale,y.Tp(b,b.parent,b.parent_bone,d,e,f)):b.c.Ka&&b.c.Ka.b4w_group_relative?
(d=g.create_sep(c.i,c.scale,c.quat),y.Zv(b,b.c.Ka,d)):b.c.Ka&&!b.c.Ka.b4w_group_relative&&(u.A(b),g.multiply(b.c.Ka.c.g.Fb,b.c.g.Fb,b.c.g.Fb),u.set_translation(b,g.get_trans_view(b.c.g.Fb)),u.set_scale(b,g.get_scale(b.c.g.Fb)),u.set_rotation(b,g.get_quat_view(b.c.g.Fb)));if("MESH"==b.type&&b.b4w_reflective)if(d=b.c.g,"CUBE"==b.b4w_reflection_type)d.Uc=H++;else if("PLANE"==b.b4w_reflection_type){a:{e=b.constraints;for(f=0;f<e.length;f++){var k=e[f];if("LOCKED_TRACK"==k.type&&"REFLECTION PLANE"==k.name){e=
k.target;break a}}e=null}e?e.c||a.Nl(e):(f=q.Rj("%reflection%"),e=L.rh(f,"EMPTY"),e.c=L.rh(f,"EMPTY"),f=L.sh("EMPTY"),e.c.g=f,y.gm(e,b,[0,0,0],null,1),aa.EMPTY||(aa.EMPTY=[]),aa.EMPTY.push(e),aa.ALL.push(e));f=null;for(k=0;k<P.length;k++)if(P[k]==e){f=k;break}null==f&&(f=P.length,P.push(e));e.c.g.Ec=f;d.Ec=f;e.c.Pg.push(b)}u.A(b);b.field&&(c.kn=b.field.strength,x.Zt(b))};a.aD=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.c.g||"DYNAMIC"!=c.c.g.type&&"CAMERA"!=c.c.g.type||u.A(c);c.b4w_use_default_animation&&
h.Cs(c)&&(h.apply_def(c),c.c.G.length&&h.play(c,null,h.SLOT_ALL))}};a.get_meta_tags=function(a){a=a.b4w_object_tags;return{title:a?a.title:"",description:a?a.description:"",category:a?a.category:""}};a.cleanup=function(){H=v=0;P=[];aa={ALL:[]}};a.copy=function(a,b,c){var d=L.Lm(b,a.type);d.c=L.Lm(b,a.type);b=[];if(c){for(var e=0;e<a.c.p.length;e++)a.c.p[e].ig||(d.c.p.push(L.ag(a.c.p[e])),b.push(a.c.p[e].P));for(e=0;e<a.c.p.length;e++)if(a.c.p[e].ig){var f=L.ag(a.c.p[e]);d.c.p.push(f);for(var g=0;g<
b.length;g++)b[g]==a.c.p[e].P&&(f.P=d.c.p[g].P)}}else d.c.p=m(a.c.p);d.c.g=L.ag(a.c.g);a.c.ab&&(d.c.ab=a.c.ab);a.c.Ka&&(d.c.Ka=a.c.Ka);a.Xd&&(d.Xd=m(a.Xd));!a.c.q||a.c.Bc||a.c.is_character||a.c.Ih||(d.c.q=L.ag(a.c.q));d.game=L.ag(a.game);d.b4w_collision_id=a.b4w_collision_id;d.b4w_correct_bounding_offset=a.b4w_correct_bounding_offset;d.b4w_collision=a.b4w_collision;d.data=a.data;if(c)for(e=0;e<d.c.p.length;e++)d.c.p[e].P&&C.$t(d.c.p[e].P),d.c.p[e].Wh=d.uuid,n.OC(d.c.p[e],q.oh(d.c.g,0));d.uuid=q.mr();
d.c.g.Kn=!0;d.c.g.xk=q.kr(v);v++;return d};a.Cz=function(a,b){for(var c=a.c.g.Ag,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null};a.xz=function(a,b){for(var c=a.c.g.zg,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null};a.update_boundings=function(a){for(var b=a.c.g,c=a.c.p,d,e,g,k,h,m,l=0;l<c.length;l++){var v=c[l];if("MAIN"==v.type){var v=v.P.Pc,t=c[l].P.Mb,B=t.a_position.offset,t=t.a_position.length+B;d=k=v[B];e=h=v[B+1];g=m=v[B+2];for(var x=B;x<t;x+=3){var B=v[x],q=v[x+1],w=v[x+
2];d=Math.max(B,d);e=Math.max(q,e);g=Math.max(w,g);k=Math.min(B,k);h=Math.min(q,h);m=Math.min(w,m)}}}var A={max_x:parseFloat(d.toFixed(3)),max_y:parseFloat(e.toFixed(3)),max_z:parseFloat(g.toFixed(3)),min_x:parseFloat(k.toFixed(3)),min_y:parseFloat(h.toFixed(3)),min_z:parseFloat(m.toFixed(3))},r=d-k,y=e-h,z=g-m;k=.5*(d+k);var F=.5*(e+h),ka=.5*(g+m),E=k,H=ka;h=Math.max(r,Math.max(y,z))/2;m=Math.max(r,z)/2;var ha=[k/(r?r:1),F/(y?y:1),ka/(z?z:1)],T=.5;if(b.hd)B=Math.max(Math.abs(A.max_x),Math.abs(A.min_x)),
q=Math.max(Math.abs(A.max_y),Math.abs(A.min_y)),w=Math.max(Math.abs(A.max_z),Math.abs(A.min_z)),h=Math.sqrt(B*B+q*q+w*w),m=Math.sqrt(B*B+q*q),A.max_x=A.max_y=A.max_z=h,A.min_x=A.min_y=A.min_z=-h,k=new Float32Array([0,0,0]),z=new Float32Array([h,h,h]),y=new Float32Array([0,0,0]);else{for(l=0;l<c.length;l++)if(v=c[l],"MAIN"==v.type)for(v=v.P.Pc,t=c[l].P.Mb,B=t.a_position.offset,t=t.a_position.length+B,x=B;x<t;x+=3){var B=v[x],q=v[x+1],w=v[x+2],K=Math.sqrt((k-B)*(k-B)+(F-q)*(F-q)+(ka-w)*(ka-w));if(K>
h){var p=k-h*(B-k)/K,I=F-h*(q-F)/K,K=ka-h*(w-ka)/K;k=(p+B)/2;F=(I+q)/2;ka=(K+w)/2;h=Math.sqrt((k-B)*(k-B)+(F-q)*(F-q)+(ka-w)*(ka-w))}I=Math.sqrt((E-B)*(E-B)+(H-w)*(H-w));I>m&&(p=E-m*(B-E)/I,K=H-m*(w-H)/I,E=(p+B)/2,H=(K+w)/2,m=Math.sqrt((E-B)*(E-B)+(H-w)*(H-w)));B/=r?r:1;q/=y?y:1;w/=z?z:1;K=Math.sqrt((ha[0]-B)*(ha[0]-B)+(ha[1]-q)*(ha[1]-q)+(ha[2]-w)*(ha[2]-w));K>T&&(p=ha[0]-T*(B-ha[0])/K,I=ha[1]-T*(q-ha[1])/K,K=ha[2]-T*(w-ha[2])/K,ha[0]=(p+B)/2,ha[1]=(I+q)/2,ha[2]=(K+w)/2,T=Math.sqrt((ha[0]-B)*(ha[0]-
B)+(ha[1]-q)*(ha[1]-q)+(ha[2]-w)*(ha[2]-w)))}l=r?r*ha[0]:d;e=y?y*ha[1]:e;g=z?z*ha[2]:g;r*=T;y*=T;z*=T;k=new Float32Array([k,F,ka]);z=new Float32Array([r,y,z]);y=new Float32Array([l,e,g]);m=parseFloat(m.toFixed(3))}b.Hb=A;n.JB(b,m,m,A);A=f.Bk(h,k);b.Tc=A;A=f.Ak([z[0],0,0],[0,z[1],0],[0,0,z[2]],y);b.Te=A;u.A(a);if(Q.wireframe_debug)for(l=0;l<c.length;l++)if("WIREFRAME"===c[l].type&&c[l].dg){a=J.pn(1,A.F);C.gt(a,[A.Qe[0],A.Re[1],A.Se[2]],A.F);C.Jl(a,1,!0);a.N.a_polyindex=C.en(a);n.NC(c[l],a);break}};
a.Uv=function(a){aa.ALL.push(a);aa[a.c.type]||(aa[a.c.type]=[]);aa[a.c.type].push(a);var b=a.c.g.Ec;if(null!=b)for(var c=0;c<P.length;c++){var d=P[c];d.c.g.Ec==b&&d.c.Pg.push(a)}};a.vn=function(a,b,c){b=aa[b]||[];for(var d=[],e=0;e<b.length;e++){var f=b[e];if(f.c.g.Xb==c||c==x.DATA_ID_ALL)for(var g=f.c.Tg,k=0;k<g.length;k++)g[k].Sg==a&&d.push(f)}return d};a.get_all_objects=function(a){var b=aa.ALL;if(a==x.DATA_ID_ALL)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.c.g.Xb==a&&c.push(e)}return c}};b4w.module.__obj_util=function(a,p){function c(a,b){return{modifiers:[],constraints:[],data:null,parent:null,Me:[],Xd:[],fd:null,name:a,type:b,cA:!1,ab:!1,g:null,Pa:null,kd:[],G:[],q:null,Tg:[],Pg:[],o:null,wa:null,Up:null,Ka:null,PF:[],p:[],Et:null,m:null,Yc:null,Ob:[],rc:null,yh:null,tq:null,Bc:!1,is_character:!1,Ih:!1}}function d(a){if(!(a instanceof Object))return a;var b=null,c=null,e=null;a.S&&(b=a.S,a.S=null);a.Nb&&(c=a.Nb,a.Nb=null);a.aa&&(e=a.aa,a.aa=null);var h;h=a.constructor;switch(h){case Float32Array:case Uint32Array:case Uint16Array:h=
new h(a);break;case Array:h=new h(a.length);for(var m=0;m<a.length;m++)h[m]=d(a[m]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:h=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:h=null;break;case Function:h=a;break;default:for(m in h=new h,a)h[m]=d(a[m])}b&&(h.S=b,a.S=b);c&&(h.Nb=c,a.Nb=c);e&&(h.aa=e,a.aa=e);return h}var b=p("__camera");p("__print");var e=p("__tsr"),l=p("quat"),m=p("vec4"),h=p("mat4");a.sh=function(a){a={type:a,Xb:0,Jz:[0,0],i:new Float32Array(3),
quat:new Float32Array(4),Fb:new Float32Array(8),Z:new Float32Array(16),Sr:new Float32Array(16),Tb:new Float32Array(3),ac:new Float32Array(3),Gh:0,Hh:0,Kn:!1,xk:null,qd:0,Zo:!1,eu:!1,Aa:b.MS_STATIC,np:1,mp:1,op:1,dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,ke:null,Wt:!1,je:0,eg:0,eb:!1,$b:null,fc:null,Db:null,Ym:!0,M:null,wj:null,Uc:null,Ec:null,cc:new Float32Array(4),gj:0,aj:0,kn:0,uj:0,yg:0,Js:"",Ol:!1,Jc:!1,pc:!1,oc:!1,dc:!1,Ub:!1,Hc:!1,uf:"",de:!1,Qc:!1,Gk:!1,Cd:!1,Bb:!1,uh:!1,Fh:!1,cl:!1,
Ug:!1,ll:!1,Lb:!1,kl:!1,Ds:!1,$k:!1,is_visible:!1,mn:!1,Xj:0,Sd:0,He:0,he:0,ge:0,be:0,te:"",Rb:null,pk:!1,hd:!1,qm:!1,Ji:"",Ii:!1,jg:0,time:0,lp:0,hu:0,ve:0,fj:!1,Ob:!1,Qd:!1,yf:[],Jh:!1,Pe:!1,Oe:1,em:0,dm:1,Ll:new Int8Array([-1,-1]),Gl:[],os:[],rt:[],Gc:null,Fc:null,Oc:null,Nc:null,Sc:null,Ls:null,im:null,hm:null,ue:null,Ag:null,dl:null,Cc:null,zg:null,el:null,lh:null,Hb:null,nm:null,lm:null,mm:null,hb:null,Tc:null,Ib:null,Te:null,Vf:null,scale:1,lf:1E4};l.identity(a.quat);e.identity(a.Fb);h.identity(a.Z);
h.identity(a.Sr);return a};a.Lm=c;a.rh=function(a,b){var d=c(a,b);d.cA=!0;d.particle_systems=[];return d};a.ag=d;a.ab=function(a){return a.c.ab?!0:!1};a.oj=function(a){return"MESH"==a.type&&a.c.ab?!0:!1};a.lk=function(a,b){a.c.Tg.push({Sg:b,p:[],rf:null,Xe:null})};a.Pk=function(a,b){for(var c=a.c.Tg,d=0;d<c.length;d++){var e=c[d];if(e.Sg==b)return e}return null};a.bu=function(a,b){for(var c=0;c<a.length;c++)m.copy(b,a[c].c.g.cc)}};b4w.module.__particles=function(a,p){function c(){throw"_rand() undefined";}function d(a,b,c,d,e,f,k){var h=a.Fk,g=a.md,m=a.time;a=a.Ps;for(var l=b?4:1,J=0;J<h.length;J+=l){var E=h[J];if(m>a&&m>=E&&E>a||m<a&&(E>a||m>=E))for(E=0;8>E;E++)g[8*J+E]=e[E];for(E=0;8>E;E++)r[E]=g[8*J+E];E=y;E[0]=c[3*J];E[1]=c[3*J+1];E[2]=c[3*J+2];n.transform_vec3(E,r,E);f[3*J]=E[0];f[3*J+1]=E[1];f[3*J+2]=E[2];var p=y;p[0]=d[3*J];p[1]=d[3*J+1];p[2]=d[3*J+2];n.transform_dir_vec3(p,r,p);k[3*J]=p[0];k[3*J+1]=p[1];k[3*J+2]=p[2];
if(b)for(E=1;4>E;E++)f[3*(J+E)]=f[3*J],f[3*(J+E)+1]=f[3*J+1],f[3*(J+E)+2]=f[3*J+2],k[3*(J+E)]=p[0],k[3*(J+E)+1]=p[1],k[3*(J+E)+2]=p[2]}}function b(a){a?(h.pC(a),c=function(){return h.aB()}):c=function(){return Math.random()}}var e=p("__config"),l=p("__geometry"),m=p("__scenes"),h=p("__util"),n=p("__tsr"),f=p("vec3"),k=e.Zd,r=new Float32Array(8),y=new Float32Array(3);a.Vh=function(a){for(var b=0;b<a.c.p.length;b++)if(a.c.p[b].la)return!0;return!1};a.oo=function(a){for(var b=0;b<a.c.p.length;b++){var c=
a.c.p[b].la;if(c&&"EMITTER"==c.po)return!0}return!1};a.Lw=function(a){return 0<a.particle_systems.length?!0:!1};a.Kw=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;return!1};a.Nz=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.Sz=function(a,b,c){var d=a.la={name:b.name,po:b.settings.type,time:0,Ps:-1,kp:!1,H:0,R:0,Rt:0,Tn:0,hs:0,
cyclic:!1,Mh:0,jo:0,Dr:0,xh:0,Xc:0,Of:new Float32Array(3),size:0,Rp:0,Qp:0,qt:0,Gq:0,pt:new Float32Array(8),Fq:new Float32Array(16),Xh:null,Ms:null,ws:null,xs:null,Fk:null,Um:null,md:null};d.H=b.settings.frame_start;d.R=b.settings.frame_end;d.Rt=(d.R-d.H)/k.Ra;d.Tn=b.settings.lifetime;d.hs=d.Tn/k.Ra;d.cyclic=b.settings.b4w_cyclic?1:0;d.Mh=b.settings.mass;d.jo=b.settings.normal_factor;d.Dr=9.81*b.settings.effector_weights.gravity;d.xh=b.settings.b4w_fade_in/k.Ra;d.Xc=b.settings.b4w_fade_out/k.Ra;f.scale(m.Hz(),
b.settings.effector_weights.wind,d.Of);d.kp="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var e,h;a.og?(a=c.halo.size,e=c.halo.hardness,30>e?(e=.5,h=.9):40>e?(e=.1,h=1):50>e?(e=0,h=.8):(e=0,h=.5)):(a=b.settings.particle_size,h=e=1);d.size=a;d.Rp=e;d.Qp=h;a=b.settings.texture_slots;b=[-1,0,-1,0,-1,0,-1,0];if(a[0]&&a[0].use_map_size&&a[0].texture&&"BLEND"==a[0].texture.type&&a[0].texture.use_color_ramp){a=a[0].texture.color_ramp.elements;e=Math.min(2*a.length,b.length);for(h=0;h<e;h+=2){var l=a[h/
2];b[h]=l.position;b[h+1]=(l.color[0]+l.color[1]+l.color[2])/3}d.qt=a.length}d.pt.set(b);b=c.texture_slots;c=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(b[0]&&"STRAND"==b[0].texture_coords&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp){a=b[0].texture.color_ramp.elements;e=Math.min(4*a.length,c.length);for(h=0;h<e;h+=4)l=a[h/4],c[h]=l.position,c[h+1]=l.color[0],c[h+2]=l.color[1],c[h+3]=l.color[2];d.Gq=a.length}d.Fq.set(c)};a.Uy=function(a,e,m,n){var t=a.la,r=m.settings.count,
x=m.settings.frame_start/k.Ra,u=m.settings.frame_end/k.Ra,g=m.settings.lifetime/k.Ra,q=m.settings.lifetime_random,y=m.settings.emit_from,J=m.settings.factor_random,E=m.settings.angular_velocity_mode,p=m.settings.angular_velocity_factor,K=m.settings.b4w_randomize_emission,Q=m.settings.b4w_cyclic,I=!a.og;b(m.seed);e=l.cr(e,["a_position","a_normal"],null);switch(y){case "VERT":m=e.C[0].a_position;e=e.C[0].a_normal;for(var v=m.length/3,y=[],H=0;H<r;H++){var P=Math.round((v-1)*c());y.push(P);I&&(y.push(P),
y.push(P),y.push(P))}v=[];for(H=0;H<y.length;H++)v.push(m[3*y[H]]),v.push(m[3*y[H]+1]),v.push(m[3*y[H]+2]);m=new Float32Array(v);v=[];for(H=0;H<y.length;H++)v.push(e[3*y[H]]),v.push(e[3*y[H]+1]),v.push(e[3*y[H]+2]);y=new Float32Array(v);break;case "FACE":m=[];y=[];H=[];h.Wk(0,H);v=l.qn(e,r,!1,H);h.Wk(0,H);e=l.qn(e,r,!0,H);for(H=0;H<v.length;H++)m.push(v[H][0],v[H][1],v[H][2]),I&&(m.push(v[H][0],v[H][1],v[H][2]),m.push(v[H][0],v[H][1],v[H][2]),m.push(v[H][0],v[H][1],v[H][2])),y.push(e[H][0],e[H][1],
e[H][2]),I&&(y.push(e[H][0],e[H][1],e[H][2]),y.push(e[H][0],e[H][1],e[H][2]),y.push(e[H][0],e[H][1],e[H][2]));m=new Float32Array(m);y=new Float32Array(y);break;case "VOLUME":throw"Particle emission from volume is not supported";default:throw"Wrong emit from option";}y=[m,y];e=y[0];y=y[1];t.Xh=new Float32Array(e);t.ws=new Float32Array(y);t.Ms=new Float32Array(e.length);t.xs=new Float32Array(y.length);m=[];u=(u-x)/r;for(v=0;v<r;v++)H=K?u*v+10*u*(.5-c()):u*v,Q||(H+=x),m.push(H),I&&(m.push(H),m.push(H),
m.push(H));x=new Float32Array(m);t.Fk=new Float32Array(x);t.Um=new Float32Array(x);t.md=new Float32Array(8*x.length);for(K=0;K<8*x.length;K++)for(Q=0;8>Q;Q++)t.md[8*K+Q]=n[Q];t.kp&&d(t,I,e,y,n,e,y);n=h.sb("EMITTER_PARTICLES");t=h.jd();t.a_position=e;t.a_normal=y;n.C[0]=t;if(I){a.le=l.ak;a=[];for(t=0;t<r;t++)a.push(4*t,4*t+2,4*t+1,4*t,4*t+3,4*t+2);a=new Uint16Array(a);n.ka=a;a=n.N;t=[];for(K=0;K<r;K++)t.push(-.5,-.5,-.5,.5,.5,.5,.5,-.5);t=new Float32Array(t);a.a_p_bb_vertex=t}else a.le=l.xp,n.ka=new Uint16Array(0);
n.O=e.length/3;n.N.a_p_delay=x;a=n.N;t=[];q*=g;for(x=0;x<r;x++)K=q*c(),t.push(g-K),I&&(t.push(g-K),t.push(g-K),t.push(g-K));g=new Float32Array(t);a.a_p_lifetime=g;g=n.N;q=[];for(a=0;a<r;a++){t=[c()-.5,c()-.5,c()-.5];f.normalize(t,t);q.push(J*t[0]);q.push(J*t[1]);q.push(J*t[2]);switch(E){case "NONE":q.push(0);break;case "SPIN":case "VELOCITY":q.push(p);break;case "RAND":q.push(2*p*(c()-.5));break;default:throw"Undefined velocity factor";}if(I)for(t=q.slice(-4),x=0;12>x;x++)q.push(t[x%4])}r=new Float32Array(q);
g.a_p_vels=r;return n};a.XC=function(a){for(var b=a.c.p,c=0;c<b.length;c++){var e=b[c],f=b[c].la;if(f){var k=e.P;if(!f.kp)break;var h=f.Ms,m=f.xs;d(f,!e.og,f.Xh,f.ws,a.c.g.Fb,h,m);l.tA(k);l.Ml(k,"a_position",3,h);l.Ml(k,"a_normal",3,m)}}};a.NB=function(a,b,c){a=a.c.p;for(var d=0;d<a.length;d++){var e=a[d].la;e&&e.name==b&&(e.Ps=e.time,e.time=c)}};a.VA=function(a){for(var b=a.O,c=a.C[0].a_position,d=a.N.a_texcoord,e=[],f=[],k=0;k<b;k++)f.push(c[3*k]),f.push(c[3*k+1]),e.push(c[3*k+2]);e=new Float32Array(e);
f=new Float32Array(f);a.N.a_lf_dist=e;a.N.a_lf_bb_vertex=f;a.N.a_texcoord=d;return a};a.set_size=function(a,b,c){a=a.c.p;for(var d=0;d<a.length;d++){var e=a[d].la;e&&e.name==b&&(e.size=c)}};a.set_normal_factor=function(a,b,c){a=a.c.p;for(var d=0;d<a.length;d++){var e=a[d].la;e&&e.name==b&&(e.jo=c)}};a.set_factor=function(a,b,c){a=a.c.p;for(var d=0;d<a.length;d++){var e=a[d],f=e.la;if(f&&f.name==b){var k=f.Fk;if(1==c)f=k;else if(0==c)for(var h=!e.og,g=h?4:1,f=f.Um,m=0;m<f.length;m+=g)f[m]=1E4,h&&(f[m+
1]=f[m],f[m+2]=f[m],f[m+3]=f[m]);else for(var n=1/c,f=f.Um,g=(h=!e.og)?4:1,r=0,m=0;m<f.length;m+=g)m>=r?(f[m]=k[m],r+=n):f[m]=1E4,h&&(f[m+1]=f[m],f[m+2]=f[m],f[m+3]=f[m]);l.Ml(e.P,"a_p_delay",1,f)}}};a.gD=function(a,b,c){for(var d=0;d<a.c.p.length;d++){var e=a.c.p[d].la;if(e)for(var f=0;f<8*e.Fk.length;f++)e.md[8*f]=b[0],e.md[8*f+1]=b[1],e.md[8*f+2]=b[2],e.md[8*f+3]=b[3],e.md[8*f+4]=c[0],e.md[8*f+5]=c[1],e.md[8*f+6]=c[2],e.md[8*f+7]=c[3]}}};b4w.module.__primitives=function(a,p){function c(a,b,c,d){for(var e=[],h=[],l=[],p=[],G=2*c/(a-1),t=2*d/(b-1),A=0;A<a;A++)for(var x=-c+A*G,u=0;u<b;u++)if(h.push(x,0,-d+u*t),l.push(0,1,0),p.push(A/(a-1),u/(b-1)),A&&u){var g=A*b+u,q=g-1,L=(A-1)*b+u,J=L-1;e.push(g,q,L);e.push(q,J,L)}a=m.jd();a.a_position=new Float32Array(h);a.a_normal=new Float32Array(l);l=m.sb("GRID_PLANE");l.C[0]=a;l.N.a_texcoord=new Float32Array(p);l.ka=new Uint32Array(e);l.O=h.length/3;return l}function d(a){var b=a.length;if(b%
4)throw"Wrong array";for(var c=[],d=[],h=0;h<b;h+=4){var l=a[h+1],p=a[h+2],D=a[h+3];e(a[h],d);e(l,d);e(p,d);e(D,d);c.push(h,h+1,h+2);c.push(h,h+2,h+3)}a=m.jd();a.a_position=new Float32Array(d);b=m.sb("FROM_QUADS");b.C[0]=a;b.ka=new Uint32Array(c);b.O=d.length/3;return b}function b(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function e(a,b){b.push(a[0],a[1],a[2])}var l=p("__geometry"),m=p("__util"),h=p("__config").r;a.$E=function(a){for(var b=m.sb("LINE"),c=[],d=0;d<2*a;d++)c.push(d);d=m.jd();d.a_point=
new Float32Array(c);b.C[0]=d;b.ka=new Uint32Array(c);b.O=2*a;return b};a.aF=function(a,b){var d=c(2,2,a,b);d.name="PLANE";return d};a.ZE=c;a.Zy=function(a,b,c){function d(a,b){return 1==a%2&&(0==b||b==D-1)||1==b%2&&(0==a||a==p-1)?!0:!1}var e=c/=Math.pow(2,a-1),w=c,p=b+1,D=b+1;b=[];c=[];for(var G=0,t=0,A=-1,x=[],u=0;u<a;u++){for(var g=2*e/(p-1),q=2*w/(D-1),L=[],J=[],E=0,M=0;M<p;M++){for(var K=-e+M*g,Q=[],I=0;I<D;I++){var v=-w+I*q;if(K>-G&&K<G&&v>-t&&v<t)Q.push(-1),E++;else{for(var H=null,P=0;P<x.length;P+=
3)if(K==x[P]&&v==x[P+1]){H=x[P+2];break}P=null!==H?H:A+1;d(M,I)?(Q.push(-2),E++):(null==H&&(0==I||I==D-1||0==M||M==p-1?(H=u==a-1?g:2*g,L.push(K,v,P)):H=g,c.push(K,H,v),A++),Q.push(P));if(M&&I)if(1==M)if(d(M-1,I)){if(1<I){var v=P-1,H=J[M-1][I+1],Z=H-1;b.push(P,v,Z)}else H=J[M-1][I+1],Z=H-1;b.push(P,Z,H)}else d(M,I)||(v=P-1,H=J[M-1][I],b.push(P,v,H));else if(M==p-1){if(!d(M,I))if(I==D-1)v=P-1,H=J[M-1][I-1],Z=J[M-2][I],b.push(P,v,H),b.push(P,H,Z);else{var v=P-1,H=J[M-1][I],Z=H-1,aa=H+1;b.push(P,v,Z);
b.push(P,Z,H);b.push(P,H,aa);2==I&&(aa=J[M-2][I-2],b.push(v,aa,Z))}}else 1==I?d(M,I-1)?(v=J[M-1][I],H=J[M-1][I-1],b.push(P,H,v)):(v=Q[I-1],H=J[M-1][I],Z=J[M-2][I-1],b.push(P,v,H),b.push(v,Z,H)):I==D-1?d(M,I)||(v=Q[I-1],H=J[M-1][I-1],Z=J[M-2][I],b.push(P,v,H),b.push(P,H,Z)):-1!=J[M-1][I]&&-1!=J[M-1][I-1]&&-1!=Q[I-1]?(v=Q[I-1],H=J[M-1][I],Z=J[M-1][I-1],b.push(P,v,H),b.push(v,Z,H),I==D-2&&d(M,I+1)&&(aa=J[M-1][I+1],b.push(P,H,aa))):I==D-2&&d(M,I+1)&&(H=J[M-1][I],aa=J[M-1][I+1],b.push(P,H,aa))}}J.push(Q)}x=
L;G=e;t=w;e*=2;w*=2}2E4>G&&(a=-(2*G)/(p-1),c.push(-2E4,a,-2E4),c.push(-2E4,a,2E4),c.push(-G,a,-t),c.push(-G,a,t),c.push(2E4,a,-2E4),c.push(2E4,a,2E4),c.push(G,a,-t),c.push(G,a,t),P=A+1,b.push(P+3,P+2,P+1,P+2,P+0,P+1,P+6,P+4,P+2,P+4,P+0,P+2,P+5,P+7,P+1,P+7,P+3,P+1,P+5,P+4,P+7,P+7,P+4,P+6));a=m.jd();a.a_position=new Float32Array(c);e=m.sb("multigrid_plane");e.C[0]=a;e.ka=new Uint32Array(b);e.O=c.length/3;h.qu&&(l.Jl(e,1,!0),a.a_polyindex=l.en(e));return e};a.YE=function(a){var b=a.length;if(b%3)throw"Wrong array";
for(var c=[],d=[],h=0;h<b;h+=3){var l=a[h+1],p=a[h+2];e(a[h],d);e(l,d);e(p,d);c.push(h,h+1,h+2)}a=m.jd();a.a_position=new Float32Array(d);b=m.sb("FROM_TRIANGLES");b.C[0]=a;b.ka=new Uint32Array(c);b.O=d.length/3;return b};a.XE=d;a.Vy=function(a){a=m.yD(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=d(b);a.name="FRUSTUM";return a};a.tb=function(){var a=m.sb("FULLSCREEN_TRI"),
b=m.jd();b.a_position=new Float32Array([0,0,1,0,0,1]);a.C[0]=b;a.ka=new Uint32Array([0,1,2]);a.O=3;return a};a.Wy=function(){var a=m.sb("FULLSCREEN_QUAD"),b=m.jd();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.C[0]=b;a.ka=new Uint32Array([0,2,1,1,2,3]);a.O=4;return a};a.Ry=function(){var a=m.sb("BILLBOARD"),b=m.jd();b.a_bb_vertex=new Float32Array([-.5,-.5,-.5,.5,.5,.5,.5,-.5]);a.C[0]=b;a.ka=new Uint32Array([0,2,1,0,3,2]);a.O=4;return a};a.Sy=function(){var a=m.sb("CUBEMAP_BOARD"),b=m.jd();
b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.C[0]=b;a.ka=new Uint32Array([0,2,1,0,3,2]);a.O=4;return a};a.pn=function(a,c){var d=m.sb("UV_SPHERE"),h,y,w=[],p=[],D=[];for(y=0;8>=y;y++)for(h=0;16>=h;h++){var G=h/16,t=y/8;p.push(-a*Math.cos(2*G*Math.PI)*Math.sin(t*Math.PI)+c[0],a*Math.cos(t*Math.PI)+c[1],a*Math.sin(2*G*Math.PI)*Math.sin(t*Math.PI)+c[2])}for(y=G=0;8>y;y++)for(h=0;16>h;h++){var t=b(p,17*y+h+1),A=b(p,17*y+h),x=b(p,17*(y+1)+h),u=b(p,17*(y+1)+h+1);Math.abs(t[1])==a+c[1]?(e(t,w),
e(x,w),e(u,w),D.push(G,G+1,G+2),G+=3):Math.abs(x[1])==a+c[1]?(e(t,w),e(A,w),e(x,w),D.push(G,G+1,G+2),G+=3):(e(t,w),e(A,w),e(x,w),e(u,w),D.push(G,G+1,G+2),D.push(G,G+2,G+3),G+=4)}h={};h.a_position=w;p=l.nq(D,p,w);h.a_normal=l.lq(D,w,p);h.a_tangent=[];d.N.a_influence=[];d.N.a_color=[];d.N.a_texcoord=[];d.C[0]=h;d.ka=D;d.O=w.length/3;return d};a.nr=function(a){var b=m.sb("INDEX"),c=m.jd();c.a_index=new Float32Array(a);for(var d=0;d<a;d++)c.a_index[d]=d;b.C[0]=c;b.ka=new Uint16Array(0);b.O=a;return b}};b4w.module.__prerender=function(a,p){function c(a,c){var d=a.pd,e=c.k;d.is_visible=!1;var f;if(!(f=!d||d.Fh)){var h=e.cf,l=d.Ib.F;f=d.lf;h=Math.sqrt((l[0]-h[0])*(l[0]-h[0])+(l[1]-h[1])*(l[1]-h[1])+(l[2]-h[2])*(l[2]-h[2]));l=d.yg*d.Ib.Ia;f=!(h>=d.uj&&h<f+l)}if(f)return!1;d.is_visible=!0;(f="OUTLINE_MASK"==c.type&&!Boolean(d.qd))||(e=e.Mk,d.uh?f=!1:("STATIC"===d.type?(f=d.Ib,d=f.F,d=m.kC(d,e,f.Ia)):(f=d.Vf,d=f.F,d=m.ty(d,e,f.Qe,f.Re,f.Se)),f=d));return f?!1:"WIREFRAME"==c.type?a.D.wireframe_mode==b.Fp.WM_DEBUG_SPHERES?
a.D.dg:!a.D.dg:!0}var d=p("__config"),b=p("__debug"),e=p("__geometry"),l=p("__renderer"),m=p("__util"),h=p("__vec3"),n=d.r,f="MAIN_OPAQUE MAIN_BLEND MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_GLOW SHADOW_CAST DEPTH OUTLINE_MASK WIREFRAME COLOR_PICKING MAIN_XRAY COLOR_PICKING_XRAY".split(" ");a.to=function(a){if(-1<f.indexOf(a.type)){for(var b=!1,d=a.s,m=0;m<d.length;m++){var p=d[m];if("MAIN_CUBE_REFLECT"==a.type)for(var D=0;6>D;D++)a.k.Mk=a.Om[D],p.Wm[D]=c(p,a),p.Wm[D]&&(b=!0);else p.Wa=c(p,a),p.Wa&&
(b=!0)}switch(a.type){case "WIREFRAME":break;default:"MAIN_OPAQUE"===a.type||"DEPTH"===a.type||b?a.Wa=!0:(a.Wa&&l.clear(a),a.Wa=!1)}}if("MAIN_BLEND"==a.type&&n.alpha_sort&&a.s){b=a.k.cf;d=h.dist(b,a.tu)>n.alpha_sort_threshold;for(m=0;m<a.s.length;m++)if(D=a.s[m],p=D.pd,p.mn||d){var G=D.D;if(G&&G.Ha&&G.Ke!=e.Wd){G=G.P;if(!G||!D.Wa)continue;(D=G.Vk)&&D.type==e.Gp&&e.RC(G,p.Z,b)}p.mn=!1}d&&h.copy(b,a.tu)}}};b4w.module.__print=function(a){function p(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var d=1;d<a.length;d++)c.push(a[d]);return c}var c=!1,d=0,b=0;a.PB=function(a){c=a};a.Zn=function(){console.log.apply(console,arguments)};a.log=function(){if(c){var a=p(arguments,"B4W LOG");console.log.apply(console,a)}};a.error=function(){d++;var a=p(arguments,"B4W ERROR");console.error.apply(console,a)};a.warn=function(){b++;var a=p(arguments,"B4W WARN");console.warn.apply(console,
a)};a.info=function(){var a=p(arguments,"B4W INFO");console.info.apply(console,a)};a.xy=function(){d++;var a=p(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.yy=function(){b++;var a=p(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){c&&console.time.apply(console,arguments)};a.timeEnd=function(){c&&console.timeEnd.apply(console,arguments)};a.group=function(){c&&console.group.apply(console,arguments)};a.groupCollapsed=function(){c&&console.groupCollapsed.apply(console,
arguments)};a.groupEnd=function(){c&&console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)};a.Gz=function(){return b};a.pz=function(){return d};a.clear_errors_warnings=function(){d=b=0}};b4w.module.print=b4w.module.__print;b4w.module.__reformer=function(a,p){function c(a){switch(a.type){case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in
a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));
"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",
a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":switch(a.node_tree_name=a.node_tree_name.replace(/\.[0-9]{3,}$/g,""),a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}}}
function d(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.strips.length;e++){var f=d.strips[e];"action"in f||(f.action=null,b("strip",f,"action"));"action_frame_start"in f||(f.action_frame_start=0,b("strip",f,"action_frame_start"));"action_frame_end"in f||(f.action_frame_end=f.frame_end-f.frame_start,b("strip",f,"action_frame_end"));"repeat"in f||(f.repeat=1,b("strip",f,"repeat"));"use_reverse"in f||(f.use_reverse=!1,b("strip",f,"use_reverse"));"scale"in f||(f.scale=1,b("strip",
f,"scale"))}}function b(a,b,c){c=c+">>"+a;c in D||(D[c]={Ro:[],ct:"undefined",type:a});D[c].Ro.push(b.name)}function e(a,b){param_id in D||(D[param_id]={Ro:[],ct:"deprecated",type:a});D[param_id].Ro.push(b.name)}function l(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var e=f.Zf(a);a.materials=c;a.submeshes=d;e.name=b;e.materials=a.materials.slice(0);e.submeshes=[];for(c=0;c<d.length;c++){var g=f.Ni(d[c]);e.submeshes.push(g)}return e}var m=p("__boundings"),
h=p("__curve"),n=p("__print"),f=p("__util"),k=p("vec3"),r=p("vec4"),y=p("quat"),w=p("mat4"),C=[5,4],D={};a.wq=function(a){return-1!=f.ju(a,C)};a.Xw=function(a){D={};var h=a.worlds;if(0==h.length){n.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var k={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,
depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};h.push(k)}for(var h=a.worlds,m=0;m<h.length;m++){k=h[m];"use_sky_blend"in k||(b("world",k,"use_sky_blend"),k.use_sky_blend=!1);"use_sky_paper"in k||(b("world",k,"use_sky_paper"),k.use_sky_paper=!1);"use_sky_real"in k||(b("world",k,"use_sky_real"),k.use_sky_real=!1);"b4w_sky_settings"in k&&"rayleigh_brightness"in k.b4w_sky_settings||(b("world",
k,"rayleigh_brightness"),k.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in k||(b("world",k,"fog_settings"),k.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},
"b4w_fog_color"in k&&(k.fog_settings.use_custom_color=!0,k.fog_settings.color=k.b4w_fog_color),"b4w_fog_density"in k&&0<k.b4w_fog_density&&(k.fog_settings.use_fog=!0,k.fog_settings.depth=1/k.b4w_fog_density));"render_sky"in k.b4w_sky_settings||(b("world",k,"render_sky"),k.b4w_sky_settings.render_sky=!1);for(var l=k.texture_slots,k=0;k<l.length;k++){var g=l[k];"blend_type"in g||(g.blend_type="MIX",b("world_texture_slot",g,"blend_type"));"use_map_blend"in g||(g.use_map_blend=!1,b("world_texture_slot",
g,"use_map_blend"));"use_map_horizon"in g||(g.use_map_horizon=!0,b("world_texture_slot",g,"use_map_horizon"));"use_map_zenith_up"in g||(g.use_map_zenith_up=!1,b("world_texture_slot",g,"use_map_zenith_up"));"use_rgb_to_intensity"in g||(g.use_rgb_to_intensity=!1,b("world_texture_slot",g,"use_rgb_to_intensity"));"invert"in g||(g.invert=!1,b("world_texture_slot",g,"invert"));"color"in g||(g.color=[1,0,1],b("world_texture_slot",g,"color"));"blend_factor"in g||(g.blend_factor=0,b("world_texture_slot",g,
"blend_factor"));"horizon_factor"in g||(g.horizon_factor=1,b("world_texture_slot",g,"horizon_factor"));"zenith_up_factor"in g||(g.zenith_up_factor=0,b("world_texture_slot",g,"zenith_up_factor"));"zenith_down_factor"in g||(g.zenith_down_factor=0,b("world_texture_slot",g,"zenith_down_factor"));"default_value"in g||(g.default_value=1,b("world_texture_slot",g,"default_value"))}}k=a.scenes;for(m=0;m<k.length;m++)l=k[m],g=l.world,"timeline_markers"in l||(l.timeline_markers=null,b("scene",l,"timeline_markers")),
"b4w_reflection_quality"in l||(l.b4w_reflection_quality="MEDIUM",b("scene",l,"b4w_reflection_quality")),"b4w_use_nla"in l||(l.b4w_use_nla=!1,b("scene",l,"b4w_use_nla")),"fps"in l||(l.fps=24,b("scene",l,"fps")),"b4w_nla_cyclic"in l||(l.b4w_nla_cyclic=!1,b("scene",l,"b4w_nla_cyclic")),"b4w_nla_script"in l||(l.b4w_nla_script=[],b("scene",l,"b4w_nla_script")),"b4w_detect_collisions"in l&&(e("scene",l),delete l.b4w_detect_collisions),"audio_doppler_speed"in l||(l.audio_doppler_speed=343.3),"audio_doppler_factor"in
l||(l.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in l||(l.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},b("scene",l,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in l||(l.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in l||(l.b4w_enable_bloom=!1,b("scene",l,"b4w_enable_bloom")),"b4w_enable_motion_blur"in l||(l.b4w_enable_motion_blur=!1,b("scene",l,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in l||(l.b4w_enable_color_correction=
!1,b("scene",l,"b4w_enable_color_correction")),"b4w_enable_antialiasing"in l||(l.b4w_enable_antialiasing=!0,b("scene",l,"b4w_enable_antialiasing")),"b4w_tags"in l||(l.b4w_tags={title:"",description:""},b("scene",l,"b4w_tags")),"b4w_enable_object_selection"in l||(l.b4w_enable_object_selection="AUTO",b("scene",l,"b4w_enable_object_selection")),"b4w_enable_outlining"in l||(l.b4w_enable_outlining="AUTO",b("scene",l,"b4w_enable_outlining")),"b4w_enable_glow_materials"in l||(l.b4w_enable_glow_materials=
"AUTO",b("scene",l,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in l||(l.b4w_enable_anchors_visibility="AUTO",b("scene",l,"b4w_enable_anchors_visibility")),"b4w_outline_color"in l||(l.b4w_outline_color=[1,1,1],b("scene",l,"b4w_outline_color")),"b4w_outline_factor"in l||(l.b4w_outline_factor="b4w_glow_factor"in l?l.b4w_glow_factor:1,b("scene",l,"b4w_outline_factor")),"b4w_shadow_settings"in l||(b("scene",l,"b4w_shadow_settings"),h=g.b4w_shadow_settings,l.b4w_shadow_settings=h?h:{csm_resolution:2048,
self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),h=l.b4w_shadow_settings,"csm_resolution"in h||(b("scene",l,"b4w_shadow_settings.csm_resolution"),h.csm_resolution=2048),"self_shadow_polygon_offset"in h||(b("scene",l,"b4w_shadow_settings.self_shadow_polygon_offset"),h.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in h||
(b("scene",l,"b4w_shadow_settings.self_shadow_normal_offset"),h.self_shadow_normal_offset=.01),"b4w_enable_csm"in h||(b("scene",l,"b4w_shadow_settings.b4w_enable_csm"),h.b4w_enable_csm=!1),"csm_num"in h||(b("scene",l,"b4w_shadow_settings.csm_num"),h.csm_num=1),"csm_first_cascade_border"in h||(b("scene",l,"b4w_shadow_settings.csm_first_cascade_border"),h.csm_first_cascade_border=10),"first_cascade_blur_radius"in h||(b("scene",l,"b4w_shadow_settings.first_cascade_blur_radius"),h.first_cascade_blur_radius=
3),"csm_last_cascade_border"in h||(b("scene",l,"b4w_shadow_settings.csm_last_cascade_border"),h.csm_last_cascade_border=100),"last_cascade_blur_radius"in h||(b("scene",l,"b4w_shadow_settings.last_cascade_blur_radius"),h.last_cascade_blur_radius=1.5),"fade_last_cascade"in h||(b("scene",l,"b4w_shadow_settings.fade_last_cascade"),h.fade_last_cascade=!0),"blend_between_cascades"in h||(b("scene",l,"b4w_shadow_settings.blend_between_cascades"),h.blend_between_cascades=!0),"b4w_ssao_settings"in l||(b("scene",
l,"b4w_ssao_settings"),h=g.b4w_ssao_settings,l.b4w_ssao_settings=h?h:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),h=l.b4w_ssao_settings,"dist_factor"in h||(b("scene",l,"b4w_ssao_settings.dist_factor"),h.dist_factor=0),"samples"in h||(b("scene",l,"b4w_ssao_settings.samples"),h.samples=16),"hemisphere"in h||(b("scene",l,"b4w_ssao_settings.hemisphere"),h.hemisphere=!1),"blur_depth"in h||(b("scene",l,"b4w_ssao_settings.blur_depth"),h.blur_depth=!1),"blur_discard_value"in
h||(b("scene",l,"b4w_ssao_settings.blur_discard_value"),h.blur_discard_value=1),"b4w_bloom_settings"in l||(b("scene",l,"b4w_bloom_settings"),h=g.b4w_bloom_settings,l.b4w_bloom_settings=h?h:{key:.2,blur:4,edge_lum:1}),"key"in l.b4w_bloom_settings||(b("scene",l,"b4w_bloom_settings.key"),l.b4w_bloom_settings.key=.2),"blur"in l.b4w_bloom_settings||(b("scene",l,"b4w_bloom_settings.blur"),l.b4w_bloom_settings.blur=4),"edge_lum"in l.b4w_bloom_settings||(b("scene",l,"b4w_bloom_settings.edge_lum"),l.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in l||(b("scene",l,"b4w_motion_blur_settings"),h=g.b4w_motion_blur_settings,l.b4w_motion_blur_settings=h?h:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in l.b4w_motion_blur_settings||(b("scene",l,"b4w_motion_blur_settings.motion_blur_factor"),l.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in l.b4w_motion_blur_settings||(b("scene",l,"b4w_motion_blur_settings.motion_blur_decay_threshold"),l.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in l||(b("scene",l,"b4w_color_correction_settings"),h=g.b4w_color_correction_settings,l.b4w_color_correction_settings=h?h:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in l||(b("scene",l,"b4w_god_rays_settings"),h=g.b4w_god_rays_settings,l.b4w_god_rays_settings=h?h:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in l.b4w_god_rays_settings||(b("scene",l,"b4w_god_rays_settings.steps_per_pass"),l.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in l||(b("scene",l,"b4w_glow_settings"),l.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},h=l.b4w_glow_settings,"b4w_render_glow_over_blend"in g&&(h.render_glow_over_blend=g.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in g&&(h.small_glow_mask_coeff=g.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in g&&(h.large_glow_mask_coeff=g.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
g&&(h.small_glow_mask_width=g.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in g&&(h.large_glow_mask_width=g.b4w_large_glow_mask_width)),g=l.b4w_render_shadows,"AUTO"!=g&&"OFF"!=g&&"ON"!=g&&(l.b4w_render_shadows=g?"ON":"OFF"),g=l.b4w_render_reflections,"OFF"!=g&&"ON"!=g&&(l.b4w_render_reflections=g?"ON":"OFF"),g=l.b4w_render_refractions,"AUTO"!=g&&"OFF"!=g&&"ON"!=g&&(l.b4w_render_refractions=g?"ON":"OFF");l=a.meshes;for(m=0;m<l.length;m++){g=l[m];g.b4w_bounding_box||(b("mesh",g,"b4w_bounding_box"),
g.b4w_bounding_box={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0});g.b4w_bounding_box_source||(b("mesh",g,"b4w_bounding_box_source"),g.b4w_bounding_box_source=g.b4w_bounding_box);g.uv_textures||(b("mesh",g,"uv_textures"),g.uv_textures=[]);g.b4w_bounding_sphere_center||(g.b4w_bounding_sphere_center=[0,0,0]);g.b4w_bounding_cylinder_center||(g.b4w_bounding_cylinder_center=[0,0,0]);g.b4w_bounding_ellipsoid_center||(g.b4w_bounding_ellipsoid_center=[0,0,0]);g.b4w_bounding_ellipsoid_axes||(k=g.b4w_bounding_box,
g.b4w_bounding_ellipsoid_axes=[(k.max_x-k.min_x)/2,(k.max_y-k.min_y)/2,(k.max_z-k.min_z)/2]);"b4w_shape_keys"in g||(g.b4w_shape_keys=[],b("mesh",g,"b4w_shape_keys"));for(var k=g,h=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],q=null,r=0;r<h.length;r++)k[h[r]]&&(q?(k[h[r]]=!1,n.warn('WARNING property "'+h[r]+'" of object "'+k.name+'" has been set to "false". Foreground property "'+q+'" already exists.')):q=h[r]);for(k=0;k<g.b4w_vertex_anim.length;k++)h=
g.b4w_vertex_anim[k],"allow_nla"in h||(b('mesh["b4w_vertex_anim"]',g,"allow_nla"),h.allow_nla=!0)}k=a.cameras;for(m=0;m<k.length;m++)l=k[m],l.type||(l.type="PERSP",b("camera",l,"type")),"b4w_eye_target_dist"in l&&(delete l.b4w_eye_target_dist,e("camera",l)),"b4w_hover_zero_level"in l||(l.b4w_hover_zero_level=0,b("camera",l,"b4w_hover_zero_level")),"b4w_trans_velocity"in l||(l.b4w_trans_velocity=1,b("camera",l,"b4w_trans_velocity")),"b4w_rot_velocity"in l||(l.b4w_rot_velocity=1,b("camera",l,"b4w_rot_velocity")),
"b4w_zoom_velocity"in l||(l.b4w_zoom_velocity=.1,b("camera",l,"b4w_zoom_velocity")),"b4w_use_distance_limits"in l||(l.b4w_use_distance_limits=!1,b("camera",l,"b4w_use_distance_limits")),"b4w_distance_min"in l||(l.b4w_distance_min=1,b("camera",l,"b4w_distance_min")),"b4w_distance_max"in l||(l.b4w_distance_max=100,b("camera",l,"b4w_distance_max")),"b4w_horizontal_translation_min"in l||(l.b4w_horizontal_translation_min=-100,b("camera",l,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in
l||(l.b4w_horizontal_translation_max=100,b("camera",l,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in l||(l.b4w_vertical_translation_min=-100,b("camera",l,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in l||(l.b4w_vertical_translation_max=100,b("camera",l,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in l||(l.b4w_use_horizontal_clamping=!1,b("camera",l,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in l||(l.b4w_rotation_left_limit=-Math.PI,
b("camera",l,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in l||(l.b4w_rotation_right_limit=Math.PI,b("camera",l,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in l||(l.b4w_horizontal_clamping_type="LOCAL",b("camera",l,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in l||(l.b4w_use_vertical_clamping=!1,b("camera",l,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in l||(l.b4w_rotation_down_limit=-Math.PI/2,b("camera",l,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in
l||(l.b4w_rotation_up_limit=Math.PI/2,b("camera",l,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in l||(l.b4w_vertical_clamping_type="LOCAL",b("camera",l,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in l||(l.b4w_hover_angle_min=Math.PI/6,b("camera",l,"b4w_hover_angle_min")),"b4w_hover_angle_max"in l||(l.b4w_hover_angle_max=Math.PI/6,b("camera",l,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in l||(l.b4w_enable_hover_hor_rotation=!0,b("camera",l,"b4w_enable_hover_hor_rotation")),
"b4w_use_panning"in l||(l.b4w_use_panning=!0,b("camera",l,"b4w_use_panning"));k=a.lamps;for(m=0;m<k.length;m++)l=k[m],"b4w_generate_shadows"in l||(l.b4w_generate_shadows=!1,b("lamp",l,"b4w_generate_shadows")),"b4w_dynamic_intensity"in l||(l.b4w_dynamic_intensity=!1,b("lamp",l,"b4w_dynamic_intensity")),"use_diffuse"in l||(l.use_diffuse=!0,b("lamp",l,"use_diffuse")),"use_specular"in l||(l.use_specular=!0,b("lamp",l,"use_specular"));k=a.speakers;for(m=0;m<k.length;m++)l=k[m],"b4w_behavior"in l||(l.b4w_behavior=
l.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_disable_doppler"in l||(l.b4w_disable_doppler=!1),"b4w_delay"in l||(l.b4w_delay=0),"b4w_delay_random"in l||(l.b4w_delay_random=0),"b4w_volume_random"in l||(l.b4w_volume_random=0),"b4w_pitch_random"in l||(l.b4w_pitch_random=0),"b4w_fade_in"in l||(l.b4w_fade_in=0),"b4w_fade_out"in l||(l.b4w_fade_out=0),"b4w_loop"in l||(l.b4w_loop=!1),"b4w_loop_count"in l||(l.b4w_loop_count=0),"b4w_loop_count_random"in l||(l.b4w_loop_count_random=0),"b4w_playlist_id"in
l||(l.b4w_playlist_id=""),l.animation_data&&d(l.animation_data);k=a.textures;for(m=0;m<k.length;m++)l=k[m],"b4w_anisotropic_filtering"in l||(l.b4w_anisotropic_filtering="OFF",b("texture",l,"b4w_anisotropic_filtering")),"b4w_water_foam"in l||(l.b4w_water_foam=!1,b("texture",l,"b4w_water_foam")),"b4w_foam_uv_freq"in l||(l.b4w_foam_uv_freq=[1,1],b("texture",l,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in l||(l.b4w_foam_uv_magnitude=[1,1],b("texture",l,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in
l||(l.b4w_parallax_steps=5,b("material",l,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in l||(l.b4w_parallax_lod_dist=10,b("material",l,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in l||(l.b4w_shore_dist_map=!1,b("texture",l,"b4w_shore_dist_map")),"b4w_shore_boundings"in l||(l.b4w_shore_boundings=new Float32Array(4),l.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",l,"b4w_shore_boundings")),"b4w_max_shore_dist"in l||(l.b4w_max_shore_dist=100,b("texture",l,"b4w_max_shore_dist")),"b4w_disable_compression"in
l||(l.b4w_disable_compression=!1,b("texture",l,"b4w_disable_compression")),"b4w_source_type"in l||(l.b4w_source_type="",b("texture",l,"b4w_source_type")),"b4w_source_id"in l||(l.b4w_source_id="",b("texture",l,"b4w_source_id")),"b4w_source_size"in l||(l.b4w_source_size=1024,b("texture",l,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in l||(l.b4w_enable_canvas_mipmapping=!0,b("texture",l,"b4w_enable_canvas_mipmapping"));h=a.materials;for(m=0;m<h.length;m++){q=h[m];"b4w_node_mat_type"in q&&e("material",
q);"b4w_skydome"in q&&e("material",q);"b4w_procedural_skydome"in q&&e("material",q);q.b4w_water&&("b4w_water_shore_smoothing"in q||(q.b4w_water_shore_smoothing=!1,b("material",q,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in q||(q.b4w_water_dynamic=!1,b("material",q,"b4w_water_dynamic")),"b4w_waves_height"in q||(q.b4w_waves_height=1,b("material",q,"b4w_waves_height")),"b4w_waves_length"in q||(q.b4w_waves_length=1,b("material",q,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in q||(q.b4w_water_dst_noise_scale0=
.05,b("material",q,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in q||(q.b4w_water_dst_noise_scale1=.03,b("material",q,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in q||(q.b4w_water_dst_noise_freq0=1.3,b("material",q,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in q||(q.b4w_water_dst_noise_freq1=1,b("material",q,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in q||(q.b4w_water_dir_min_shore_fac=.4,b("material",q,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in
q||(q.b4w_water_dir_freq=.5,b("material",q,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in q||(q.b4w_water_dir_noise_scale=.05,b("material",q,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in q||(q.b4w_water_dir_noise_freq=.07,b("material",q,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in q||(q.b4w_water_dir_min_noise_fac=.5,b("material",q,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in q||(q.b4w_water_dst_min_fac=.2,b("material",q,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in
q||(q.b4w_water_waves_hor_fac=5,b("material",q,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in q||(q.b4w_water_absorb_factor=6,b("material",q,"b4w_water_absorb_factor")),"b4w_water_fog_color"in q||(q.b4w_water_fog_color=new Float32Array(3),q.b4w_water_fog_color=[.5,.7,.7],b("material",q,"b4w_water_fog_color")),"b4w_foam_factor"in q||(q.b4w_foam_factor=5,b("material",q,"b4w_foam_factor")),"b4w_generated_mesh"in q||(q.b4w_generated_mesh=!1,b("material",q,"b4w_generated_mesh")),"b4w_water_num_cascads"in
q||(q.b4w_water_num_cascads=5,b("material",q,"b4w_water_num_cascads")),"b4w_water_subdivs"in q||(q.b4w_water_subdivs=64,b("material",q,"b4w_water_subdivs")),"b4w_water_detailed_dist"in q||(q.b4w_water_detailed_dist=1E3,b("material",q,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in q||(q.b4w_water_enable_caust=!1,b("material",q,"b4w_water_enable_caust")),"b4w_water_caust_scale"in q||(q.b4w_water_caust_scale=.25,b("material",q,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in q||(q.b4w_water_caust_brightness=
.5,b("material",q,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in q||(q.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in q||(q.b4w_dynamic_grass_color="");"diffuse_intensity"in q||(q.diffuse_intensity=1,b("material",q,"diffuse_intensity"));"b4w_use_ghost"in q||(q.b4w_use_ghost=!1);"b4w_collision_margin"in q||(q.b4w_collision_margin=.04,b("material",q,"b4w_collision_margin"));"b4w_collision_group"in q||(q.b4w_collision_group=128,b("material",q,"b4w_collision_group"));"b4w_collision_mask"in
q||(q.b4w_collision_mask=127,b("material",q,"b4w_collision_mask"));"b4w_do_not_render"in q||(q.b4w_do_not_render=!1,b("material",q,"b4w_do_not_render"));"HALO"!=q.type||"b4w_halo_sky_stars"in q||(q.b4w_halo_sky_stars=!1,b("material",q,"b4w_halo_sky_stars"));"HALO"!=q.type||"b4w_halo_stars_blend_height"in q||(q.b4w_halo_stars_blend_height=10,b("material",q,"b4w_halo_stars_blend_height"));"HALO"!=q.type||"b4w_halo_stars_min_height"in q||(q.b4w_halo_stars_min_height=0,b("material",q,"b4w_halo_stars_min_height"));
"specular_shader"in q||(q.specular_shader="COOKTORR",b("material",q,"specular_shader"));"diffuse_shader"in q||(q.diffuse_shader="LAMBERT",b("material",q,"diffuse_shader"));"roughness"in q||(q.roughness=.5,b("material",q,"roughness"));"diffuse_fresnel"in q||(q.diffuse_fresnel=.1,b("material",q,"diffuse_fresnel"));"diffuse_fresnel_factor"in q||(q.diffuse_fresnel_factor=.5,b("material",q,"diffuse_fresnel_factor"));"specular_slope"in q||(q.specular_slope=.2,b("material",q,"specular_slope"));"specular_toon_size"in
q||(q.specular_toon_size=.5,b("material",q,"specular_toon_size"));"specular_toon_smooth"in q||(q.specular_toon_smooth=.1,b("material",q,"specular_toon_smooth"));"specular_alpha"in q||(q.specular_alpha=1,b("material",q,"specular_alpha"));"b4w_wettable"in q||(q.b4w_wettable=!1,b("material",q,"b4w_wettable"));"b4w_refractive"in q||(q.b4w_refractive=!1,b("material",q,"b4w_refractive"));"b4w_refr_bump"in q||(q.b4w_refr_bump=0,b("material",q,"b4w_refr_bump"));"b4w_shallow_water_col"in q||(q.b4w_shallow_water_col=
[0,.8,.3],b("material",q,"b4w_shallow_water_col"));"b4w_shore_water_col"in q||(q.b4w_shore_water_col=[0,.9,.2],b("material",q,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in q||(q.b4w_shallow_water_col_fac=1,b("material",q,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in q||(q.b4w_shore_water_col_fac=.5,b("material",q,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in q||(q.b4w_water_sss_strength=5.9,b("material",q,"b4w_water_sss_strength"));"b4w_water_sss_width"in q||(q.b4w_water_sss_width=
.45,b("material",q,"b4w_water_sss_width"));"b4w_render_above_all"in q||(q.b4w_render_above_all=!1,b("material",q,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in q||(q.b4w_water_norm_uv_velocity=.05,b("material",q,"b4w_water_norm_uv_velocity"));"specular_ior"in q||(q.specular_ior=1,b("material",q,"specular_ior"));"darkness"in q||(q.darkness=0,b("material",q,"darkness"));"diffuse_toon_size"in q||(q.diffuse_toon_size=0,b("material",q,"diffuse_toon_size"));"diffuse_toon_smooth"in q||(q.diffuse_toon_smooth=
0,b("material",q,"diffuse_toon_smooth"));l=q.texture_slots;for(k=0;k<l.length;k++)g=l[k],"blend_type"in g||(g.blend_type="MIX",b("texture_slot",g,"blend_type"));if(q.node_tree){l=q.node_tree.nodes;for(k=0;k<l.length;k++)c(l[k]);q.node_tree.animation_data&&d(q.node_tree.animation_data)}}g=a.node_groups;for(m=0;m<g.length;m++)for(l=g[m].node_tree.nodes,k=0;k<l.length;k++)c(l[k]);l=a.objects;for(m=0;m<l.length;m++){g=l[m];switch(g.type){case "MESH":"b4w_dynamic_geometry"in g||(g.b4w_dynamic_geometry=
!1);"b4w_reflexible"in g||(g.b4w_reflexible=!1);"b4w_reflexible_only"in g||(g.b4w_reflexible_only=!1);"b4w_reflective"in g||(g.b4w_reflective=!1);"b4w_reflection_type"in g||(g.b4w_reflection_type="PLANE",b("object",g,"b4w_reflection_type"));"b4w_wind_bending"in g||(g.b4w_wind_bending=!1,b("object",g,"b4w_wind_bending"));"b4w_wind_bending_angle"in g||(g.b4w_wind_bending_angle=10,g.b4w_wind_bending_freq=.25,b("object",g,"wind bending params"));"b4w_detail_bending_amp"in g||(g.b4w_detail_bending_amp=
.1,g.b4w_branch_bending_amp=.3,b("object",g,"detail bending params"));"b4w_detail_bending_freq"in g||(g.b4w_detail_bending_freq=1,b("object",g,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in g||(g.b4w_main_bend_stiffness_col="",b("object",g,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in g||(g.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",g,"b4w_detail_bend_colors"));"b4w_caustics"in g||(g.b4w_caustics=!1);"vertex_groups"in
g&&g.vertex_groups.length&&g.data&&0==g.data.vertex_groups.length&&(g.data.vertex_groups=g.vertex_groups,delete g.vertex_groups,b("object",g,"vertex_groups"));"b4w_vertex_anim"in g&&g.b4w_vertex_anim.length&&g.data&&0==g.data.b4w_vertex_anim.length&&(g.data.b4w_vertex_anim=g.b4w_vertex_anim,delete g.b4w_vertex_anim,b("object",g,"b4w_vertex_anim"));"b4w_do_not_render"in g||(g.b4w_do_not_render=!1);"use_ghost"in g.game||(g.game.use_ghost=!1);"use_sleep"in g.game||(g.game.use_sleep=!1);"velocity_min"in
g.game||(g.game.velocity_min=0);"velocity_max"in g.game||(g.game.velocity_max=0);"collision_group"in g.game||(g.game.collision_group=1);"collision_mask"in g.game||(g.game.collision_mask=255);"b4w_vehicle_settings"in g?g.b4w_vehicle_settings&&("steering_ratio"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.steering_ratio=10),"steering_max"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.steering_max=1),"inverse_control"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.inverse_control=!1),"force_max"in
g.b4w_vehicle_settings||(g.b4w_vehicle_settings.force_max=1500),"brake_max"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.brake_max=100),"speed_ratio"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_compression=
4.4),"suspension_stiffness"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in g.b4w_vehicle_settings||
(g.b4w_vehicle_settings.floating_factor=3),"floating_factor"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.water_rot_damp=.9)):(g.b4w_vehicle_settings=null,b("object",g,"b4w_vehicle_settings"));"b4w_floating_settings"in g?g.b4w_floating_settings&&("floating_factor"in g.b4w_floating_settings||(g.b4w_floating_settings.floating_factor=
3),"water_lin_damp"in g.b4w_floating_settings||(g.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in g.b4w_floating_settings||(g.b4w_floating_settings.water_rot_damp=.8)):(g.b4w_floating_settings=null,b("object",g,"b4w_floating_settings"));"b4w_character_settings"in g?g.b4w_character_settings&&("walk_speed"in g.b4w_character_settings||(g.b4w_character_settings.walk_speed=4),"run_speed"in g.b4w_character_settings||(g.b4w_character_settings.run_speed=8),"step_height"in g.b4w_character_settings||
(g.b4w_character_settings.step_height=.25),"jump_strength"in g.b4w_character_settings||(g.b4w_character_settings.jump_strength=5),"waterline"in g.b4w_character_settings||(g.b4w_character_settings.waterline=0)):(g.b4w_character_settings=null,b("object",g,"b4w_character_settings"));"b4w_selectable"in g||(g.b4w_selectable=!1,b("object",g,"b4w_selectable"));"b4w_outlining"in g||(g.b4w_outlining=!1,b("object",g,"b4w_outlining"));"b4w_outline_on_select"in g||(g.b4w_outline_on_select=!1,b("object",g,"b4w_outline_on_select"));
"b4w_billboard"in g||(g.b4w_billboard=!1,b("object",g,"b4w_billboard"));"b4w_billboard_geometry"in g||(g.b4w_billboard_geometry="SPHERICAL",b("object",g,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in g||(g.b4w_pres_glob_orientation=!1,b("object",g,"b4w_pres_glob_orientation"));"b4w_outline_settings"in g||("b4w_glow_settings"in g?g.b4w_outline_settings=g.b4w_glow_settings:(g.b4w_outline_settings={},g.b4w_outline_settings.outline_duration=1,g.b4w_outline_settings.outline_period=1,g.b4w_outline_settings.outline_relapses=
0),b("object",g,"b4w_outline_settings"));"b4w_lod_transition"in g||(g.b4w_lod_transition=.01,b("object",g,"b4w_lod_transition"));"lod_levels"in g||(g.lod_levels=[],b("object",g,"lod_levels"));"b4w_animation_mixing"in g||(g.b4w_animation_mixing=!1,b("object",g,"b4w_animation_mixing"));break;case "EMPTY":"b4w_group_relative"in g||(g.b4w_group_relative=!1,b("object",g,"b4w_group_relative")),"b4w_anchor"in g||(g.b4w_anchor=null,b("object",g,"b4w_anchor")),!g.b4w_anchor||"max_width"in g.b4w_anchor||(g.b4w_anchor.max_width=
250)}"collision_margin"in g.game||(g.game.collision_margin=.04,b("object",g,"collision_margin"));"b4w_anim_behavior"in g||(g.b4w_anim_behavior=g.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",g,"b4w_anim_behavior"));if(!("rotation_quaternion"in g)){k=[0,0,0,1];f.euler_to_quat(g.rotation_euler,k);var h=k,q=k[0],r=k[1],y=k[2];h[0]=k[3];h[1]=q;h[2]=r;h[3]=y;g.rotation_quaternion=k;b("object",g,"rotation_quaternion")}"webgl_do_not_batch"in g&&(g.b4w_do_not_batch=g.webgl_do_not_batch)&&e("object",
g);"b4w_shadow_cast_only"in g||(g.b4w_shadow_cast_only=!1,b("object",g,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in g||(g.b4w_correct_bounding_offset="AUTO",b("object",g,"b4w_correct_bounding_offset"));h=g.particle_systems;for(k=0;k<h.length;k++)q=h[k],r=q.settings,"use_rotation_dupli"in r||(r.use_rotation_dupli=!1,b("object",r,"use_rotation_dupli")),"use_whole_group"in r||(r.use_whole_group=!1,b("object",r,"use_whole_group")),q.transforms||(q.transforms=new Float32Array,b("particle_system",
q,"transforms")),"b4w_billboard_align"in r||(r.b4w_billboard_align="VIEW",b("particle_settings",r,"b4w_billboard_align")),"b4w_dynamic_grass"in r||(r.b4w_dynamic_grass=!1,b("object",r,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in r||(r.b4w_dynamic_grass_scale_threshold=.01,b("object",r,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in r||(r.b4w_initial_rand_rotation=!1,b("particle_settings",r,"b4w_initial_rand_rotation")),"b4w_rotation_type"in r||(r.b4w_rotation_type=
"Z",b("particle_settings",r,"b4w_rotation_type")),"b4w_rand_rotation_strength"in r||(r.b4w_rand_rotation_strength=1,b("particle_settings",r,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in r||(r.b4w_hair_billboard=!1,b("particle_settings",r,"b4w_hair_billboard")),"b4w_hair_billboard_type"in r||(r.b4w_hair_billboard_type="BASIC",b("particle_settings",r,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in r||(r.b4w_hair_billboard_jitter_amp=0,b("particle_settings",r,"b4w_hair_billboard_jitter_amp")),
"b4w_hair_billboard_jitter_freq"in r||(r.b4w_hair_billboard_jitter_freq=0,b("particle_settings",r,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in r||(r.b4w_hair_billboard_geometry="SPHERICAL",b("particle_settings",r,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in r||(r.b4w_wind_bend_inheritance="PARENT",b("particle_settings",r,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in r||(r.b4w_shadow_inheritance="PARENT",b("particle_settings",r,"b4w_shadow_inheritance")),
"b4w_reflection_inheritance"in r||(r.b4w_reflection_inheritance="PARENT",b("particle_settings",r,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in r||(r.b4w_vcol_from_name="",b("particle_settings",r,"b4w_vcol_from_name")),"b4w_vcol_to_name"in r||(r.b4w_vcol_to_name="",b("particle_settings",r,"b4w_vcol_to_name")),"b4w_coordinate_system"in r||(r.b4w_coordinate_system="LOCAL",b("particle_settings",r,"b4w_coordinate_system")),"b4w_allow_nla"in r||(r.b4w_allow_nla=!0,b("particle_settings",r,"b4w_allow_nla")),
"b4w_enable_soft_particles"in r||(r.b4w_enable_soft_particles=!1,b("particle_settings",r,"b4w_enable_soft_particles")),"b4w_particles_softness"in r||(r.b4w_particles_softness=1,b("particle_settings",r,"b4w_particles_softness"));"constraints"in g||(g.constraints=[],b("object",g,"constraints"));h=g.modifiers;for(k=0;k<h.length;k++){a:{q=h[k];switch(q.type){case "ARRAY":if(!("fit_type"in q)){n.error("WARNING Incomplete modifier "+String(q.type)+' for "'+g.name+'", reexport "'+a.b4w_filepath_blend+'" scene');
q=!1;break a}}q=!0}q||(h.splice(k,1),k--)}"animation_data"in g||(g.animation_data={action:null,nla_tracks:[]},b("object",g,"animation_data"));g.animation_data&&("action"in g.animation_data||(g.animation_data.action=null,n.warn("no action in animation data "+g.name)),"nla_tracks"in g.animation_data||(g.animation_data.nla_tracks=[],n.warn("no NLA in animation data "+g.name)),d(g.animation_data));"b4w_collision_id"in g||(g.b4w_collision_id="",b("material",g,"b4w_collision_id"));k=g.scale;0==k[0]&&0==
k[1]&&0==k[2]?k=!0:(h=Math.abs((k[1]-k[2])/k[1]),k=.005>Math.abs((k[0]-k[1])/k[0])&&.005>h);k||n.warn("non-uniform scale for object "+g.name);if(0>g.scale[0]||0>g.scale[1]||0>g.scale[2])n.warn("negative scale for object "+g.name+", using positive scale instead"),g.scale[0]=Math.abs(g.scale[0]),g.scale[1]=Math.abs(g.scale[1]),g.scale[2]=Math.abs(g.scale[2])}for(var E in D)m=D[E],k=E.match(/.*?(?=>>|$)/i)[0],n.warn("WARNING "+String(k)+" is "+m.ct+" for "+m.type+", reexport "+a.b4w_filepath_blend)};
a.Uw=function(a,b){"num_channels"in a||(a.num_channels=1,n.warn('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.ow=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var d=b[c].type;if("ARRAY"==d||"CURVE"==d){b=!0;break a}}b=!1}if(!b)return null;b=l(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var e=a[c];switch(e.type){case "ARRAY":for(var d=b,g=e,n=0,p=0,J=0,E=new Float32Array(16),e=[],M=1;M<g.count;M++){g.use_constant_offset&&
(n+=g.constant_offset_displace[0],p+=g.constant_offset_displace[1],J+=g.constant_offset_displace[2]);if(g.use_relative_offset)var K=d.b4w_bounding_box,n=n+(K.max_x-K.min_x)*g.relative_offset_displace[0],p=p+(K.max_y-K.min_y)*g.relative_offset_displace[1],J=J+(K.max_z-K.min_z)*g.relative_offset_displace[2];f.FC(n,p,J,E);for(var C=K=l(d),I=E,v=0;v<C.submeshes.length;v++){var H=C.submeshes[v];f.sf(H.position,I,H.position,0);f.zD(H.normal,I,H.normal);f.CC(H.tangent,I,H.tangent)}e.push(K)}for(M=0;M<e.length;M++)for(g=
d,n=e[M],p=0;p<g.submeshes.length;p++){J=g.submeshes[p];E=n.submeshes[p];K=J.base_length;C=J.indices.length;J.base_length+=E.base_length;for(var P in J)if("base_length"!=P)if("indices"==P)for(J[P]=f.JC(J[P],E[P]),I=C;I<J.indices.length;I++)J.indices[I]+=K;else"vertex_colors"!=P&&(J[P]=f.Hy(J[P],E[P]))}break;case "CURVE":for(var d=b,M=e.object.c.Et,g=new Float32Array(16),p=M.jf?4:3,n=new Float32Array(p),p=new Float32Array(p),J=new Float32Array(3),E=new Float32Array(4),K=new Float32Array(4),C=new Float32Array(3),
I=new Float32Array(3),v=new Float32Array(3),H=new Float32Array(4),D=new Float32Array(4),aa=0;aa<d.submeshes.length;aa++){var R=d.submeshes[aa],W=R.position,ba=R.normal,R=R.tangent,U;a:switch(U=e.deform_axis,U){case "POS_X":case "NEG_X":U=0;break a;case "POS_Y":case "NEG_Y":U=1;break a;case "POS_Z":case "NEG_Z":U=2;break a;default:throw"Wrong deform axis value "+U;}C[0]=0;C[1]=0;C[2]=0;C[U]=1;for(var ca=h.nC(M),S=0;S<W.length/3;S++){v[0]=W[3*S];v[1]=W[3*S+1];v[2]=W[3*S+2];var oa=v[U],X=h.mC(M,oa);
h.oC(M,X,n);J[0]=n[0];J[1]=n[1];J[2]=n[2];h.lC(M,X,p);I[0]=p[0];I[1]=0;I[2]=p[2];k.normalize(I,I);y.rotationTo(C,I,E);0>oa?(n[0]=I[0],n[1]=I[1],n[2]=I[2],k.scale(n,oa,n),k.add(J,n,J)):oa>ca&&(n[0]=I[0],n[1]=I[1],n[2]=I[2],k.scale(n,oa-ca,n),k.add(J,n,J));w.fromRotationTranslation(E,J,g);M.jf&&(y.setAxisAngle(C,n[3],K),k.transformQuat(v,K,v));v[U]=0;k.transformMat4(v,g,v);W[3*S]=v[0];W[3*S+1]=v[1];W[3*S+2]=v[2];ba.length&&(H[0]=ba[3*S],H[1]=ba[3*S+1],H[2]=ba[3*S+2],H[3]=0,r.transformMat4(H,g,H),ba[3*
S]=H[0],ba[3*S+1]=H[1],ba[3*S+2]=H[2]);R.length&&(D[0]=R[3*S],D[1]=R[3*S+1],D[2]=R[3*S+2],D[3]=0,r.transformMat4(D,g,D),R[3*S]=D[0],R[3*S+1]=D[1],R[3*S+2]=D[2])}}}m.bB(b)}return b};a.CE=function(){return{name:"DEFAULT",use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",
specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},
type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]}};a.ww=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(d.b4w_use_nla)for(var d=d.b4w_nla_script,e=0;e<d.length;e++){var f=d[e];switch(f.type){case "SELECT":case "SELECT_PLAY":for(var h=
0;h<a.length;h++){var k=a[h];k.name==f.object&&(k.b4w_selectable=!0)}break;case "SHOW":case "HIDE":for(h=0;h<a.length;h++)k=a[h],k.name==f.object&&(k.b4w_do_not_batch=!0)}}}}};b4w.module.__scenegraph=function(a,p){function c(a){a=xa.ag(a);a.ne=null;a.nb=null;a.Vc=null;return a}function d(a,c){var d=[];O.Pd(a,function(b,c,f){-1<d.indexOf(f)?O.lB(a,b,c,f,e(f)):d.push(f)});O.X(a,function(b,f){for(var z=0;z<f.ma.length;z++){var g=f.ma[z];c||"MAIN_PLANE_REFLECT"!=f.type&&"MAIN_CUBE_REFLECT"!=f.type&&"MAIN_XRAY"!=f.type||(g.ah=!0);-1<d.indexOf(g)?f.ma[z]=e(g):d.push(g)}"ANTIALIASING"==f.type&&O.Ge(a,b,function(a,b){if("MOTION_BLUR"==b.type)for(var c=0;c<b.ma.length;c++){var d=
b.ma[c];d.fa=T.u;d.ea=T.u}});c||O.Ge(a,b,function(a,b,c){"DEPTH"==c.V&&(c.ah=!0)})});O.X(a,function(c){var d={};b(a,c,d);for(var e in d){c=d[e];for(var f=c[0],z=0;z<c.length;z++)if(c[z].fa==T.u){f=c[z];break}for(var g=c[0],z=0;z<c.length;z++)if(c[z].ea==T.u){g=c[z];break}for(var h=c[0],z=0;z<c.length;z++)if(!c[z].ah){h=c[z];break}for(z=0;z<c.length;z++)c[z].fa=f.fa,c[z].ea=g.ea,c[z].ah=h.ah}})}function b(a,c,d){O.Ge(a,c,function(c,e,f){f.Ua&&f.V==f.ua&&(d[f.V]=d[f.V]||[],-1==d[f.V].indexOf(f)&&d[f.V].push(f),
b(a,c,d))});O.Gf(a,c,function(a,b,c){c.Ua&&(d[c.V]=d[c.V]||[],-1==d[c.V].indexOf(c)&&d[c.V].push(c))});c=O.Za(a,c);if("MOTION_BLUR"==c.type)for(var e=0;e<c.ma.length;e++){var f=c.ma[e];d[f.V].push(f)}}function e(a){if(a.ya)throw"Failed to clone slink with attached texture";return hc.Zf(a)}function l(a){var b=O.dp(a),c=[];O.X(b,function(a,d){switch(d.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":var e=[];break;default:e=c}for(var z=0;z<d.ma.length;z++){var g=
d.ma[z],l=k(e,g,h(g));g.ya=l;d.Nd[z]=l}for(z=0;z<d.Nd.length;z++)l=d.Nd[z],f(e,l);switch(d.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":e=[]}O.Gf(b,a,function(c,d,f){if(!f.ya){if((c=n(b,a,f.V))&&f.Ua&&!f.ya){d=e;for(var z=c,g=0;g<d.length;g++){var l=d[g];l.$o===z&&l.Gj++}}else c=k(e,f,h(f));f.ya=c}});O.Ge(b,a,function(a,b,c){f(e,c.ya)});O.Gf(b,a,function(a,b,c){c.ya&&"NONE"==c.ua&&f(e,c.ya)})})}function m(a){y(a,function(b,c,d){b.ti&&(ia(a,
d,"SMAA_NEIGHBORHOOD_BLENDING")&&"SMAA_NEIGHBORHOOD_BLENDING"!=d.type||ia(a,d,"ANTIALIASING")||"ANCHOR_VISIBILITY"==d.type)&&(b.Cf*=Pa.render_resolution_factor)})}function h(a){a=hc.Zf(a);delete a.ua;delete a.Ua;delete a.ya;return JSON.stringify(a)}function n(a,b,c){var d=null;O.Ge(a,b,function(a,b,e){if(e.Ua&&e.V==e.ua&&e.V==c&&e.ya)return d=e.ya,!0});O.Gf(a,b,function(a,b,e){if(e.Ua&&e.V==c&&e.ya)return d=e.ya,!0});return d}function f(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.$o===b&&d.Gj&&
d.Gj--}}function k(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=a[e];if(f.id==c&&0===f.Gj){d=f;break}}if(d&&!Pa.qA)return d.Gj++,d.$o;b=r(b);a.push({id:c,Gj:1,$o:b});return b}function r(a){var b=a.Cf*a.size;switch(a.V){case "COLOR":var c=T.Ck("COLOR",T.ih);T.resize(c,b,b);T.Kj(c,a.fa,a.ea);return c;case "DEPTH":return a.ah?(c=T.Ck("DEPTH_RBUF",T.hh),T.resize(c,b,b)):(c=T.Ck("DEPTH_TEX",T.Ci),T.resize(c,b,b),T.Kj(c,a.fa,a.ea)),c;case "CUBEMAP":return c=T.zx(b);case "SCREEN":return null;default:throw"Wrong slink param: "+
a.V;}}function y(a,b){var c=!1;O.Pd(a,function(d,e,f){if(f&&(d=O.Za(a,d),e=O.Za(a,e),b(f,!1,d,e)))return c=!0});c||O.X(a,function(a,c){for(var d=0;d<c.ma.length;d++)if(b(c.ma[d],!0,c,null))return!0})}function w(a){O.X(a,function(b,c){if("SINK"!=c.type){var d=c.k;O.Gf(a,b,function(a,b,c){c.Ua&&c.ya&&(F.Cl(d,c.V,c.ya),c.V==c.ua&&b.k&&F.Cl(b.k,c.V,c.ya))});for(var e=0;e<c.ma.length;e++){var f=c.ma[e];f.Ua&&f.V==f.ua&&F.Cl(d,f.V,c.Nd[e])}!d.nb&&!d.Vc||d.ne||(d.ne=ha.kB(d.nb,d.Vc))}})}function C(a){var b=
null,c=0;O.X(a,function(a,d){if(d.type==Zb.AC){if(c==Zb.zC)return b=d,!0;c++}});return b}function D(a,b){var c=O.Dg(a,b),d=g("NONE"),e=O.w(a,d),f=O.Ar(a)[0];O.Pd(a,function(b,c){c==f&&O.cB(a,b,f,b,e)});O.Pd(a,function(e,f,z){if(e==c)return O.n(a,b,d,A(Zb.ZB,"u_color",z.size,z.Cf,z.ti)),!0});O.gd(a,e,f,A("SCREEN","NONE",.5,.5,!0))}function G(a,b){var c=t("SHADOW_CAST");c.Mm=a;c.self_shadow_polygon_offset=b.self_shadow_polygon_offset;switch(b.Qn){case "SPOT":case "POINT":c.k=F.rb(F.Pb);F.Dl(c.k,180*
b.ud/Math.PI,.1,2*b.distance);break;default:c.k=F.rb(F.Rf)}return c}function t(a){a={type:a,Ma:"",Ha:!1,Gs:!1,jm:!1,gl:!1,Ui:0,time:0,k:null,Ti:null,Om:[],s:[],ma:[],Nd:[],Of:new Float32Array(3),tu:new Float32Array(3),ic:new Float32Array(3),Yb:new Float32Array(4),Lk:new Float32Array(4),wc:new Float32Array(16),ut:0,bf:0,Fg:0,ug:null,kf:null,tg:null,vg:null,ff:new Float32Array(3),Pf:new Float32Array(3),vt:new Float32Array(4),Mt:new Float32Array([0,0,0]),Uo:new Float32Array(3),Nt:new Float32Array(4),
tt:new Float32Array(3),xj:0,Xm:0,qj:!1,pf:new Float32Array(3),Lf:0,mb:null,Ql:!1,zf:new Float32Array(2),Af:new Float32Array(2),ei:0,Ph:0,zm:0,wd:null,Nf:0,gh:0,Mf:0,de:!1,qq:0,rq:new Float32Array(2),pq:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,fi:new Float32Array(3),ssao_hemisphere:0,ssao_blur_depth:0,ssao_blur_discard_value:0,
ii:0,hi:0,gi:0,Gt:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,Oh:0,xl:0,mi:0,Mm:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,gu:null,eq:null,Kg:null,bloom_key:0,bloom_blur:0,bloom_edge_lum:0,rm:0,cn:0,mb_decay_threshold:0,mb_factor:0,ps:0,tl:"",fA:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,ap:new Float32Array(2),Na:new Float32Array(2),Wa:!0,enqueue:!0,ja:!0,oa:!0,
Kb:!0,sa:!0,Fe:1};a.Na[0]=1;a.Na[1]=1;return a}function A(a,b,c,d,e){return{V:a,ua:b,size:c,Cf:d,ti:e,Ua:!0,ya:null,ah:!1,fa:T.sc,ea:T.sc}}function x(a,b){for(var c=0,d=Y(a,b),e=0;e<d.length;e++){var f=d[e];"SHADOW_CAST"==f.type&&(f=f.k,b.MA=f.Xa/(f.Xa-f.bb),b.gu=f.va,b.eq=new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1]),b.Kg=b.Kg||[],b.Kg[c]=f.xa,c++)}}function u(){var a=t("GRASS_MAP");a.k=F.rb(F.Le);return a}function g(a){var b=t("POSTPROCESSING");b.ja=!1;b.oa=!1;b.Kb=!1;b.k=F.rb(F.zb);
b.tl=a;switch(a){case "NONE":b.Na[0]=1;b.Na[1]=1;break;case "GRAYSCALE":b.Na[0]=1;b.Na[1]=1;break;case "X_BLUR":b.Na[0]=1;b.Na[1]=0;break;case "Y_BLUR":b.Na[0]=0;b.Na[1]=1;break;case "X_GLOW_BLUR":b.Na[0]=1;b.Na[1]=0;break;case "Y_GLOW_BLUR":b.Na[0]=0;b.Na[1]=1;break;case "X_EXTEND":b.Na[0]=1;b.Na[1]=0;break;case "Y_EXTEND":b.Na[0]=0;b.Na[1]=1;break;default:throw"Wrong postprocessing effect: "+a;}return b}function q(a){var b=t("BLOOM_BLUR");b.ja=!1;b.oa=!1;b.Kb=!1;b.k=F.rb(F.zb);b.tl=a;switch(a){case "X_BLUR":b.Na[0]=
1;b.Na[1]=0;break;case "Y_BLUR":b.Na[0]=0;b.Na[1]=1;break;default:throw"Wrong postprocessing effect for bloom blur: "+a;}return b}function L(a,b){var c=t("GLOW_COMBINE");c.ja=!1;c.oa=!1;c.Kb=!1;c.small_glow_mask_coeff=b.ef.small_glow_mask_coeff;c.large_glow_mask_coeff=b.ef.large_glow_mask_coeff;c.small_glow_mask_width=b.ef.small_glow_mask_width;c.large_glow_mask_width=b.ef.large_glow_mask_width;c.k=a;return c}function J(a,b,c,d,e,f,z,g,h){var k=t("MAIN_"+a);if("OPAQUE"===a)k.ja=!0,k.oa=c,k.Ha=!1;
else if("BLEND"===a)k.ja=!1,k.oa=!1,k.Ha=!0;else if("XRAY"===a)k.ja=!1,k.oa=!0,k.Ha=!0;else if("PLANE_REFLECT"===a||"CUBE_REFLECT"===a)k.ja=!0,k.oa=!0,k.Ha=!1;else if("GLOW"===a)k.ja=!0,k.oa=!1,k.Ha=!1;else throw"wrong main subscene type";k.Ha&&g&&(k.self_shadow_normal_offset=g.self_shadow_normal_offset);k.k=b;if(a=z.Io)k.vt.set([a.Ew,a.Pz,a.JD,a.ID]),k.tt.set(a.color),k.ut=a.za;k.ff.set(z.ff);k.Pf.set(z.Pf);k.bf=z.bf;k.Yb=f.Yb;k.Lk=f.Lk;d&&(k.mb=d,d.Yb&&(k.wd=new Float32Array(d.Yb)),k.Nf=d.waves_height,
k.gh=d.waves_length,k.Mf=d.Mf,d.de&&h&&(k.de=!0,k.qq=d.Rw,k.rq.set(d.Sw),k.pq=d.Qw),d.Fl&&(k.Ql=!0,f=d.XB,k.zf[0]=(f[0]+f[1])/2,k.zf[1]=(f[2]+f[3])/2,k.Af[0]=f[0]-f[1],k.Af[1]=f[2]-f[3],k.ei=d.ei,k.Ph=d.Ph));k.ug=new Float32Array(3*e);k.kf=new Float32Array(3*e);k.tg=new Float32Array(3*e);k.vg=new Float32Array(0==e%2?2*e:2*e+2);return k}function E(a,b){var c=t("COLOR_PICKING");b&&(c.type+="_XRAY",c.ja=!1,c.oa=!0);c.enqueue=!1;c.k=a;return c}function M(a){var b=t("WIREFRAME");b.Wa=!1;b.ja=!1;b.oa=!1;
b.k=a;return b}function K(a){var b=t("ANCHOR_VISIBILITY");b.ja=!0;b.oa=!1;b.k=a;return b}function Q(a,b){var c=t("DEPTH");c.k=a;c.self_shadow_normal_offset=b.self_shadow_normal_offset;return c}function I(a,b,c){var d=t("SSAO");d.ja=!1;d.oa=!1;d.Kb=!1;d.k=a;d.Yb=b.Yb;d.wd=new Float32Array(b.Yb);d.ii=c.radius_increase;d.ssao_hemisphere=c.Oz;d.hi=c.influence;d.gi=c.dist_factor;d.Gt=c.tB;return d}function v(a,b){var c=t("SSAO_BLUR");c.ja=!1;c.oa=!1;c.Kb=!1;c.k=a;c.ssao_blur_depth=b.Hw;c.ssao_blur_discard_value=
b.iq;return c}function H(){var a=t("ANTIALIASING");a.ja=!1;a.oa=!1;a.Kb=!1;a.Fe=1/Pa.render_resolution_factor;a.k=F.rb(F.zb);return a}function P(a){var b=t(a);b.ja="SMAA_BLENDING_WEIGHT_CALCULATION"==a||"SMAA_EDGE_DETECTION"==a?!0:!1;b.oa=!1;b.Kb=!1;b.Fe=1/Pa.render_resolution_factor;b.k=F.rb(F.zb);"SMAA_BLENDING_WEIGHT_CALCULATION"==a&&(b.gA=new Float32Array(4));return b}function Z(a,b,c,d){var e=t("COMPOSITING");e.ja=!1;e.oa=!1;e.Kb=!1;e.k=F.rb(F.zb);e.brightness=a;e.contrast=b;e.exposure=c;e.saturation=
d;return e}function aa(a,b){var c=t("MOTION_BLUR");c.ja=!1;c.oa=!1;c.Kb=!1;c.k=F.rb(F.zb);c.jm=!0;c.mb_decay_threshold=a;c.mb_factor=b;return c}function R(a){var b=t("DOF");b.ja=!1;b.oa=!1;b.Kb=!1;b.k=a;b.Fe=b.k.dof_power;return b}function W(a){var b=t("OUTLINE_MASK");b.Kb=!1;b.k=a;return b}function ba(a){var b=t("OUTLINE");b.pf.set(a.pf);b.xj=a.xj;b.cn=5;b.rm=3;b.Kb=!1;b.k=F.rb(F.zb);return b}function U(){var a=t("REFRACT");a.ja=!1;a.oa=!1;a.Kb=!1;a.k=F.rb(F.zb);return a}function ca(a,b,c,d,e,f,
z){var g=t("GOD_RAYS");g.ja=!1;g.oa=!1;g.Kb=!1;g.ff=new Float32Array([1,1,1]);g.Pf=new Float32Array([1,1,1]);g.bf=1;g.Gs=d;g.Lf=b;g.xl=e;g.Oh=c;g.mi=z;g.k=a;g.Fg=f;g.ug=new Float32Array(3*f);g.kf=new Float32Array(3*f);g.tg=new Float32Array(3*f);g.vg=new Float32Array(0==f%2?2*f:2*f+2);return g}function S(a,b){var c=t("GOD_RAYS_COMBINE");c.ja=!1;c.oa=!1;c.Kb=!1;c.k=F.rb(F.zb);c.god_rays_intensity=a;c.Fg=b;c.ug=new Float32Array(3*b);c.kf=new Float32Array(3*b);c.tg=new Float32Array(3*b);c.vg=new Float32Array(0==
b%2?2*b:2*b+2);return c}function oa(a,b){var c=t("SKY");c.enqueue=!1;c.ja=!1;c.oa=!1;c.Kb=!1;var d=F.rb(F.zb);d.width=na.Dk;d.height=na.Dk;c.k=d;c.Ti=hc.Ty();c.Fg=a;c.ug=new Float32Array(3*a);c.kf=new Float32Array(3*a);c.tg=new Float32Array(3*a);c.vg=new Float32Array(0==a%2?2*a:2*a+2);c.ff=new Float32Array([1,1,1]);c.Pf=new Float32Array([1,1,1]);c.bf=1;c.fi.set(b.fi);c.procedural_skydome=b.procedural_skydome;c.use_as_environment_lighting=b.use_as_environment_lighting;c.rayleigh_brightness=b.rayleigh_brightness;
c.mie_brightness=b.mie_brightness;c.spot_brightness=b.spot_brightness;c.scatter_strength=b.scatter_strength;c.rayleigh_strength=b.rayleigh_strength;c.mie_strength=b.mie_strength;c.rayleigh_collection_power=b.rayleigh_collection_power;c.mie_collection_power=b.mie_collection_power;c.mie_distribution=b.mie_distribution;return c}function X(){var a=t("COPY");a.ja=!1;a.oa=!1;a.k=F.rb(F.zb);return a}function da(){var a=t("ANAGLYPH");a.ja=!1;a.oa=!1;a.k=F.rb(F.zb);return a}function ea(){var a=t("LUMINANCE");
a.ja=!1;a.oa=!1;a.k=F.rb(F.zb);return a}function fa(){var a=t("AVERAGE_LUMINANCE");a.ja=!1;a.oa=!1;a.k=F.rb(F.zb);return a}function ga(a,b,c,d){var e=t("LUMINANCE_TRUNCED");e.ja=!1;e.oa=!1;e.bloom_key=a;e.bloom_edge_lum=b;e.k=d;e.ug=new Float32Array(3*c);e.kf=new Float32Array(3*c);e.tg=new Float32Array(3*c);e.vg=new Float32Array(0==c%2?2*c:2*c+2);return e}function B(a){var b=t("BLOOM");b.ja=!1;b.oa=!1;b.k=F.rb(F.zb);b.bloom_blur=a;return b}function N(){var a=t("SINK");a.enqueue=!1;return a}function ia(a,
b,c){if(b.type===c)return!0;b=ja(a,b);for(var d=0;d<b.length;d++)if(ia(a,b[d],c))return!0;return!1}function ta(a,b,c){if(b.type===c)return!0;b=Y(a,b);for(var d=0;d<b.length;d++)if(ta(a,b[d],c))return!0;return!1}function Y(a,b){var c=O.Dg(a,b);if(c==O.Ap)throw"Subscene not in graph";for(var d=[],e=O.Qr(a,c),f=0;f<e;f++){var z=O.Ok(a,c,f);z!=c&&d.push(O.Za(a,z))}return d}function ja(a,b){var c=O.Dg(a,b);if(c==O.Ap)throw"Subscene not in graph";for(var d=[],e=O.Jg(a,c),f=0;f<e;f++){var z=O.ng(a,c,f);
z!=c&&d.push(O.Za(a,z))}return d}function sa(a){var b=[],c=[];y(a,function(a){a.ya&&-1==b.indexOf(a.ya)&&(b.push(a.ya),c.push(a.ya,b.length-1))});return c}function z(a,b){var c;c=""+(a.V+"\\n");c+="NONE"!=a.ua?a.ua+"\\n":"";c+="(";if(a.ti){var d=a.Cf;Math.round(d)!=d&&(d=d.toFixed(2));d=(1==d?"":d)+"S";c+=d+"x"+d}else c+=a.size+"x"+a.size;if("SCREEN"!=a.V){c+=" ";if(a.ah)c+="RR";else{var d=a.fa,e=a.ea,f="";d==T.u?f+="L":d==T.sc&&(f+="N");e==T.u?f+="L":e==T.sc&&(f+="N");c+=f}for(d=0;d<b.length;d+=
2)b[d]==a.ya&&(c+=" "+b[d+1])}return c+")\\n"}var F=p("__camera"),ka=p("__config"),ra=p("__debug"),O=p("__graph"),ha=p("__renderer"),T=p("__textures"),hc=p("__util"),xa=p("__obj_util");p("vec4");var Zb=ka.Tm,Pa=ka.r,na=ka.ai;a.dx=function(a){switch(a.ua){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "NONE":return!1;default:return!0}};a.IC=y;a.Lx=function(a,b,e){function f(d,e){var g=c(qa[e]);b.M.push(g);g=J(d,g,!1,la,sa,gb,Ua,Ta,a.Xg);h.push(g);O.w(z,g);O.n(z,k[e],g,
ka[e]);"XRAY"==d?g.ma.push(A("DEPTH","DEPTH",1,1,!0)):O.n(z,k[e],g,r[e]);db&&(O.n(z,db,g,hb),O.n(z,db,g,$a));if(ya){for(var l=0;l<xa.length;l++)O.n(z,xa[l],g,ta[l]);if(Sb.mc&&Wa||zc||Qa){var l=bc[e],m=c(l.k);b.M.push(m);var F=t("DEPTH_PACK");F.ja=!1;F.oa=!1;F.k=m;O.w(z,F);var m=A("DEPTH","u_depth",1,1,!0),v=A("COLOR","u_scene_depth",1,1,!0);v.fa=T.sc;v.ea=T.sc;O.n(z,l,F,m);O.n(z,F,g,v)}}if(y.length)for(F=y.length/qa.length,l=0;l<F;l++)m=F*e+l,O.n(z,y[m],g,ha[m]);if(Y.length)for(l=0;l<Y.length;l++)O.n(z,
Y[l],g,ja[l]);p.length&&O.n(z,p[e],g,ia[e]);return g}var z=O.create(),k=[],h=[],n=[],ka=[],r=[],y=[],ha=[],p=[],ia=[],xa=[],ta=[],Y=[],ja=[],sa=a.jA,la=a.mb,zc=a.shore_smoothing,Qa=a.aC,Ab=a.Ao,Tb=a.De,La=a.Ch,Sb=a.vA,ib=a.Og,Vc=a.mh,Bc=a.Sh,Ea=a.qh,Ia=a.antialiasing,Ua=a.up,gb=a.su,Ta=a.Ae,yb=a.yA,vb=a.Gw,wb=a.Tw,Xa=a.Iz,Fa=a.KA,kb=a.vh,ya=a.jy,Wa=a.mc,Ga=Boolean(e.length),qa=[];if(a.anaglyph_use&&!Ga){var Wb=b.M[0],Ub=c(Wb);F.ms(Wb,F.Ab);F.ms(Ub,F.Gb);qa.push(Wb,Ub);b.M.push(Ub)}else{var wa=b.M[0];
qa.push(wa)}if(Ab){F.hp(qa[0],Ta);for(var rc=Ta.csm_num,V=0;V<rc;V++){var Hb=G(V,Ta);O.w(z,Hb);xa.push(Hb);var Lb=Ta.csm_resolution,wa=Hb.k;wa.width=Lb;wa.height=Lb;Hb.ja=!1;ta.push(A("DEPTH","u_shadow_map"+V,Lb,1,!1));(ra.uq()||Pa.er)&&Hb.ma.push(A("COLOR","COLOR",Lb,1,!1))}}if(ib&&ib.ys&&!Ga)for(V=0;V<ib.ys;V++){wa=F.rb(F.Pb);wa.width=a.cg;wa.height=a.cg;F.Dl(wa,90,.1,100);F.xf(wa,wa.Ea);var va=J("CUBE_REFLECT",wa,!1,la,sa,gb,Ua,null,a.Xg);va.Ti=hc.Xy();for(var za=0;6>za;za++)va.Om.push(F.Cx());
O.w(z,va);var zb=A("CUBEMAP","u_cube_reflection",a.cg,1,!1);zb.fa=T.u;zb.ea=T.u;var Cc=A("DEPTH","DEPTH",a.cg,1,!1);ja.push(zb);va.ma.push(Cc);Y.push(va);ib.Xe.push(va)}if(ib&&0<ib.Zs.length&&!Ga)for(V=0;V<qa.length;V++)for(za=0;za<ib.Zs.length;za++)wa=c(qa[V]),wa.cc=new Float32Array(4),b.M.push(wa),va=J("PLANE_REFLECT",wa,!1,la,sa,gb,Ua,null,a.Xg),O.w(z,va),zb=A("COLOR","u_plane_reflection",1,a.Dj,!0),zb.fa=T.u,zb.ea=T.u,Cc=A("DEPTH","DEPTH",1,a.Dj,!0),ha.push(zb),va.ma.push(Cc),y.push(va),ib.rf.push(va);
k=[];h=[];if(a.Bb){var db=u();O.w(z,db);Lb=na.Qk;db.k.width=Lb;db.k.height=Lb;var hb=A("DEPTH","u_grass_map_depth",Lb,1,!1);hb.fa=T.u;hb.ea=T.u;var $a=A("COLOR","u_grass_map_color",Lb,1,!1);$a.fa=T.u;$a.ea=T.u}else $a=hb=db=null;for(var Ma=[],eb=[],bc=[],Mb=[],V=0;V<qa.length;V++){var wa=qa[V],ab={};r.push(A("DEPTH","DEPTH",1,1,!0));if(ya){var Nb=c(wa);b.M.push(Nb);ab=Q(Nb,Ta);bc.push(ab);O.w(z,ab);if(Ab){for(za=0;za<xa.length;za++)Hb=xa[za],O.n(z,Hb,ab,ta[za]);var Mc=A("COLOR","u_color",1,1,!0),
Ob=A("DEPTH","u_depth",1,1,!0);if(Tb){var Nc=c(wa);b.M.push(Nc);var Dc=a.qC,Ha=I(Nc,gb,Dc);O.w(z,Ha);var lb=A("COLOR","u_ssao_mask",1,1,!0);O.n(z,ab,Ha,Mc);O.n(z,ab,Ha,Ob);var Bb=c(wa);b.M.push(Bb);var bb=v(Bb,Dc);O.w(z,bb);var Vb=A("COLOR","u_shadow_mask",1,1,!0);O.n(z,Ha,bb,lb);O.n(z,ab,bb,Ob)}}else ra.uq()&&ab.ma.push(A("COLOR","COLOR",1,1,!0));db&&(O.n(z,db,ab,hb),O.n(z,db,ab,$a))}va=J("OPAQUE",wa,!ya,la,sa,gb,Ua,null,a.Xg);O.w(z,va);h.push(va);eb.push(va);ya&&(O.n(z,ab,va,r[V]),lb?O.n(z,bb,va,
Vb):Ab&&O.n(z,ab,va,A("COLOR","u_shadow_mask",1,1,!0)));var Cb=A("COLOR","u_color",1,1,!0);ka.push(A("COLOR","COLOR",1,1,!0));db&&(O.n(z,db,va,hb),O.n(z,db,va,$a));if(y.length)for(var cc=y.length/qa.length,za=0;za<cc;za++){var Aa=cc*V+za;O.n(z,y[Aa],va,ha[Aa])}if(Y.length)for(za=0;za<Y.length;za++)O.n(z,Y[za],va,ja[za])}k=h;h=[];if(!Ga&&a.kx){wa=c(k[0].k);b.M.push(wa);var Ra=E(wa,!1);O.w(z,Ra);if(a.Ie){wa=c(k[0].k);b.M.push(wa);var qb=E(wa,!0);O.w(z,qb);O.n(z,Ra,qb,A("COLOR","COLOR",1,1,!0));O.n(z,
Ra,qb,A("DEPTH","DEPTH",1,1,!0))}}else Ra=null;if(Sb.mc&&!Ga)for(V=0;V<qa.length;V++){var Xb=U();O.w(z,Xb);O.n(z,k[V],Xb,Cb);p.push(Xb);ia.push(A("COLOR","u_refractmap",1,1,!0))}if(a.xn){for(V=0;V<qa.length;V++)va=f("BLEND",V),Ma.push(va);k=h;h=[]}if(a.df){for(V=0;V<qa.length;V++){var Ka=c(qa[V]);b.M.push(Ka);var sc=J("GLOW",Ka,!1,la,sa,gb,Ua);O.w(z,sc);O.n(z,eb[V],sc,r[V]);var Pb=g("X_GLOW_BLUR");Pb.Ma="GLOW_MASK_SMALL";Pb.Fe=a.ef.small_glow_mask_width;var Ib=A("COLOR","u_color",1,1,!0);Ib.fa=T.u;
Ib.ea=T.u;O.w(z,Pb);O.n(z,sc,Pb,Ib);var Ya=g("Y_GLOW_BLUR");Ya.Ma="GLOW_MASK_SMALL";Ya.Fe=a.ef.small_glow_mask_width;var jc=A("COLOR","u_color",1,.5,!0);jc.fa=T.u;jc.ea=T.u;O.w(z,Ya);O.n(z,Pb,Ya,jc);var $b=g("X_GLOW_BLUR");$b.Ma="GLOW_MASK_LARGE";$b.Fe=a.ef.large_glow_mask_width;var kc=A("COLOR","u_color",1,.5,!0);kc.fa=T.u;kc.ea=T.u;O.w(z,$b);O.n(z,Ya,$b,kc);var mb=g("Y_GLOW_BLUR");mb.Ma="GLOW_MASK_LARGE";mb.Fe=a.ef.large_glow_mask_width;var rb=A("COLOR","u_color",1,.25,!0);rb.fa=T.u;rb.ea=T.u;O.w(z,
mb);O.n(z,$b,mb,rb);var Db=c(qa[V]);b.M.push(Db);var dc=L(Db,a);O.w(z,dc);a.xn?O.n(z,Ma[V],dc,A("COLOR","u_src_color",1,1,!0)):O.n(z,eb[V],dc,A("COLOR","u_src_color",1,1,!0));var Eb=A("COLOR","u_glow_mask_small",1,.5,!0);Eb.fa=T.u;Eb.ea=T.u;O.n(z,Ya,dc,Eb);var Yb=A("COLOR","u_glow_mask_large",1,.25,!0);Yb.fa=T.u;Yb.ea=T.u;O.n(z,mb,dc,Yb);n.push(dc)}k=n;h=[]}if(!a.xn){for(V=0;V<qa.length;V++)va=f("BLEND",V),Ma.push(va);k=h;h=[]}if(a.Ie){for(V=0;V<qa.length;V++){var ac=f("XRAY",V);Mb.push(ac)}k=h;h=
[]}if(Pa.wireframe_debug){for(V=0;V<qa.length;V++){wa=c(qa[V]);b.M.push(wa);var sb=M(wa);h.push(sb);O.w(z,sb);O.n(z,k[V],sb,ka[V]);O.n(z,k[V],sb,r[V]);db&&(O.n(z,db,sb,hb),O.n(z,db,sb,$a))}k=h;h=[]}if(!Ga&&a.Wv){wa=c(qa[0]);b.M.push(wa);var xb=K(wa);O.w(z,xb);O.n(z,k[0],xb,r[0])}if(La&&ya&&!Ga){for(V=0;V<qa.length;V++){var Qb=Xa.Oh,Oc=Xa.Jn,nb=Xa.mi,Na=k[V],Ec=la?1:0,Fb=A("DEPTH","u_input",1,1,!0);Fb.fa=T.u;Fb.ea=T.u;var lc=A("COLOR","u_input",1,.25,!0);lc.fa=T.u;lc.ea=T.u;var ec=Qb/nb,Fc=c(qa[V]);
b.M.push(Fc);var Gc=ca(Fc,Ec,Qb,!0,ec,sa,nb);O.w(z,Gc);O.n(z,Na,Gc,Fb);var ec=Qb/nb*.5,fb=c(qa[V]);b.M.push(fb);var Sa=ca(fb,Ec,Qb,!1,ec,sa,nb);O.w(z,Sa);O.n(z,Gc,Sa,lc);var ec=Qb/nb*.25,ad=c(qa[V]);b.M.push(ad);var fc=ca(ad,Ec,Qb,!1,ec,sa,nb);O.w(z,fc);O.n(z,Sa,fc,lc);var bd=S(Oc,sa);h.push(bd);O.w(z,bd);O.n(z,Na,bd,A("COLOR","u_main",1,1,!0));O.n(z,fc,bd,A("COLOR","u_god_rays",1,1,!0))}k=h;h=[]}if(Vc&&!Ga){for(V=0;V<qa.length;V++){var Na=k[V],jd=ea();O.w(z,jd);O.n(z,Na,jd,A("COLOR","u_input",1,
1,!0));var cd=fa();O.w(z,cd);cd.k.width=1;cd.k.height=1;var Wc=A("COLOR","u_input",1,.25,!0);Wc.fa=T.u;Wc.ea=T.u;var ob=A("COLOR","u_luminance",1,.25,!0);ob.fa=T.u;ob.ea=T.u;O.n(z,jd,cd,Wc);var tc=vb.key,vd=vb.py,qd=c(qa[V]);b.M.push(qd);var dd=ga(tc,vd,sa,qd);O.w(z,dd);O.n(z,Na,dd,A("COLOR","u_main",1,1,!0));O.n(z,jd,dd,ob);O.n(z,cd,dd,A("COLOR","u_average_lum",1,1,!1));var mc=A("COLOR","u_color",1,.25,!0);mc.fa=T.u;mc.ea=T.u;Pb=q("X_BLUR");O.w(z,Pb);O.n(z,dd,Pb,mc);Ya=q("Y_BLUR");O.w(z,Ya);O.n(z,
Pb,Ya,mc);var kd=B(vb.blur);O.w(z,kd);var ld=A("COLOR","u_bloom",1,.25,!0);ld.fa=T.u;ld.ea=T.u;O.n(z,Ya,kd,ld);O.n(z,Na,kd,A("COLOR","u_main",1,1,!0));h.push(kd)}k=h;h=[]}if(Bc&&!Ga){for(V=0;V<k.length;V++){var Xc=k[V],Pc=aa(yb.mb_decay_threshold,yb.mb_factor);h.push(Pc);O.w(z,Pc);O.n(z,Xc,Pc,A("COLOR","u_mb_tex_curr",1,1,!0));Pc.ma.push(A("COLOR","u_mb_tex_accum",1,1,!0))}k=h;h=[]}if(kb&&ya&&!Ga){for(V=0;V<k.length;V++){var Na=k[V],Hc=c(qa[V]);b.M.push(Hc);mc=A("COLOR","u_color",1,1,!0);mc.fa=T.u;
mc.ea=T.u;var uc=g("X_BLUR");O.w(z,uc);O.n(z,Na,uc,mc);var vc=g("Y_BLUR");O.w(z,vc);O.n(z,uc,vc,mc);var ab=Ma[V],Qc=R(Hc);Hc.dof_distance=b.dof_distance;Hc.ke=b.ke;Hc.dof_front=b.dof_front;Hc.dof_rear=b.dof_rear;Hc.dof_power=b.dof_power;Hc.dof_on=1;h.push(Qc);O.w(z,Qc);O.n(z,Na,Qc,A("COLOR","u_sharp",1,1,!0));O.n(z,vc,Qc,A("COLOR","u_blurred",1,1,!0));O.n(z,ab,Qc,A("DEPTH","u_depth",1,1,!0))}k=h;h=[]}if(!Ga&&a.outline){for(V=0;V<qa.length;V++){var Na=k[V],wd=c(qa[V]);b.M.push(wd);var md=W(wd);O.w(z,
md);var nd=g("X_EXTEND"),xd=A("COLOR","u_color",1,1,!0),yd=A("COLOR","u_outline_mask",1,1,!0);nd.qj=!0;O.w(z,nd);O.n(z,md,nd,xd);var od=A("COLOR","u_color",1,.5,!0);od.fa=T.u;od.ea=T.u;var Rc=g("Y_EXTEND");Rc.qj=!0;O.w(z,Rc);O.n(z,nd,Rc,od);uc=g("X_BLUR");uc.qj=!0;O.w(z,uc);O.n(z,Rc,uc,od);var pd=A("COLOR","u_color",1,.25,!0);pd.fa=T.u;pd.ea=T.u;var Yc=A("COLOR","u_outline_mask_blurred",1,.25,!0);Yc.fa=T.u;Yc.ea=T.u;vc=g("Y_BLUR");vc.qj=!0;O.w(z,vc);O.n(z,uc,vc,pd);var nc=ba(Fa);O.w(z,nc);O.n(z,Na,
nc,A("COLOR","u_outline_src",1,1,!0));O.n(z,md,nc,yd);O.n(z,vc,nc,Yc);h.push(nc)}k=h;h=[]}if(Ea&&!Ga){for(V=0;V<k.length;V++){var Na=k[V],Sc=Z(wb.brightness,wb.contrast,wb.exposure,wb.saturation);O.w(z,Sc);O.n(z,Na,Sc,A("COLOR","u_color",1,1,!0));h.push(Sc)}k=h;h=[]}if(Ia){for(V=0;V<k.length;V++)if(Na=k[V],Pa.smaa){var Jb=A("COLOR","u_color",1,1,!0);Jb.fa=T.u;Jb.ea=T.u;var Zc=P("SMAA_EDGE_DETECTION");O.w(z,Zc);O.n(z,Na,Zc,Jb);var $c=P("SMAA_BLENDING_WEIGHT_CALCULATION");O.w(z,$c);O.n(z,Zc,$c,Jb);
var gc=A("COLOR","u_search_tex",1,1,!1),rd=A("COLOR","u_area_tex",1,1,!1);gc.fa=T.u;gc.ea=T.u;rd.fa=T.u;rd.ea=T.u;$c.ma.push(gc);$c.ma.push(rd);var Tc=P("SMAA_NEIGHBORHOOD_BLENDING");O.w(z,Tc);O.n(z,Na,Tc,Jb);var wc=A("COLOR","u_blend",1,1,!0);wc.fa=T.u;wc.ea=T.u;O.n(z,$c,Tc,wc);h.push(Tc)}else{var xc=H();O.w(z,xc);var ed=A("COLOR","u_color",1,1,!0);ed.fa=T.u;ed.ea=T.u;O.n(z,Na,xc,ed);if(1<Pa.render_resolution_factor){var ma=g("NONE");O.w(z,ma);O.n(z,xc,ma,ed);h.push(ma)}else h.push(xc)}k=h;h=[]}if(a.anaglyph_use&&
!Ga){var Za=da();O.w(z,Za);O.n(z,k[0],Za,A("COLOR","u_sampler_left",1,1,!0));O.n(z,k[1],Za,A("COLOR","u_sampler_right",1,1,!0));h.push(Za)}else h.push(k[0]);var zd=O.Dg(z,k[0]);if("MOTION_BLUR"==k[0].type)var Ic=!0;else Ic=!1,O.Ge(z,zd,function(a,b,c){if(c.V==c.ua)return Ic=!0});if(Ic){var Ja=X();O.w(z,Ja);O.n(z,k[0],Ja,A("COLOR","u_color",1,1,!0));k=h;h=[];h.push(Ja)}Ra&&(qb?h.push(qb):h.push(Ra));xb&&h.push(xb);if(!Ga&&a.Hl.procedural_skydome){var pb=oa(sa,a.Hl);O.w(z,pb);h.push(pb)}var Jc=N();
O.w(z,Jc);for(V=0;V<h.length;V++){var tb=h[V];switch(tb.type){case "COLOR_PICKING":case "COLOR_PICKING_XRAY":O.n(z,tb,Jc,A("COLOR","NONE",1,1,!0));O.n(z,tb,Jc,A("DEPTH","NONE",1,1,!0));break;case "SKY":O.n(z,tb,Jc,A("CUBEMAP","u_sky",na.Dk,1,!1));break;case "ANCHOR_VISIBILITY":O.n(z,tb,Jc,A("COLOR","NONE",1,1,!0));break;default:if(Ga){var fd=e[0].l,oc=A("COLOR","OFFSCREEN",1,1,!0);oc.ya=fd;O.n(z,h[V],Jc,oc);for(za=1;za<e.length;za++){var gd=e[za].l,Ja=X();O.w(z,Ja);O.n(z,h[V],Ja,A("COLOR","u_color",
1,1,!0));oc=A("COLOR","OFFSCREEN",1,gd.Vg/fd.Vg,!0);oc.ya=gd;O.n(z,Ja,Jc,oc)}}else O.n(z,h[V],Jc,A("SCREEN","NONE",1,1,!0))}}if(Zb.enabled){var Uc=C(z);Uc&&D(z,Uc)}d(z,ya);1<Pa.render_resolution_factor&&m(z);l(z);w(z);if(Ab){for(V=0;V<bc.length;V++)x(z,bc[V]);for(V=0;V<Ma.length;V++)x(z,Ma[V]);for(V=0;V<Mb.length;V++)x(z,Mb[V])}return z};a.qF=t;a.Ic=function(a,b,c){var d=a.Fe;a.ap[0]=b*a.Na[0]*d;a.ap[1]=c*a.Na[1]*d};a.Vb=function(a,b){a.Fe=b};a.RE=function(a){var b=null;O.X(a,function(a,c){return c.k&&
null===c.k.ne?(b=c,!0):!1});return b};a.La=function(a,b,c){a=Y(a,b);for(b=0;b<a.length;b++)if(a[b].type===c)return a[b];return null};a.iF=ia;a.kF=ta;a.tz=Y;a.eF=ja;a.Ya=function(a,b){var c=null;O.X(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.ay=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=sa(a);O.X(a,function(a,d){var e=b+="    ",f="",f=d.type.replace(/_/g,
" ");"POSTPROCESSING"==d.type&&(f+=" ("+d.tl.replace(/_/g," ")+")");if(d.k){for(var f=f+"\\n",g=0;g<c.length;g+=2)c[g]==d.k.nb&&(f+="C"+c[g+1]+" ");for(g=0;g<c.length;g+=2)c[g]==d.k.Vc&&(f+="D"+c[g+1])}d.ma.length&&(f+="\\n-----\\n");for(g=0;g<d.ma.length;g++)f+=z(d.ma[g],c);g="SINK"==d.type?"dotted":d.enqueue?"solid":"dashed";b=e+(String(a)+' [label="'+f+'" color="black" style="'+(g+",bold")+'"];\n')});O.Pd(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+z(e,c)+'" style="'+
(e.Ua?"solid":"dotted")+'"];\n'});return b+="}"};a.Mx=function(a){a=O.EC(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.enqueue&&b.push(d)}return b}};b4w.module.__textures=function(a,p){function c(){return{name:"",type:0,source:"",Lo:"",width:0,height:0,Jm:1,ik:!0,Vg:1024,Yq:!1,ce:null,Ta:null,bi:null,ht:1,ze:0,ci:!1,Rl:!1,sg:!1,H:0,ra:0,Ah:0,kD:!1,Zg:!1,ho:0,hc:0,Wb:0,fb:null,Kf:null}}function d(d,e,f,g){var h=d.type,k=new Uint8Array([204,204,204,255]),l=c();switch(h){case "DATA_TEX2D":case "IMAGE":var m=q.createTexture(),n=q.TEXTURE_2D;q.bindTexture(n,m);q.texImage2D(n,0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,k);d.image&&"MOVIE"==d.image.source&&
(l.sg=!0,l.H=d.frame_start,l.ra=d.frame_offset,l.Ah=d.frame_duration,l.kD=d.use_auto_refresh,l.Zg=d.use_cyclic,l.ho=d.movie_length,0!=l.ra&&w.warn('Frame offset for texture "'+d.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));break;case "NONE":m=q.createTexture();n=q.TEXTURE_2D;q.bindTexture(n,m);if("NONE"==d.b4w_source_type)return null;if("SCENE"==d.b4w_source_type)if(d.b4w_source_id&&(f=G.keysearch("name",d.b4w_source_id,f)))l.Vg=d.b4w_source_size,f.yd=f.yd||
[],f.yd.push(d),q.texImage2D(n,0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,k);else return null;break;case "ENVIRONMENT_MAP":m=q.createTexture();n=q.TEXTURE_CUBE_MAP;q.bindTexture(n,m);f="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var r=0;6>r;r++)t.In?q.texImage2D(q["TEXTURE_CUBE_MAP_"+f[r]],0,q.RGB,1,1,0,q.RGB,q.UNSIGNED_BYTE,k):q.texImage2D(q["TEXTURE_CUBE_MAP_"+f[r]],0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,k);break;case "BLEND":return null;default:return w.error('texture "'+
d.name+'" has unsupported type "'+h+'"'),null}"NONE"==h&&(!d.b4w_enable_canvas_mipmapping||"CANVAS"!=d.b4w_source_type)||"DATA_TEX2D"==h||"IMAGE"==h&&"MOVIE"==d.image.source?q.texParameteri(n,q.TEXTURE_MIN_FILTER,q.LINEAR):t.In&&"ENVIRONMENT_MAP"==h?q.texParameteri(n,q.TEXTURE_MIN_FILTER,q.LINEAR):q.texParameteri(n,q.TEXTURE_MIN_FILTER,L[t.Kl]);q.texParameteri(n,q.TEXTURE_MAG_FILTER,q.LINEAR);k=n;f=d.b4w_anisotropic_filtering;"DEFAULT"===f&&(f=e);"OFF"!==f&&t.jk&&(e=D.fz())&&(f=parseFloat(f.split("x")[0]),
q.texParameterf(k,e.TEXTURE_MAX_ANISOTROPY_EXT,f));"REPEAT"!=d.extension||d.b4w_shore_dist_map?(q.texParameteri(n,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(n,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE)):(q.texParameteri(n,q.TEXTURE_WRAP_S,q.REPEAT),q.texParameteri(n,q.TEXTURE_WRAP_T,q.REPEAT));l.type=a.ih;l.width=1;l.height=1;l.fb=m;l.Wb=n;"CANVAS"==d.b4w_source_type&&"NONE"==h?(h=d.b4w_source_id,m=d.b4w_source_size,l.Yq=d.b4w_enable_canvas_mipmapping,l.Lo=h,l.source="CANVAS",n=document.createElement("canvas"),
n.width=m,n.height=m,l.ce=n.getContext("2d"),g in u||(u[g]={}),u[g][h]=l,b(l)):"SCENE"==d.b4w_source_type&&"NONE"==h?(l.Lo=d.b4w_source_id,l.source="SCENE"):(l.source=h,q.generateMipmap(n),q.bindTexture(n,null));l.name=d.name;return d.l=l}function b(a){if("CANVAS"!=a.source)throw"Wrong texture";var b=a.Wb;q.bindTexture(b,a.fb);var c=h(a),d=n(a),e=a.ce.canvas;q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,!0);q.texImage2D(b,0,c,c,d,e);q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,!1);a.Yq&&q.generateMipmap(b);q.bindTexture(b,
null);a.width=e.width;a.height=e.height}function e(a){var b=a.Wb;q.bindTexture(b,a.fb);q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,!0);q.texImage2D(b,0,q.RGBA,q.RGBA,q.UNSIGNED_BYTE,a.bi[a.ze]);q.bindTexture(b,null)}function l(a){q.texParameteri(a,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE);q.texParameteri(a,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE);q.texParameteri(a,q.TEXTURE_MAG_FILTER,q.LINEAR);q.texParameteri(a,q.TEXTURE_MIN_FILTER,q.LINEAR)}function m(a,b){var c=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384];
return-1==c.indexOf(a)||-1==c.indexOf(b)}function h(b){switch(b.type){case a.ih:b=q.RGBA;break;case a.Yl:b=q.RGB;break;case a.dk:b=q.RGBA;break;case a.ek:b=q.RGB;break;case a.Ci:b=q.DEPTH_COMPONENT;break;default:throw"Wrong texture type";}return b}function n(b){switch(b.type){case a.ih:b=q.UNSIGNED_BYTE;break;case a.Yl:b=q.UNSIGNED_BYTE;break;case a.dk:b=q.FLOAT;break;case a.ek:b=q.FLOAT;break;case a.Ci:b=q.UNSIGNED_INT;break;default:throw"Wrong texture type";}return b}function f(a,b){return b in
g&&a in g[b]?(t.cd?g[b][a].ci=!0:g[b][a].Ta.play(),!0):null}function k(a,b){if(b in g&&a in g[b]){var c=g[b][a];t.cd?(c.ze=c.ra,e(c),c.ze++):c.Ta.currentTime=c.ra/c.hc;return!0}return null}function r(a,b){return b in g&&a in g[b]?(t.cd?g[b][a].ci=!1:g[b][a].Ta.pause(),!0):null}var y=p("__config"),w=p("__print"),C=p("__dds"),D=p("__extensions"),G=p("__util"),t=y.r,A=y.Zd,x=y.o;a.sc=0;a.u=0;a.Kv=0;a.Iv=0;a.Jv=0;a.Hv=0;a.ih=10;a.Yl=20;a.dk=30;a.ek=40;a.Ci=50;a.hh=60;var u={},g={},q=null,L;a.td=function(b){L=
[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.sc=b.NEAREST;a.u=b.LINEAR;a.Kv=b.NEAREST_MIPMAP_NEAREST;a.Iv=b.LINEAR_MIPMAP_NEAREST;a.Jv=b.NEAREST_MIPMAP_LINEAR;a.Hv=b.LINEAR_MIPMAP_LINEAR;q=b};a.jz=function(a,b){return b in u&&a in u[b]?u[b][a].ce:null};a.VC=function(a,c){return c in u&&a in u[c]?(b(u[c][a]),!0):!1};a.Ck=function(b,d){var e=c();e.name=b;e.type=d;e.source="NONE";if(d==a.hh)e.Kf=q.createRenderbuffer();else{var f=q.TEXTURE_2D,g=q.createTexture();
q.bindTexture(f,g);q.texParameteri(f,q.TEXTURE_MAG_FILTER,q.LINEAR);q.texParameteri(f,q.TEXTURE_MIN_FILTER,q.LINEAR);q.texParameteri(f,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE);q.texParameteri(f,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE);q.bindTexture(f,null);e.Wb=f;e.fb=g}return e};a.zx=function(b){var d=q.createTexture(),e=q.TEXTURE_CUBE_MAP;q.bindTexture(e,d);q.texParameteri(e,q.TEXTURE_MAG_FILTER,q.LINEAR);q.texParameteri(e,q.TEXTURE_MIN_FILTER,q.LINEAR);q.texParameteri(e,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE);q.texParameteri(e,
q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE);for(var f="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),g=0;6>g;g++)q.texImage2D(q[f[g]],0,q.RGBA,b,b,0,q.RGBA,q.UNSIGNED_BYTE,null);q.bindTexture(e,null);e=c();e.name="CUBEMAP";e.type=a.ih;e.source="NONE";e.width=3*b;e.height=2*b;e.Jm=1;e.fb=d;e.Wb=q.TEXTURE_CUBE_MAP;return e};a.Kj=function(b,c,d){if(b.type!=a.hh){var e=b.Wb;q.bindTexture(e,
b.fb);c&&q.texParameteri(e,q.TEXTURE_MIN_FILTER,c);d&&q.texParameteri(e,q.TEXTURE_MAG_FILTER,d);q.bindTexture(e,null)}};a.dF=function(b){if(b.type==a.hh)return{min:a.sc,rA:a.sc};var c=b.Wb;q.bindTexture(c,b.fb);b=q.getTexParameter(c,q.TEXTURE_MIN_FILTER);var d=q.getTexParameter(c,q.TEXTURE_MAG_FILTER);q.bindTexture(c,null);return{min:b,rA:d}};a.resize=function(b,c,d){c=Math.max(c,1);d=Math.max(d,1);if(b.width!=c||b.height!=d){if(b.type==a.hh)q.bindRenderbuffer(q.RENDERBUFFER,b.Kf),q.renderbufferStorage(q.RENDERBUFFER,
q.DEPTH_COMPONENT16,c,d),q.bindRenderbuffer(q.RENDERBUFFER,null);else{var e=b.Wb;q.bindTexture(e,b.fb);var f=h(b),g=n(b);q.texImage2D(e,0,f,c,d,0,f,g,null);q.bindTexture(e,null)}c>t.Sb||d>t.Sb?w.error('Slink texture "'+b.name+'" has unsupported size: '+c+"x"+d+". Max available: "+t.Sb+"x"+t.Sb+"."):(b.width=c,b.height=d)}};a.Tx=d;a.hD=function(a){var b=a.Wb;q.bindTexture(b,a.fb);q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Ta.length?q.texImage2D(b,0,q.RGBA,q.RGBA,q.UNSIGNED_BYTE,a.Ta):q.texImage2D(b,
0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,a.Ta);q.bindTexture(b,null)};a.eD=e;a.Sj=function(a,b,c,d,e){var f=a.source,h=a.Wb;q.bindTexture(h,a.fb);if(4==b.length){var k=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==f)if(k)q.texImage2D(h,0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(c){c=C.Br(b);if(c.width>t.Sb||c.height>t.Sb){w.error('Texture "'+d+'" has unsupported size: '+c.width+"x"+c.height+". Max available: "+t.Sb+"x"+t.Sb+".");return}C.jD(q,D.yr(),
b,!0);m(c.width,c.height)&&(a.dq||w.warn("using NPOT texture",d),l(h));a.width=c.width;a.height=c.height;a.Jm=C.lz(b)}else{q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,!0);if(b.width>t.Sb||b.height>t.Sb){w.error('Texture "'+d+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+t.Sb+"x"+t.Sb+".");return}a.sg?t.cd?b&&(e in g||(g[e]={}),g[e][a.name]=a,a.bi=b,a.hc=a.ho/b.length,a.Ah=Math.round(a.Ah/a.hc),a.ra=Math.round(a.ra/a.hc),a.H=Math.round(a.H/a.hc),a.ze=a.ra,q.texImage2D(h,0,q.RGBA,q.RGBA,
q.UNSIGNED_BYTE,a.bi[0])):(a.Ta=b,a.Ta.loop=a.Zg,b&&(e in g||(g[e]={}),g[e][a.name]=a),a.hc=A.Ra,b.duration&&(a.hc=a.ho/b.duration),x.Vq||(b.playbackRate=A.Ra/a.hc,x.yq&&2<b.playbackRate&&(b.playbackRate=2)),q.texImage2D(h,0,q.RGBA,q.RGBA,q.UNSIGNED_BYTE,a.Ta)):q.texImage2D(h,0,q.RGBA,q.RGBA,q.UNSIGNED_BYTE,b);a.sg?t.cd?(a.width=b[0].width,a.height=b[0].height):(a.width=b.videoWidth,a.height=b.videoHeight):(a.width=b.width,a.height=b.height);m(a.width,a.height)?(a.dq||(a.sg?w.warn("using NPOT video texture",
d):w.warn("using NPOT texture",d)),l(h)):a.sg||q.generateMipmap(h)}else if("ENVIRONMENT_MAP"==f)if(c=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],k){for(k=0;6>k;k++)e=c[k],q.texImage2D(q["TEXTURE_CUBE_MAP_"+e[0]],0,q.RGBA,1,1,0,q.RGBA,q.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,!1);f=b.width/3;if(f>t.Bg||f>t.Bg){w.warn('Cubemap texture "'+d+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+
3*t.Bg+"x"+2*t.Bg+". Reduced image size will be used.");var n=b.width/3*(t.Bg/f)}else n=f;for(k=0;6>k;k++){e=c[k];var r=document.createElement("canvas");r.width=n;r.height=n;var y=r.getContext("2d");"POSITIVE_Y"==e[0]||"NEGATIVE_Y"==e[0]?(y.translate(0,n),y.scale(1,-1)):(y.translate(n,0),y.scale(-1,1));y.drawImage(b,e[1]*f,e[2]*f,f,f,0,0,n,n);q.texImage2D(q["TEXTURE_CUBE_MAP_"+e[0]],0,q.RGBA,q.RGBA,q.UNSIGNED_BYTE,r)}a.width=3*n;a.height=2*n;m(b.width/3,b.height/2)?(w.warn("using NPOT cube map texture",
d),l(h)):q.generateMipmap(h)}else"DATA_TEX2D"==f&&(q.texImage2D(h,0,q.RGBA,b.width,b.height,0,q.RGBA,q.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);q.bindTexture(h,null)};a.iy=function(a){q.deleteTexture(a)};a.sj=function(a){return a&&a.name&&(a.fb||a.Kf)?!0:!1};a.Xr=function(a){return a&&a.name&&a.Kf?!0:!1};a.vF=function(b){return b.type==a.dk||b.type==a.ek?!0:!1};a.Bz=function(b){var c=0;switch(b.type){case a.ih:case a.Yl:c=4;break;case a.dk:case a.ek:c=16;break;case a.Ci:c=3;break;
case a.hh:c=2}return c};a.bz=function(a){var b=null,b={name:"special_ssao_texture",type:"DATA_TEX2D",extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};d(b,null,a,0);b.image={filepath:null};return b};a.cleanup=function(){if(!t.cd)for(var a in g)for(var b in g[a])g[a][b].Ta.pause(),g[a][b].Ta.src="",g[a][b].Ta.load();u={};g={}};a.play_video=f;a.reset_video=k;a.pause_video=r;a.pause=function(){for(var a in g)for(var b in g[a])t.cd&&!g[a][b].ci||!t.cd&&g[a][b].Ta.paused||(r(b,a),g[a][b].Rl=!0)};a.reset=
function(){for(var a in g)for(var b in g[a])k(b,a),g[a][b].Rl=!1};a.play=function(a){for(var b in g)for(var c in g[b])if(!a||g[b][c].Rl)f(c,b),g[b][c].Rl=!1}};b4w.module.__assets=function(a,p){function c(){return C.Wz()?p(C.bc.tk).data:null}function d(){var a={fk:null,Sv:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.fk=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=c();b&&a.fk in b&&(a.status=200,b[a.fk]&&(a.response=a.Sv(b[a.fk])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var g=b[d];20===g.state&&c++;if(c>=u.xA)break;if(10===g.state)switch(g.state=20,c++,g.type){case a.AT_ARRAYBUFFER:e(g,"arraybuffer");break;case a.AT_JSON:e(g,"json");break;case a.AT_TEXT:e(g,"text");break;case a.AT_AUDIOBUFFER:l(g);break;case a.AT_IMAGE_ELEMENT:m(g);
break;case a.AT_AUDIO_ELEMENT:h(g);break;case a.$j:n(g);break;case a.Zj:f(g);break;default:t.ha("Wrong asset type: "+g.type)}}}function e(a,b){var e=c(),f=e&&a.t in e?new d:new XMLHttpRequest;f.open("GET",a.t,!0);"text"==b?(f.overrideMimeType("text/plain"),f.responseType="text"):"json"==b?(f.overrideMimeType("application/json"),f.responseType="text"):f.responseType=b;f.onreadystatechange=function(){if(40!=a.state&&4==f.readyState){if(200==f.status||0==f.status){var c=f.response;if(c){if("json"==b&&
"string"==typeof c)try{c=JSON.parse(c)}catch(d){D.error(d+" (parsing JSON "+a.t+")");a.qb(null,a.uri,a.type,a.t,a.vb);return}a.qb(c,a.uri,a.type,a.t,a.vb)}else D.error("empty responce when trying to get "+a.t),a.qb(null,a.uri,a.type,a.t,a.vb)}else D.error(f.status+" when trying to get "+a.t),a.qb(null,a.uri,a.type,a.t,a.vb);a.state=30}};f.addEventListener("progress",function(b){b.lengthComputable&&a.Ss(b.loaded/b.total)},!1);f.send(null)}function l(a){var b=c(),e=b&&a.t in b?new d:new XMLHttpRequest;
e.open("GET",a.t,!0);e.responseType="arraybuffer";e.onreadystatechange=function(){if(40!=a.state&&4==e.readyState)if(200==e.status||0==e.status){var b=e.response;b?G.dy(b,function(b){a.qb(b,a.uri,a.type,a.t,a.vb);a.state=30},function(){a.qb(null,a.uri,a.type,a.t,a.vb);D.error("failed to decode "+a.t);a.state=30}):(a.qb(null,a.uri,a.type,a.t,a.vb),D.error("empty responce when trying to get "+a.t),a.state=30)}else a.qb(null,a.uri,a.type,a.t,a.vb),D.error(e.status+" when trying to get "+a.t),a.state=
30};e.send(null)}function m(a){var b=document.createElement("img");g.allow_cors&&(b.crossOrigin="Anonymous");b.onload=function(){40!=a.state&&(a.qb(b,a.uri,a.type,a.t,a.vb),a.state=30)};b.addEventListener("error",function(){40!=a.state&&(a.qb(null,a.uri,a.type,a.t,a.vb),D.error("could not load image: "+a.t),a.state=30)},!1);var d=c();if(d&&a.t in d)if(d[a.t]){var e=r(a.t);b.src="data:"+e+";base64,"+d[a.t]}else x.Ln()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=
new CustomEvent("error"),b.dispatchEvent(d);else b.src=a.t}function h(a){var b=document.createElement("audio");if(g.allow_cors||g.Hq)b.crossOrigin="Anonymous";b.addEventListener("loadeddata",function(){40!=a.state&&(a.qb(b,a.uri,a.type,a.t,a.vb),a.state=30)},!1);b.addEventListener("error",function(){40!=a.state&&(a.qb(null,a.uri,a.type,a.t,a.vb),D.error("could not load sound: "+a.t),a.state=30)},!1);var d=c();if(d&&a.t in d)if(d[a.t]){var e=y(a.t);b.src="data:"+e+";base64,"+d[a.t];40!=a.state&&(a.qb(b,
a.uri,a.type,a.t,a.vb),a.state=30)}else x.Ln()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),b.dispatchEvent(d);else b.src=a.t,g.rg&&b.load();g.fo&&(b.autoplay=!0,b.pause());setTimeout(function(){b.cC=1},5E3)}function n(a){function b(){40!=a.state&&(a.qb(null,a.uri,a.type,a.t),D.error("could not load video: "+a.t,a.vb),a.state=30)}var d=document.createElement("video");d.muted=!0;if(g.allow_cors||g.rg)d.crossOrigin="Anonymous";d.addEventListener("loadeddata",
function(){d.removeEventListener("error",b,!1);40!=a.state&&(a.qb(d,a.uri,a.type,a.t,a.vb),a.state=30)},!1);d.addEventListener("error",b,!1);var e=c();if(e&&a.t in e)if(e[a.t]){var f=w(a.t);d.src="data:"+f+";base64,"+e[a.t];40!=a.state&&d.addEventListener("loadeddata",function(){a.qb(d,a.uri,a.type,a.t,a.vb);a.state=30},!1)}else x.Ln()?(e=document.createEvent("CustomEvent"),e.initCustomEvent("error",!1,!1,null)):e=new CustomEvent("error"),d.dispatchEvent(e);else d.src=a.t,g.rg&&d.load();g.fo&&(d.autoplay=
!0,d.pause());setTimeout(function(){d.cC=1},1E4)}function f(a){function b(c){a.qb(c,a.uri,a.type,a.t,a.vb)}var e=c(),f=e&&a.t in e?new d:new XMLHttpRequest;f.open("GET",a.t,!0);f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=a.state&&4==f.readyState){if(200==f.status||0==f.status){var c=f.response;c?k(c,b):(a.qb(null,a.uri,a.type,a.t,a.vb),D.error("empty responce when trying to get "+a.t))}else a.qb(null,a.uri,a.type,a.t,a.vb),D.error(f.status+" when trying to get "+a.t);a.state=
30}};f.addEventListener("progress",function(b){b.lengthComputable&&a.Ss(b.loaded/b.total)},!1);f.send(null)}function k(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],hq:[],hc:c[4]},g=20,h=0;h<e;h++){var k=c[g/4],l=new Blob([d.subarray(g+4,g+4+k)],{type:"image/jpg"}),m=document.createElement("img");m.src=window.URL.createObjectURL(l);f.images.push(m);f.hq.push(l);g+=k+8-k%4}m.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.hq;
b(f)}}function r(a){var b="image";switch(t.sn(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function y(a){var b="audio";switch(t.sn(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function w(a){var b="video";switch(t.sn(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var C=p("__config"),D=p("__print"),
G=p("__sfx"),t=p("__util"),A=p("__version"),x=p("__compat"),u=C.$d,g=C.r;a.AT_ARRAYBUFFER=10;a.AT_JSON=20;a.AT_TEXT=30;a.AT_AUDIOBUFFER=40;a.AT_IMAGE_ELEMENT=50;a.AT_AUDIO_ELEMENT=60;a.$j=70;a.Zj=80;var q=[],L=0,J={};a.Nj=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.gF=function(a){if(J[a])return J[a];var b=u.Qs?a+A.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==
c.status){b=c.responseText;if(b.length)return J[a]=b;t.ha("Error XHR: responce is empty, GET "+a)}else t.ha("Error XHR: "+c.status+", GET "+a)};a.cleanup=function(){for(var a=0;a<q.length;a++)q[a].state=40;q=[];L=0;J={}};a.enqueue=function(a,d,e,f){for(var g=0;g<a.length;g++){var h=a[g],h={uri:h[0],type:h[1],t:h[2],vb:h[3],state:10,qb:d||function(){},Hs:e||function(){},Ss:f||function(){},Is:L};if(u.Qs){var k=c();k&&h.t in k||(h.t+=A.timestamp())}q.push(h)}b(q);L++};a.update=function(){b(q);for(var a=
q,c=0,d=!0,e=0;e<a.length;e++){var f=a[e];f.Is===a[c].Is?30!==f.state&&(d=!1):(d&&(a[e-1].Hs(),d=e-c,a.splice(c,d),e-=d),c=e,d=30===a[e].state?!0:!1);e===a.length-1&&d&&(a[e].Hs(),a.splice(c))}}};b4w.module.__loader=function(a,p){function c(b,c,e,f){var h=t,k=C.create(),l;for(l in c){var m=d(c[l]);(f&&m.kb||!b&&m.wb)&&r(m);C.w(k,m)}for(l in c)for(m=c[l],m.name=l,b=0;b<m.J.length;b++)C.n(k,c[m.J[b]],m,null);c=d({name:"out",Sa:a.vu,ib:function(a,b,c,d,e){0===b.id&&(h.Qo=!0);w(b)||(b.status=2);b.ks(b.id,!0);e(b,c);D.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},lb:5});var n=[];if(e)for(e=C.Ar(k),b=0;b<e.length;b++)n.push(C.Za(k,e[b]));else C.X(k,function(a,b){b.gb||n.push(b)});C.w(k,
c);for(b=0;b<n.length;b++)c.J.push(n[b].name),C.n(k,n[b],c,null);return k}function d(a){a.gb=a.gb||!1;a.Sa||0===a.Sa||(a.Sa=a.xd);a.J=a.J||[];a.pj=a.pj||!1;a.Ho=a.Ho||!1;a.lb=a.lb||0;a.kb=a.kb||!1;a.wb=a.wb||!1;a.status=0;a.EF=0;a.Xn=0;a.Yf=a.Yf||null;return a}function b(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var f=b[e];C.Za(a.Ld,f).pj&&(C.Gf(a.Ld,f,function(d){var e=!0;C.Ge(a.Ld,d,function(a,b){if(!b.pj)return e=!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(e))}for(e=d.length-
1;0<=e;e--)b.splice(d[e],1);return c}function e(a){function c(b,d){var e=C.Za(a.Ld,b),f=C.Za(a.Ld,d),g=f.Sa-e.Sa;0==g&&(g=e.gb-f.gb);return g}var d=[],e=a.Ee,f=!1;do{var h=b(a,e);d.push.apply(d,e);0<h.length&&(f=!0);e=h}while(0<h.length);f&&d.sort(c);a.Ee=d;return a.Ee.length}function l(a,b,c){if(b.Ho)return b.pj=!0,h(a,b),!1;if(!b.ib&&!b.Ve&&!b.Mi)return h(a,b),!1;if(0==b.status&&(b.status++,b.ib))return b.ib(c,a,b,b.Yf,h,n),!0;if(1==b.status){if(b.Ve)return b.Ve(c,a,b,b.Yf,h,n),!0;b.status++}return 2==
b.status&&(b.status++,b.Mi)?(b.Mi(c,a,b,b.Yf,h,n),!0):!1}function m(a){if(0==a.Il)return 100;var b=0;C.X(a.Ld,function(c,d){a.do_not_load_resources&&d.kb||(b+=d.Xn*d.lb)});return G.trunc(100*b/a.Il)}function h(a,b){b.pj=!0;b.status=3;f(a,b,1)}function n(a,b,c){1>c?f(a,b,c):b.status++}function f(a,b,c){var d=t;if(b.ib||b.Ve||b.Mi)if(b.Xn=c,b=m(a),a.Qq!=b||1==c)a.Po(b,performance.now()-a.St),a.Qq=b,d.$n=!0}function k(a,b){var c=null;C.X(a.Ld,function(a,d){if(d.name==b)return c=d,1});return c}function r(a){a.Ho=
!0;a.Xn=1}function y(a){a.Po=null;a.Im=null;a.Ld=null;a.Ee=null}function w(a){return a&&(3==a.status||4==a.status)}var C=p("__graph"),D=p("__print"),G=p("__util");a.xd=0;a.Td=1;a.vu=2;var t=null;a.zr=function(){return t};a.Nx=function(){var a={Od:[],Rm:0,hk:0,Qo:!1,$n:!1};return t=a};a.Ux=function(a,b,d,e,f,h,k,l){var m=t,n={id:m.Od.length,status:0,t:b,fq:"",ks:d||function(){},Wn:l||!1,eG:h,St:0,Qq:0,Il:0,Bo:!1,Po:e||function(){},Im:f||function(){},Ld:null,Ee:null,Dn:!1,Cn:!1,Gn:!1};a=c(0===n.id,
a,h,k);n.Ld=a;b=[];d=C.zz(a);for(e=0;e<d.length;e++)b.push(d[e]);n.Ee=b;C.X(a,function(a,b){!(b.ib||b.Ve||b.Mi)||n.do_not_load_resources&&b.kb||(n.Il+=b.lb)});m.Od.push(n);m.hk++;return n.id};a.dD=function(b){var c=t;if(c&&0!=t.hk)if(c.$n)c.$n=!1;else{var d=performance.now();do{var f=c.Od[c.Rm],h=b[f.id];if(!w(f))if(0==f.status&&(f.status=1,f.St=performance.now(),f.Po(0,0)),e(f)){var k=f,m=k.Ee.length;do{var n=C.Za(k.Ld,k.Ee[0]),r=l(k,n,h);n.Sa==a.Td&&(k.Bo=!0);n=k.Ee.shift();k.Ee.push(n);m--}while(!r&&
0!=m)}else k=c,m=f,m.Im(h,m),m.status=3,k.hk--,y(m);c.Qo&&(c.Rm=(c.Rm+1)%c.Od.length);if(f.Bo){f.Bo=!1;break}}while(16>performance.now()-d)}};a.Lp=function(a){var b=t;a.Im(null,a);a.status=3;b.hk--;y(a);a.status=4;0===a.id&&(b.Qo=!0);a.ks(a.id,!1)};a.XF=n;a.st=function(a,b){var c=k(a,b);null!==c&&r(c)};a.DC=w;a.is_primary_loaded=function(a){var b=t;if(!b)return!1;a|=0;return b.Od[a]&&(3==b.Od[a].status||2==b.Od[a].status)};a.cleanup=function(){t=null}};b4w.module.__nla=function(a,p){function c(){return{type:"CLIP",H:0,R:0,ye:!1,paused:!1,Tf:"",Hi:"",Qb:0,Fi:0,Ei:0,ar:0,$q:0,ni:!1,fu:!1,scale:1,repeat:1}}function d(a,b){if(a.animation_data){var c=a.animation_data.nla_tracks;if(c)for(var e=0;e<c.length;e++)b.push(c[e])}c=a.nodes;for(e=0;e<c.length;e++){var f=c[e];f.node_group&&(f=f.node_group.node_tree)&&d(f,b)}}function b(a,b){for(var c=a.b4w_nla_script,d=b.vf,e=0;e<c.length;e++){var f=c[e];switch(f.type){case "PLAY":d.push({type:"PLAY",H:f.frame_range[0],
R:f.frame_range[1],hf:!1});break;case "SELECT":case "SELECT_PLAY":var g=A.Fd(A.Qf,f.object,0),h=A.yz(a),k=h.indexOf(g);if(-1==k){t.error("NLA script error: non-selectable object");return}for(var f={type:f.type,xt:"SELECT"==f.type?f.target_slot:e+1,$B:e+1,wf:-1,yB:h.length,xB:k,H:f.frame_range[0],R:f.frame_range[1],hf:!1},k=[],l=0;l<h.length;l++)k.push(D.create_selection_sensor(h[l],!0));D.create_sensor_manifold(g,"NLA_SELECT_"+e,D.CT_SHOT,k,D.ey,function(a,c,d,e){if(!(b.Jb>=b.vf.length)&&(d=b.vf[b.Jb],
"SELECT"==d.type||"SELECT_PLAY"==d.type&&!d.hf)){for(d=0;d<e.yB;d++)if(D.get_sensor_value(a,c,d)&&d==e.xB){e.wf=1;return}e.wf=0}},f);d.push(f);break;case "JUMP":d.push({type:"JUMP",Jo:f.target_slot});break;case "CONDJUMP":d.push({type:"CONDJUMP",Jo:f.target_slot,nx:f.condition,Hj:f.register1,Ij:f.register2,mo:f.number1,no:f.number2});break;case "REGSTORE":d.push({type:"REGSTORE",dB:f.registerd,HA:f.number1});break;case "MATH":d.push({type:"MATH",JA:f.operation,Hj:f.register1,Ij:f.register2,mo:f.number1,
no:f.number2,Zh:f.registerd});break;case "SHOW":case "HIDE":g=A.Fd(A.Qf,f.object,0);d.push({type:f.type,obj:g});break;case "REDIRECT":d.push({type:"REDIRECT",url:f.url});break;case "PAGEPARAM":d.push({type:"PAGEPARAM",LA:f.param_name,Zh:f.registerd});break;case "NOOP":d.push({type:"NOOP"})}}}function e(a,b,c,d){if(a.vf.length){if(a.Jb>=a.vf.length)if(a.cyclic)a.Jb=0;else{a.ra-=L.Ra*c;return}var f=m(a,b,!1,d),g=a.vf[a.Jb];switch(g.type){case "PLAY":g.hf?f>=g.R&&(g.hf=!1,a.Jb++,e(a,b,c,d)):(a.ra+=g.H-
f,g.hf=!0,l(a,g));break;case "SELECT":case "SELECT_PLAY":-1<g.wf?"SELECT"==g.type||"SELECT_PLAY"==g.type&&0==g.wf?(a.Jb=g.wf?g.xt:g.$B,g.wf=-1,e(a,b,c,d)):g.hf?f>=g.R&&(g.hf=!1,a.Jb=g.xt,g.wf=-1,e(a,b,c,d)):(a.ra+=g.H-f,g.hf=!0,l(a,g)):a.ra-=L.Ra*c;break;case "JUMP":a.Jb=g.Jo;e(a,b,c,d);break;case "CONDJUMP":var f=-1==g.Hj?g.mo:a.Id[g.Hj],h=-1==g.Ij?g.no:a.Id[g.Ij],k=!1;switch(g.nx){case "EQUAL":f==h&&(k=!0);break;case "NOTEQUAL":f!=h&&(k=!0);break;case "LESS":f<h&&(k=!0);break;case "GREATER":f>h&&
(k=!0);break;case "LEQUAL":f<=h&&(k=!0);break;case "GEQUAL":f>=h&&(k=!0)}k?a.Jb=g.Jo:a.Jb++;e(a,b,c,d);break;case "REGSTORE":a.Id[g.dB]=g.HA;a.Jb++;e(a,b,c,d);break;case "MATH":f=-1==g.Hj?g.mo:a.Id[g.Hj];h=-1==g.Ij?g.no:a.Id[g.Ij];switch(g.JA){case "ADD":a.Id[g.Zh]=f+h;break;case "MUL":a.Id[g.Zh]=f*h;break;case "SUB":a.Id[g.Zh]=f-h;break;case "DIV":0==h&&u.ha("Division by zero in NLA script"),a.Id[g.Zh]=f/h}a.Jb++;e(a,b,c,d);break;case "SHOW":A.show_object(g.obj);a.Jb++;e(a,b,c,d);break;case "HIDE":A.hide_object(g.obj);
a.Jb++;e(a,b,c,d);break;case "REDIRECT":window.location.href=g.url;a.vf.length=0;break;case "PAGEPARAM":a:{f=location.href.toString();if(-1!=f.indexOf("?"))for(f=f.split("?")[1].split("&"),h=0;h<f.length;h++)if(k=f[h].split("="),1<k.length&&k[0]==g.LA){f=Number(k[1]);break a}f=0}a.Id[g.Zh]=f;a.Jb++;e(a,b,c,d);break;case "NOOP":a.Jb++,e(a,b,c,d)}}}function l(a,b){for(var c=a.vf,d=0;d<c.length;d++){var e=c[d];e!=b&&(e.wf=-1)}}function m(a,b,c,d){b=(b-d)*L.Ra+a.ra-a.H;a.cyclic&&c&&(b%=a.R-a.H+1);return b+=
a.H}function h(a,b){a=u.clamp(a,b.H,b.R);var c=a-b.H,d=(b.R-b.H)/b.repeat,c=c/d&&0==c%d?b.Ei:b.Fi+c%d/b.scale;b.fu&&(c=b.Ei-c+b.Fi);return c}function n(a,b,c){b?q.pause_video(a.name,c):(q.reset_video(a.name,c),q.play_video(a.name,c))}function f(a,b){for(var d=[],e=0;e<a.length;e++){var f=a[e].strips;if(f)for(var g=0;g<f.length;g++){var h=f[g],k=c();k.type=h.type;k.H=h.frame_start;k.R=h.frame_end;k.Qb=b;k.Fi=h.action_frame_start;k.Ei=h.action_frame_end;k.fu=h.use_reverse;k.scale=h.scale;k.repeat=h.repeat;
h.action&&(k.Tf=h.action.name,k.Hi=h.action.uuid);d.push(k)}}return d}function k(a){return x.re(a)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function r(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}function y(a,b){var c=A.get_active();
c.na&&(c.na.ra-=m(c.na,b,!0,M)-a,c.na.ln=!0)}var w=p("__animation"),C=p("__camera"),D=p("__controls"),G=p("__config");p("__loader");var t=p("__print"),A=p("__scenes"),x=p("__sfx"),u=p("__util"),g=p("__lights"),q=p("__textures"),L=G.Zd,J=G.r,E=[],M=-1;a.cD=function(a,e,h){e={H:a.frame_start,R:a.frame_end,ra:0,tj:-1,yl:a.frame_end,xo:a.frame_start,ui:null,Xb:h,cyclic:e,xe:[],S:[],vf:[],rj:!1,ln:!1,QF:a.name,Jb:0,Id:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}};a.na=e;b(a,e);for(var l=A.$a(a,"ALL",A.DATA_ID_ALL),
m=0;m<l.length;m++){var n=l[m],r=0,q=[];if((h=n.animation_data)&&h.nla_tracks.length){var y=h.nla_tracks;if(u.is_armature(n)||C.is_camera(n)||u.is_mesh(n)||u.Yk(n)||g.al(n)||x.re(n))y=f(y,r),y.length&&(q=q.concat(y),r++)}k(n)&&(y=n.data.animation_data.nla_tracks,y=f(y,r),y.length&&(q=q.concat(y),r++));if(w.Kz(n)){var p=n.data.materials;for(h=0;h<p.length;h++){var D=p[h].node_tree;if(D&&(y=[],d(D,y),y=f(y,r),y.length)){for(var D=r,G=y,L=w.or(),M=[],oa=0,X=0;X<G.length;X++){var da=G[X];""!=da.Hi?da=
u.keysearch("uuid",da.Hi,L):(da=da.Tf,da=u.keysearch("name",da,L)||u.keysearch("name",da+"_B4W_BAKED",L));if(da){var da=da.fcurves,ea=[],fa;for(fa in da)ea.push(fa);M.push(ea)}}for(X=0;X<M.length;X++){L=!1;for(da=0;da<X;da++)if(u.tw(M[X],M[da])){G[X].Qb=G[da].Qb;L=!0;break}L||(G[X].Qb=r+oa++)}r=D+oa;q=q.concat(y)}}}for(h=0;h<n.particle_systems.length;h++)y=n.particle_systems[h],p=y.settings,"EMITTER"==p.type&&p.b4w_allow_nla&&(p=c(),p.type="CLIP",p.H=e.H,p.R=e.R+1,p.Tf=y.name,p.Qb=r,p.Fi=p.H,p.Ei=
p.R,q.push(p),r++);y=r+1;for(h=0;h<n.c.Ob.length;h++)D=n.c.Ob[h],D.Vv&&(r=y,p=c(),p.type="CLIP",p.H=e.H,p.R=e.R+1,p.Tf=D.name,p.Qb=r,p.Fi=p.H,p.Ei=p.R,q.push(p));q.length&&(n.Zl=q,e.xe.push(n))}a=a.l.vi;for(h=0;h<a.length;h++)if(fa=a[h].l,fa.Ta||fa.bi)p=c(),p.type="VIDEO",l=1,J.cd&&(l=fa.hc),p.H=Math.min(fa.H*l,e.R),p.R=fa.Zg?e.R:Math.min((fa.Ah+fa.H+fa.ra)*l,e.R),p.Tf=a[h].name,fa.Qv=p,e.S.push(fa);a=e.H;h=e.R;for(fa=0;fa<e.xe.length;fa++)for(l=e.xe[fa],m=l.Zl,n=0;n<m.length;n++)q=m[n],p=l.name+
" ["+q.H+":"+q.R+"]",q.H=Math.max(a,q.H),q.R=Math.min(h+1,q.R),q.H>q.R?(t.warn("NLA: out of scene range: "+p),m.splice(n,1),n--):q.Tf||"CLIP"!=q.type||(t.warn('NLA: no action in strip for object "'+l.name+'".'),m.splice(n,1),n--);for(a=0;a<e.xe.length;a++)for(h=e.xe[a].Zl,fa=0;fa<h.length;fa++){l=h[fa];m=e.H;n=e.R+1;for(q=0;q<h.length;q++)p=h[q],l.Qb==p.Qb&&(p.R<=l.H&&(m=l.H),p.H>=l.R&&(n=Math.min(n,p.H)));l.ar=m;l.$q=n}E.push(e)};a.start=function(){M=0};a.update=function(a,b){if(!(0>M)){0==M&&(M=
a);for(var c=0;c<E.length;c++){var d=E[c];if(d.rj&&(d.ra-=L.Ra*b,!d.ln))continue;d.ln=!1;e(d,a,b,M);var f=m(d,a,!0,M);if(f>=d.yl)if(d.cyclic)d.ui&&d.ui(),y(d.xo,a),f=m(d,a,!0,M);else{d.rj=!0;d.ra-=f-d.yl;d.ui&&d.ui();continue}for(var g=0;g<d.xe.length;g++){for(var k=d.xe[g],l=k.Zl,r=0;r<l.length;r++){var q=l[r];"SOUND"==q.type&&f<d.tj-1E-6&&(q.ye=!1)}for(r=0;r<l.length;r++)switch(q=l[r],q.type){case "CLIP":if(q.ar<=f&&f<q.$q&&!q.ye){var t=k,u=q;""!=u.Hi?w.mw(t,u.Hi,u.Qb):w.apply(t,u.Tf,u.Qb);w.set_behavior(t,
w.AB_FINISH_STOP,u.Qb);var p=h(u.H,u);w.set_frame(t,p,u.Qb);for(t=0;t<l.length;t++)l[t]!=q&&l[t].Qb==q.Qb&&(l[t].ye=!1);q.ye=!0}q.ye&&(t=k,u=h(f,q),p=w.get_current_frame_float(t,q.Qb),1E-6<Math.abs(u-p)&&w.set_frame(t,u,q.Qb));break;case "SOUND":(f<d.tj-1E-6||d.tj<q.H)&&q.H<=f&&f<q.R&&!q.ye&&(x.play(k,(q.H-f)/L.Ra,(q.R-q.H)/L.Ra),q.ye=!0),d.tj<q.R&&q.R<=f&&q.ye&&(q.ye=!1)}}for(g=0;g<d.S.length;g++)q=d.S[g].Qv,q.H<=Math.round(f)&&Math.round(f)<q.R&&!q.ni&&(n(d.S[g],q.ni,d.Xb),q.ni=!0),q.R<=Math.round(f)&&
q.ni&&(n(d.S[g],q.ni,d.Xb),q.ni=!1);d.tj=f}}};a.cleanup=function(){E.length=0;M=-1};a.Mr=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||k(a)||r(a)?!0:!1};a.set_frame=y;a.get_frame=function(a){var b=A.get_active();return b.na?m(b.na,a,!0,M):-1};a.sC=function(){var a=A.get_active();a.na&&(a.na.rj=!0)};a.SA=function(a){var b=A.get_active();b.na&&(b.na.rj=!1,b.na.ui=a?a:null)};a.get_frame_start=function(){var a=A.get_active();return a.na?a.na.H:-1};a.get_frame_end=function(){var a=
A.get_active();return a.na?a.na.R:-1};a.is_play=function(){var a=A.get_active();return a.na?!a.na.rj:!1};a.check_nla=function(){var a=A.get_active();return a.na?a.b4w_use_nla:!1};a.check_nla_scripts=function(){var a=A.get_active();return a.na?0<a.b4w_nla_script.length:!1};a.set_range=function(a,b){var c=A.get_active();if(c.na)c.na.xo=a,c.na.yl=b;else return!1};a.reset_range=function(){var a=A.get_active();if(a.na)a=a.na,a.xo=a.H,a.yl=a.R;else return!1};a.set_cyclic=function(a){var b=A.get_active();
if(b.na)b.na.cyclic=a;else return!1};a.clear_callback=function(){var a=A.get_active();a.na&&(a.na.ui=null)}};b4w.module.__camera=function(a,p){function c(b){b=b.c.g;switch(b.Aa){case a.MS_TARGET_CONTROLS:b.Gh=W.dist(b.i,b.Tb);b.Hh=b.M[0].top;break;case a.MS_HOVER_CONTROLS:b.eb&&(b.Gh=W.dist(b.i,b.ac),b.Hh=b.M[0].top)}}function d(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),bb:new Float32Array([0,0,0,0]),Xa:new Float32Array([0,0,0,0])}}function b(b){switch(b){case "STATIC":return a.MS_STATIC;case "TARGET":return a.MS_TARGET_CONTROLS;
case "EYE":return a.MS_EYE_CONTROLS;case "HOVER":return a.MS_HOVER_CONTROLS;default:throw"Unknown move style";}}function e(b){var c={type:b,name:"",Cf:1,width:0,height:0,ne:null,nb:null,Vc:null,Ea:0,Ac:0,bb:0,Xa:0,left:0,right:0,top:0,bottom:0,cf:new Float32Array(3),dr:new Float32Array(3),quat:new Float32Array(4),va:new Float32Array(16),rE:new Float32Array(16),xa:new Float32Array(16),wi:new Float32Array(16),ZA:new Float32Array(16),Jd:new Float32Array(16),ot:new Float32Array(16),Rd:new Float32Array(16),
dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,ke:null,dof_on:0,Mk:d(),Pj:0,Md:0,cc:null,Si:null,Nm:null,Nq:new Float32Array(4),sl:new Float32Array(4)};if(b==a.zb)return c;switch(b){case a.Pb:n(c,40,.1,1E3);break;case a.Rc:n(c,2.5,.1,1E3);break;case a.Vd:break;case a.Le:break;case a.Rf:break;case a.Ab:case a.Gb:throw"Stereo camera may only be created from perspective one";default:throw"Unknown camera type";}return c}function l(b,c,d){if(b.type!=a.Ab&&b.type!=a.Gb)throw"set_stereo_params(): wrong camera type";
b.Pj=c;b.Md=d;g(b,b.Ea);if(aa.ia())for(c=aa.get_active(),b=c.l.Ae,c=aa.kj(c).c.g.M,d=0;d<c.length;d++)K(c[d],b)}function m(a,b){return h(a.c.g.quat,b)}function h(a,b){var c=R.quat_to_dir(a,R.AXIS_Y,ea),d=R.quat_to_dir(a,R.AXIS_Z,fa),e=-Math.asin(c[1]/W.length(c)),c=Math.abs(e)>Math.PI/4?W.scale(d,-R.sign(e),ga):W.scale(c,-R.sign(d[1]),ga),f=Math.atan(Math.abs(c[0]/c[2]));0<d[1]&&(e=R.sign(e)*Math.PI-e);d=f;0>c[2]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=e;return b}function n(b,c,d,e,f){switch(b.type){case a.Pb:case a.Ab:case a.Gb:b.Ac=
c;b.Ea=1;break;case a.Rc:b.top=c;b.Ea=1;break;case a.Vd:delete b.Ac;b.Ac=c;b.Ea=f/c;break;case a.Le:b.top=c;b.Ea=f/c;break;default:Z.error("set_frustum(): Unsupported camera type: "+b.type)}b.bb=d;b.Xa=e}function f(b,c){var d=c.c.g.i,e=c.c.g.quat,f=ja;S.rotateX(c.c.g.Z,-Math.PI/2,f);S.invert(f,b.va);if(b.cc){var f=b.cc[0],h=b.cc[1],k=b.cc[2],l=b.cc[3],m=ja;m[0]=1-2*f*f;m[1]=-2*f*h;m[2]=-2*f*k;m[3]=0;m[4]=-2*f*h;m[5]=1-2*h*h;m[6]=-2*h*k;m[7]=0;m[8]=-2*f*k;m[9]=-2*h*k;m[10]=1-2*k*k;m[11]=0;m[12]=-2*
f*l;m[13]=-2*h*l;m[14]=-2*k*l;m[15]=1;S.multiply(b.va,m,b.va);g(b,b.Ea,!0);f=ia;h=ja;S.invert(b.va,h);S.transpose(h,h);ba.transformMat4(b.cc,h,f);h=ta;h[0]=(R.sign(f[0])+b.xa[8])/b.xa[0];h[1]=(R.sign(f[1])+b.xa[9])/b.xa[5];h[2]=-1;h[3]=(1+b.xa[10])/b.xa[14];ba.scale(f,2/(f[0]*h[0]+f[1]*h[1]+f[2]*h[2]+f[3]*h[3]),f);b.xa[2]=f[0];b.xa[6]=f[1];b.xa[10]=f[2]+1;b.xa[14]=f[3]}b.type==a.Ab?b.va[12]+=b.Md/2:b.type==a.Gb&&(b.va[12]-=b.Md/2);S.multiply(b.xa,b.va,b.Rd);L(b);q(b);W.copy(b.cf,b.dr);W.copy(d,b.cf);
U.copy(e,b.quat)}function k(b,c,d,e){S.lookAt(c,d,e,b.va);b.type==a.Ab?b.va[12]+=b.Md/2:b.type==a.Gb&&(b.va[12]-=b.Md/2);S.multiply(b.xa,b.va,b.Rd);L(b);q(b);W.copy(c,b.cf)}function r(a){var b=a.c.g.M;if(!b)throw"Wrong object";for(var c=a.c.g,d=0;d<b.length;d++){var e=b[d];f(e,a);R.dn(e.Rd,e.Mk);if(e.ke)if(e.dof_on){var g=W.dist(c.i,e.ke.location);e.dof_distance=g}else e.dof_distance=0}}function y(b){b=b.c.g;if(b.Aa==a.MS_TARGET_CONTROLS){var c=R.quat_to_dir(b.quat,R.AXIS_Z,ea);b.Zo=0<c[1]}}function w(b,
c){var d=b.c.g,e=d.$b;!e||d.Aa!=a.MS_EYE_CONTROLS&&d.Aa!=a.MS_TARGET_CONTROLS||(c&&(d=m(b,X),e.left+=d[0],e.right+=d[0]),e.left=R.angle_wrap_0_2pi(e.left),e.right=R.angle_wrap_0_2pi(e.right))}function C(b,c){var d=b.c.g,e=d.fc;!e||d.Aa!=a.MS_EYE_CONTROLS&&d.Aa!=a.MS_TARGET_CONTROLS||(c&&(d=m(b,X),e.cb+=d[1],e.Qa+=d[1]),e.cb=R.angle_wrap_periodic(e.cb,-Math.PI,Math.PI),e.Qa=R.angle_wrap_periodic(e.Qa,-Math.PI,Math.PI))}function D(b){var c=b.c.g;if(E(b)&&c.M[0].type===a.Rc){if(c.Aa===a.MS_TARGET_CONTROLS)var d=
W.dist(c.i,c.Tb),c=d/c.Gh*c.Hh;else c.eb&&c.Aa===a.MS_HOVER_CONTROLS?(d=W.distance(c.i,c.ac),c=d/c.Gh*c.Hh):c=b.c.g.M[0].top;for(var e in b.c.g.M)d=b.c.g.M[e],d.top=c,g(d,d.Ea);r(b)}}function G(a,b,c,d,e){var f=a.c.g,g=b,h=c;if(d||e)a=m(a,da),d&&(g=b-a[0]),e&&(h=c-a[1]);if(g||h)b=U.identity(B),g&&(g=U.setAxisAngle(R.AXIS_Y,g,N),U.multiply(b,g,b)),h&&(g=R.quat_to_dir(f.quat,R.AXIS_X,ea),h=U.setAxisAngle(g,h,N),U.normalize(h,h),U.multiply(b,h,b)),U.multiply(b,f.quat,f.quat)}function t(a,b,c,d,e){var f=
a.c.g,g=b,h=c;if(d||e){var k=m(a,da);d&&(g=b-k[0]);e&&(h=c-k[1])}x(a,a.c.g.Tb,g,h);a=m(a,da);a=R.angle_wrap_periodic(a[1],-Math.PI,Math.PI);f.Zo=Math.abs(a)>Math.PI/2}function A(a,b,c,d,e){var f=a.c.g,g=b,h=c;if(d||e){var k=m(a,da);d&&(g=b-k[0]);e&&(h=c-k[1])}f.Ym||(g=0);x(a,f.ac,g,h);h&&u(a)}function x(a,b,c,d){var e=a.c.g;if(c||d){var f=U.identity(B);c&&(c=U.setAxisAngle(R.AXIS_Y,c,N),U.multiply(f,c,f));a=M(a);d&&(!a||a&&e.eb)&&(a=R.quat_to_dir(e.quat,R.AXIS_X,ea),d=U.setAxisAngle(a,d,N),U.normalize(d,
d),U.multiply(f,d,f));R.pB(e.i,b,f,e.i);U.multiply(f,e.quat,e.quat)}}function u(a){var b=a.c.g;if(b.eb){var c=m(a,X)[1];a=a.c.g;a.Db.Qa-a.Db.cb?(c=(a.Db.Qa-c)/(a.Db.Qa-a.Db.cb),c=Math.max(c,0)):c=0;c=c*(a.eg-a.je)+a.je;a=R.quat_to_dir(b.quat,R.AXIS_MY,ea);W.normalize(a,a);W.scale(a,c,a);W.subtract(b.ac,a,b.i)}}function g(b,c,d){switch(b.type){case a.Pb:if(!c)throw"No aspect ratio";b.Ea=c;case a.Vd:S.perspective(R.wl(b.Ac),b.Ea,b.bb,b.Xa,b.xa);break;case a.Rc:if(!c)throw"No aspect ratio";b.Ea=c;case a.Le:c=
b.top*b.Ea;S.ortho(-c,c,-b.top,b.top,b.bb,b.Xa,b.xa);break;case a.Rf:S.ortho(b.left,b.right,b.bottom,b.top,b.bb,b.Xa,b.xa);break;case a.Ab:case a.Gb:if(!c)throw"No aspect ratio";b.Ea=c;var e=Math.tan(b.Ac*Math.PI/360);c=b.bb*e;var f=b.Ea*b.Pj*e;b.type==a.Ab?(e=f-b.Md/2,f+=b.Md/2):(e=f+b.Md/2,f-=b.Md/2);e=-(b.bb/b.Pj*e);f*=b.bb/b.Pj;S.frustum(e,f,-c,c,b.bb,b.Xa,b.xa);b.left=e;b.right=f;break;case a.zb:return;default:throw"Wrong camera type: "+b.type;}d||(S.multiply(b.xa,b.va,b.Rd),L(b),q(b))}function q(a){S.copy(a.va,
a.Jd);a.Jd[12]=0;a.Jd[13]=0;a.Jd[14]=0;a.Jd[15]=1;S.multiply(a.xa,a.Jd,a.Jd);S.invert(a.Jd,a.Jd)}function L(a){S.copy(a.va,a.wi);S.multiply(a.xa,a.wi,a.wi);S.invert(a.wi,a.wi)}function J(b,c,d,e,f){e||(e=new Float32Array(24));c||(c=b.bb);d||(d=b.Xa);var g,h,k,l,m,n,B,r;switch(b.type){case a.zb:throw"Extraction from NONE camera is not possible";case a.Pb:case a.Vd:g=c*Math.tan(b.Ac*Math.PI/360);l=-g;h=g*b.Ea;k=-h;m=d/c*g;r=-m;n=m*b.Ea;B=-n;break;case a.Rc:case a.Le:k=b.top*b.Ea;g=m=b.top;h=n=k;l=r=
-b.top;k=B=-k;break;case a.Rf:g=m=b.top;h=n=b.right;l=r=b.bottom;k=B=b.left;break;case a.Ab:case a.Gb:m=c/b.bb;g=c*Math.tan(b.Ac*Math.PI/360);l=-g;h=b.right*m;k=b.left*m;B=d/c;m=g*B;r=-m;n=h*B;B*=k;break;default:throw"Wrong camera type: "+b.type;}e[0]=k;e[1]=l;e[2]=-c;e[3]=h;e[4]=l;e[5]=-c;e[6]=h;e[7]=g;e[8]=-c;e[9]=k;e[10]=g;e[11]=-c;e[12]=B;e[13]=r;e[14]=-d;e[15]=B;e[16]=m;e[17]=-d;e[18]=n;e[19]=m;e[20]=-d;e[21]=n;e[22]=r;e[23]=-d;f&&(c=ja,S.invert(b.va,c),R.sf(e,c,e,0));return e}function E(a){return"CAMERA"===
a.type?!0:!1}function M(b){return E(b)&&b.c.g&&b.c.g.Aa==a.MS_HOVER_CONTROLS?!0:!1}function K(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.Si){var d=b.csm_num;a.Si=Array(d);for(var e=0;e<d;e++)a.Si[e]=new Float32Array(3);a.Nm=new Float32Array(d)}for(d=0;d<c;d++){var e=0==d?a.bb:Q(b,a,d-1),f=Q(b,a,d),e=J(a,e,f,sa),e=v.sz(e);a.Si[d].set(e.F);a.Nm[d]=e.Ia;a.Nq[d]=W.length(e.F);a.sl[d]=I(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.sl[0]=b.first_cascade_blur_radius}function Q(a,
b,c){var d=a.csm_num,e=R.clamp(a.csm_first_cascade_border,b.bb,b.Xa);a=R.clamp(a.csm_last_cascade_border,b.bb,b.Xa);return R.clamp(I(e,a,d,c),b.bb,b.Xa)}function I(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}var v=p("__boundings");p("__config");var H=p("__constraints"),P=p("__container"),Z=p("__print"),aa=p("__scenes"),R=p("__util"),W=p("vec3"),ba=p("vec4"),U=p("quat"),ca=p("mat3"),S=p("mat4");a.zb=10;a.Pb=20;a.Rc=30;a.Vd=40;a.Le=50;a.Rf=60;
a.Ab=70;a.Gb=80;a.MS_STATIC=0;a.MS_TARGET_CONTROLS=2;a.MS_EYE_CONTROLS=3;a.MS_HOVER_CONTROLS=4;var oa=Math.PI/180/2,X=new Float32Array(2),da=new Float32Array(2),ea=new Float32Array(3),fa=new Float32Array(3),ga=new Float32Array(3),B=new Float32Array(4),N=new Float32Array(4),ia=new Float32Array(4),ta=new Float32Array(4),Y=new Float32Array(16),ja=new Float32Array(16),sa=new Float32Array(24);a.Pw=function(d){var f=d.c.g,g=d.data;switch(g.type){case "PERSP":var h=e(a.Pb);if(g.angle_y)var k=g.angle_y/Math.PI*
180;n(h,k,g.clip_start,g.clip_end);break;case "ORTHO":h=e(a.Rc),n(h,g.ortho_scale/2,g.clip_start,g.clip_end)}h.name=d.name;f.Wt=!1;f.Aa=b(g.b4w_move_style);f.dof_distance=d.data.dof_distance;f.ke=d.data.dof_object;f.dof_front=d.data.b4w_dof_front;f.dof_rear=d.data.b4w_dof_rear;f.dof_power=d.data.b4w_dof_power;f.Ym=d.data.b4w_enable_hover_hor_rotation;f.M=[h];f.np=d.data.b4w_trans_velocity;f.mp=d.data.b4w_rot_velocity;f.op=d.data.b4w_zoom_velocity;f.Aa==a.MS_TARGET_CONTROLS&&(f.Tb.set(g.b4w_target),
y(d));g=d.c.g;k=g.Aa;if(k===a.MS_TARGET_CONTROLS||k===a.MS_EYE_CONTROLS||k===a.MS_HOVER_CONTROLS){var l=d.data,B=null,r=null,v=null;k===a.MS_TARGET_CONTROLS||k===a.MS_EYE_CONTROLS?(l.b4w_use_panning&&(g.eu=l.b4w_use_panning),l.b4w_use_horizontal_clamping&&(B={left:l.b4w_rotation_left_limit,right:l.b4w_rotation_right_limit}),l.b4w_use_vertical_clamping&&(r={Qa:l.b4w_rotation_down_limit,cb:l.b4w_rotation_up_limit}),k===a.MS_TARGET_CONTROLS&&(g.eb=l.b4w_use_distance_limits&&l.b4w_distance_min<=l.b4w_distance_max,
g.eb&&(g.je=l.b4w_distance_min,g.eg=l.b4w_distance_max))):k===a.MS_HOVER_CONTROLS&&(l.b4w_use_horizontal_clamping&&l.b4w_horizontal_translation_min<=l.b4w_horizontal_translation_max&&(B={left:l.b4w_horizontal_translation_min,right:l.b4w_horizontal_translation_max}),l.b4w_use_vertical_clamping&&l.b4w_vertical_translation_min<=l.b4w_vertical_translation_max&&(r={Qa:l.b4w_vertical_translation_min,cb:l.b4w_vertical_translation_max}),g.eb=l.b4w_use_distance_limits&&l.b4w_hover_angle_min<=l.b4w_hover_angle_max&&
l.b4w_distance_min<=l.b4w_distance_max,g.eb&&(v={Qa:l.b4w_hover_angle_min,cb:l.b4w_hover_angle_max},g.je=l.b4w_distance_min,g.eg=l.b4w_distance_max));var q=B;q&&k==a.MS_EYE_CONTROLS&&(q.left*=-1,q.right*=-1);if(q=r)switch(k){case a.MS_TARGET_CONTROLS:q.Qa*=-1;q.cb*=-1;break;case a.MS_HOVER_CONTROLS:var t=-q.Qa;q.Qa=-q.cb;q.cb=t}(q=v)&&k==a.MS_HOVER_CONTROLS&&(q.Qa*=-1,q.cb*=-1);g.$b=B;g.fc=r;g.Db=v;w(d,"LOCAL"==l.b4w_horizontal_clamping_type);C(d,"LOCAL"==l.b4w_vertical_clamping_type)}if(f.Aa===a.MS_HOVER_CONTROLS)if(f=
d.c.g,f.eb){g=d.c.g;k=R.quat_to_dir(g.quat,R.AXIS_MY,ea);l=ia;l.set(R.AXIS_Y);l[3]=0;k=R.line_plane_intersect(l,-d.data.b4w_hover_zero_level,g.i,k,g.ac);l=m(d,X)[1];if(!k||Math.abs(l)<oa)Z.warn("Active hover camera view vector and the supporting plane are parallel to each other. Set hover pivot based on the camera position."),g.ac[0]=g.i[0],g.ac[1]=0,g.ac[2]=g.i[2];g=m(d,X);f=R.Ue(g[1],f.Db.cb,f.Db.Qa);0<g[1]&&Z.warn("Active hover camera has wrong orientation");f?A(d,0,f):u(d)}else f.Ym=!1;h.type==
a.Rc&&c(d)};a.Rz=c;a.Cx=d;a.rb=e;a.sE=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.nb);case "DEPTH":return Boolean(a.Vc);case "SCREEN":return!Boolean(a.nb)&&!Boolean(a.Vc);default:throw"Wrong attachment type: "+b;}};a.Cl=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.nb=c;break;case "DEPTH":a.Vc=c;break;case "SCREEN":a.nb=null;a.Vc=null;break;default:throw"Wrong attachment type: "+b;}};a.bF=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.nb;case "DEPTH":return a.Vc;
case "SCREEN":return null;default:throw"Wrong attachment type: "+b;}};a.ms=function(b,c){if(b.type!=a.Pb||c!=a.Ab&&c!=a.Gb)throw"make_stereo(): wrong camera type";b.type=c;l(b,6,.065)};a.MB=l;a.get_camera_angles=m;a.qr=h;a.get_camera_angles_char=function(a,b){m(a,b);b[0]=R.angle_wrap_0_2pi(b[0]+Math.PI);b[1]*=-1;return b};a.get_angles=function(a,b){var c=a.c.g,d=R.quat_to_dir(c.quat,R.AXIS_MY,ea),e=Math.asin(d[1]/W.length(d));0==d[0]&&0==d[2]?c=0:(Math.abs(e)>Math.PI/4&&(d=0>=e?R.quat_to_dir(c.quat,
R.AXIS_MZ,fa):R.quat_to_dir(c.quat,R.AXIS_Z,fa)),c=Math.atan(Math.abs(d[0]/d[2])),0<d[2]&&(c=Math.PI-c),0<d[0]&&(c=2*Math.PI-c));b[0]=c;b[1]=e;return b};a.Dl=n;a.DB=function(b,c,d,e,f,g,h){switch(b.type){case a.Rf:b.left=c;b.right=d;b.bottom=e;b.top=f;b.bb=g;b.Xa=h;break;default:Z.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.get_move_style=function(a){return a.c.g.Aa};a.QB=f;a.RF=k;a.lt=function(a,b,c){var d=ea;d[0]=0;d[1]=-1;d[2]=0;W.transformQuat(d,c,d);d[0]+=b[0];d[1]+=
b[1];d[2]+=b[2];var e=fa;e[0]=0;e[1]=0;e[2]=-1;W.transformQuat(e,c,e);k(a,b,d,e)};a.Dy=function(a,b,c,d,e){d[0]=a[0];d[1]=a[1];d[2]=a[2];S.lookAt(a,b,c,ja);S.invert(ja,ja);S.rotateX(ja,Math.PI/2,ja);ca.fromMat4(ja,Y);U.fromMat3(Y,e)};a.UC=r;a.TC=function(b){var c=b.c.g,d=b.c.g;if(d.Aa===a.MS_TARGET_CONTROLS||d.Aa===a.MS_EYE_CONTROLS){if(d.$b){var e=d.$b.left,f=d.$b.right,g=m(b,X);(g=d.Aa==a.MS_TARGET_CONTROLS?R.Ue(g[0],e,f):R.Ue(g[0],f,e))&&(d.Aa==a.MS_TARGET_CONTROLS?t(b,g,0):G(b,g,0))}d.fc&&(e=
d.fc.Qa,f=d.fc.cb,g=m(b,X),(g=d.Aa==a.MS_TARGET_CONTROLS?R.Ue(g[1],f,e):R.Ue(g[1],e,f))&&(d.Aa==a.MS_TARGET_CONTROLS?t(b,0,g):G(b,0,g)));d.Aa===a.MS_TARGET_CONTROLS&&d.eb&&(g=b.c.g,e=W.subtract(g.i,g.Tb,ea),f=W.length(e),f>g.eg?(W.scale(e,g.eg/f,e),W.add(g.Tb,e,g.i)):f<g.je&&(f=R.quat_to_dir(g.quat,R.AXIS_MY,fa),W.scale(f,100*g.je,f),W.add(e,f,e),W.scale(e,-g.je/W.length(e),e),W.add(g.Tb,e,g.i)))}d.Aa===a.MS_HOVER_CONTROLS&&(d=b.c.g,g=d.eb?d.ac:d.i,d.$b&&(e=R.clamp(g[0],d.$b.left,d.$b.right)-g[0],
g[0]+=e,d.eb&&(d.i[0]+=e)),d.fc&&(e=R.clamp(g[2],d.fc.Qa,d.fc.cb)-g[2],g[2]+=e,d.eb&&(d.i[2]+=e)),d=b.c.g,d.eb&&d.Db&&(g=m(b,X)[1],g=R.Ue(g,d.Db.cb,d.Db.Qa),R.quat_to_dir(d.quat,R.AXIS_MY,ea),g&&A(b,0,g)));D(b);switch(c.Aa){case a.MS_TARGET_CONTROLS:H.qB(c.i,c.quat,c.Tb);H.correct_up(b,R.AXIS_Y);break;case a.MS_EYE_CONTROLS:b.c.Pa||H.correct_up(b,R.AXIS_Y)}y(b)};a.ip=y;a.UA=w;a.YA=C;a.bD=D;a.rotate_eye_camera=G;a.rotate_target_camera=t;a.rotate_hover_camera=A;a.Qz=u;a.wF=function(b){switch(b.type){case a.Pb:case a.Rc:case a.Ab:case a.Gb:return!0;
default:return!1}};a.dz=function(b){b=b.c.g.M[0];switch(b.type){case a.Pb:case a.Vd:case a.Ab:case a.Gb:return Math.PI*b.Ac/180;default:return Z.error("get_min_fov(): Unsupported camera type: "+b.type),0}};a.xf=g;a.ym=q;a.oq=L;a.By=J;a.vw=function(a){a=a.c.g;var b=v.ed();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.Hb=b;var c=v.Bk(1,[0,0,0]);a.Tc=c;a.lm=v.Iq(1,b);a.nm=v.Kq(1,b);a.mm=v.Jq(1,b)};a.is_camera=E;a.is_target_camera=function(b){return E(b)&&b.c.g&&b.c.g.Aa==a.MS_TARGET_CONTROLS?
!0:!1};a.is_eye_camera=function(b){return E(b)&&b.c.g&&b.c.g.Aa==a.MS_EYE_CONTROLS?!0:!1};a.is_hover_camera=M;a.hp=K;a.Xx=Q;a.project_point=function(b,c,d){b=b.c.g.M[0];switch(b.type){case a.Pb:case a.Vd:case a.Rc:case a.Le:case a.Ab:case a.Gb:var e=ia;e.set(c);e[3]=1;ba.transformMat4(e,b.Rd,e);c=-e[1]/e[3];d[0]=(e[0]/e[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;P.AD(d[0],d[1],d,b);2<d.length&&(d[2]=(e[2]/Math.abs(e[3])+1)/2);return d;default:return Z.error("Non-compatible camera"),d}};a.qz=function(a){return a.c.g.M[0]};
a.Nk=function(b,c){switch(b.type){case a.Pb:case a.Vd:case a.Ab:case a.Gb:var d=Math.tan(R.wl(b.Ac)/2);switch(c){case "LEFT":return-d*b.Ea;case "RIGHT":return d*b.Ea;case "TOP":return d;case "BOTTOM":return-d}break;case a.Rc:case a.Le:switch(c){case "LEFT":return-b.top*b.Ea;case "RIGHT":return b.top*b.Ea;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.Rf:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;default:R.ha("Unknown camera type")}};
a.eA=function(b){switch(b.type){case a.Rc:case a.Le:case a.Rf:return!0;default:return!1}};a.get_fov=function(b,c){switch(b.type){case a.Pb:case a.Vd:case a.Ab:case a.Gb:var d=R.wl(b.Ac);return c?d*b.Ea:d;default:return 0}}};b4w.module.__lights=function(a,p){function c(a){return{name:"",index:0,type:a,Ns:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),ph:new Float32Array(3),ud:0,Wg:0,$y:!1,qs:!1,Xq:!1,$g:!0,Hf:!0,af:1,distance:25,QE:"INVERSE_SQUARE"}}function d(a){a.ph[0]=a.color[0]*a.af;a.ph[1]=a.color[1]*a.af;a.ph[2]=a.color[2]*a.af}var b=p("__util"),e=p("vec3");new Float32Array(3);a.pF=c;a.iA=function(a){var m=a.data,h=c(m.type);h.name=a.name;h.$g=m.use_diffuse;h.Hf=m.use_specular;var n=
b.quat_to_dir(a.c.g.quat,b.AXIS_Y,[]);e.normalize(n,n);h.direction[0]=n[0];h.direction[1]=n[1];h.direction[2]=n[2];h.color[0]=m.color[0];h.color[1]=m.color[1];h.color[2]=m.color[2];h.af=m.energy;d(h);h.distance=m.distance;if("POINT"===h.type||"SPOT"===h.type)h.distance=m.distance;"SPOT"===h.type?(h.Wg=m.spot_blend,h.ud=m.spot_size):"POINT"===h.type&&(h.ud=Math.PI/2);h.$y=m.b4w_generate_shadows;h.Xq=m.b4w_dynamic_intensity;a.c.wa=h};a.FB=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];
d(a)};a.HB=function(a,b){a.Wg=b};a.GB=function(a,b){a.distance=b};a.IB=function(a,b){a.ud=b};a.it=function(a,b){a.af=b;d(a)};a.al=function(a){return"LAMP"===a.type?!0:!1};a.YC=function(a){if("LAMP"!=a.type)throw"Wrong light object";var c=a.c.wa;if(c&&(e.copy(c.direction,c.Ns),b.quat_to_dir(a.c.g.quat,b.AXIS_Y,c.direction),e.normalize(c.direction,c.direction),"SUN"==c.type)){a=Math.acos(e.dot(c.Ns,b.Ep));var d=Math.acos(e.dot(c.direction,b.Ep));c.qs=Math.floor(a/.025)!=Math.floor(d/.025)?!0:!1}}};b4w.module.__scenes=function(a,p){function c(){wb||(wb=d(Fa));return wb}function d(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.yd||!c.yd.length)return c}return null}function b(){if(!Xa)throw"No active scene available";return Xa}function e(a,b,c,d){for(var e=null,f=0;f<b.length;f++){var g=b[f];if((c?g.origin_name:g.name)==a&&g.c.g.Xb==d){e=g;break}}return e}function l(a,b){b||(b="ALL");var c=[];m(a.objects,b,c);return c}function m(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];"ALL"!=b&&b!=e.type||
c.push(e);(e=e.dupli_group)&&m(e.objects,b,c)}}function h(b){if(La.Lj)switch(b.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var c=!1,d=!1,e=B(b,"LAMP",a.DATA_ID_ALL),f=La.De&&b.b4w_enable_ssao;if(0==e.length&&!f)return!1;b=B(b,"MESH",a.DATA_ID_ALL);for(e=0;e<b.length;e++){var g=b[e];g.b4w_shadow_cast&&(c=!0);g.b4w_shadow_receive&&(d=!0);if((f||c)&&d)return!0}return!1}function n(a){if(!a.Da)return!1;a=a.Da.LAMP;for(var b=0;b<a.length;b++)if("SUN"==a[b].c.wa.type)return!0;
return!1}function f(a){if(!La.shore_smoothing)return!1;a=N(a);for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function k(b){b=B(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)for(var d=b[c].particle_systems,e=0;e<d.length;e++){var f=d[e].settings;if(f.b4w_enable_soft_particles&&0<f.b4w_particles_softness)return!0}return!1}function r(b){var c=N(b),d=[];b=B(b,"MESH",a.DATA_ID_ALL);for(var e=0;e<c.length;e++){var f=c[e];if(f.b4w_water){for(var g=
{},h=0;h<b.length;h++)for(var k=b[h],l=k.data.materials,m=0;m<l.length;m++)l[m]==f&&(g.Mf=k.location[1]);g.Yb=f.b4w_water_fog_color.slice(0);g.Yb.push(f.b4w_water_fog_density);f.b4w_water_dynamic?(g.$i=!0,g.waves_height=f.b4w_waves_height,g.waves_length=f.b4w_waves_length,g.dst_noise_scale0=f.b4w_water_dst_noise_scale0,g.dst_noise_scale1=f.b4w_water_dst_noise_scale1,g.dst_noise_freq0=f.b4w_water_dst_noise_freq0,g.dst_noise_freq1=f.b4w_water_dst_noise_freq1,g.dir_min_shore_fac=f.b4w_water_dir_min_shore_fac,
g.dir_freq=f.b4w_water_dir_freq,g.dir_noise_scale=f.b4w_water_dir_noise_scale,g.dir_noise_freq=f.b4w_water_dir_noise_freq,g.dir_min_noise_fac=f.b4w_water_dir_min_noise_fac,g.dst_min_fac=f.b4w_water_dst_min_fac,g.waves_hor_fac=f.b4w_water_waves_hor_fac):(g.$i=!1,g.waves_height=0,g.waves_length=0);g.de=f.b4w_water_enable_caust;g.Rw=f.b4w_water_caust_scale;g.Qw=f.b4w_water_caust_brightness;g.Sw=new Float32Array([.3,.7]);g.Fl=null;f=f.texture_slots;for(h=0;h<f.length;h++)k=f[h].texture,!0===k.b4w_shore_dist_map&&
(g.Fl=k.image,g.ei=k.image.size[0],g.XB=k.b4w_shore_boundings,g.Ph=k.b4w_max_shore_dist);d.push(g)}}if(0<d.length){g=d[0];if(!g.$i)for(e=0;e<d.length;e++)d[e].$i&&(g=d[e]);return g}return null}function y(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(c.mc=!0)}}}var c={mc:!1};a=N(a);for(var d=0;d<a.length;d++){var e=a[d];e.b4w_refractive&&(c.mc=!0);e.node_tree&&b(e.node_tree)}return c}
function w(a,b){if(La.zl)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;for(var c=[],d=0,e=0;e<b.length;e++){var f=b[e],g=f.c;g.g.Hc&&"CUBE"==g.g.uf&&d++;if(g.Pg.length){for(var h=null,k=0;k<c.length;k++)if(c[k]==g){h=k;break}null==h&&c.push(f)}}return{Zs:c,ys:d,Xe:[],rf:[]}}function C(a,b){var c={},d=a.world.b4w_sky_settings;c.iB=d.render_sky;c.procedural_skydome=d.procedural_skydome&&b;c.use_as_environment_lighting=d.use_as_environment_lighting;c.fi=d.color;c.rayleigh_brightness=
d.rayleigh_brightness;c.mie_brightness=d.mie_brightness;c.spot_brightness=d.spot_brightness;c.scatter_strength=d.scatter_strength;c.rayleigh_strength=d.rayleigh_strength;c.mie_strength=d.mie_strength;c.rayleigh_collection_power=d.rayleigh_collection_power;c.mie_collection_power=d.mie_collection_power;c.mie_distribution=d.mie_distribution;c.dc=d.reflexible;c.Ub=d.reflexible_only;!b&&d.procedural_skydome&&Va.warn("There is no sun on the scene. Procedural sky won't be rendered");return c}function D(a){var b=
{};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.Oz=a.hemisphere;b.Hw=a.blur_depth;b.iq=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.tB=a.samples;return b}function G(a){var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.py=a.edge_lum;b.key=a.key;return b}function t(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function A(a){var b={};a=a.b4w_color_correction_settings;b.brightness=
a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function x(a){var b={};a=a.b4w_god_rays_settings;b.Jn=a.intensity;b.Oh=a.max_ray_length;b.mi=a.steps_per_pass;return b}function u(a){var b={};b.pf=a.b4w_outline_color;b.xj=a.b4w_outline_factor;return b}function g(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=
a.large_glow_mask_width;return b}function q(a,b){var c=a.world,d=c.light_settings,e={};e.bf=d.environment_energy;e.jp=d.use_environment_light;e.Zm=d.environment_color;e.ff=c.horizon_color.slice(0);e.Pf=c.zenith_color.slice(0);e.tD=c.use_sky_paper;e.sD=c.use_sky_blend;e.uD=c.use_sky_real;e.wt=null;e.Io=null;e.$m=null;if(e.jp&&"SKY_TEXTURE"==e.Zm&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var d=null,f=0;f<c.texture_slots.length;f++)if(c.texture_slots[f].texture.b4w_use_as_environment_lighting){d=
c.texture_slots[f];break}d?e.$m=d:(Va.warn("environment lighting is set to 'Sky Texture', but there is no world texture with 'Sky Texture Usage' property set to 'ENVIRONMENT_LIGHTING'"),e.jp=!1)}for(f=0;f<c.texture_slots.length;f++)if(c.texture_slots[f].texture.b4w_use_as_skydome){c=c.texture_slots[f];e.wt=c;e.Io={Ew:c.blend_factor,Pz:c.horizon_factor,JD:c.zenith_up_factor,ID:c.zenith_down_factor,color:c.color,za:c.default_value,invert:c.invert,rD:c.use_rgb_to_intensity,Fw:c.blend_type,nD:c.use_map_blend,
oD:c.use_map_horizon,qD:c.use_map_zenith_up,pD:c.use_map_zenith_down};break}return e}function L(a){var b=a.world,c=b.fog_settings;a={};a.lD=c.use_fog;a.Jn=c.intensity;a.depth=c.depth;a.start=c.start;a.height=c.height;a.Ey=c.falloff;a.color=c.use_custom_color?c.color.slice(0):b.horizon_color.slice(0);b=a.color;a.Yb=new Float32Array([b[0],b[1],b[2],1/a.depth]);a.Lk=new Float32Array([a.Jn,a.depth,a.start,a.height]);return a}function J(b){if(!La.Bb)return!1;var c=!1,d=!1;b=B(b,"MESH",a.DATA_ID_ALL);for(var e=
0;e<b.length;e++){for(var f=b[e],g=f.data.materials,h=0;h<g.length;h++)g[h].b4w_terrain&&(c=!0);f=f.particle_systems;for(h=0;h<f.length;h++)g=f[h].settings,"HAIR"==g.type&&g.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function E(b){if(Sb.outlining_overview_mode)return!0;if(La.enable_selectable)switch(b.b4w_enable_object_selection){case "OFF":return!1;case "ON":return!0;case "AUTO":b=B(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)if(b[c].c.g.Ug)return!0;return!1}else return!1}function M(b){if(Sb.outlining_overview_mode)return!0;
if(La.enable_outlining)switch(b.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":b=B(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)if(b[c].c.g.Lb)return!0;return!1}else return!1}function K(b){if(La.df)switch(b.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":b=B(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,e=0;e<d.length;e++)if(Gb.vq(d[e]))return!0;return!1}else return!1}function Q(a,b){if(La.mc)switch(a.b4w_render_refractions){case "OFF":return!1;
case "ON":return!0;case "AUTO":return b.mc}else return!1}function I(b){b=B(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,e=0;e<d.length;e++){var f=d[e],g=f.game_settings.alpha_blend;if(f.b4w_render_above_all&&"OPAQUE"!=g&&"CLIP"!=g)return!0}return!1}function v(b){switch(b.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0}b=B(b,"EMPTY",a.DATA_ID_ALL);for(var c=0;c<b.length;c++){var d=b[c];if(d.b4w_anchor&&d.b4w_anchor.detect_visibility)return!0}return!1}
function H(a,b,c){var d=Ba.Dg(a,b);Ba.Ge(a,d,function(a,b,d){if(d.Ua){switch(d.V){case "COLOR":case "CUBEMAP":a=b.k.nb;break;case "DEPTH":a=b.k.Vc;break;case "SCREEN":a=null;break;case "MAIN_CUBE_REFLECT":return;default:throw"Wrong slink";}switch(d.ua){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "u_cube_reflection":case "u_plane_reflection":break;default:if(!a)throw"Connection of SCREEN is forbidden";if(a.Kf)throw"Batch texture can't use renderbuffer";
la.xq(c.ec,d.ua)&&na.kh(c,a,d.ua)}}});for(a=0;a<b.ma.length;a++){var d=b.ma[a],e=b.Nd[a];switch(d.ua){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":break;default:if(e.Kf)throw"Batch texture can't use renderbuffer";la.xq(c.ec,d.ua)&&na.kh(c,e,d.ua)}}}function P(a,b){return{Wa:!0,Wm:[!0,!0,!0,!0,!0,!0],pd:a,D:b}}function Z(a,b,c,d,e,f){for(var g=b.c.g,h=b.c.p,k=0;k<h.length;k++){var l=h[k];l.oc||l.Ub||"MAIN"!=l.type&&"NODES_GLOW"!=l.type&&"PARTICLES"!=l.type||!("OPAQUE"==
l.Ma&&"OPAQUE"==d||"BLEND"==l.Ma&&"BLEND"==d||"XRAY"==l.Ma&&"XRAY"==d||"NODES_GLOW"==l.type&&"GLOW"==d)||(f||(aa(l,a,b,c,d,e),W(e,l),na.ob(l),ba(l)),a.s.push(P(g,l)),H(c,a,l),U(l))}a.s.sort(function(a,b){var c;if(a.D&&b.D){c=a.D.Ha;var d=b.D.Ha;(c=c==d?0:c>d?1:-1)||(c=a.D.Gg,d=b.D.Gg,c=c==d?0:c>d?1:-1)}else c=0;return c})}function aa(a,b,c,d,e,f){var g=c.c.g,h=jb.Pk(c,f),k="NO_SHADOWS";if((c=pa.Ya(d,"SHADOW_CAST"))&&a.pc){switch(e){case "OPAQUE":k="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":k=
"SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":k="NO_SHADOWS";break;case "DEPTH":k="SHADOW_MASK_GENERATION";break;default:throw"Wrong subscene type";}na.Wp(a,f.l.Ae,c)}c=a.Eb;la.I(c,"SHADOW_USAGE",k);a.Bb&&(k=pa.Ya(d,"GRASS_MAP"))&&ca(a,k,g);if("DEPTH"!=a.type&&"COLOR_ID"!=e||a.Eh){e=b.Fg;la.I(c,"NUM_LIGHTS",e);la.I(c,"NUM_LFACTORS",0==e%2?e/2:Math.floor(e/2)+1);"special_skydome.glslf"==la.ur(c)&&la.I(c,"REFLECTION_PASS",0);la.I(c,"SSAO_ONLY",0);b.mb&&b.wd?la.I(c,"WATER_EFFECTS",
1):la.I(c,"WATER_EFFECTS",0);b.mb&&b.de&&g.de?(la.I(c,"CAUSTICS",1),la.I(c,"CAUST_SCALE",la.v(b.qq)),la.I(c,"CAUST_SPEED",la.v(b.rq,2)),la.I(c,"CAUST_BRIGHT",la.v(b.pq))):la.I(c,"CAUSTICS",0);b.mb&&(la.I(c,"WAVES_HEIGHT",la.v(b.Nf)),la.I(c,"WAVES_LENGTH",la.v(b.gh)),la.I(c,"WATER_LEVEL",la.v(b.Mf)));g=h.Xe;h=h.rf;-1!==a.Nb.indexOf("u_mirrormap")?la.I(c,"REFLECTION_TYPE","REFL_MIRRORMAP"):a.Hc&&g?(g=g.k.nb,na.kh(a,g,"u_cube_reflection"),la.I(c,"REFLECTION_TYPE","REFL_CUBE")):a.Hc&&h?(g=h.k.nb,na.kh(a,
g,"u_plane_reflection"),la.I(c,"REFLECTION_TYPE","REFL_PLANE")):la.I(c,"REFLECTION_TYPE","REFL_NONE");(h=pa.Ya(d,"SKY"))?a.Rs?(g=h.k.nb,na.kh(a,g,"u_sky")):La.ul?(a.wc=h.wc,la.I(c,"PROCEDURAL_FOG",1)):la.I(c,"PROCEDURAL_FOG",0):la.I(c,"PROCEDURAL_FOG",0);g=f.l.up;g.jp&&(la.I(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==g.Zm?(g=g.$m?na.hz(g.$m,!1):h.k.nb,la.I(c,"SKY_TEXTURE",1),na.kh(a,g,"u_sky_texture")):"SKY_COLOR"==g.Zm&&la.I(c,"SKY_COLOR",1));g=f.l.su;g.lD&&(la.I(c,"USE_FOG",1),la.I(c,"FOG_TYPE",
g.Ey));a.zo?(La.Xi&&la.I(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.Eh||"NODES_GLOW"==a.type?(la.I(c,"REFRACTIVE",1),f.l.mc?la.I(c,"USE_REFRACTION",1):la.I(c,"USE_REFRACTION",0)):f.l.mc?la.I(c,"REFRACTIVE",1):la.I(c,"REFRACTIVE",0)):(la.I(c,"REFRACTIVE",0),la.I(c,"USE_REFRACTION",0),la.I(c,"USE_REFRACTION_CORRECTION",0));a.Lf&&(La.shore_smoothing&&a.Sl&&pa.Ya(d,"DEPTH")?la.I(c,"SHORE_SMOOTHING",1):la.I(c,"SHORE_SMOOTHING",0),a.water_dynamic&&b.mb&&b.Nf?la.I(c,"DYNAMIC",1):la.I(c,"DYNAMIC",
0));"PARTICLES"==a.type&&(la.I(c,"SIZE_RAMP_LENGTH",a.la.qt),la.I(c,"COLOR_RAMP_LENGTH",a.la.Gq));if(!a.ig)for(b=a.S,d=0;d<b.length;d++)if(g=b[d],"SCENE"==g.source)for(h=0;h<Fa.length;h++){e=Fa[h];for(var k=Fa[h].yd,l=0;l<k.length;l++)k[l].l==g&&Ba.n(kb,e,f,null)}if(a.Kh){b=0;for(var m in a.Kh)b++;a.Pn=new Float32Array(3*b);a.Nn=new Float32Array(3*b);a.Mn=new Float32Array(3*b);a.On=new Float32Array(4*b);la.I(c,"NUM_LAMP_LIGHTS",b);for(d=0;d<f.Da.LAMP.length;d++)R(a,f.Da.LAMP[d])}}}function R(a,b){var c=
b.uuid;if(c in a.Kh){c=a.Kh[c];a.Pn.set(b.c.g.i,3*c);a.Nn.set(b.c.wa.direction,3*c);a.Mn.set(b.c.wa.ph,3*c);var d=Wb,e=b.c.wa;d[0]=-1;d[1]=-1;d[2]=-1;d[3]=e.Hf?1:0;switch(e.type){case "POINT":d[2]=e.distance;break;case "SPOT":d[2]=e.distance;var f=d[0]=Math.cos(e.ud/2);d[1]=e.Wg*(1-f)}a.On.set(d,4*c)}}function W(b,c){var d=B(b,"LAMP",a.DATA_ID_ALL);c.Eb.Un=[];for(var e=X(d)||d[0],f=0;f<d.length;f++){var g=d[f].c.wa;if("AREA"!=g.type){if("SPOT"==g.type||"POINT"==g.type)var h=Math.cos(g.ud/2);if("SPOT"==
g.type)var k=g.Wg*(1-h);var l=g.index;c.Eb.Un.push({type:g.type,index:l,mA:Math.floor(l/2),lA:0==l%2?"rg":"ba",ud:h,Wg:k,distance:g.distance,dA:g.$g||g.Hf,Py:l==e.c.wa.index})}}}function ba(a){var b=a.ec.attributes,c=a.P.Mb,d;for(d in b)c[d]||Qa.ha('missing data for "'+d+'" attribute');if("MAIN"==a.type||"NODES_GLOW"==a.type)if(b=la.Dz(a.ec.qp),10<b&&("MAIN"==a.type&&Va.warn("Varying limit exceeded for main shader - "+b+', materials: "'+a.$c.join(", ")+'"'),"MAIN"==a.type&&a.Eh||"NODES_GLOW"==a.type))d=
c=0,a.bh&&(c=Qa.Ed(a.bh)),a.yb&&(d=Qa.Ed(a.yb)),Va.warn("Varying limit exceeded for node shader - "+b+", uv: "+c+", vc: "+d+', materials: "'+a.$c.join(", ")+'"')}function U(a){8<a.S.length&&Va.warn(a.type,"too many textures used - "+a.S.length+' (max 8), materials "'+a.$c.join(", ")+'"')}function ca(a,b,c){a.ic=b.ic;var d=b.ic[0],e=b.ic[1],f=b.ic[2];c=c.Hb;c=Math.max(c.max_x-c.min_x,c.max_z-c.min_z);f=0==f?c:Math.max(f,c);b.ic[2]=f;b=b.k;Oa.Dl(b,f/2,-e,-d,f/2);Oa.xf(b);d=a.yn||0;d=0==d?c:Math.max(d,
c);a.yn=d}function S(a){var b=Y(a,"MAIN_OPAQUE"),c=!0;Ba.X(a.l.jb,function(d,e){"SHADOW_CAST"===e.type&&(oa(e,b,e.s,a,c),c=!1)})}function oa(b,c,d,e,f){if(0!=d.length){var g=b.k;c=c.k;var h=B(e,"LAMP",a.DATA_ID_ALL);if(h=X(h)||h[0]){var k=h.c.g;Oa.lt(g,k.i,k.quat);Ab.copy(c.cf,g.cf);Tb.copy(c.va,g.ot);if("SPOT"==h.c.wa.type||"POINT"==h.c.wa.type)Oa.xf(g,g.Ea);else{h=Hb;ua.ed(h);for(k=0;k<d.length;k++){var l=d[k].pd;0==k?ua.zk(l.hb,h):ua.Zq(h,l.hb)}d=ua.Ay(h,rc);Qa.sf(d,g.va,d);if(e.l.Ae.enable_csm){e=
Ab.copy(c.Si[b.Mm],qa);h=Tb.invert(c.va,wa);Qa.sf(e,h,e);Qa.sf(e,g.va,e);b=c.Nm[b.Mm];if(f)for(za=0,zb=-Infinity,f=2;f<d.length;f+=3)za=Math.min(za,d[f]),zb=Math.max(zb,d[f]);f=Hb;f.max_x=e[0]+b;f.max_y=e[1]+b;f.max_z=zb;f.min_x=e[0]-b;f.min_y=e[1]-b;f.min_z=za}else{b=f=Hb;c=V;c.set(d);e=Wa/9;d=Tb.identity(wa);Tb.rotate(d,e,Qa.AXIS_MZ,d);k=h=-1;for(l=0;10>l;l++){var m=ua.Bw(c,Lb),z=(m.max_x-m.min_x)*(m.max_y-m.min_y);if(-1==h||z<h)h=z,k=l,ua.zk(m,b);Qa.sf(c,d,c)}b=k*e;0<b&&(c=Tb.identity(wa),Tb.rotate(c,
b,Qa.AXIS_MZ,c),Tb.multiply(c,g.va,g.va));b=f.max_x-f.min_x;c=f.max_y-f.min_y;b&&c&&(e=Math.abs(b-c)/2,2<b/c?(f.max_y+=e,f.min_y-=e):2<c/b&&(f.max_x+=e,f.min_x-=e));f.max_x+=.005;f.max_y+=.005;f.max_z+=.005;f.min_x-=.005;f.min_y-=.005;f.min_z-=.005}Oa.DB(g,f.min_x,f.max_x,f.min_y,f.max_y,-f.max_z,-f.min_z);Oa.xf(g)}Qa.dn(g.Rd,g.Mk)}}}function X(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.data.b4w_generate_shadows)return c}return!1}function da(a,b,c,d,e){for(var f=b.c.g,g=b.c.p,h=0;h<g.length;h++){var k=
g[h];"COLOR_ID"==k.type&&(e||(aa(k,a,b,c,"COLOR_ID",d),na.ob(k),ba(k)),"COLOR_PICKING"==a.type&&"COLOR_ID"==k.Ma||"COLOR_PICKING_XRAY"==a.type&&"COLOR_ID_XRAY"==k.Ma)&&(e||(na.ta(k,"USE_OUTLINE",0),na.ob(k),ba(k)),a.s.push(P(f,k)))}}function ea(a,b,c,d,e){d||(e.Bb&&(d=pa.Ya(c,"GRASS_MAP"))&&ca(e,d,b),na.ob(e),ba(e));a.s.push(P(b,e));H(c,a,e);U(e)}function fa(a,b){for(var c=ta(b,Ua),d=a.c.wa,e=a.c.g,f=d.index,g=0;g<c.length;g++){var h=c[g];h.kf.set(e.i,3*f);h.ug.set(d.direction,3*f);h.tg.set(d.ph,
3*f);switch(d.type){case "SUN":h.Nt.set(e.quat);h.Mt=d.ph;"SKY"===h.type?(h.gl=d.qs,Ab.copy(d.direction,h.Uo),ga(b,h)):Ab.copy(d.direction,h.Uo);break;case "HEMI":case "POINT":case "SPOT":break;default:Va.error("Unknown light type: "+d.type+'".')}var k=Ga;k[0]=d.$g?1:0;k[1]=d.Hf?1:0;h.vg.set(k,2*f);h.sa=!0;for(k=0;k<h.s.length;k++){var l=h.s[k].D;l.Kh&&R(l,a)}}}function ga(a,b){Ac.Zi(b);if(b.gl)for(var c=ta(a,["MAIN_OPAQUE","MAIN_BLEND","MAIN_XRAY","MAIN_GLOW"]),d=0;d<c.length;d++)for(var e=c[d].s,
f=0;f<e.length;f++){var g=e[f];g.Wa&&(g=g.D,na.Vw(g)&&Ac.QC(g))}}function B(b,c,d){if(!b.Da)throw"Access to uninitialized scene";b=b.Da[c]||[];if(d==a.DATA_ID_ALL)return b;c=[];for(var e=0;e<b.length;e++){var f=b[e];f.c.g.Xb==d&&c.push(f)}return c}function N(b){var c=[];b=B(b,"MESH",a.DATA_ID_ALL);for(var d=0;d<b.length;d++)for(var e=b[d].data,f=0;f<e.materials.length;f++){var g=e.materials[f];-1==c.indexOf(g)&&c.push(g)}return c}function ia(a,b,c){for(var d=a.l,e=a.camera.c.g.M,f=0;f<e.length;f++){var g=
e[f];Oa.xf(g,b/c);d.Ao&&Oa.hp(g,d.Ae)}d.Ao&&(d.hl=!0,Y(a,"DEPTH").sa=!0,Y(a,"MAIN_BLEND").sa=!0);var h=d.jb;pa.IC(h,function(d,e,f){if(d.ti){var g=d.Cf*b,k=d.Cf*c;if(e)for(e=0;e<f.ma.length;e++)f.ma[e]==d&&zc.resize(d.ya,g,k);else switch(zc.sj(d.ya)&&zc.resize(d.ya,g,k),d=f.k,d.width=g,d.height=k,f.type){case "DOF":ja(a,{dof_power:f.k.dof_power,dof_on:f.k.dof_on});break;case "GLOW_COMBINE":z(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case "BLOOM":sa(a,
{bloom_blur:f.bloom_blur});break;case "OUTLINE":f=pa.La(h,f,"POSTPROCESSING");g=pa.La(h,f,"POSTPROCESSING");k=pa.La(h,g,"POSTPROCESSING");d=pa.La(h,k,"POSTPROCESSING");pa.Ic(f,1/b,1/c);pa.Ic(g,1/b,1/c);pa.Ic(k,1/b,1/c);pa.Ic(d,1/b,1/c);break;default:pa.Ic(f,1/b,1/c)}}})}function ta(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];Ba.X(a.l.jb,function(a,b){b.type==e&&c.push(b)})}return c}function Y(a,b){return pa.Ya(a.l.jb,b)}function ja(a,b){var c=Y(a,"DOF");if(!c)return Va.error("DOF is not enabled on the scene. Check camera settings"),
0;var d=a.l.jb;"boolean"==typeof b.dof_on&&(c.k.dof_on=parseFloat(b.dof_on));"number"==typeof b.dof_distance&&(c.k.dof_distance=b.dof_distance);"number"==typeof b.dof_front&&(c.k.dof_front=b.dof_front);"number"==typeof b.dof_rear&&(c.k.dof_rear=b.dof_rear);if("number"==typeof b.dof_power){c.k.dof_power=b.dof_power;var e=pa.La(d,c,"POSTPROCESSING"),d=pa.La(d,e,"POSTPROCESSING");pa.Vb(e,c.k.dof_power);pa.Ic(e,1/c.k.width,1/c.k.height);pa.Vb(d,c.k.dof_power);pa.Ic(d,1/c.k.width,1/c.k.height)}c.sa=!0}
function sa(a,b){var c=Y(a,"LUMINANCE_TRUNCED"),d=Y(a,"BLOOM");if(!c||!d)return Va.error("Bloom is not enabled on the scene"),0;"number"==typeof b.bloom_key&&(c.bloom_key=b.bloom_key,c.sa=!0);"number"==typeof b.bloom_edge_lum&&(c.bloom_edge_lum=b.bloom_edge_lum,c.sa=!0);if("number"==typeof b.bloom_blur){var e=a.l.jb,c=pa.La(e,d,"BLOOM_BLUR"),e=pa.La(e,c,"BLOOM_BLUR");d.bloom_blur=b.bloom_blur;pa.Vb(c,b.bloom_blur);pa.Ic(c,1/d.k.width,1/d.k.height);pa.Vb(e,b.bloom_blur);pa.Ic(e,1/d.k.width,1/d.k.height)}}
function z(a,b){var c=Y(a,"GLOW_COMBINE");if(!c)return Va.error("Glow is not enabled on the scene"),null;for(var d=a.l.jb,e=pa.tz(d,c),f=0;f<e.length;++f){var g=e[f];if("POSTPROCESSING"===g.type&&"GLOW_MASK_LARGE"===g.Ma)var h=g;if("POSTPROCESSING"===g.type&&"GLOW_MASK_SMALL"===g.Ma)var k=g}e=pa.La(d,h,"POSTPROCESSING");d=pa.La(d,k,"POSTPROCESSING");"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.sa=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=
b.large_glow_mask_coeff,c.sa=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,pa.Vb(k,b.small_glow_mask_width),pa.Ic(k,1/c.k.width,1/c.k.height),k.sa=!0,pa.Vb(d,b.small_glow_mask_width),pa.Ic(d,1/c.k.width,1/c.k.height),d.sa=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,pa.Vb(h,b.large_glow_mask_width),pa.Ic(h,1/c.k.width,1/c.k.height),h.sa=!0,pa.Vb(e,b.large_glow_mask_width),pa.Ic(e,1/c.k.width,1/c.k.height),
e.sa=!0)}function F(a,b){var c=Y(Xa,"MAIN_OPAQUE");if(!c||!c.mb)return Va.error("get_water_surface_level() - no water parameters on the scene"),0;var d=c.Nf,e=c.gh,f=c.Mf,g=c.mb;if(!d||!g.$i)return g.Mf;var h=Ab.length(c.Of),k=c.time;h&&(k*=h);var l=Ga;l[0]=20/e*(a-.25*k);l[1]=20/e*(b-.25*k);h=Qa.sq(l);l[0]=17/e*(b+.1*k);l[1]=17/e*(a+.1*k);var l=Qa.sq(l),h=h+l-1,m=g.dst_noise_scale0,l=g.dst_noise_scale1,z=g.dst_noise_freq0,F=g.dst_noise_freq1,n=Ga;n[0]=m*(a+z*k);n[1]=m*(b+z*k);m=Qa.Ko(n);n[0]=l*(b-
F*k);n[1]=l*(a-F*k);l=Qa.Ko(n);l*=d*m;if(c.Ql)if(F=(a-c.zf[0])/c.Af[0],n=(c.zf[1]+b)/c.Af[1],F+=.5,n+=.5,1<F||0>F||1<n||0>n)d=l;else var F=Qa.pr(Xa.l.Fo,c.ei,F,n),m=g.dir_freq,B=g.dir_noise_scale,r=g.dir_noise_freq,z=g.dir_min_noise_fac,n=g.dst_min_fac,c=e/c.Ph/Math.PI,B=[B/e*(a+r*k),B/e*(b+r*k)],e=Math.sqrt(F),d=d*Math.max(F,g.dir_min_shore_fac)*Math.sin(e/c+m*k)*Math.max(Qa.Ko(B),z),g=Math.max(e,n),d=d*(1-g)+l*g,h=h*F;else d=l;return f+(d+.05*h)}function ka(a,b){a.qj&&"POSTPROCESSING"==a.type&&
b.Wa!=a.Wa&&(a.Wa=b.Wa);b.Wa||"OUTLINE"!=a.type||(a.Xm=0)}function ra(a,b,c,d){var e=Ba.Za(a,b);Oa.Cl(e.k,c,d);e.jm=!0;Ba.Gf(a,b,function(b,e,f){f.Ua&&f.V==c&&pa.dx(f)&&O(a,b,f.ua,d)});Ba.Ge(a,b,function(b,e,f){f.Ua&&f.V==c&&f.V==f.ua&&ra(a,b,c,d)})}function O(a,b,c,d){a=Ba.Za(a,b).s;for(b=0;b<a.length;b++)na.mB(a[b].D,d,c)}function ha(a){var b=Y(a,"GRASS_MAP");if(b){var c=b.k,d=a.camera.c.g,e=d.i;a=qa;a[0]=0;a[1]=-b.ic[2]/2;a[2]=0;Ab.transformQuat(a,d.quat,a);a[0]+=e[0];a[1]=0;a[2]+=e[2];b=Ub;b[0]=
0;b[1]=0;b[2]=0;b[3]=1;Oa.lt(c,a,b)}}function T(a,b){Ba.X(a,function(c,d){if("MOTION_BLUR"==d.type){if(!d.ma[0]||!d.Nd[0])throw"Wrong MOTION_BLUR subscene";var e=d.ma[0],f=d.Nd[0];d.Nd[0]=d.k.nb;Ba.Gf(a,c,function(b,c,d){d.Ua&&O(a,b,d.ua,f)});ra(a,c,e.V,f);O(a,c,e.ua,d.Nd[0]);d.ps=Math.exp(-b/d.mb_factor)}})}function hc(b,c){var d=0,e=b.Rv;0==e.bp&&(e.bp=c);var f=c-e.bp;if(e.at&&f/e.ad>=e.at)a.clear_outline_anim(b);else{f%=e.ad;if(f<e.Es)switch(e=f/(e.Es/5),f=Math.floor(e),f){case 0:d=(e-f)/2;break;
case 1:d=(e-f)/2+.5;break;case 2:d=1;break;case 3:d=1-(e-f)/2;break;case 4:d=.5-(e-f)/2}b.c.g.qd=d}}function xa(a){Ba.X(a.l.jb,function(a,b){b.sa=!0})}function Zb(a){if("WIND"==a.field.type){a=a.c.g;Qa.quat_to_dir(a.quat,Qa.AXIS_Y,va);Ab.normalize(va,va);Ab.scale(va,a.kn,va);a=Fa;for(var b=0;b<a.length;b++)for(var c=ta(a[b],Ta),d=0;d<c.length;d++)c[d].Of.set(va)}}function Pa(a){var c=b();if(c=Y(c,"OUTLINE"))c.pf.set(a),c.sa=!0}var na=p("__batch"),ua=p("__boundings"),Oa=p("__camera"),cb=p("__config"),
Da=p("__container"),Rb=p("__constraints"),yc=p("__data"),pc=p("__debug"),ic=p("__geometry"),Ba=p("__graph"),ub=p("__hud"),Gb=p("__nodemat"),jb=p("__obj_util");p("__particles");var qc=p("__physics"),Ca=p("__prerender"),Kb=p("__primitives"),Va=p("__print"),Ac=p("__renderer"),pa=p("__scenegraph"),Kc=p("__sfx"),la=p("__shaders"),zc=p("__textures"),Qa=p("__util"),Ab=p("vec3"),Tb=p("mat4"),La=cb.r,Sb=cb.Lb,ib=cb.ai,Vc=cb.Zd,Bc="ARMATURE CAMERA EMPTY LAMP MESH SPEAKER".split(" "),Ea=["ARMATURE","EMPTY",
"MESH","SPEAKER"],Ia="GRASS_MAP SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH OUTLINE_MASK WIREFRAME".split(" ");a.ZD=Ia;var Ua="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT GOD_RAYS GOD_RAYS_COMBINE SKY LUMINANCE_TRUNCED".split(" "),gb="MAIN_OPAQUE SSAO MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),Ta="SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH GOD_RAYS OUTLINE_MASK WIREFRAME".split(" "),
yb="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),vb=0,wb=null,Xa=null,Fa=[],kb=null,ya=[],Wa=Math.PI/2;a.Qf=0;a.Vl=1;a.Wl=2;a.DATA_ID_ALL=-1;var Ga=new Float32Array(2),qa=new Float32Array(3);new Float32Array(4);var Wb=new Float32Array(4),Ub=new Float32Array(4),wa=new Float32Array(16),rc=new Float32Array(24),V=new Float32Array(24),Hb=ua.ed(),Lb=ua.ed(),va=new Float32Array(3),za=0,zb=-Infinity;a.set_active=function(a){Xa=a;Kc.BB(a)};a.XA=function(a,b){var c=
a.l,d=pa.Mx(c.jb);if(a==b){ia(a,Da.Fz(),Da.Ez());for(var e=0;e<d.length;e++)a.l.Ng.push(d[e])}else for(e=a.yd[0],ia(a,e.l.Vg,e.l.Vg),e=0;e<d.length;e++)b.l.Ng.push(d[e]);d=ta(a,Ta);for(e=0;e<d.length;e++)d[e].Of.set(va);for(e=0;e<c.Ng.length;e++)"SHADOW_CAST"==c.Ng[e].type&&Ac.Zi(c.Ng[e])};a.lj=c;a.fn=d;a.get_active=b;a.ia=function(){return Xa?!0:!1};a.kj=function(a){return a.camera};a.jj=function(){return Fa};a.wz=function(){if(1==Fa.length)return Fa;for(var a=0;a<Fa.length;a++){var b=Fa[a].l.jb;
Ba.X(b,function(b,c){for(var d=0;d<c.s.length;d++){for(var e=c.s[d].D.S,f=null,g=0;g<e.length;g++)if("SCENE"==e[g].source&&e[g].Lo==Fa[a].name&&"COPY"!=c.type){Va.error('Texture-scene loop detected. A scene is rendered to texture "'+e[g].name+'" yet this texture belongs to the same scene.');Ba.Dg(kb,Fa[a]);f=c.s[d].D;break}f&&(f.S=[],f.Nb=[],na.PC(f,null),na.ob(f))}})}for(var c=[],a=0;a<Fa.length;a++)if(b=Fa[a],!b.yd.length){b=Ba.Dg(kb,b);Ba.uy(kb,b);b=Ba.So(kb,b,Ba.Ul);b=Ba.dp(b);Ba.X(b,function(a,
b){c.push(b)});break}return c};a.Fd=function(b,c,d,f){for(var g=Fa,h=null,k=0;k<g.length;k++){var l=B(g[k],"ALL",a.DATA_ID_ALL);switch(b){case a.Qf:h=e(c,l,!1,d);break;case a.Vl:h=null;(l=e(c,l,!1,f))&&l.dupli_group&&(h=e(d,l.dupli_group.objects,!0,f));break;case a.Wl:for(var h=null,m=0;m<c.length;m++)if((h=e(c[m],l,0!=m,d))&&h.dupli_group)l=h.dupli_group.objects;else break}if(h)break}return h};a.iw=function(a,b,c){for(var d in Ea){var e=Ea[d],f=l(a,e),g=b.l.vi,h=!1;for(d=0;d<c.length;d++)if(h=!0,
c[d].l&&c[d].l.sg){for(var k=0;k<g.length;k++)g[k]==c[d]&&(h=!1);h&&g.push(c[d])}e in b.Da||(b.Da[e]=[]);for(k=0;k<f.length;k++)Qa.is_armature(f[k])&&f[k].proxy||(b.Da.ALL.push(f[k]),b.Da[e].push(f[k]))}};a.cw=function(b,c,d){b.Da={ALL:[]};for(var e in Bc){var m=Bc[e],z=l(b,m);b.Da[m]=[];for(var F=0;F<z.length;F++)Qa.is_armature(z[F])&&z[F].proxy||(b.Da.ALL.push(z[F]),b.Da[m].push(z[F]))}b.yd=b.yd||[];b.l=b.l||{};b.na=null;m=b.l;z=b.camera.c.g;e=b.b4w_shadow_settings;F=m.Ae={};e.csm_resolution>La.Sb?
(F.csm_resolution=La.Sb,Va.error("Shadow map texture has unsupported size. Changed to "+La.Sb+".")):F.csm_resolution=e.csm_resolution;F.self_shadow_polygon_offset=e.self_shadow_polygon_offset;F.self_shadow_normal_offset=e.self_shadow_normal_offset;F.enable_csm=e.b4w_enable_csm;var p=B(b,"LAMP",a.DATA_ID_ALL);if(p=X(p)||p[0])F.Qn=p.c.wa.type,F.ud=p.c.wa.ud,F.distance=p.c.wa.distance,"SPOT"!=F.Qn&&"POINT"!=F.Qn||!F.enable_csm||(Va.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),
F.enable_csm=!1);F.enable_csm?(F.csm_num=e.csm_num,F.csm_first_cascade_border=e.csm_first_cascade_border,F.first_cascade_blur_radius=e.first_cascade_blur_radius,F.csm_last_cascade_border=e.csm_last_cascade_border,F.last_cascade_blur_radius=e.last_cascade_blur_radius,F.fade_last_cascade=e.fade_last_cascade,F.blend_between_cascades=e.blend_between_cascades):(F.csm_num=1,F.csm_first_cascade_border=e.csm_first_cascade_border,F.first_cascade_blur_radius=e.first_cascade_blur_radius,F.csm_last_cascade_border=
e.csm_last_cascade_border,F.last_cascade_blur_radius=e.last_cascade_blur_radius,F.fade_last_cascade=!1,F.blend_between_cascades=!1);m.vi=[];for(e=0;e<c.length;e++)c[e].l&&c[e].l.sg&&m.vi.push(c[e]);c=y(b);m.Xg=n(b);m.Hl=C(b,m.Xg);m.up=q(b,m.Hl);m.su=L(b);m.jA=B(b,"LAMP",a.DATA_ID_ALL).length;m.mb=r(b);m.vA=c;m.Ie=I(b);m.Wv=v(b);m.zs=0;z.M[0].type!=Oa.Pb&&La.anaglyph_use?(Va.warn("Anaglyph stereo is disabled for the non-perspective camera"),e=!1):e=La.anaglyph_use;m.anaglyph_use=e;m.Ao=La.Xi&&h(b);
m.shore_smoothing=f(b);m.aC=k(b);m.Og=w(b,d);m.Gw=G(b);m.yA=t(b);m.Tw=A(b);m.Iz=x(b);m.KA=u(b);m.ef=g(b);m.vh=La.vh&&(0<z.dof_distance||z.ke);m.Bb=J(b);m.Sh=La.Sh&&b.b4w_enable_motion_blur;m.qh=La.qh&&b.b4w_enable_color_correction;m.antialiasing=La.antialiasing&&b.b4w_enable_antialiasing;m.mh=La.mh&&b.b4w_enable_bloom&&m.Xg;m.De=La.De&&b.b4w_enable_ssao;m.qC=D(b);m.Ch=La.Ch&&b.b4w_enable_god_rays&&m.Xg;m.mc=Q(b,c);m.jy=La.Xi;m.kx=E(b);m.outline=M(b);m.df=K(b);m.xn=b.world.b4w_render_glow_over_blend;
switch(b.b4w_reflection_quality){case "LOW":m.cg=ib.Oq;m.Dj=ib.Ks;break;case "MEDIUM":m.cg=ib.Zx;m.Dj=ib.QA;break;case "HIGH":m.cg=ib.Yx;m.Dj=ib.PA;break;default:m.cg=ib.Oq,m.Dj=ib.Ks}d=b.yd.sort(function(a,b){return b.l.Vg-a.l.Vg});m.jb=pa.Lx(m,z,d);m.Ng=[];m.hl=!1;m.io=!1;Fa.push(b);kb||(kb=Ba.create());Ba.w(kb,b)};a.Hm=l;a.tn=function(a){return a.l.jb};a.Qy=function(a){Ba.X(a,function(b,c){var d=null;switch(c.type){case "POSTPROCESSING":d=na.Mq(c.tl);break;case "SSAO":d=na.Rx(c);break;case "SSAO_BLUR":d=
na.Sx(c);break;case "DEPTH_PACK":d=na.Ax();break;case "REFRACT":case "COPY":d=na.Mq("NONE");break;case "GOD_RAYS":pa.La(a,c,"WIREFRAME")||pa.La(a,c,"MAIN_BLEND")||pa.La(a,c,"GOD_RAYS");d=na.Ex(c.Gs,c.Lf,c.mi);break;case "GOD_RAYS_COMBINE":pa.La(a,c,"WIREFRAME")||pa.La(a,c,"MAIN_BLEND");pa.La(a,c,"GOD_RAYS");d=na.Fx();break;case "MOTION_BLUR":d=na.Ix();break;case "DOF":var d=na.Bx(),e=pa.La(a,c,"POSTPROCESSING"),f=pa.La(a,e,"POSTPROCESSING");pa.Vb(e,c.k.dof_power);pa.Vb(f,c.k.dof_power);break;case "OUTLINE":var d=
na.Jx(),e=pa.La(a,c,"POSTPROCESSING"),f=pa.La(a,e,"POSTPROCESSING"),g=pa.La(a,f,"POSTPROCESSING"),h=pa.La(a,g,"POSTPROCESSING");pa.Vb(f,c.rm);pa.Vb(e,c.rm);pa.Vb(h,c.cn*c.xj);pa.Vb(g,c.cn*c.xj);break;case "GLOW_COMBINE":d=na.Dx();break;case "COMPOSITING":d=na.yx();break;case "ANTIALIASING":d=na.ux();break;case "SMAA_RESOLVE":case "SMAA_EDGE_DETECTION":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_NEIGHBORHOOD_BLENDING":d=na.Px(c.type);break;case "ANAGLYPH":d=na.sx();break;case "SKY":d=na.Kx();
break;case "LUMINANCE":d=na.Gx();break;case "AVERAGE_LUMINANCE":d=na.vx();break;case "LUMINANCE_TRUNCED":d=na.Hx();break;case "BLOOM_BLUR":d=na.wx();break;case "BLOOM":d=pa.La(a,c,"BLOOM_BLUR");e=pa.La(a,d,"BLOOM_BLUR");pa.Vb(d,c.bloom_blur);pa.Vb(e,c.bloom_blur);d=na.xx();break;case "VELOCITY":d=na.Vx();break;case "ANCHOR_VISIBILITY":d=na.tx()}d&&(e=P(jb.sh("NONE"),d),ba(d),c.s.push(e),H(a,c,d),U(d))})};a.append_object=function(a,b,c){switch(b.type){case "MESH":var d=a.l.jb,e=b.c.g;!pa.Ya(d,"SHADOW_CAST")&&
e.pc&&(e.pc=!1);e=ta(a,Ia);c&&(qc.K(b)&&qc.append_object(b,a),a.Da.ALL.push(b),a.Da[b.type].push(b),b.c.Ka&&b.c.Ka.dupli_group.objects&&(b.origin_name=b.name,b.c.Ka.dupli_group.objects.push(b)));for(var f=0;f<e.length;f++){var g=e[f],h=b,k=d,l=a,m=c;switch(g.type){case "MAIN_OPAQUE":Z(g,h,k,"OPAQUE",l,m);break;case "MAIN_BLEND":Z(g,h,k,"BLEND",l,m);break;case "MAIN_XRAY":Z(g,h,k,"XRAY",l,m);break;case "MAIN_GLOW":Z(g,h,k,"GLOW",l,m);break;case "MAIN_PLANE_REFLECT":case "MAIN_CUBE_REFLECT":for(var z=
h.c.g,F=h.c.p,n=0;n<F.length;n++){var B=F[n];if(("MAIN"==B.type||"PARTICLES"==B.type)&&"REFLECT"==B.Ma){if("MAIN_PLANE_REFLECT"==g.type){var r;a:{r=l.l.Og.rf;for(var v=0;v<r.length;v++)if(r[v]==g){r=v;break a}r=null}if(r==z.Ec)continue}else{a:{if(l.l.Og)for(r=l.l.Og.Xe,v=0;v<r.length;v++)if(r[v]==g){r=v;break a}r=null}if(r==z.Uc)continue}m||(aa(B,g,h,k,"REFLECT",l),r=B.Eb,la.I(r,"DISABLE_FOG",0),la.I(r,"WATER_EFFECTS",0),"special_skydome.glslf"==la.ur(r)&&la.I(r,"REFLECTION_PASS",1),la.I(r,"TEXTURE_NORM",
0),W(l,B),na.ob(B),ba(B));g.s.push(P(z,B))}}break;case "DEPTH":z=h.c.p;for(F=0;F<z.length;F++)n=z[F],"DEPTH"!=n.type||n.oc||"DEPTH"!=n.Ma&&"NODES"!=n.Ma||(m||(aa(n,g,h,k,"DEPTH",l),na.ob(n),ba(n)),g.s.push(P(h.c.g,n)),H(k,g,n),U(n));break;case "SHADOW_CAST":z=!1;F=h.c.g;h=h.c.p;n=pa.Ya(k,"GRASS_MAP");for(B=0;B<h.length;B++)r=h[B],"DEPTH"==r.type&&"SHADOW_CAST"==r.Ma&&(z=!0,m||(la.I(r.Eb,"SHADOW_USAGE","SHADOW_CASTING"),r.Bb&&n&&ca(r,n,F),na.ta(r,"SHADOW_TEX_RES",la.v(l.l.Ae.csm_resolution)),na.ob(r),
ba(r)),g.s.push(P(F,r)));z&&oa(g,pa.Ya(k,"MAIN_OPAQUE"),g.s,l,!0);break;case "COLOR_PICKING":da(g,h,k,l,m);break;case "COLOR_PICKING_XRAY":da(g,h,k,l,m);break;case "OUTLINE_MASK":k=h.c.g;h=h.c.p;for(l=0;l<h.length;l++)z=h[l],"COLOR_ID"==z.type&&"OUTLINE"==z.Ma&&(m||(na.ta(z,"USE_OUTLINE",1),na.ob(z),ba(z)),g.s.push(P(k,z)));break;case "GRASS_MAP":k=h.c.g;h=h.c.p;for(l=0;l<h.length;l++)z=h[l],"GRASS_MAP"==z.type&&(m||(na.ob(z),ba(z)),g.s.push(P(k,z)),z=g.k,r=k.hb,F=g.ic[0],n=g.ic[1],B=g.ic[2],0==F&&
0==n?(F=r.min_y,n=r.max_y):(F=Math.min(F,r.min_y),n=Math.max(n,r.max_y)),r=1E-4*(n-F),g.ic[0]=F-r,g.ic[1]=n+r,Oa.Dl(z,B/2,-n,-F,B/2),Oa.xf(z));break;case "WIREFRAME":for(l=h.c.g,h=h.c.p,z=0;z<h.length;z++)F=h[z],"WIREFRAME"==F.type&&ea(g,l,k,m,F)}}break;case "LAMP":b.c.wa.index=a.l.zs++;c=ta(a,Ua);for(d=0;d<c.length;d++)c[d].Fg++;fa(b,a)}};a.remove_object=function(a){if(!a.c.g.Kn)return!1;var c=b();yc.WA(c,a,!1);var d=c.Da.ALL.indexOf(a);-1!=d&&c.Da.ALL.splice(d,1);d=c.Da[a.type].indexOf(a);-1!=d&&
c.Da[a.type].splice(d,1);a.c.Ka&&a.c.Ka.dupli_group.objects&&(d=a.c.Ka.dupli_group.objects.indexOf(a),-1!=d&&a.c.Ka.dupli_group.objects.splice(d,1));Rb.Yw(a)&&Rb.remove(a);return!0};a.Eo=function(a){a.l.hl=!0};a.mz=function(a,b){for(var c=a.l.Ae,d=new Float32Array(c.csm_num),e=0;e<c.csm_num;e++)d[e]=Oa.Xx(c,b,e);return d};a.dE=ea;a.hide_object=function(a){a.c.g.Fh=!0};a.show_object=function(a){a.c.g.Fh=!1};a.is_hidden=function(a){return a.g.Fh};a.gB=function(a,b,c){b=b.c.g;a=ta(a,Ia);for(var d=0;d<
a.length;d++)for(var e=a[d].s,f=e.length-1;0<=f;f--){var g=e[f];g.pd==b&&(g.D&&c&&ic.zq(g.D.P),e.splice(f,1))}};a.check_object=function(a,b){return b.Da[a.type]&&-1<b.Da[a.type].indexOf(a)?!0:!1};a.dC=function(a){var b=a.Da.LAMP;if(b.length==a.l.zs){for(var c=[],d=0;d<b.length;d++)c[b[d].c.wa.index]=d;for(d=0;d<c.length-1;d++)for(var e=d+1;e<c.length;e++){var f=b[c[d]].c.wa,g=b[c[e]].c.wa;if(g.$g&&g.Hf&&(!f.$g||!f.Hf)||!f.$g&&(g.$g||!f.Hf&&g.Hf))f=c[d],c[d]=c[e],c[e]=f}for(d=0;d<c.length;d++)b[c[d]].c.wa.index=
d,fa(b[c[d]],a)}};a.Yg=fa;a.cleanup=function(){for(var a=0;a<Fa.length;a++){var b=Fa[a];Ba.X(b.l.jb,function(a,b){if("SINK"!=b.type){var c=b.k;Ac.jB(c.ne,c.nb,c.Vc,c.width,c.height);for(var c=b.s,d=0;d<c.length;d++){var e=c[d].D;e&&na.jx(e)}}});b.l.jb=[];b.l.Ng=[]}Xa=wb=null;Fa.length=0;kb=null;ya.length=0;va[0]=0;va[1]=0;va[2]=0};a.ls=function(a,b,c){a=Oa.By(a,a.bb,a.Xa,null,!0);var d=Kb.Vy(a);a=jb.sh("DYNAMIC");a.hb=a.Hb={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.Ib=
a.Tc=ua.Dw();var e=a.Ib.Ia;a.Vf=a.Te=ua.Ak([e,0,0],[0,e,0],[0,0,e],a.Ib.F);c=na.Ox(d,c);b.s.push(P(a,c))};a.$a=B;a.fF=function(a){return[a.frame_start,a.frame_end]};a.mt=function(a,b,c){Da.UB(a,b,c);Xa&&ia(Xa,a,b)};a.yC=ta;a.da=Y;a.get_environment_colors=function(a){a=ta(a,Ua)[0];var b=a.ff,c=a.Pf,d=[],e=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];e[0]=c[0];e[1]=c[1];e[2]=c[2];return[a.bf,d,e]};a.set_environment_colors=function(a,b,c,d){a=ta(a,Ua);for(var e=0;e<a.length;e++){var f=a[e];isNaN(b)||(f.bf=b);c&&
f.ff.set(c);d&&f.Pf.set(d);f.sa=!0}};a.get_sky_params=function(a){if(a=Y(a,"SKY")){var b={};b.color=Array(3);Ab.copy(a.fi,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;
b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.set_sky_params=function(a,b){var c=Y(a,"SKY");c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.fi.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&
(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=
b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.sa=!0,c.gl=!0,ga(a,c))};a.get_fog_color_density=function(a,b){var c=b||[],d=ta(a,gb)[0].Yb;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.set_fog_color_density=function(a,b){for(var c=ta(a,gb),d=0;d<c.length;d++){var e=c[d];e.Yb.set(b);e.sa=!0}};a.get_ssao_params=function(a){var b=Y(a,"SSAO");a=Y(a,"SSAO_BLUR");if(!b)return null;var c=b.s[0].D,d={};d.ssao_quality=na.Cb(c,"SSAO_QUALITY")[1];
d.ssao_hemisphere=b.ssao_hemisphere;d.ssao_blur_depth=a.ssao_blur_depth;d.iq=a.ssao_blur_discard_value;d.radius_increase=b.ii;d.influence=b.hi;d.dist_factor=b.gi;d.ssao_only=b.ssao_only;d.ssao_white=na.Cb(c,"SSAO_WHITE")[1];return d};a.set_ssao_params=function(a,b){var c=Y(a,"SSAO"),d=Y(a,"SSAO_BLUR");if(!c)return Va.error("SSAO is not enabled on the scene"),0;if("string"==typeof b.ssao_quality){var e=c.s[0].D;na.ta(e,"SSAO_QUALITY",b.ssao_quality);na.ob(e,!0)}"number"==typeof b.ssao_hemisphere&&
(e=c.s[0].D,na.ta(e,"SSAO_HEMISPHERE",b.ssao_hemisphere),na.ob(e,!0));"number"==typeof b.ssao_blur_depth&&(e=d.s[0].D,na.ta(e,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),na.ob(e,!0));"number"==typeof b.ssao_blur_discard_value&&(d.ssao_blur_discard_value=b.ssao_blur_discard_value);"number"==typeof b.ii&&(c.ii=b.ii);"number"==typeof b.hi&&(c.hi=b.hi);"number"==typeof b.gi&&(c.gi=b.gi);if("number"==typeof b.ssao_only){c=Y(a,"MAIN_OPAQUE");c.ssao_only=b.ssao_only;for(var f=0;f<c.s.length;f++)e=c.s[f].D,na.ta(e,
"SSAO_ONLY",b.ssao_only),na.ob(e,!0)}"number"==typeof b.ssao_white&&(e=c.s[0].D,na.ta(e,"SSAO_WHITE",b.ssao_white),na.ob(e,!0));c.sa=!0;d.sa=!0};a.get_dof_params=function(a){a=Y(a,"DOF");if(!a)return null;var b={};b.dof_distance=a.k.dof_distance;b.dof_front=a.k.dof_front;b.dof_rear=a.k.dof_rear;b.dof_power=a.k.dof_power;b.ke=a.k.ke;return b};a.set_dof_params=ja;a.get_god_rays_params=function(a){var b=ta(a,["GOD_RAYS"]);a=Y(a,"GOD_RAYS_COMBINE");if(!b||!a)return null;var c={};c.god_rays_max_ray_length=
b[0].Oh;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=na.Cb(b[0].s[0].D,"STEPS_PER_PASS")[1];return c};a.set_god_rays_params=function(a,b){var c=ta(a,["GOD_RAYS"]),d=Y(a,"GOD_RAYS_COMBINE");if(!c||!d)return Va.error("God Rays are not enabled on the scene"),0;"number"==typeof b.god_rays_intensity&&(d.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var e=b.god_rays_max_ray_length,f=0;f<c.length;f++)c[f].Oh=e,c[f].xl=e/c[f].mi/(f+1),c[f].sa=!0;
if("number"==typeof b.god_rays_steps)for(var g=la.v(b.god_rays_steps,1),e=c[0].Oh,f=0;f<c.length;f++){c[f].mi=g;c[f].xl=e/g/(f+1);c[f].sa=!0;var h=c[f].s[0].D;na.ta(h,"STEPS_PER_PASS",g);na.ob(h,!0)}d.sa=!0};a.get_bloom_params=function(a){var b=Y(a,"LUMINANCE_TRUNCED");a=Y(a,"BLOOM");if(!b||!a)return null;var c={};c.bloom_key=b.bloom_key;c.bloom_edge_lum=b.bloom_edge_lum;c.bloom_blur=a.bloom_blur;return c};a.set_bloom_params=sa;a.get_glow_material_params=function(a){a=Y(a,"GLOW_COMBINE");if(!a)return null;
var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.set_glow_material_params=z;a.get_wind_params=function(){var a=va,b=Ab.length(a);if(0==b)return null;var c={};c.wind_dir=180*Math.atan(a[0]/a[2])/Math.PI;c.wind_strength=b;return c};a.set_wind_params=function(b,c){for(var d=B(b,"ALL",a.DATA_ID_ALL),e=0;e<d.length;e++){var f=d[e];if("EMPTY"===
f.type&&f.field&&"WIND"===f.field.type)var g=f}if(!g)return Va.error("There is no wind on the scene"),0;d=g.c.g;"number"==typeof c.wind_dir&&(qa=[0,c.wind_dir/180*Math.PI,-Math.PI/2],Qa.euler_to_quat(qa,Ub),d.quat.set(Ub),Zb(g));"number"==typeof c.wind_strength&&(d.kn=c.wind_strength,Zb(g));xa(b)};a.wB=function(a){a.l.io=!0};a.get_water_surface_level=F;a.get_water_mat_params=function(a,b){var c=Y(a,"MAIN_OPAQUE");if(c&&(b.waves_height=c.Nf,b.waves_length=c.gh,c.wd)){b.water_fog_density=c.wd[3];var d=
b.water_fog_color=[];d[0]=c.wd[0];d[1]=c.wd[1];d[2]=c.wd[2]}};a.set_water_params=function(a,b){var c=Y(a,"MAIN_OPAQUE");if(!c||!c.mb)return Va.error("set_water_params() - no water parameters on the scene"),null;c=c.mb;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=
b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);
"number"==typeof b.water_dynamic&&(c.$i=b.water_dynamic);for(var d=ta(a,yb),e=0;e<d.length;e++){var f=d[e];"number"==typeof b.water_fog_density&&c.Yb&&(f.wd[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.Yb&&f.wd.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.Nf=b.waves_height);"number"==typeof b.waves_length&&(f.gh=b.waves_length);f.sa=!0}};a.get_shore_dist=function(a,b){var c=Y(Xa,"MAIN_OPAQUE");if(!c.Ql)return 100;var d=c.Ph,e=c.Mf,f=(a[0]-c.zf[0])/c.Af[0],g=(c.zf[1]+
a[2])/c.Af[1],f=f+.5,g=g+.5;if(1<f||0>f||1<g||0>g)e=1;else return c=d*Qa.pr(Xa.l.Fo,c.ei,f,g),e=(e-a[1])*b,e=Math.sqrt(c*c+e*e)};a.update=function(a,c){for(var d=b().camera.c.g,e=0;e<Fa.length;e++){var f=Fa[e],g=f.l.jb;if(f.l.mb)var h=d.i[1]-F(d.i[0],d.i[2]);for(var k=f.l.vi,l=0;l<k.length;l++){var m=k[l].l,z=m.Ta,n=m.Ah+m.ra;if(z){var B=Math.round(z.currentTime*m.hc),r=m.ra/m.hc;if(B<m.ra-(La.rg?5:0)||k[l].l.Zg&&B>n)z.currentTime=r;!m.Zg&&B>n&&z.pause();2<=z.readyState&&!z.paused&&zc.hD(m)}else if(m.bi){z=
Math.min(m.bi.length,m.Ah+m.ra);if(m.ze<m.ra||m.Zg&&m.ze>=z)m.ze=m.ra;!m.Zg&&m.ze>=z&&(m.ci=!1);z=Math.round(a*Vc.Ra/m.hc)*m.ht;z!=vb&&m.ci&&(zc.eD(m),m.ze++);vb=z}}Ba.X(g,function(b,c){-1<Ta.indexOf(c.type)&&(c.time=a);f.l.mb&&(c.zm=h)})}for(e=0;e<Fa.length;e++)if(f=Fa[e],l=f.l,d=l.Ng,l.hl&&(S(f),l.hl=!1),l.io&&(ha(f),l.io=!1),d.length){f.b4w_enable_motion_blur&&T(l.jb,c);if(l.outline){for(var v=0,e=0;e<f.Da.MESH.length;e++)l=f.Da.MESH[e],v+=l.c.g.qd,-1!=ya.indexOf(l)&&hc(l,a);Ba.X(f.l.jb,function(a,
b){"OUTLINE"===b.type&&(b.Xm=v)})}g=null;for(l=0;l<d.length;l++)"OUTLINE_MASK"==d[l].type&&(g=l);for(l=0;l<d.length;l++)k=d[l],Ca.to(k),null!==g&&ka(k,d[g]),Ac.Zi(k)}La.show_hud_debug_info&&ub.YB(Fa,c)};a.rn=function(a){var b=[];Ba.X(a.l.jb,function(a,c){b.push(c)});return b};a.apply_outline_anim=function(a,b,c,d){a.Rv={bp:0,Es:b,ad:c,at:d};-1==ya.indexOf(a)&&ya.push(a)};a.clear_outline_anim=function(a){a.c.g.qd=0;a=ya.indexOf(a);-1!=a&&ya.splice(a,1)};a.xE=function(){ya=[]};a.get_cam_water_depth=
function(){var a=Y(Xa,"MAIN_BLEND"),b=Xa;return a||b.l.mb?a.zm:null};a.get_object_data_id=function(a){return a.c.g.Xb};a.cu=xa;a.SB=function(a,b){switch(b){case "WM_NONE":a.Wa=!1;break;case "WM_OPAQUE_WIREFRAME":case "WM_TRANSPARENT_WIREFRAME":case "WM_FRONT_BACK_VIEW":case "WM_DEBUG_SPHERES":for(var c=0;c<a.s.length;c++)a.s[c].D.wireframe_mode=pc.Fp[b];a.Wa=!0}a.Ha="WM_TRANSPARENT_WIREFRAME"==b;a.sa=!0};a.RB=function(a,b){for(var c=0;c<a.s.length;c++)a.s[c].D.wireframe_edge_color=b,a.sa=!0};a.Pp=
function(a,b){for(var c=0;c<b.length;c++)a.Da.ALL.push(b[c]),a.Da.MESH.push(b[c])};a.Zt=Zb;a.pick_object=function(b,d){var e=c();if(!e)return Va.error("No active scene"),null;var f=Y(e,"COLOR_PICKING");if(f){var g=Da.Am(b,d,Ga,f.k);Ca.to(f);Ac.Zi(f);var h=Y(e,"COLOR_PICKING_XRAY");h?(Ca.to(h),Ac.Zi(h),f=h.k):f=f.k;g[1]=f.height-g[1];h=Ac.Ys(f.ne,g[0],g[1]);g=B(e,"MESH",a.DATA_ID_ALL);for(f=0;f<g.length;f++){var k=g[f].c.g,l=k.xk;if(l&&3>Math.abs(255*l[0]-h[0])&&3>Math.abs(255*l[1]-h[1])&&3>Math.abs(255*
l[2]-h[2]))return k.Lb&&k.Ds&&(Sb.outlining_overview_mode?(Pa(Sb.pf),k.qd=Sb.qd,a.apply_outline_anim(g[f],Sb.ml,Sb.nl,Sb.ol)):(Pa(e.b4w_outline_color),k.qd=e.b4w_outline_factor,e=k.wj,a.apply_outline_anim(g[f],e.ml,e.nl,e.ol))),g[f]}}else Va.error("Object Selection is not available on the scene");return null};a.set_outline_color=Pa;a.Hz=function(){return va};a.yz=function(b){var c=[];b=B(b,"MESH",a.DATA_ID_ALL);for(var d=0;d<b.length;d++){var e=b[d];e.c.g.Ug&&c.push(e)}return c};a.get_meta_tags=function(a){var b=
{title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.LC=function(){for(var b=Xa,c=B(b,"MESH",a.DATA_ID_ALL),d=0;d<c.length;d++)for(var e=c[d].c.p,f=0;f<e.length;f++){var g=e[f];"MAIN"==g.type&&(W(b,g),na.ob(g))}};a.Yt=function(a,b){var c=qa;Ab.negate(b,c);for(var d=0;6>d;d++){var e=a.Ti[d],f=a.Om[d],g=a.k;Tb.translate(Qa.wu[d],c,e);Tb.multiply(g.xa,e,g.Rd);Qa.dn(g.Rd,f)}};a.au=function(a,b,c){Qa.GC(b,c,Qa.AXIS_Y,a.k.cc)};a.xw=function(a){for(var b=
0;b<a.length;b++)for(var c=a[b],d=c.c.Tg,e=0;e<d.length;e++){var f=d[e],g=f.Sg;if(null!=c.c.g.Ec){var h=g.l.Og.rf;h.length&&(g=c.c.g.Ec,f.rf=h[g])}else null!=c.c.g.Uc&&(h=g.l.Og.Xe,h.length&&(g=c.c.g.Uc,f.Xe=h[g]))}};a.marker_frame=function(a,b){return a.timeline_markers[b]}};b4w.module.__physics=function(a,p){function c(a,b){for(var d=a.c.kd,e=0;e<d.length;e++)d[e].c.g.Ol&&b.push(d[e]),c(d[e],b)}function d(a,b){for(var c=a.pb.s,d=0;d<c.length;d++)for(var e=c[d].q,f=0;f<e.gc.length;f++){var g=e.gc[f];"ANY"!=g.Va&&b!=g.Va||t(g)}}function b(a,b){if(da)switch(a){case v.Fu:da.pb.ru=!0;v.B(v.mv,Date.now()-performance.now(),ca.od,ca.xm?S.hr:0);break;case v.Gu:Q.Zn("URANIUM:",b.slice(1));break;case v.Bu:Q.error(b);break;case v.Cu:I.fbmsg.apply(this,b.slice(1));break;case v.Lu:var c=
e(b.L);if(c){var d=b.i,f=b.quat,h=b.Gd,k=b.zd,c=c.c.q;c.Pm=b.time;Z.set_sep(d,1,f,c.Qm);W.copy(h,c.Gd);W.copy(k,c.zd)}break;case v.Iu:(d=e(b.Bm))&&Z.set_sep(b.i,1,b.quat,d.c.m.Fj[b.uo]);break;case v.Du:if(f=e(b[1]))d=b[4],f=f.c.Yc.rk[b[2]],P.set_translation(f,b[3]),P.set_rotation(f,d),P.A(f);break;case v.Mu:if(c=e(b[1]))c.c.m.speed=b[2];break;case v.xu:l(da,b.Wf,b.Xf,b.result,null,null,0);break;case v.zu:l(da,b.Wf,b.Xf,b.result,b.$f,b.coll_norm,b.coll_dist);break;case v.yu:if(c=e(b[1]))d=c.c.q,d.Oi&&
d.Oi(b[2]);break;case v.zp:case v.Ju:if(d=da.pb.Yh[b.id])if(f=e(b.nh),a==v.zp)h=d.callback,h(d.id,b.hit_fract,f,b.hit_time);else{var h=b.hit_fract,k=b.hit_time,c=b.hit_pos,m=d.callback;c?m(d.id,h,f,k,c,b.hit_norm):m(d.id,h,f,k)}break;case v.Ku:g(id);break;case v.Hu:console.log("Physics Ping: OUT "+(b[2]-b[1]).toFixed(3)+" ms, IN "+(performance.now()-b[2]).toFixed(3)+" ms, ALL "+(performance.now()-b[1]).toFixed(3)+" ms");break;case v.Eu:oa=b[1];break;case v.Au:console.log(b[1]);break;default:Q.error("Wrong message: "+
a)}}function e(a){return ea[a]||null}function l(a,b,c,d,f,g,h){a=a.pb.s;for(var k=0;k<a.length;k++)for(var l=a[k].q,n=0;n<l.gc.length;n++){for(var B=l.gc[n],r=B.qf,v=!1,q=0;q<r.length;q++){var t=r[q];if(t[0]===b&&t[1]===c){B.yj[q]=d;v=!0;break}}v&&(r=m(B),f&&B.sm!=b&&(v=f,q=g,t=h,v[0]+=q[0]*t,v[1]+=q[1]*t,v[2]+=q[2]*t,q[0]*=-1,q[1]*=-1,q[2]*=-1),B.callback(r,r?B.sm==b?e(c):e(b):null,f,g,h))}}function m(a){a=a.yj;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function h(){B.body++;return B.body}
function n(a){if("ANY"==a)return 0;var b=ga.indexOf(a);return-1==b?(ga.push(a),ga.length-1):b}function f(a){return{L:a,Mh:0,Zk:!1,Bf:!0,Bc:!1,is_character:!1,Yz:!1,yk:null,Va:"",Pi:0,zE:{},gc:[],Oi:null,Pm:0,Qm:new Float32Array([0,0,0,1,0,0,0,1]),Gd:new Float32Array(3),zd:new Float32Array(3),vk:new Float32Array(3),uk:new Float32Array(4)}}function k(a,b){switch(a){case "BOX":var c=b.Hb;break;case "CYLINDER":c=b.nm;break;case "CONE":c=b.mm;break;case "SPHERE":c=b.Tc;break;case "CAPSULE":c=b.lm}return c}
function r(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.F&&(b.center=a.F);"number"===typeof a.Ia&&(b.radius=a.Ia);"number"===typeof a.height&&(b.height=a.height);return b}function y(a,b,c,d){var e=a.c.g.i,f=b.c.g.Z,g=new Float32Array(16);
U.invert(f,g);f=new Float32Array(3);W.transformMat4(e,g,f);switch(b.c.m.type){case 10:b=b.c.rc;a=a.c.g.Hb;v.B(v.Qu,c,f,b.BC,b.Co,(a.max_y-a.min_y)/2,d);break;case 20:v.B(v.Pu,c,f,a.ZF)}}function w(a){return a.c.q&&a.c.q.yk?!0:!1}function C(a,b,c,d,e,f,g,h,k,l){var m;B.Pa++;m=B.Pa.toString(16);v.B(v.Xu,m,a,h,b.c.q.L,c,d,e.c.q.L,f,g,k,l);b.c.q.yk=m}function D(a){var b=a.c.q;if(b&&(0===b.Mh||!0===b.Zk||!1===b.Bf||"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type)&&(a.c.g.i[0]!=a.c.q.vk[0]||a.c.g.i[1]!=a.c.q.vk[1]||
a.c.g.i[2]!=a.c.q.vk[2]||a.c.g.quat[0]!=a.c.q.uk[0]||a.c.g.quat[1]!=a.c.q.uk[1]||a.c.g.quat[2]!=a.c.q.uk[2])){var b=a.c.q,c=a.c.g;W.copy(c.i,b.vk);ba.copy(c.quat,b.uk);var d=v.wr(v.ck);d.L=b.L;d.i=c.i;"DYNAMIC"==b.type?ba.identity(d.quat):d.quat=c.quat;v.B(v.ck)}a=a.c.kd;for(b=0;b<a.length;b++)D(a[b])}function G(a,b,c,d,e){e=e||new Float32Array(3);a=a.c.g.quat;e[0]=b;e[1]=c;e[2]=d;W.transformQuat(e,a,e)}function t(a){var b=a.qf,c=a.yj,d=a.sm,e=[],f=a.Va,g=da;if(!e)throw"At least one destination required";
for(var h=0;h<g.pb.s.length;h++){var k=g.pb.s[h];if("ANY"==f||k.q.Va==f)k=k.q.L,e&&-1==e.indexOf(k)&&e.push(k)}for(f=0;f<e.length;f++)g=e[f],d<g&&!A(b,d,g)?(b.push([d,g]),c.push(!1)):d>g&&!A(b,g,d)&&(b.push([g,d]),c.push(!1));v.B(v.Ou,d);v.B(v.Wu,b,a.Ad)}function A(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function x(a){u(a)&&(a=a.c.q,v.B(v.iv,a.L),a.Oi=null)}function u(a){return a.c.q&&a.c.q.Oi?!0:!1}function g(a){var b=da.pb;b.Yh[a]&&(delete b.Yh[a],b.yo.splice(b.yo.indexOf,
1),v.B(v.rv,a))}function q(a,b){if(b.li){var c=a.c.q.L,d=b.wh*b.dj,e=b.Ki*b.Li,f=-b.ji*b.ki*2*Math.PI/b.Oj;b.nj&&(f*=-1);switch(b.type){case 10:v.B(v.Ev,c,d,e,f);break;case 20:v.B(v.Dv,c,d,e,f)}}}function L(a){return a.c.Bc&&"CHASSIS"==a.c.rc.kc?!0:!1}function J(a){return a.c.Bc&&"HULL"==a.c.rc.kc?!0:!1}function E(a){return a.c.is_character?!0:!1}function M(a){return a.c.Ih&&"MAIN_BODY"==a.c.yh.kc?!0:!1}var K=p("__config");p("__constraints");var Q=p("__print"),I=p("__debug"),v=p("__ipc");p("__renderer");
var H=p("__scenes"),P=p("__transform"),Z=p("__tsr"),aa=p("__util"),R=p("__version"),W=p("vec3"),ba=p("quat"),U=p("mat4"),ca=K.q,S=K.r,oa=0,X=null,da=null,ea={},fa=[],ga=[],B={body:0,Pa:0,Vs:0},N=new Float32Array(3),ia=new Float32Array(4),ta=new Float32Array(4),Y=new Float32Array(16),ja=new Float32Array(8),sa=new Float32Array(8);a.Tz=function(a){if(da)Q.warn("Multiple physics scenes are currently not supported");else{a.pb={ru:!1,s:[],Yh:{},yo:[]};var c=ca.Tj+R.timestamp();Q.log("%cLOAD PHYSICS","color: #0a0",
c,"Max FPS: "+ca.od);X=new Worker(c);v.init(X,b);da=a;ca.ping&&setInterval(function(){v.B(v.ov,performance.now())},1E3)}};a.ex=function(a){return a.pb?a.pb.ru:!0};a.cleanup=function(){if(da){X.terminate();da=X=null;ea={};fa.length=0;ga.length=0;for(var a in B)B[a]=0}};a.append_object=function(a,b){var e=a.c.g;if(!e)throw"No object render: "+a.name;if(a.parent&&e.Ol)return null;var g=[];e.Ol&&c(a,g);var l=b.pb.s;if(L(a)||J(a)||E(a)||M(a)||a.b4w_collision){var m,B=a,t=e.Js,u=B.c.g,x=B.game,p=h();if("CAMERA"==
B.type)var N=x.use_collision_bounds?x.collision_bounds_type:"BOX",ia=k(N,u),A=u.gj,D=u.aj,A=.5,D=0;else"EMPTY"==B.type?(N="EMPTY",ia=null,D=A=0):(N=x.use_collision_bounds?x.collision_bounds_type:"BOX",ia=k(N,u),A=u.gj,D=u.aj);var I=u.i,G=u.quat,P=x.use_ghost,K=x.use_sleep,Z=x.mass,ja=x.velocity_min,R=x.velocity_max,sa=x.damping,ga=x.rotation_damping,S=B.b4w_collision_id,Ca=n(S),ca=x.collision_margin,X=x.collision_group,oa=x.collision_mask,pa=u.Tc.Ia,Kc=r(ia),la=B.b4w_correct_bounding_offset,zc;var Qa=
N;if(g.length){var Ab=[],Tb={};Tb.quat=new Float32Array([0,0,0,1]);Tb.trans=new Float32Array(3);Tb.worker_bounding=Kc;Tb.bounding_type=Qa;Ab.push(Tb);U.invert(u.Z,Y);ba.invert(u.quat,ta);for(var La=0;La<g.length;La++){var Sb={},ib=g[La],Vc=ib.game.collision_bounds_type,Bc=new Float32Array(4),Ea=new Float32Array(3);W.transformMat4(ib.c.g.i,Y,Ea);ba.multiply(ta,ib.c.g.quat,Bc);Sb.trans=Ea;Sb.quat=Bc;Sb.bounding_type=Vc;Sb.worker_bounding=r(k(Vc,ib.c.g));Ab.push(Sb)}zc=Ab}else zc=[];v.B(v.Tu,p,I,G,t,
P,K,Z,ja,R,sa,ga,Ca,ca,X,oa,N,Kc,pa,A,D,zc,la);ea[p]=B;fa.push(B);var Ia=f(p);Ia.type=t;Ia.Mh=Z;Ia.Zk=P;Ia.Va=S;Ia.Pi=Ca;m=Ia;a.c.q=m;var Ua={D:null,q:m};l.push(Ua);d(b,m.Va)}else for(var gb=a.c.p,Ta=0;Ta<gb.length;Ta++){var yb=gb[Ta],vb;if(vb="PHYSICS"==yb.type){var wb;a:{for(var Xa=b.pb.s,Fa=0;Fa<Xa.length;Fa++){var kb=Xa[Fa].D;if(kb&&kb.id==yb.id){wb=!0;break a}}wb=!1}vb=!wb}if(vb)if(yb.Lc.O)if(yb.Lf&&b.l.mb){var ya=yb,Wa=da,Ga=H.da(Wa,"MAIN_OPAQUE");v.B(v.bv,Ga.Mf);if(Ga.mb&&ya.ED){var qa={};
qa.dst_noise_scale0=ya.dst_noise_scale0;qa.dst_noise_scale1=ya.dst_noise_scale1;qa.dst_noise_freq0=ya.dst_noise_freq0;qa.dst_noise_freq1=ya.dst_noise_freq1;qa.dir_min_shore_fac=ya.dir_min_shore_fac;qa.dir_freq=ya.dir_freq;qa.dir_noise_scale=ya.dir_noise_scale;qa.dir_noise_freq=ya.dir_noise_freq;qa.dir_min_noise_fac=ya.dir_min_noise_fac;qa.dst_min_fac=ya.dst_min_fac;qa.waves_hor_fac=ya.waves_hor_fac;var Wb=Ga.Nf,Ub=Ga.gh;Ga.Ql?v.B(v.Bp,qa,Ga.Af[0],Ga.Af[1],Ga.zf[0],Ga.zf[1],Ga.Ph,Wb,Ub,Ga.ei,Wa.l.Fo):
v.B(v.Bp,qa,0,0,0,0,0,Wb,Ub,0,null)}}else{var wa;if(yb.mD){var rc=a,V=yb,Hb=h(),Lb=V.Lc,va=Lb.C[0].a_position,za=Lb.ka||null,zb=V.Va,Cc=n(zb);v.B(v.Zu,Hb,va,za,rc.c.g.i,Cc,V.Cq,V.Bq,V.Dq);var db=f(Hb);db.Zk=!0;db.Va=zb;db.Pi=Cc;wa=db}else{var hb=a,$a=yb,Ma=h(),eb=$a.Lc,bc=eb.C[0].a_position,Mb=eb.ka||null,ab=hb.c.g.i,Nb=$a.gj,Mc=$a.aj,Ob=$a.Va,Nc=n(Ob);v.B(v.av,Ma,bc,Mb,ab,Nb,Mc,Nc,$a.Cq,$a.Bq,$a.Dq);var Dc=f(Ma);Dc.Va=Ob;Dc.Pi=Nc;wa=Dc}m=wa;Ua={D:yb,q:m};l.push(Ua);d(b,m.Va)}else Q.error("Object "+
a.name+" has collision material with no assigned vertices")}if(L(a)||J(a)){var Ha=a,lb=Ha.c.q.L;L(Ha)?(Ha.c.m.type=10,v.B(v.Uu,lb,Ha.c.m.Vo,Ha.c.m.Xo,Ha.c.m.Wo,Ha.c.m.tp,Ha.c.m.bo)):J(Ha)&&(Ha.c.m.type=20,v.B(v.Su,lb,Ha.c.m.hg,Ha.c.m.eh,Ha.c.m.fh));if(Ha.c.m.Mg){var Bb=Ha.c.m.Mg;switch(Ha.c.m.type){case 10:y(Bb[1],Ha,lb,!0);y(Bb[0],Ha,lb,!0);y(Bb[3],Ha,lb,!1);y(Bb[2],Ha,lb,!1);break;case 20:for(var bb=0;bb<Bb.length;bb++)y(Bb[bb],Ha,lb,!1)}}q(a,a.c.m)}else if(E(a)){var Vb=a.c.g,Cb=a.c.q,cc=Vb.Hb.max_y-
Vb.Hb.min_y,Aa=Cb.L,Ra=a.c.tq,qb=Ra.DD,Xb=Ra.sB,Ka=Ra.rC,sc=Ra.hA,Pb=Ra.FD,Ib=aa.my(a);v.B(v.Vu,Aa,Ib,cc,qb,Xb,Ka,sc,Pb);Cb.is_character=!0}else if(M(a)){var Ya=a,jc=Ya.c.q.L;v.B(v.Yu,jc,Ya.c.Yc.hg,Ya.c.Yc.eh,Ya.c.Yc.fh);if(Ya.c.Yc.rk)for(var $b=Ya.c.Yc.rk,kc=0;kc<$b.length;kc++){var mb=$b[kc],rb=mb.c.g.i,Db=Ya.c.g.Z,dc=new Float32Array(16);U.invert(Db,dc);var Eb=new Float32Array(3);W.transformMat4(rb,dc,Eb);v.B(v.Ru,jc,Eb,mb.Iw)}Ya.c.q.Yz=!0}for(Ta=0;Ta<fa.length;Ta++)if(a=fa[Ta],a.c.q){var Yb=a;
if(!w(Yb))for(var ac=0;ac<Yb.constraints.length;ac++){var sb=Yb.constraints[ac],xb=sb.target,Qb=sb.pivot_type;if("RIGID_BODY_JOINT"==sb.type&&xb.c.q){var Oc=new Float32Array([sb.pivot_x,sb.pivot_y,sb.pivot_z]),nb,Na=new Float32Array([sb.axis_x,sb.axis_y,sb.axis_z]);nb=aa.euler_to_quat(Na,new Float32Array(4));var Ec=U.fromRotationTranslation(nb,Oc,new Float32Array(16)),Fb=U.multiply(Yb.c.g.Z,Ec,new Float32Array(16)),lc=U.invert(xb.c.g.Z,new Float32Array(16)),ec=U.multiply(lc,Fb,lc),Fc=aa.Nh(ec),Gc=
aa.matrix_to_quat(ec),fb=sb,Sa={};Sa.use_limit_x=fb.use_limit_x;Sa.use_limit_y=fb.use_limit_y;Sa.use_limit_z=fb.use_limit_z;Sa.use_angular_limit_x=fb.use_angular_limit_x;Sa.use_angular_limit_y=fb.use_angular_limit_y;Sa.use_angular_limit_z=fb.use_angular_limit_z;Sa.limit_max_x=fb.limit_max_x;Sa.limit_min_x=fb.limit_min_x;Sa.limit_max_y=fb.limit_max_y;Sa.limit_min_y=fb.limit_min_y;Sa.limit_max_z=fb.limit_max_z;Sa.limit_min_z=fb.limit_min_z;Sa.limit_angle_max_x=fb.limit_angle_max_x;Sa.limit_angle_min_x=
fb.limit_angle_min_x;Sa.limit_angle_max_y=fb.limit_angle_max_y;Sa.limit_angle_min_y=fb.limit_angle_min_y;Sa.limit_angle_max_z=fb.limit_angle_max_z;Sa.limit_angle_min_z=fb.limit_angle_min_z;C(Qb,Yb,Oc,nb,xb,Fc,Gc,Sa,null,null)}}}};a.Gy=e;a.update=function(){for(var a=0;a<fa.length;a++){var b=fa[a],c=b.c.q;if(c.Bf&&c.Pm){var d=performance.now()/1E3-c.Pm,d=Math.min(d,10/ca.od),d=d-1/ca.od;S.EA&&(d=0);var e=ja;Z.Uz(c.Qm,d,c.Gd,c.zd,ja);P.OB(b,e);P.A(b);D(b);if(b.c.m)for(var c=b,d=c.c.m.Mg,e=c.c.g.Fb,
f=ja,g=0;g<d.length;g++){var h=d[g];Z.multiply(e,c.c.m.Fj[g],f);P.set_tsr(h,f);P.A(h)}b.c.m&&b.c.m.li&&(c=b.c.m,d=c.li)&&(e=b.c.m.Ht,h=Y,f=b.c.g.i,g=b.c.g.quat,aa.fp(b.c.m.It,g,f,h),aa.Nh(h,d.c.g.i),aa.matrix_to_quat(h,d.c.g.quat),h=ia,aa.gp(e,g,f,h),e=ta,ba.setAxisAngle(h,-c.ji*c.ki*2*Math.PI,e),ba.multiply(e,d.c.g.quat,d.c.g.quat),P.A(d));b.c.m&&b.c.m.Oo&&(c=b.c.m,d=c.Oo)&&(f=b.c.m.Ct,e=Y,g=b.c.g.i,h=b.c.g.quat,aa.fp(b.c.m.Dt,h,g,e),aa.Nh(e,d.c.g.i),aa.matrix_to_quat(e,d.c.g.quat),e=ia,aa.gp(f,
h,g,e),f=ta,g=Math.abs(c.speed)*c.Mj,g>c.Qh&&(g=c.Qh),ba.setAxisAngle(e,-g,f),ba.multiply(f,d.c.g.quat,d.c.g.quat),P.A(d));b.c.m&&b.c.m.Yo&&(c=b.c.m,d=c.Yo)&&(e=b.c.m.Pt,h=Y,f=b.c.g.i,g=b.c.g.quat,aa.fp(b.c.m.Qt,g,f,h),aa.Nh(h,d.c.g.i),aa.matrix_to_quat(h,d.c.g.quat),b=ia,aa.gp(e,g,f,b),e=ta,ba.setAxisAngle(b,-Math.abs(c.wh)*c.Wi,e),ba.multiply(e,d.c.g.quat,d.c.g.quat),P.A(d))}}if(a=da)a=H.da(a,"MAIN_OPAQUE"),a.mb&&0<a.mb.waves_height&&(b=W.length(a.Of),v.B(v.Cv,a.time*b));v.TA()};a.cz=function(){return da};
a.pause=function(){da&&v.B(v.nv)};a.resume=function(){da&&v.B(v.sv)};a.enable_simulation=function(a){a=a.c.q;if(!a)throw"No object physics";if(!a.Bf){var b=a.L;a.Bf=!0;v.B(v.lv,b)}};a.disable_simulation=function(a){a=a.c.q;if(!a)throw"No object physics";if(a.Bf){var b=a.L;a.Bf=!1;v.B(v.kv,b)}};a.Bl=function(a){return Boolean(a.pb)};a.K=function(a){return Boolean(a.c.q)};a.has_dynamic_physics=function(a){return(a=a.c.q)&&a.Bf&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Mh&&0==a.Zk?!0:!1};a.has_simulated_physics=
function(a){return(a=a.c.q)&&a.Bf?!0:!1};a.set_gravity=function(a,b){v.B(v.Bv,a.c.q.L,b)};a.Mz=w;a.apply_constraint=C;a.clear_constraint=function(a){a=a.c.q;v.B(v.qv,a.yk);a.yk=null};a.pull_to_constraint_pivot=function(b,c,d,e,f,g){c=Z.create_sep(c,1,d,ja);f=Z.create_sep(f,1,g,sa);Z.invert(c,c);Z.multiply(f,c,c);P.get_tsr(e,f);Z.multiply(f,c,c);P.set_tsr(b,c);P.A(b);a.set_transform(b,b.c.g.i,b.c.g.quat)};a.set_transform=function(a,b,c){Z.set_sep(a.c.g.i,1,a.c.g.quat,a.c.q.Qm);var d=v.wr(v.ck);d.L=
a.c.q.L;d.i=b;d.quat=c;v.B(v.ck)};a.sync_transform=D;a.apply_velocity=function(a,b,c,d){G(a,b,c,d,N);a=a.c.q.L;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var e=Math.abs(N[0]),f=Math.abs(N[1]),g=Math.abs(N[2]);N[0]=e?N[0]/e*Math.max(e,b):0;N[1]=f?N[1]/f*Math.max(f,c):0;N[2]=g?N[2]/g*Math.max(g,d):0;v.B(v.Dp,a,N[0],N[1],N[2])};a.apply_velocity_world=function(a,b,c,d){v.B(v.Dp,a.c.q.L,b,c,d)};a.apply_force=function(a,b,c,d){G(a,b,c,d,N);v.B(v.cv,a.c.q.L,N[0],N[1],N[2])};a.apply_torque=function(a,b,c,
d){G(a,b,c,d,N);v.B(v.ev,a.c.q.L,N[0],N[1],N[2])};a.set_character_move_dir=function(a,b,c){v.B(v.vv,a.c.q.L,b,c)};a.set_character_move_type=function(a,b){v.B(v.wv,a.c.q.L,b)};a.set_character_walk_velocity=function(a,b){v.B(v.Av,a.c.q.L,b)};a.set_character_run_velocity=function(a,b){v.B(v.yv,a.c.q.L,b)};a.set_character_fly_velocity=function(a,b){v.B(v.tv,a.c.q.L,b)};a.character_jump=function(a){v.B(v.gv,a.c.q.L)};a.character_rotation_inc=function(a,b,c){v.B(v.hv,a.c.q.L,b,c)};a.set_character_rotation=
function(a,b,c){v.B(v.xv,a.c.q.L,b,c)};a.set_character_rotation_h=function(a,b){v.B(v.uv,a.c.q.L,b)};a.set_character_rotation_v=function(a,b){v.B(v.zv,a.c.q.L,b)};a.append_collision_test=function(a,b,c,d){a=a.c.q;var e=a.L;b=b||"ANY";for(var f=0;f<a.gc.length;f++){var g=a.gc[f];if(g.Va==b&&g.callback==c)return}g={sm:e,Ad:d||!1,Va:b,callback:c,qf:[],yj:[]};a.gc.push(g);t(g)};a.remove_collision_test=function(a,b,c){a=a.c.q;for(var d=0;d<a.gc.length;d++){var e=a.gc[d];if(e.Va==b&&e.callback==c){if(m(e)){var f=
W.set(0,0,0,N);e.callback(!1,null,f,f,0)}a.gc.splice(d,1);d--;for(var e=e.qf,f=da.pb.s,g=0;g<f.length;g++)for(var h=f[g].q,k=0;k<h.gc.length;k++)for(var l=h.gc[k],n=0;n<l.qf.length;n++)for(var B=l.qf[n],r=0;r<e.length;r++){var q=e[r];B[0]==q[0]&&B[1]==q[1]&&(e.splice(r,1),r--)}e.length&&v.B(v.Cp,e)}}};a.apply_collision_impulse_test=function(a,b){u(a)&&x(a);var c=a.c.q;v.B(v.dv,c.L);c.Oi=b};a.clear_collision_impulse_test=x;a.append_ray_test=function(a,b,c,d,e,f,g,h,k){var l;B.Vs++;l=B.Vs;d=d||"ANY";
a={id:l,L:a?a.c.q.L:0,V:new Float32Array(b),ua:new Float32Array(c),Va:d,Pi:n(d),cq:f,Mw:g,Ad:h,Uk:k,callback:e};b=da.pb;l=a.id;b.Yh[l]=a;b.yo.push(a);v.B(v.$u,a.id,a.L,a.V,a.ua,a.Pi,a.cq,a.Mw,a.Ad,a.Uk);return l};a.remove_ray_test=g;a.change_ray_test_from_to=function(a,b,c){var d=da.pb.Yh[a];d&&!d.cq&&(d.V.set(b),d.ua.set(c),v.B(v.fv,a,b,c))};a.Wr=function(a){return da.pb.Yh[a]?!0:!1};a.vehicle_throttle=function(a,b){var c=a.c.m;c.wh=b;q(a,c)};a.vehicle_steer=function(a,b){var c=a.c.m;c.ji=b;q(a,
c)};a.vehicle_brake=function(a,b){var c=a.c.m;c.Ki=b;q(a,c)};a.is_vehicle_chassis=L;a.is_vehicle_hull=J;a.Xz=function(a){if(!a.c.Bc)return!1;a=a.c.rc.kc;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.Vz=function(a){return a.c.Bc?"BOB"==a.c.rc.kc?!0:!1:!1};a.Zz=function(a){return a.c.Ih?"BOB"==a.c.yh.kc?!0:!1:!1};a.Zr=function(a){return a.c.Bc&&"STEERING_WHEEL"==a.c.rc.kc?!0:!1};a.Yr=function(a){return a.c.Bc&&"SPEEDOMETER"==a.c.rc.kc?!0:!1};
a.$r=function(a){return a.c.Bc&&"TACHOMETER"==a.c.rc.kc?!0:!1};a.get_vehicle_speed=function(a){return a.c.m.speed};a.HD=function(a){switch(a){case "WHEEL_FRONT_LEFT":return 0;case "WHEEL_FRONT_RIGHT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.is_character=E;a.xF=M;a.rz=function(){return oa};a.cy=function(){v.B(v.jv)};a.fB=function(a){var b=fa.indexOf(a);-1==b&&Q.error("Object "+a.name+" doesn't have bounding physics");for(var c=da,d=a.c.q.L,e=c.pb.s,f=[],g=0;g<e.length;g++)for(var h=
e[g].q,k=0;k<h.gc.length;k++)for(var l=h.gc[k],n=0;n<l.qf.length;n++){var B=l.qf[n],r=l.yj[n];if(B[0]==d||B[1]==d)l.qf.splice(n,1),l.yj.splice(n,1),n--,r&&!m(l)&&(r=W.set(0,0,0,N),l.callback(!1,null,r,r,0)),f.push(B)}f.length&&v.B(v.Cp,f);u(a)&&x(a);delete ea[d];fa.splice(b,1);a=c.pb.s;for(b=0;b<a.length;b++)a[b].q.L==d&&(a.splice(b,1),b--);v.B(v.pv,d)}};b4w.module.__data=function(a,p){function c(a,b){if(a)for(var c=S(a,b.id),d=0;d<c.length;d++){var e=c[d];"MESH"==e.type&&delete e.data.submeshes}Ba[b.id]=null;ub[b.id]=null}function d(a,b,c){var d;a instanceof ArrayBuffer&&(a=ia.Br(a));d=a.width;a=a.height;ra.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(Gb)&&c&&ra.warn("image",b,"is not from app root.")}function b(a,b,c,d,e,f){d=b.t;if(!d)throw"Nothing requested";ja.enqueue([[d,ja.AT_JSON,
d]],function(d,f,g,h){if(d){ra.log("%cLOAD METADATA","color: #616",h);f=ua.Jt(d.b4w_format_version);switch(ua.ju(f,Da.Cg)){case -1:f[0]<Da.Cg[0]?ua.ha("JSON version is too old relative to B4W engine: "+ua.Jf(f)+", required: "+ua.Jf(Da.Cg)+". Reexport scene with the latest B4W addon to fix it."):ra.warn("JSON version is a bit old relative to B4W engine: "+ +ua.Jf(f)+", required: "+ua.Jf(Da.Cg)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>
Da.Cg[0]?ua.ha("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):ra.warn("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}Da.Yn=f;for(var k in d)a[k]=d[k];0===b.id&&(jb=a);(d=a.binaries[0].binfile)?b.fq=d:(Y.st(b,"load_binaries"),Y.st(b,"prepare_bindata"));d=a==jb;if(a.b4w_export_errors)for(k=0;k<a.b4w_export_errors.length;k++)f=a.b4w_export_errors[k],(d&&"PRIMARY"==
f.type||"ALL"==f.type)&&ra.xy(f.text);d=a==jb;if(a.b4w_export_warnings)for(k=0;k<a.b4w_export_warnings.length;k++)f=a.b4w_export_warnings[k],(d&&"PRIMARY"==f.type||"ALL"==f.type)&&ra.yy(f.text);e(b,c)}else Y.Lp(b)},null,function(a){f(b,c,a)})}function e(a,b,c,d,e,f){d=U(b.t)+b.fq;if(!d)throw"Binary data is missing";ja.enqueue([[d,ja.AT_ARRAYBUFFER,d]],function(d,f,g,k){d?(ra.log("%cLOAD BINARY","color: #616",k),a.bin_data=d,d=h(d),f=ua.Jt(a.b4w_format_version),d[0]!=f[0]&&ua.ha("BIN version does not match to JSON version: "+
ua.Jf(d)+", required: "+ua.Jf(Da.Cg)+". Reexport scene to fix it."),d[1]!=f[1]&&ra.warn("BIN version does not match to JSON version: "+ +ua.Jf(d)+", required: "+ua.Jf(Da.Cg)+". Some compatibility issues can occur. Reexport scene to fix it."),e(b,c)):Y.Lp(b)},null,function(a){f(b,c,a)})}function l(a,b,c,d,e){Zb.cx()&&e(b,c)}function m(a,b,c,d,e){d=a.bin_data;var f=a.binaries[0],g=a.objects,k=a.meshes;a=a.actions;for(var l=ua.Zw(),m=h(d),m=5<=m[0]&&4<m[1]?12:0,z=["indices"],F=["normal","tangent"],B=
["color","group"],r=["position","texcoord","texcoord2"],v=0;v<k.length;v++)for(var q=k[v].submeshes,t=0;t<q.length;t++)for(var y in q[t]){var x=q[t][y][1];if(-1!=z.indexOf(y)){var u=4*q[t][y][0]+f["int"]+m,w=q[t],p=y,N=d;if(l)var T=new Uint32Array(N,u,x);else for(var T=new Uint32Array(x),N=new DataView(N),H=0;H<x;H++)T[H]=N.getUint32(u+4*H,!0);w[p]=T}else if(-1!=r.indexOf(y))u=4*q[t][y][0]+f["float"]+m,q[t][y]=n(d,u,x,l);else if(-1!=F.indexOf(y)){u=2*q[t][y][0]+f["short"]+m;w=q[t];p=y;N=d;T=new Float32Array(x);
N=new DataView(N);for(H=0;H<x;H++)T[H]=N.getInt16(u+2*H,!0)/32767;w[p]=T}else if(-1!=B.indexOf(y)){u=2*q[t][y][0]+f.ushort+m;w=q[t];p=y;N=d;T=new Float32Array(x);N=new DataView(N);for(H=0;H<x;H++)T[H]=N.getUint16(u+2*H,!0)/65535;w[p]=T}}for(y=0;y<g.length;y++)for(k=g[y].particle_systems,z=0;z<k.length;z++)F=k[z],F.transforms=n(d,4*F.transforms[0]+f["float"]+m,F.transforms[1],l);for(g=0;g<a.length;g++){y=a[g];k=y.fcurves;z=y.frame_range;B=z[0];r=z[1];v=fa.gz(B,r);z=null;0>v&&(v=0);var t=q=!1,ka;for(ka in k)q|=
-1<ka.indexOf("rotation_euler"),t|=-1<ka.indexOf("rotation_quaternion");F=[];for(ka in k)if(q&&t&&-1<ka.indexOf("rotation_euler"))delete k[ka];else{var x=k[ka],ia;for(ia in x)u=x[ia],w=n(d,f["float"]+4*u.bin_data_pos[0]+m,u.bin_data_pos[1],l),p=new Float32Array(v),null===z&&(z=new Int8Array(v)),fa.rw(u,w,p,z,B,r),u.uc=p;-1<ka.indexOf("rotation_euler")&&(fa.Fy(k[ka]),F.push(ka))}for(B=0;B<F.length;B++)r=F[B],v=r.replace("euler","quaternion"),k[v]=k[r],delete k[r];y.Mv=z}e(b,c)}function h(a){var b=
new Uint8Array(a,0,4),c=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];for(var d=0;d<b.length;d++)if("B4WB"[d]!=String.fromCharCode(b[d])){c=5;a=4;break}return[c,a]}function n(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+4*e,!0)}return d}function f(a,b,c,d,e){var f=a.cameras,g=a.groups,h=a.materials,l=a.meshes,m=a.node_groups,n=a.objects,F=a.particles,B=a.scenes,r=a.speakers,v=a.textures,q=a.worlds;m||(ra.warn('"node_groups" datablock undefined. reexport main scene.'),
m=a.node_groups=[]);for(var t="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),y={},u=0;u<t.length;u++)for(var x=a[t[u]],w=0;w<x.length;w++){var p=x[w];y[p.uuid]=p}for(var N=0;N<B.length;N++){for(var H=B[N],ia=H.objects,ha=0;ha<ia.length;ha++)G(ia,ha,y);H.camera&&G(H,"camera",y);H.world&&G(H,"world",y)}for(N=0;N<g.length;N++)for(var A=g[N].objects,ha=0;ha<A.length;ha++)G(A,ha,y);for(N=0;N<n.length;N++){var C=
n[N];C.dupli_group&&G(C,"dupli_group",y);C.parent&&G(C,"parent",y);if(C.animation_data){var E=C.animation_data;E.action&&G(E,"action",y);if(E.nla_tracks)for(ha=0;ha<E.nla_tracks.length;ha++)for(var I=E.nla_tracks[ha],xa=0;xa<I.strips.length;xa++)I.strips[xa].action&&G(I.strips[xa],"action",y)}switch(C.type){case "MESH":if(!C.data)throw"mesh not found for object "+C.name;G(C,"data",y);for(var J=!1,hc=C.modifiers,ha=0;ha<hc.length;ha++){var L=hc[ha];"ARMATURE"==L.type?(J&&ra.warn('Object "'+C.name+
'" has more than one armature modifiers. Only the first one will be used.'),J=!0,G(L,"object",y)):"CURVE"==L.type&&G(L,"object",y)}var P=C.particle_systems;if(P)for(ha=0;ha<P.length;ha++)G(P[ha],"settings",y);break;case "ARMATURE":G(C,"data",y);for(var Zb=C.pose.bones,K=C.data.bones,ha=0;ha<Zb.length;ha++){var ta=Zb[ha];ta.bone=K[ta.bone];for(var Y=ta.parent_recursive,xa=0;xa<Y.length;xa++)Y[xa]=Zb[Y[xa]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":G(C,"data",y)}var na=C.constraints;
if(na)for(ha=0;ha<na.length;ha++){var Z=na[ha];Z.target&&G(Z,"target",y)}var ja=C.lod_levels;if(ja)for(ha=0;ha<ja.length;ha++){var Q=ja[ha];Q.object&&G(Q,"object",y)}}for(N=0;N<l.length;N++)for(var da=l[N].materials,ha=0;ha<da.length;ha++)G(da,ha,y);for(N=0;N<h.length;N++){for(var R=h[N],Da=R.texture_slots,ha=0;ha<Da.length;ha++)G(Da[ha],"texture",y);var aa=R.node_tree;aa&&D(aa,y)}for(N=0;N<m.length;N++)(aa=m[N].node_tree)&&D(aa,y);for(N=0;N<v.length;N++){var sa=v[N],ea=sa.type;"IMAGE"!=ea&&"ENVIRONMENT_MAP"!=
ea||G(sa,"image",y)}for(N=0;N<f.length;N++){var ga=f[N];ga.dof_object&&G(ga,"dof_object",y)}for(N=0;N<r.length;N++){var Rb=r[N];Rb.sound&&G(Rb,"sound",y);if(Rb.animation_data&&(E=Rb.animation_data,E.action&&G(E,"action",y),E.nla_tracks))for(ha=0;ha<E.nla_tracks.length;ha++)for(I=E.nla_tracks[ha],xa=0;xa<I.strips.length;xa++)I.strips[xa].action&&G(I.strips[xa],"action",y)}for(N=0;N<F.length;N++){for(var ub=F[N],Da=ub.texture_slots,ha=0;ha<Da.length;ha++)G(Da[ha],"texture",y);ub.dupli_group&&G(ub,"dupli_group",
y);ub.dupli_object&&G(ub,"dupli_object",y)}for(N=0;N<q.length;N++)if(Da=q[N].texture_slots)for(ha=0;ha<Da.length;ha++)G(Da[ha],"texture",y);O.Xw(a);for(var W=a.textures,U=a==jb?a.scenes[0].b4w_anisotropic_filtering:k().b4w_anisotropic_filtering,Ca=0;Ca<W.length;Ca++)a==jb||"SCENE"!=W[Ca].b4w_source_type||(W[Ca].b4w_source_id=""),Pa.Tx(W[Ca],U,a.scenes,b.id);for(var ic={},Ba=a.objects,qc=0;qc<Ba.length;qc++){var ba=Ba[qc];if("MESH"===ba.type&&!ba.particle_systems.length)for(var ca=ba.data,X=ca.name,
la=ca.submeshes,pa=ca.materials,Gb=0;Gb<la.length;Gb++)0!==la[Gb].base_length||ic[X]||(pa[Gb]&&ra.warn('material "'+pa[Gb].name+'" is not assigned to any face (object "'+ba.name+'").'),ic[X]=!0)}for(var Kb=a.meshes,Va=0;Va<Kb.length;Va++){var Kc=Kb[Va];Kc.materials.length||Kc.uv_textures.length&&ra.warn('mesh "'+Kc.name+'" has a UV map but has no exported material.')}a.materials.push({name:"DEFAULT",use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,
fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,
b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]});for(var mb=
a.meshes,rb=ua.keysearch("name","DEFAULT",a.materials),Db=0;Db<mb.length;Db++){var dc=mb[Db];0==dc.materials.length&&dc.materials.push(rb)}for(var Eb=a.actions,Yb=b.id,ac=0;ac<Eb.length;ac++){var sb=Eb[ac];sb.Ov=Yb;fa.Yv(sb)}for(var xb=a.scenes,Qb=0;Qb<xb.length;Qb++){for(var Oc=xb[Qb],nb=[],Na=[],Ec=xb[Qb].objects,Fb=0;Fb<Ec.length;Fb++){var lc=Ec[Fb];M(Ec,lc,nb,Na);var ec=lc.dupli_group;if(ec)for(var Fc=ec.objects,Gc=0;Gc<Fc.length;Gc++)M(Fc,Fc[Gc],nb,Na)}for(Fb=0;Fb<Na.length;Fb++)for(var fb=Na[Fb],
Sa=[Oc],ad=0;ad<Sa.length;ad++){for(var fc=Sa[ad].objects,bd=0;bd<fc.length;bd++){var jd=fc[bd].dupli_group;if(jd){var cd=jd.objects,Wc=cd.indexOf(fb);-1<Wc&&cd.splice(Wc,1)}}var Wc=fc.indexOf(fb);-1<Wc&&fc.splice(Wc,1)}for(Fb=0;Fb<nb.length;Fb++)ua.lw(nb[Fb][0],nb[Fb][1])}oa(a,b.id);var ob=S(a,b.id);O.ww(ob,a.scenes);for(Ca=0;Ca<ob.length;Ca++){var tc=ob[Ca];if("MESH"==tc.type){var vd=O.ow(tc);vd&&(a.meshes.push(vd),tc.data=vd)}z.Nl(tc);tc.c.g.Xb=b.id}for(Ca=0;Ca<ob.length;Ca++)tc=ob[Ca],a!=jb&&
tc.parent&&-1<Ac.indexOf(tc.parent.type)&&(tc.parent=""),z.$C(tc);for(var qd=0;qd<a.scenes.length;qd++)for(var dd=T.Hm(a.scenes[qd],"ALL"),mc=0;mc<dd.length;mc++)for(var kd=dd[mc].particle_systems,ld=0;ld<kd.length;ld++){var Xc=kd[ld].settings;if("HAIR"==Xc.type)if("OBJECT"==Xc.render_type){var Pc=Xc.dupli_object;Pc.Ip||z.Nl(Pc)}else if("GROUP"==Xc.render_type)for(var Hc=Xc.dupli_group,uc=0;uc<Hc.objects.length;uc++)Pc=Hc.objects[uc],Pc.Ip||z.Nl(Pc);else ra.warn("render type",Xc.render_type,"not supported for particle systems ("+
Xc.name+").")}for(var vc=0;vc<ob.length;vc++){var Qc=ob[vc];if("MESH"==Qc.type){var wd=fa.get_first_armature_object(Qc);if(wd){var md=wd.c.g;if(md.Pe){var nd=Qc.c.g.Sc,xd=[],yd;for(yd in nd){var od=nd[yd];xd.push(4*od.Vi,4*od.jq)}md.os.push(xd)}md.Gl.push(Qc.c.g)}}}for(var Rc=-1,pd=-1,Yc=fa.vr(),nc=0;nc<ob.length;nc++){var Sc=ob[nc],Jb=Sc.c.g;if(ua.is_mesh(Sc)&&Jb.Jh){var Zc=Jb.ve;Zc>Rc&&(Rc=Zc);Yc>=Zc&&Zc>pd&&(pd=Zc)}}for(nc=0;nc<ob.length;nc++)Sc=ob[nc],Jb=Sc.c.g,ua.is_mesh(Sc)&&Jb.Jh&&(Jb.fj=!0,
Rc<Yc?Jb.ve=Rc:Jb.ve<=Yc?Jb.ve=pd:(ra.warn('too many bones for "'+Sc.name+'" / '+Jb.ve+" bones (max "+Yc+" with blending, "+2*Yc+" without blending). Blending between frames will be disabled."),Jb.ve=Rc,Jb.fj=!1),Jb.fj=Jb.fj&&!pc.ir);for(var $c=0;$c<ob.length;$c++){var gc=ob[$c];if(ua.is_mesh(gc)){var rd=gc.lod_levels.length;if(rd)for(var Tc=gc,wc=0;wc<rd;wc++){var xc=gc.lod_levels[wc].object;if(!xc){Tc.c.g.cl=!0;Tc.c.g.lf=gc.lod_levels[wc].distance;break}xc.c.g.yg=gc.c.g.yg;Tc.c.g.lf=gc.lod_levels[wc].distance;
xc.c.g.uj=gc.lod_levels[wc].distance;if(gc.lod_levels[wc+1])xc.c.g.lf=gc.lod_levels[wc+1].distance;else{xc.c.g.cl=!0;xc.c.g.lf=1E4;break}Tc.c.g.cl=!1;Tc=xc}}}for(var ed=0;ed<ob.length;ed++){var ma=ob[ed];if(ma.c.Bc){var Za=ma.c.rc;if("CHASSIS"==Za.kc){ma.c.m={};ma.c.m.dj=Za.dj;ma.c.m.Li=Za.Li;ma.c.m.Vo=Za.Vo;ma.c.m.Xo=Za.Xo;ma.c.m.Wo=Za.Wo;ma.c.m.tp=Za.tp;ma.c.m.Co=Za.Co;ma.c.m.bo=Za.bo;ma.c.m.wh=0;ma.c.m.Ki=1;ma.c.m.ji=0;ma.c.m.speed=0;ma.c.m.Mg=[];ma.c.m.Fj=[];ma.c.m.li=null;for(var zd=ma.c.Ka?
ma.c.Ka.dupli_group.objects:ob,Ic=0;Ic<zd.length;Ic++){var Ja=zd[Ic];if(Ja.c.Bc){var pb=Ja.c.rc;if(ka.Xz(Ja)&&Za.name==pb.name){var Jc=ka.HD(Ja.c.rc.kc);ma.c.m.Mg[Jc]=Ja;ma.c.m.Fj[Jc]=new Float32Array(8)}else if(ka.Zr(Ja)&&Za.name==pb.name){ma.c.m.li=Ja;ma.c.m.ki=pb.ki;ma.c.m.Oj=pb.Oj;ma.c.m.nj=pb.nj;var tb=cb.invert(ma.c.g.Z,new Float32Array(16)),fd=cb.multiply(tb,Ja.c.g.Z,tb);ma.c.m.It=fd;var oc=new Float32Array([1,0,0,0]);Oa.transformMat4(oc,fd,oc);ma.c.m.Ht=oc}else if(ka.Yr(Ja)&&Za.name==pb.name){ma.c.m.Oo=
Ja;ma.c.m.Mj=pb.Mj;ma.c.m.Qh=pb.Qh;var tb=cb.invert(ma.c.g.Z,new Float32Array(16)),gd=cb.multiply(tb,Ja.c.g.Z,tb);ma.c.m.Dt=gd;var Uc=new Float32Array([1,0,0,0]);Oa.transformMat4(Uc,gd,Uc);ma.c.m.Ct=Uc}else if(ka.$r(Ja)&&Za.name==pb.name){ma.c.m.Yo=Ja;ma.c.m.Wi=pb.Wi;var tb=cb.invert(ma.c.g.Z,new Float32Array(16)),td=cb.multiply(tb,Ja.c.g.Z,tb);ma.c.m.Qt=td;var hd=new Float32Array([1,0,0,0]);Oa.transformMat4(hd,td,hd);ma.c.m.Pt=hd}}}if(4!=ma.c.m.Mg.length)throw"Not enough wheels for chassis "+ma.name;
}else if("HULL"==Za.kc){ma.c.m={};ma.c.m.Mg=[];ma.c.m.Fj=[];ma.c.m.dj=Za.dj;ma.c.m.Li=Za.Li;ma.c.m.hg=Za.hg;ma.c.m.eh=Za.eh;ma.c.m.fh=Za.fh;ma.c.m.wh=0;ma.c.m.Ki=1;ma.c.m.ji=0;ma.c.m.speed=0;ma.c.m.li=null;for(var Dd=ma.c.Ka?ma.c.Ka.dupli_group.objects:ob,Ic=0;Ic<Dd.length;Ic++)Ja=Dd[Ic],Ja.c.Bc&&(pb=Ja.c.rc,ka.Vz(Ja)&&Za.name==pb.name?(ma.c.m.Mg.push(Ja),ma.c.m.Fj.push(new Float32Array(8))):ka.Zr(Ja)&&Za.name==pb.name?(ma.c.m.li=Ja,ma.c.m.ki=pb.ki,ma.c.m.Oj=pb.Oj,ma.c.m.nj=pb.nj,tb=cb.invert(ma.c.g.Z,
new Float32Array(16)),fd=cb.multiply(tb,Ja.c.g.Z,tb),ma.c.m.It=fd,oc=new Float32Array([1,0,0,0]),Oa.transformMat4(oc,fd,oc),ma.c.m.Ht=oc):ka.Yr(Ja)&&Za.name==pb.name?(ma.c.m.Oo=Ja,ma.c.m.Mj=pb.Mj,ma.c.m.Qh=pb.Qh,tb=cb.invert(ma.c.g.Z,new Float32Array(16)),gd=cb.multiply(tb,Ja.c.g.Z,tb),ma.c.m.Dt=gd,Uc=new Float32Array([1,0,0,0]),Oa.transformMat4(Uc,gd,Uc),ma.c.m.Ct=Uc):ka.$r(Ja)&&Za.name==pb.name&&(ma.c.m.Yo=Ja,ma.c.m.Wi=pb.Wi,tb=cb.invert(ma.c.g.Z,new Float32Array(16)),td=cb.multiply(tb,Ja.c.g.Z,
tb),ma.c.m.Qt=td,hd=new Float32Array([1,0,0,0]),Oa.transformMat4(hd,td,hd),ma.c.m.Pt=hd))}}}for(var Ad=0;Ad<ob.length;Ad++){var Lc=ob[Ad];if(Lc.c.Ih){var ud=Lc.c.yh;if("MAIN_BODY"==ud.kc){Lc.c.Yc={};Lc.c.Yc.hg=ud.hg;Lc.c.Yc.eh=ud.eh;Lc.c.Yc.fh=ud.fh;Lc.c.Yc.rk=[];for(var Ed=Lc.c.Ka?Lc.c.Ka.dupli_group.objects:ob,Bd=0;Bd<Ed.length;Bd++){var sd=Ed[Bd];if(sd.c.Ih){var Fd=sd.c.yh;ka.Zz(sd)&&ud.name==Fd.name&&(Lc.c.Yc.rk.push(sd),sd.Iw=sd.c.yh.Ot)}}}}}for(Ca=0;Ca<a.scenes.length;Ca++){var Cd=a.scenes[Ca];
yc.enabled&&Cd.b4w_enable_physics&&(a==jb||!ka.Bl(k())&&Cd==T.fn(a))&&ka.Tz(Cd)}e(b,c)}function k(){return T.fn(jb.scenes)}function r(a,b,c,d,e){a!=jb&&1<a.scenes.length&&(a.scenes=[T.fn(a.scenes)],ra.warn("loading data contains multiple scenes.","Only the first one will be loaded."));d=k();-1==pc.Ra&&(pc.Ra=d.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(d),1),a.scenes.unshift(d));for(var f=0;f<a.scenes.length;f++){var g=a.scenes[f];if(a==jb&&!g.camera)throw"Scene check failed: No camera";
for(var h=T.Hm(g,"ALL"),l=S(a,b.id),m=a.meshes,n=m.slice(0),F=0;F<l.length;F++){var B=l[F];"MESH"==B.type&&(B=n.indexOf(B.data),-1<B&&n.splice(B,1))}for(F=0;F<n.length;F++)m.splice(m.indexOf(n[F]),1);a==jb?(z.Yp(h,g),h=z.vn(g,"ALL",T.DATA_ID_ALL),T.cw(g,a.textures,h),g.l.vi.length&&(b.Dn=!0),g.b4w_enable_audio&&xa.Zp(g),h=T.tn(g),n=g.b4w_batch_grid_size):(z.Yp(h,d),T.iw(g,d,a.textures),g.b4w_enable_audio&&!d.ca&&xa.Zp(d),h=T.tn(d),n=d.b4w_batch_grid_size);l=[];m=T.Hm(g,"MESH");ga.Yy(g,n,m,l);n=g.l.Hl;
if(n.iB||n.procedural_skydome)n=ga.az(g,n),l.push(n);for(n=0;n<m.length;n++)ga.Lq(m[n],h);for(n=0;n<l.length;n++)ga.Lq(l[n],h),z.Uv(l[n]);a==jb?(T.Pp(g,l),T.Qy(h)):T.Pp(d,l)}d=z.get_all_objects(b.id);T.xw(d);d=a.materials;if(Rb.Sm&&Da.du)for(a=0;a<d.length;a++){h=d[a];l=h.texture_slots;for(f=0;f<l.length;f++)if(m=l[f],n=m.texture,"IMAGE"==n.type||"ENVIRONMENT_MAP"==n.type)g=n.image,g.tc||(-1<g.filepath.indexOf(".dds")?g.tc=!0:(g.tc=!n.b4w_disable_compression&&!m.use_map_normal&&"ENVIRONMENT_MAP"!=
n.type&&!n.b4w_shore_dist_map&&"MOVIE"!=g.source,g.tc&&(g.filepath+=".dds")));if(f=h.node_tree)for(h=f.nodes,f=0;f<h.length;f++)g=h[f],"TEXTURE"==g.type&&(l=g.texture)&&(g=l.image)&&!g.tc&&(g.tc=l.l.ik&&!l.b4w_disable_compression&&"MOVIE"!=g.source,g.tc&&(g.filepath+=".dds"))}else for(a=a.images,d=0;d<a.length;d++)f=a[d],f.tc=Boolean("FILE"==f.source&&-1<f.filepath.indexOf(".dds"));e(b,c)}function y(a,b,c,d,e){d=a.groups;a=a.objects;for(var f={},g={},h={},k={},l=0;l<d.length;l++){var m=d[l];f[m.uuid]=
m;h[m.uuid]=m}for(l=0;l<a.length;l++)m=a[l],g[m.uuid]=m,k[m.uuid]=m;w(a,null,k,h);for(var z in h)z in f||d.push(h[z]);for(z in k)z in g||a.push(k[z]);e(b,c)}function w(a,b,c,d){for(var e=[],f=0;f<a.length;f++){var g=a[f],h=c[g.uuid];if(g=h.proxy){b&&-1==e.indexOf(g.uuid)&&e.push(g.uuid);for(var k=c[g.uuid],l=k.constraints,g=0;g<l.length;g++){var m=ua.Zf(l[g]);m.name+="_CLONE";h.constraints.push(m)}"b4w_proxy_inherit_anim"in h&&!h.b4w_proxy_inherit_anim||(h.animation_data&&(k.animation_data=ua.Zf(h.animation_data)),
k.b4w_use_default_animation=h.b4w_use_default_animation,k.b4w_auto_skel_anim=h.b4w_auto_skel_anim,k.b4w_anim_behavior=h.b4w_anim_behavior,k.b4w_cyclic_animation=h.b4w_cyclic_animation)}}for(f=0;f<e.length;f++)h=ua.un(a,"uuid",e[f]),-1<h&&a.splice(h,1);e={};for(f=0;f<a.length;f++)g=a[f],h=c[g.uuid],b&&(l=ua.Zf(h),h="origin_name"in h?h.origin_name:h.name,l.name=b+"*"+h,l.origin_name=h,C(l),c[l.uuid]=l,e[g.uuid]=l.uuid,g.uuid=l.uuid),h=c[g.uuid],h.dupli_group&&(g=h.dupli_group,l=d[g.uuid],k=ua.Zf(l),
k.name=ua.Rj(l.name+"_CLONE"),k.uuid=sa.Or("Group"+k.name),d[k.uuid]=k,g.uuid=k.uuid,w(k.objects,h.name,c,d));if(b)for(f=0;f<a.length;f++){g=a[f];h=c[g.uuid];h.parent&&h.parent.uuid in e?h.parent.uuid=e[h.parent.uuid]:h.parent&&(ra.warn("Object's \""+h.name+'" parent is not in dupli group. Disabling parenting.'),h.parent=null);l=h.constraints;for(g=0;g<l.length;g++)b=l[g],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);b=h.modifiers;for(g=0;g<b.length;g++)d=b[g],d.object&&d.object.uuid in
e&&(d.object.uuid=e[d.object.uuid]);if((h=h.lod_levels)&&h.length)for(g=0;g<h.length;g++)b=h[g],b.object&&b.object.uuid in e&&(b.object.uuid=e[b.object.uuid])}for(var z in e)qc[z]=e[z]}function C(a){a.uuid=sa.Or("Object"+a.name)}function D(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&G(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in qc&&(e.lamp.uuid=qc[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&G(e,"node_group",b)}e=a.links;
for(d=0;d<e.length;d++){var f=e[d];t(f,"from_node",c);t(f,"to_node",c);A(f,"from_socket",f.from_node.outputs);A(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&G(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&G(e.strips[f],"action",b)}function G(a,b,c){(c=c[a[b].uuid])||ra.error("Dangling link found:",b,a);a[b]=c}function t(a,b,c){c=ua.keysearch("name",a[b].name,c);a[b]=c}function A(a,b,c){c=ua.keysearch("identifier",
a[b].identifier,c);a[b]=c}function x(a,b,c,e,f,g){if(!Da.do_not_load_resources){for(var h=U(b.t),k=a.images,l={},m=[],z=0;z<k.length;z++){var n=k[z],F=n.uuid;if("FILE"===n.source||"MOVIE"===n.source){var B=u(n,a.textures);if(!B.length)ra.warn("image ",n.name," has no users.");else if(!B[0].b4w_shore_dist_map){B=ua.il(h+n.filepath);if("FILE"===n.source){var r=n.tc?ja.AT_ARRAYBUFFER:ja.AT_IMAGE_ELEMENT;Rb.co&&Da.Pl&&(B=ja.Nj(B),"dds"==B[1]?(B=ja.Nj(B[0]),B=B[0]+".min50."+B[1]+".dds"):B=B[0]+".min50."+
B[1])}else"MOVIE"===n.source&&(Da.cd?(B=ja.Nj(B),B=B[0]+".altconv.seq",r=ja.Zj):(B=ja.Nj(B),r=xa.detect_video_container(B[1]),B=r!=B[1]?B[0]+".altconv."+r:B[0]+"."+r,r=ja.$j));m.push([F,r,B]);l[F]=n}}}m.length?(e.Pr=0,ja.enqueue(m,function(f,h,k,z){if(f){if(k==ja.$j||k==ja.Zj){if(k==ja.$j)var n=f.videoWidth,F=f.videoHeight;else n=f.images[0].width,F=f.images[0].height;ra.log("%cLOAD VIDEO "+n+"x"+F,"color: #"+(2048<n||2048<F?"a00":1024<n||1024<F?"aa0":"0a0"),z);-1==z.indexOf(Gb)&&ra.warn("video",
z,"is not from app root.")}else d(f,z,!0);h=l[h];z=u(h,a.textures);for(n=0;n<z.length;n++){var F=z[n],B=F.image.filepath;k==ja.Zj?(F.l.ht=f.hc,Pa.Sj(F.l,f.images,h.tc,B,b.id)):Pa.Sj(F.l,f,h.tc,B,b.id)}}f=++e.Pr/m.length;g(b,c,f)},function(){ra.log("%cLOADED ALL IMAGES","color: #0a0");f(b,c)})):f(b,c)}}function u(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e.image===a&&c.push(e)}return c}function g(a,b,c,d,e,f){if(!Da.do_not_load_resources){a=S(a,b.id);for(var g=U(b.t),h=[],k={},l=0;l<a.length;l++){var m=
a[l];if(q(m)){var z=m.data.sound,n=z.uuid;"BACKGROUND_MUSIC"==xa.wn(m)?(n=ua.mr(),b.Cn=!0):"NONE"!=xa.wn(m)&&Da.Rr&&(b.Gn=!0);if(!(n in k)){k[n]=[];z=ua.il(g+z.filepath);switch(xa.At(m)){case xa.Tl:var F=ja.AT_AUDIOBUFFER;break;case xa.vp:F=ja.AT_AUDIO_ELEMENT}var z=ja.Nj(z),B=xa.detect_audio_container(z[1]),z=B!=z[1]?z[0]+".altconv."+B:z[0]+"."+B;h.push([n,F,z])}k[n].push(m)}}h.length?ja.enqueue(h,function(a,e,g,l){if(a)for(ra.log("%cLOAD SOUND","color: #0aa",l),-1==l.indexOf(Gb)&&ra.warn("sound",
l,"is not from app root."),e=k[e],g=0;g<e.length;g++)xa.fD(e[g],a);a=++d.eC/h.length;f(b,c,a)},function(){ra.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)}):e(b,c)}}function q(a){return xa.re(a)&&xa.At(a)!=xa.wp?!0:!1}function L(a,b){for(var c=T.$a(a,"SPEAKER",T.DATA_ID_ALL),d=0;d<c.length;d++){var e=c[d];xa.re(e)&&(xa.is_cyclic(e)||b)&&xa.play_def(e)}}function J(a){a=a.l.vi;for(var b=0;b<a.length;b++)Da.cd&&a[b].use_auto_refresh?a[b].l.ci=!0:a[b].l.Ta&&a[b].use_auto_refresh&&a[b].l.Ta.play()}function E(a,
b,c,d,e){hc.start();ra.log("%cSTART NLA","color: #0a0");e(b,c)}function M(a,b,c,d){if(b.lod_levels&&b.lod_levels.length)for(var e=b.lod_levels.length,f=0;f<e;f++){var g=b.lod_levels[f],h=g.object;if(h){var k=ua.Ni(h);k.name=b.name+"_LOD_"+String(f+1);C(k);k.lod_levels=[];c.push([a,k]);d.push(h);g.object=k}}}function K(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!ka.ex(a.scenes[f])){d=!1;break}d&&(e(b,c),ra.log("%cPHYSICS READY","color: #0a0"))}function Q(a,b,c,d,e){d=k();for(var f=0;f<a.scenes.length;f++){var g=
a.scenes[f],h=a==jb?ka.Bl(g):ka.Bl(d)||ka.Bl(g);a==jb||(g=d);if(yc.enabled&&h)for(h=0;h<pa.length;h++)for(var l=T.$a(g,pa[h],T.DATA_ID_ALL),m=0;m<l.length;m++){var z=l[m];z.c.g.Xb==b.id&&(ka.append_object(z,g),b.Wn&&ka.K(z)&&ka.disable_simulation(z))}}e(b,c)}function I(a,b,c,e,f){var g={};e=[];for(var h=a.scenes,k=0;k<a.scenes.length;k++){var l=h[k];if(l.l.mb&&(l=l.l.mb.Fl)&&"FILE"===l.source){var m=l.uuid,z=ua.il(U(b.t)+l.filepath);e.push([m,l.tc?ja.AT_ARRAYBUFFER:ja.AT_IMAGE_ELEMENT,z]);g[m]=l}}e.length?
ja.enqueue(e,function(c,e,f,k){if(c){d(c,k,!0);e=g[e];k=u(e,a.textures);for(f=0;f<k.length;f++){var l=k[f];Pa.Sj(l.l,c,e.tc,l.image.filepath,b.id)}for(f=0;f<h.length;f++)if(k=h[f],k.l.mb.Fl===e){var m=c,z=document.createElement("canvas"),l=e.size[0],n=e.size[1];z.width=l;z.height=n;z=z.getContext("2d");z.drawImage(m,0,0);m=z.getImageData(0,0,l,n).data;z=new Float32Array(4);z[0]=1/16581375;z[1]=1/65025;z[2]=1/255;z[3]=1;for(var l=l*n,n=new Float32Array(l),F=0;F<l;F++)n[F]=z[1]*m[4*F+2]+z[2]*m[4*F+
3];k.l.Fo=n}}},function(){f(b,c)}):f(b,c)}function v(a,b,c,e,f){if(Da.antialiasing&&Da.smaa){e=a.scenes[0];a=[];for(var g=["SMAA_EDGE_DETECTION","SMAA_BLENDING_WEIGHT_CALCULATION","SMAA_NEIGHBORHOOD_BLENDING","SMAA_RESOLVE"],h=0;h<g.length;h++){var k=T.da(e,g[h]);k&&a.push(k)}if(a.length){e=[];h=ja.AT_IMAGE_ELEMENT;e.push(["SEARCH_TEXTURE",h,B.bc.smaa_search_texture_path]);e.push(["AREA_TEXTURE",h,B.bc.smaa_area_texture_path]);for(h=0;h<a.length;h++)if(g=a[h],"SMAA_BLENDING_WEIGHT_CALCULATION"==g.type){a=
g.ma;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==g.ua)var l=g.ya;else if("u_area_tex"==g.ua)var m=g.ya;break}e.length?ja.enqueue(e,function(a,c,e,f){a&&(d(a,f,!1),c="SEARCH_TEXTURE"==c?l:m,c.source="IMAGE",c.dq=!0,Pa.Sj(c,a,-1!=f.indexOf(".dds")?1:0,f,b.id),Pa.Kj(c,Pa.u,Pa.u))},function(){f(b,c)}):f(b,c)}else f(b,c)}else f(b,c)}function H(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];a==jb||(e=k());for(var f=z.vn(e,"LAMP",T.DATA_ID_ALL),g=0;g<f.length;g++){var h=f[g],l=h.c;l.g.Xb==
b.id&&(b.Wn&&ua.is_mesh(l)&&T.hide_object(l),d.bm.push({Sg:e,obj:h}))}f=z.vn(e,"ALL",T.DATA_ID_ALL);for(g=0;g<f.length;g++)h=f[g],l=h.c,"LAMP"!=l.type&&l.g.Xb==b.id&&(b.Wn&&ua.is_mesh(h)&&T.hide_object(h),d.bm.push({Sg:e,obj:h}))}}function P(a,b,c,d,e,f){var g=d.bm;e=d.Bs;if(g.length){a=g[e].obj;e=g[e].Sg;var h=F.Pk(a,e);T.append_object(e,a,!1);-1!=Kc.indexOf(a.type)&&e.b4w_enable_audio&&xa.append_object(a,e);a.b4w_anchor&&ea.append(a);d=++d.Bs/g.length;"LAMP"==a.type&&T.dC(e);null!=a.c.g.Uc&&T.Yt(h.Xe,
a.c.g.i);g=a.c.Pg;g.length&&e.l.Og&&(e=h.rf,T.au(e,a.c.g.i,a.c.g.quat),F.bu(g,e.k.cc))}else d=1;f(b,c,d)}function Z(a,b,c,d,e){if(a==jb){d=T.wz();for(var f=T.lj(),g=0;g<d.length;g++){var h=d[g];T.XA(h,f);h.b4w_use_nla&&hc.cD(h,h.b4w_nla_cyclic,b.id)}T.set_active(f)}else T.cu(k());a=S(a,b.id);z.aD(a);e(b,c)}function aa(a,b,c,d,e){if(a==jb)for(d=0;d<a.scenes.length;d++)a.scenes[d].b4w_use_nla||J(a.scenes[d]),L(a.scenes[d]);else a.scenes[0].b4w_use_nla||J(k()),L(k());e(b,c)}function R(a,b,c,d,e){Da.rg&&
(b.Dn||b.Cn||b.Gn)?Ca||W(a,e,b,c):e(b,c)}function W(a,b,c,d){var e=la.parentElement;Va=e.style.zIndex;e.style.zIndex="999";Ca=document.createElement("div");Ca.style.position="relative";Ca.style.height="88px";Ca.style.width="88px";var f=Math.round(la.offsetWidth/2-44);Ca.style.top=Math.round(la.offsetHeight/2-44).toString()+"px";Ca.style.left=f.toString()+"px";Ca.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
Ca.style.backgroundSize="88px";Kb=document.createElement("div");Kb.style.position="relative";Kb.style.height=la.offsetHeight.toString()+"px";Kb.style.width=la.offsetWidth.toString()+"px";Kb.style.background="rgba(0, 0, 0, 0.5)";Kb.style.zIndex="999";e.appendChild(Kb);Kb.appendChild(Ca);Ca.addEventListener("click",function(){c.Dn&&(Pa.play(),Pa.pause(),Pa.reset());if(c.Cn){if(a==jb)for(var e=0;e<a.scenes.length;e++)L(a.scenes[e],!0);else L(k(),!0);xa.pause()}c.Gn&&xa.RA();ba();b(c,d)},!1)}function ba(){if(Ca){var a=
la.parentElement;a.style.zIndex=Va;Kb.removeChild(Ca);a.removeChild(Kb);Ca=Kb=null;Va=0}}function U(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function ca(a,b,c){fa.is_animated(b)&&fa.remove(b);T.clear_outline_anim(b);ka.K(b)&&ka.fB(b);N.check_sensor_manifold(b)&&N.remove_sensor_manifold(b);T.gB(a,b,c);xa.re(b)&&xa.gC(b);ea.is_anchor(b)&&ea.remove(b.c)}function S(a,b){ub[b]||oa(a,b);return ub[b]}function oa(a,b){for(var c=a.scenes,d=[],e=0;e<c.length;e++)X(c[e].objects,0,a==jb,d);
ub[b]=[];for(e=0;e<d.length;e++)for(var c=d[e],f=0;f<c.length;f++)for(var g=c[f],h=0;h<g.length;h++)ub[b].push(g[h])}function X(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var g=a[f],h=da(g);e[h]=e[h]||[];(c||-1==Ac.indexOf(g.type))&&-1==e[h].indexOf(g)&&e[h].push(g);(g=g.dupli_group)&&X(g.objects,b+1,c,d)}}function da(a){return(a=a.parent||fa.get_first_armature_object(a))?1+da(a):0}var ea=p("__anchors"),fa=p("__animation"),ga=p("__batch"),B=p("__config"),N=p("__controls"),ia=p("__dds"),
ta=p("__extensions");p("__lights");var Y=p("__loader"),ja=p("__assets"),sa=p("__md5"),z=p("__objects"),F=p("__obj_util"),ka=p("__physics"),ra=p("__print"),O=p("__reformer"),ha=p("__renderer"),T=p("__scenes"),hc=p("__nla"),xa=p("__sfx"),Zb=p("__shaders"),Pa=p("__textures"),na=p("__nodemat"),ua=p("__util");p("__transform");p("__camera");var Oa=p("vec4"),cb=p("mat4"),Da=B.r,Rb=B.$d,yc=B.q,pc=B.Zd,ic=B.o,Ba=null,ub=null,Gb="",jb=null,qc={},Ca=null,Kb=null,Va=0,Ac=["LAMP","CAMERA"],pa=["MESH","CAMERA",
"EMPTY"],Kc=["SPEAKER"],la=null;a.is_primary_loaded=function(a){return Y.is_primary_loaded(a)};a.update=function(){Y.dD(Ba)};a.TB=function(a){la=a};a.ZC=function(a,b){if(Ca){Kb.style.height=b.toString()+"px";Kb.style.width=a.toString()+"px";var c=Math.round(a/2-44);Ca.style.top=Math.round(b/2-44).toString()+"px";Ca.style.left=c.toString()+"px"}};a.load=function(a,d,h,k,z){var n={load_main:{Sa:Y.Td,gb:!1,J:[],kb:!1,lb:500,wb:!1,ib:b},duplicate_objects:{Sa:Y.xd,gb:!1,J:["load_main"],kb:!1,lb:50,wb:!1,
ib:y},load_binaries:{Sa:Y.Td,gb:!1,J:["load_main"],kb:!1,lb:500,wb:!1,ib:e},wait_for_shaders:{Sa:Y.Td,gb:!0,J:[],kb:!1,lb:50,wb:!0,ib:l,Ve:l},prepare_bindata:{Sa:Y.xd,gb:!1,J:["duplicate_objects","load_binaries"],kb:!1,lb:0,wb:!1,ib:m},prepare_root_datablocks:{Sa:Y.xd,gb:!1,J:["duplicate_objects","prepare_bindata"],kb:!1,lb:150,wb:!1,ib:f},prepare_root_scenes:{Sa:Y.xd,gb:!1,J:["prepare_root_datablocks","wait_for_shaders"],kb:!1,lb:350,wb:!1,ib:r},load_smaa_textures:{Sa:Y.Td,gb:!0,J:["prepare_root_scenes"],
kb:!1,lb:10,wb:!0,ib:v},load_shoremap:{Sa:Y.Td,gb:!0,J:["prepare_root_scenes"],kb:!1,lb:10,wb:!0,ib:I},load_textures:{Sa:Y.Td,gb:!0,J:["prepare_root_scenes"],kb:!0,lb:500,wb:!1,ib:x,Yf:{Pr:0}},wait_physics_workers:{Sa:Y.Td,gb:!0,J:["load_shoremap"],kb:!1,lb:20,wb:!1,Ve:K},add_physics_objects:{Sa:Y.xd,gb:!1,J:["wait_physics_workers"],kb:!1,lb:20,wb:!1,ib:Q},add_objects:{Sa:Y.xd,gb:!1,J:["add_physics_objects"],kb:!1,lb:800,wb:!1,ib:H,Ve:P,Mi:Z,Yf:{bm:[],Bs:0}},load_speakers:{Sa:Y.Td,gb:!0,J:["add_objects"],
kb:!0,lb:30,wb:!1,ib:g,Yf:{eC:0}},mobile_media_start:{Sa:Y.xd,gb:!Da.rg,J:["load_textures","load_speakers"],kb:!0,lb:5,wb:!1,ib:R,Ve:R},synchronize_media:{Sa:Y.xd,gb:!0,J:["mobile_media_start"],kb:!0,lb:70,wb:!1,ib:aa},start_nla:{Sa:Y.xd,gb:!0,J:["mobile_media_start"],kb:!1,lb:5,wb:!1,ib:E}},F=Y.zr();F||(F=Y.Nx(),Ba={},ub={},qc={});Ba[F.Od.length]={};return Y.Ux(n,a,d,h,c,k||ic.aq,Da.do_not_load_resources,z)};a.unload=function(a){var b=Y.zr();if(!b||!b.Od.length||a&&!Y.DC(b.Od[a]))ra.error("Unable to unload data!");
else{if(0==a)ra.log("%cUNLOAD ALL","color: #00a"),ea.cleanup(),fa.cleanup(),xa.cleanup(),hc.cleanup(),T.cleanup(),Y.cleanup(),ka.cleanup(),z.cleanup(),ua.cleanup(),ha.cleanup(),na.cleanup(),Zb.cleanup(),N.cleanup(),ta.cleanup(),ja.cleanup(),Pa.cleanup(),ub=null,qc={},Ba=jb=null;else{ra.log("%cUNLOAD DATA "+a,"color: #00a");fa.eB(a);for(var b=T.jj(),c=0;c<b.length;c++)for(var d=b[c],e=T.$a(d,"ALL",T.DATA_ID_ALL),f=e.length-1;0<=f;f--){var g=e[f];if(g.c.g.Xb==a){ca(d,g,!0);e.splice(f,1);var h=T.$a(d,
g.type,T.DATA_ID_ALL),g=h.indexOf(g);-1!=g&&h.splice(g,1)}}}ba()}};a.WA=ca;a.set_debug_resources_root=function(a){Gb=a}};b4w.module.__batch=function(a,p){function c(a){a={type:a,Ma:"",id:0,hB:0,Wh:"",S:[],Nb:[],$c:[],Qi:[],bh:null,yb:{},ec:null,Eb:null,$p:[],LF:null,P:null,Sc:null,Qd:!1,dg:!1,Rq:!1,wireframe_mode:0,num_vertices:0,num_triangles:0,as:0,bs:0,Cr:0,yn:0,ic:new Float32Array(3),wc:new Float32Array(16),Ha:!1,Eq:!1,ba:!1,Ie:!1,Oa:!1,vd:!1,Cd:!1,Jc:!1,oc:!1,pc:!1,dc:!1,Ub:!1,Hc:!1,Bb:!1,Rs:!1,le:R.Bi,Ke:R.Wd,ig:!1,$A:"",TF:"",Er:!1,Ir:0,Fr:0,Jr:0,Kr:0,Hr:new Float32Array(3),Gr:new Float32Array(3),og:!1,Yd:0,
me:0,Ze:1,reflect_factor:0,Bt:0,Mo:1,parallax_scale:0,Ye:0,Ne:1,vs:0,eo:0,Gg:0,$s:0,yc:Array(2),qc:new Float32Array(3),Ff:new Float32Array(3),Kd:new Float32Array(3),Wc:new Float32Array(4),nd:new Float32Array(4),Kh:null,Pn:null,Nn:null,Mn:null,On:null,Eh:!1,Lf:!1,water_dynamic:!1,Sl:!1,nu:!1,ou:0,pu:0,mu:0,zi:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,gr:new Float32Array(2),fr:new Float32Array(2),hn:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),
Eg:null,zo:!1,la:null};a.Wc[3]=1;a.Eq=!0;a.ba=!0;return a}function d(a){switch(a.type){case "MAIN":case "PARTICLES":a.Ma=a.Ha?a.Ie?"XRAY":"BLEND":"OPAQUE";break;case "DEPTH":a.Ma=a.Eh?"NODES":"DEPTH";break;case "COLOR_ID":a.Ma=a.Ie?"COLOR_ID_XRAY":"COLOR_ID"}}function b(a){var b=a.P;a.P=null;var c=U.ag(a);a.P=b;c.P=b;return c}function e(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d],f=e.c.g,g=v.ed();v.zk(f.lh,g);var k=e.data.b4w_bounding_cylinder_radius,l=e.data.b4w_bounding_sphere_radius,n=e.data.b4w_bounding_sphere_center,
B=e.data.b4w_bounding_ellipsoid_axes,r=e.data.b4w_bounding_ellipsoid_center;if(f.hd){var k=Math.max(Math.abs(g.max_x),Math.abs(g.min_x)),l=Math.max(Math.abs(g.max_y),Math.abs(g.min_y)),q=Math.max(Math.abs(g.max_z),Math.abs(g.min_z)),q=Math.sqrt(k*k+l*l+q*q),k=Math.sqrt(k*k+l*l);g.max_x=g.max_y=g.max_z=q;g.min_x=g.min_y=g.min_z=-q;l=q;n[0]=n[1]=n[2]=0;B[0]=B[1]=B[2]=q;r[0]=r[1]=r[2]=0}f.Hb=g;q=v.tm(g,f.Z);f.hb=q;h(f,k,k,g);g=v.Bk(l,n);f.Tc=g;g=v.vm(g,f.Z);f.Ib=g;B=v.Ak([B[0],0,0],[0,B[1],0],[0,0,B[2]],
r);f.Te=B;B=v.um(B,f.Fb);f.Vf=B;c=c.concat(m(e,f,b))}return c}function l(a,b,c){for(var d=[],e=[],f={},g=0;g<a.length;g++){var h=a[g],k=h.c.g,l=v.ed();v.zk(k.lh,l);var n=v.tm(l,k.Z),r=v.Bk(h.data.b4w_bounding_sphere_radius,h.data.b4w_bounding_sphere_center),q=v.vm(r,k.Z),t=h.data.b4w_bounding_ellipsoid_axes,t=v.Ak([t[0],0,0],[0,t[1],0],[0,0,t[2]],h.data.b4w_bounding_ellipsoid_center),y=v.um(t,k.Fb);k.Hb=l;k.hb=n;k.Tc=r;k.Ib=q;k.Te=t;k.Vf=y;l={};l.Jc=k.Jc;l.oc=k.oc;l.pc=k.pc;l.Ug=k.Ug;l.ll=k.ll;l.Lb=
k.Lb;l.kl=k.kl;l.wj=k.wj;l.dc=k.dc;l.Ub=k.Ub;l.Hc=k.Hc;l.Uc=k.Uc;l.Ec=k.Ec;l.uf=k.uf;l.de=k.de;l.Qc=k.Qc;l.te=k.te;l.Rb=k.Rb;l.hd=k.hd;l.Ji=k.Ji;l.Ii=k.Ii;l.Bb=k.Bb;l.uh=k.uh;l.Gk=k.Gk;l.ue=k.ue;l.Ag=k.Ag;l.dl=k.dl;l.Cc=k.Cc;l.zg=k.zg;l.el=k.el;l.Cd=k.Cd;n=k.Ib.F;l.Jz=0==c?[0,0]:[Math.floor(n[0]/c),Math.floor(n[2]/c)];l.lf=k.lf;l.uj=k.uj;l.yg=k.yg;k=JSON.stringify(l);f[k]=f[k]||[];f[k].push(h)}for(var u in f){l=JSON.parse(u);c=f[u];var h=U.sh("STATIC"),w;for(w in l)h[w]=l[w];h.Xb=a[0].c.g.Xb;h.Sd=
0;h.He=0;h.he=0;h.ge=0;h.be=0;h.Fh=!1;for(g=0;g<c.length;g++)k=c[g],0==g?(h.hb=B.pa(k.c.g.hb),h.Ib=B.pa(k.c.g.Ib),h.Te=B.pa(k.c.g.Te),h.Vf=B.pa(k.c.g.Vf)):(v.Zq(h.hb,k.c.g.hb),v.wy(h.Ib,k.c.g.Ib));h.Hb=B.pa(h.hb);h.Tc=B.pa(h.Ib);e.push({g:h,xe:c})}for(a=0;a<e.length;a++)for(f=e[a].g,g=e[a].xe,u=0;u<g.length;u++){w=g[u];c=m(w,f,b);w.c.g.hd&&!w.c.g.qm?(h=ga.create(),ga.set_trans(w.c.g.i,h)):(h=w.c.g,h=ga.create_sep(h.i,h.scale,h.quat));k={};if(f.Qc||f.hd)k.au_center_pos=[h[0],h[1],h[2]];f.Qc&&(k.au_wind_bending_amp=
[w.c.g.Sd],k.au_wind_bending_freq=[w.b4w_wind_bending_freq],k.au_detail_bending_amp=[w.b4w_detail_bending_amp],k.au_detail_bending_freq=[w.b4w_detail_bending_freq],k.au_branch_bending_amp=[w.b4w_branch_bending_amp]);for(l=0;l<c.length;l++)q=c[l].g,n=c[l].Lc,r=c[l].D,q.$k?q.hd?R.vC(n,h):R.Lt(n,h):("COLOR_ID"==r.type&&(q=c[l].g=w.c.g,r.Wh=w.uuid,x(r,q),E(r,B.oh(q,0))),n=R.Lt(n,h),R.uC(n,k));d=d.concat(c)}return d}function m(a,b,d){var e=[],h=n(d,b),k=B.oh(b,0),l=a.data,m=l.materials,r=Array(m.length),
v=da.Ya(d,"MAIN_OPAQUE"),q=!1;v&&(q=v.kf.length?!0:!1);for(var t=0;t<h.length;t++){var y=h[t];if(!a.b4w_do_not_render||"PHYSICS"==y)for(var u=0;u<m.length;u++){var w=m[u];if(("LENS_FLARES"!=w.name||q)&&!R.Lr(l,u)){var p=c(y);"MAIN"==y&&(r[u]=p);if(J(p,w)){"DEPTH"==y&&r[u]&&(p.vd=r[u].vd);p.le=b.Qd||b.Cd?R.ak:R.Bi;x(p,b);for(var H=p,ia=a.particle_systems,A=0;A<ia.length;A++){var C=ia[A].settings.b4w_vcol_from_name,D=ia[A].settings.b4w_vcol_to_name;""!==C&&""!==D&&(H.yb[C]={lg:!1,src:[{name:C,Zc:7}]})}"DYNAMIC"==
b.type&&(p.Wh=a.uuid);E(p,k);var I=R.br(l,u,p.Qi,p.Sc,p.yb,p.bh);"LENS_FLARES"==w.name&&(I=ca.VA(I));e.push({D:p,Lc:I,jc:[w.name],g:b,rd:[a]})}}}}var G=a.particle_systems;if(0<G.length&&e.length){for(var P=!1,M=!1,t=0;t<G.length;t++){var K=G[t],ta=K.settings;ta.use_render_emitter&&(P=!0);"HAIR"!=ta.type||"OBJECT"!=ta.render_type&&"GROUP"!=ta.render_type&&K.transforms.length||(M=!0);if(P&&M)break}var ja=e[0].D.yb,Q;if(M){var aa;if(1<m.length){for(var sa={},fa=0;fa<G.length;fa++){var ga=G[fa].settings;
if("HAIR"==ga.type&&("OBJECT"==ga.render_type||"GROUP"==ga.render_type)){var W=ga.b4w_vcol_from_name,U=ga.b4w_vcol_to_name;""!==W&&""!==U&&(sa[W]=B.pa(ja[W]))}}"a_bending_col_main"in ja&&(sa.a_bending_col_main=B.pa(ja.a_bending_col_main));"a_bending_col_detail"in ja&&(sa.a_bending_col_detail=B.pa(ja.a_bending_col_detail));aa=R.cr(l,[],sa)}else aa=e[0].Lc;Q=aa}else Q=null;for(var S,ba=Q,X=[],ib=a.particle_systems,Vc=a.data,Bc=0;Bc<ib.length;Bc++){var Ea=ib[Bc],Ia=Ea.settings;if(Ia.count)if("EMITTER"==
Ia.type){if("DYNAMIC"==b.type){var Ua=c("PARTICLES"),gb,Ta=Vc.materials,yb=Ea.settings.material-1;yb>=Ta.length&&(Z.warn('Wrong material used for rendering particle system "'+Ea.name+'"'),yb=0);gb=Ta[yb];"HALO"===Ea.settings.render_type&&(Ua.og=!0);f(Ua,gb);x(Ua,b);var vb=Ua,wb=Ea.settings;switch(wb.b4w_billboard_align){case "VIEW":g(vb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":g(vb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":g(vb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");
break;case "ZX":g(vb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:throw"Wrong billboard align value";}g(vb,"BILLBOARD",0);g(vb,"SOFT_PARTICLES",wb.b4w_enable_soft_particles&&0<wb.b4w_particles_softness&&Y.Xi?1:0);g(vb,"SOFT_STRENGTH",ea.v(wb.b4w_particles_softness));ea.I(vb.Eb,"WORLD_SPACE","WORLD"==wb.b4w_coordinate_system?1:0);Ua.Cd=!0;Ua.Wh=a.name+"_"+Ia.uuid;Ua.$A=Ea.name;E(Ua,k);ca.Sz(Ua,Ea,gb);var Xa=ca.Uy(Ua,Vc,Ea,a.c.g.Fb);X.push({D:Ua,Lc:Xa,jc:[gb.name],g:b,rd:[a]})}}else if("HAIR"==
Ia.type){var Fa=B.Wk(Ea.seed);Ia.b4w_dynamic_grass&&(b.uh=!0);var kb=oa.wq(Y.Yn)&&!Ia.b4w_initial_rand_rotation&&!Ia.b4w_hair_billboard,ya=4;kb&&(ya=8);if(Ea.transforms.length)var Wa=Ea.transforms;else for(var Ga=R.qn(ba,Ia.count,!1,Fa),Wa=new Float32Array(Ga.length*ya),qa=0;qa<Ga.length;qa++){var Wb=.75+.5*B.bd(Fa);Wa[qa*ya]=Ga[qa][0];Wa[qa*ya+1]=Ga[qa][1];Wa[qa*ya+2]=Ga[qa][2];Wa[qa*ya+3]=Wb;kb&&(Wa[qa*ya+4]=1,Wa[qa*ya+5]=0,Wa[qa*ya+6]=0,Wa[qa*ya+7]=0)}var Ub=da.Ya(d,"GRASS_MAP")?!0:!1;if("OBJECT"==
Ia.render_type)var wa=[n(d,Ia.dupli_object.c.g,!0)],rc=L(a,b,ja,ba,[Ia.dupli_object],wa,[Wa],Ia,Ea,Ub,Fa,!1),X=X.concat(rc);else if("GROUP"==Ia.render_type){for(var V=Ia.dupli_group.objects,Hb=!1,wa=[],qa=0;qa<V.length;qa++){var Lb=n(d,Ia.dupli_group.objects[qa].c.g,!0);wa.push(Lb)}if(Ia.use_whole_group){for(var va,za=Wa,zb=V,Cc=kb,db=ya,hb={},$a=new Float32Array([0,0,0,1]),Ma=0;Ma<za.length;Ma+=db)for(var eb=0;eb<zb.length;eb++){var bc=N.create();N.scale(zb[eb].c.g.i,zb[eb].c.g.scale,bc);var Mb=
N.clone([za[Ma],za[Ma+1],za[Ma+2]]);hb[eb]||(hb[eb]=new Float32Array(za.length));Cc&&(hb[eb][Ma+4]=$a[0]=za[Ma+4],hb[eb][Ma+5]=$a[1]=za[Ma+5],hb[eb][Ma+6]=$a[2]=za[Ma+6],hb[eb][Ma+7]=$a[3]=za[Ma+7],B.vo($a,$a),B.HC(bc,$a,bc));N.add(Mb,bc,Mb);hb[eb][Ma]=Mb[0];hb[eb][Ma+1]=Mb[1];hb[eb][Ma+2]=Mb[2];hb[eb][Ma+3]=za[Ma+3]}va=hb;Hb=!0}else{var ab;if(Ia.use_group_count){for(var Nb=Wa,Mc=V,Ob=Ia.dupli_weights,Nc=Fa,Dc=kb,Ha=ya,lb={},Bb=[],bb=0;bb<Mc.length;bb++)for(var Vb=Mc[bb],Cb=Vb.origin_name||Vb.name,
cc=0;cc<Ob.length;cc++){var Aa=Ob[cc];Cb==Aa.name.split(": ")[0]&&Bb.push(Aa)}Ob.length!=Bb.length&&Z.error("dupli weights match failed");for(bb=0;bb<Nb.length;bb+=Ha){for(var Ra,qb=Bb,Xb=[0],Ka=0;Ka<qb.length;Ka++)Xb[Ka+1]=Xb[Ka]+qb[Ka].count;for(var sc=Xb[Xb.length-1]*B.bd(Nc),Pb=0,Ka=0;Ka<Xb.length;Ka++)if(sc>=Xb[Ka]&&sc<Xb[Ka+1]){Pb=Ka;break}Ra=Pb;lb[Ra]=lb[Ra]||[];lb[Ra].push(Nb[bb],Nb[bb+1],Nb[bb+2],Nb[bb+3]);Dc&&lb[Ra].push(Nb[bb+4],Nb[bb+5],Nb[bb+6],Nb[bb+7])}for(Ra in lb)lb[Ra]=new Float32Array(lb[Ra]);
ab=lb}else{for(var Ib=Wa,Ya=Fa,jc=kb,$b=ya,kc=V.length,mb={},rb=0;rb<Ib.length;rb+=$b){var Db=Math.floor(kc*B.bd(Ya));mb[Db]=mb[Db]||[];mb[Db].push(Ib[rb],Ib[rb+1],Ib[rb+2],Ib[rb+3]);jc&&mb[Db].push(Ib[rb+4],Ib[rb+5],Ib[rb+6],Ib[rb+7])}for(Db in mb)mb[Db]=new Float32Array(mb[Db]);ab=mb}va=ab}rc=L(a,b,ja,ba,V,wa,va,Ia,Ea,Ub,Fa,Hb);X=X.concat(rc)}"INSTANCE"==Ia.b4w_wind_bend_inheritance&&a.c.g.Qc&&Z.warn('Emitter object "'+a.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else throw"Unknown particle settings type";
}S=X;e=P?e.concat(S):S}return e}function h(a,b,c,d){a.nm=v.Kq(b,d);a.lm=v.Iq(c,d);a.mm=v.Jq(b,d)}function n(a,b,c){var d=["MAIN","NODES_GLOW"];(b.Ug&&da.Ya(a,"COLOR_PICKING")||b.Lb&&da.Ya(a,"OUTLINE_MASK"))&&!c&&d.push("COLOR_ID");da.Ya(a,"WIREFRAME")&&d.push("WIREFRAME");d.push("PHYSICS");(da.Ya(a,"DEPTH")||da.Ya(a,"SHADOW_CAST"))&&d.push("DEPTH");da.Ya(a,"GRASS_MAP")&&d.push("GRASS_MAP");if(b.oc||b.Ub)for(a=null,b.oc&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","WIREFRAME"]),b.Ub&&(b=["COLOR_ID",
"PHYSICS","DEPTH","WIREFRAME"],a=null!==a?B.sw(a,b):b),b=a,a=0;a<b.length;a++)c=d.indexOf(b[a]),-1!==c&&d.splice(c,1);return d}function f(a,b){var c;switch(a.type){case "MAIN":if(b.b4w_do_not_render)c=!1;else{if(b.use_nodes)t(a,b,"MAIN");else{r(a,b);var d=b.game_settings.alpha_blend;a.Ie=b.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.Gg=b.offset_z;a.Ff.set([1,1,1]);var e=b.texture_slots;ia.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Wc);switch(b.name){case "LENS_FLARES":K(a,
"special_lens_flares.glslv","special_lens_flares.glslf");u(a,"a_position");u(a,"a_texcoord");var f=y(e[0],null);Q(a,f);break;default:K(a,"main.glslv","main.glslf");var h=w("use_map_color_diffuse",e),l=w("use_map_color_spec",e),m=w("use_map_normal",e),n=w("use_map_mirror",e),f=w("use_stencil",e);c=h[0];l=l[0];m=m[0];n=n[0];h=h[1];e=f[0]&&w("use_rgb_to_intensity",e)[0];if(c){switch(c.blend_type){case "MIX":g(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":g(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}f=y(c,null);Q(a,f,"u_colormap0");Y.fm&&"CLIP"==d&&fa.Kj(f,fa.sc,fa.sc);a.Ye=c.diffuse_color_factor;a.Ne=c.use_map_alpha?c.alpha_factor:0;a.Ff.set(c.scale)}d=c&&c==l;l&&(d||(f=y(l,null),Q(a,f,"u_specmap0")),a.Bt=l.specular_color_factor);if(m&&(u(a,"a_normal"),u(a,"a_tangent"),f=y(m,null),Q(a,f,"u_normalmap0"),a.vs=m.normal_factor,f=m.texture,f.b4w_use_map_parallax&&Y.Aj)){var B=ea.v(f.b4w_parallax_steps),v=ea.v(f.b4w_parallax_lod_dist);g(a,"PARALLAX",1);g(a,"PARALLAX_STEPS",
B);g(a,"PARALLAX_LOD_DIST",v);a.parallax_scale=f.b4w_parallax_scale}n&&(f=y(n,null),Q(a,f,"u_mirrormap"),a.eo=n.mirror_factor);if(n=c&&h&&e?1:0)f=y(h,null),Q(a,f,"u_colormap1"),f=y(e,null),Q(a,f,"u_stencil0");(f=c||l||m)&&a.Ff.set(f.scale);g(a,"TEXTURE_SPEC",void 0==l?0:1);g(a,"ALPHA_AS_SPEC",d?1:0);g(a,"TEXTURE_STENCIL_ALPHA_MASK",n);u(a,"a_position");u(a,"a_normal");(c||l||m)&&u(a,"a_texcoord");if(b.b4w_water){a.Lf=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.Ha?(Z.warn('Material: "'+
b.name+'" is opaque.',"Disabling shore smoothing."),a.Sl=!1):a.Sl=b.b4w_water_shore_smoothing;K(a,"special_water.glslv","special_water.glslf");u(a,"a_position");Y.qu?(u(a,"a_polyindex"),a.ba=!0,a.wireframe_edge_color=[0,0,0],g(a,"DEBUG_WIREFRAME",1)):g(a,"DEBUG_WIREFRAME",0);d=b.texture_slots;n=w("use_map_normal",d);f=w("use_map_mirror",d)[0];n.length&&(B=y(n[0]),Q(a,B,"u_normalmap0"),a.zi=b.b4w_water_norm_uv_velocity);g(a,"NUM_NORMALMAPS",n.length);a.Eg=Array(n.length);for(B=0;B<n.length;B++)a.Eg[B]=
new Float32Array(2),a.Eg[B].set([n[B].scale[0],n[B].scale[1]]);f&&(B=y(f),Q(a,B,"u_mirrormap"),a.eo=f.mirror_factor);f=null;if(Y.zh)for(B=0;B<d.length;B++){var q=d[B];if(!0===q.texture.b4w_water_foam){f=q;break}}f?(g(a,"FOAM",1),B=y(f),Q(a,B,"u_foam"),a.foam_factor=b.b4w_foam_factor,a.gr.set(f.texture.b4w_foam_uv_freq),a.fr.set(f.texture.b4w_foam_uv_magnitude),a.hn[0]=f.scale[0],a.hn[1]=f.scale[1]):g(a,"FOAM",0);for(B=0;B<d.length;B++)if(q=d[B],!0===q.texture.b4w_shore_dist_map){var x=q;break}x&&
Y.cm?(x=y(x),Q(a,x,"u_shore_dist_map"),g(a,"SHORE_PARAMS",1),x=q.texture.b4w_shore_boundings,g(a,"MAX_SHORE_DIST",ea.v(q.texture.b4w_max_shore_dist)),g(a,"SHORE_MAP_SIZE_X",ea.v(x[0]-x[1])),g(a,"SHORE_MAP_SIZE_Y",ea.v(x[2]-x[3])),g(a,"SHORE_MAP_CENTER_X",ea.v((x[0]+x[1])/2)),g(a,"SHORE_MAP_CENTER_Y",ea.v((x[2]+x[3])/2))):g(a,"SHORE_PARAMS",0);if(b.b4w_generated_mesh&&Y.Xi)g(a,"GENERATED_MESH",1),a.nu=!0,a.ou=b.b4w_water_num_cascads,a.pu=b.b4w_water_subdivs,a.mu=b.b4w_water_detailed_dist;else{u(a,
"a_normal");if(f||n.length)u(a,"a_texcoord"),u(a,"a_tangent");g(a,"GENERATED_MESH",0)}if(b.b4w_water_dynamic){var q=ea.v(b.b4w_water_dst_noise_scale0),x=ea.v(b.b4w_water_dst_noise_scale1),n=ea.v(b.b4w_water_dst_noise_freq0),d=ea.v(b.b4w_water_dst_noise_freq1),f=ea.v(b.b4w_water_dir_min_shore_fac),B=ea.v(b.b4w_water_dir_freq),v=ea.v(b.b4w_water_dir_noise_scale),p=ea.v(b.b4w_water_dir_noise_freq),N=ea.v(b.b4w_water_dir_min_noise_fac),H=ea.v(b.b4w_water_dst_min_fac),A=ea.v(b.b4w_water_waves_hor_fac);
g(a,"DST_NOISE_SCALE_0",q);g(a,"DST_NOISE_SCALE_1",x);g(a,"DST_NOISE_FREQ_0",n);g(a,"DST_NOISE_FREQ_1",d);g(a,"DIR_MIN_SHR_FAC",f);g(a,"DIR_FREQ",B);g(a,"DIR_NOISE_SCALE",v);g(a,"DIR_NOISE_FREQ",p);g(a,"DIR_MIN_NOISE_FAC",N);g(a,"DST_MIN_FAC",H);g(a,"WAVES_HOR_FAC",A)}D(a,b);G(a,b);a.shallow_water_col.set(b.b4w_shallow_water_col);a.shore_water_col.set(b.b4w_shore_water_col);a.shallow_water_col_fac=b.b4w_shallow_water_col_fac;a.shore_water_col_fac=b.b4w_shore_water_col_fac;g(a,"ABSORB",ea.v(b.b4w_water_absorb_factor));
g(a,"SSS_STRENGTH",ea.v(b.b4w_water_sss_strength));g(a,"SSS_WIDTH",ea.v(b.b4w_water_sss_width))}"HALO"===b.type&&(q=b.halo,K(a,"halo.glslv","halo.glslf"),g(a,"NUM_RINGS",q.ring_count),g(a,"NUM_LINES",q.line_count),g(a,"NUM_STARS",q.star_tip_count),g(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0),a.Qi=["a_position"],a.Ir=q.size,a.Fr=q.hardness/20,a.Hr.set(q.b4w_halo_rings_color),a.Gr.set(q.b4w_halo_lines_color),a.Jr=1/b.b4w_halo_stars_blend_height,a.Kr=b.b4w_halo_stars_min_height,a.Er=!0);g(a,"TEXCOORD",
0);g(a,"NORMAL_TEXCOORD",0);c&&k(a,c,"TEXTURE_COLOR0_CO");h&&k(a,h,"TEXTURE_COLOR1_CO");e&&k(a,e,"TEXTURE_STENCIL_ALPHA_MASK_CO");l&&k(a,l,"TEXTURE_SPEC_CO");m&&k(a,m,"TEXTURE_NORM_CO");g(a,"SHADELESS",b.use_shadeless?1:0);a.vd=b.use_shadeless}d=b.game_settings.alpha_blend;g(a,"ALPHA","OPAQUE"===d?0:1);g(a,"ALPHA_CLIP","CLIP"===d?1:0);g(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(g(a,"VERTEX_COLOR",1),u(a,"a_color")):g(a,"VERTEX_COLOR",0);a.Yd=b.ambient;a.Ze=
b.diffuse_intensity;a.me=b.emit;a.Kd.set(b.specular_color);a.Mo=b.specular_alpha;D(a,b);G(a,b);b.b4w_wettable?g(a,"WETTABLE",1):g(a,"WETTABLE",0);C(a,b);a.zo=b.b4w_refractive;a.$s=b.b4w_refr_bump}c=!0}break;case "NODES_GLOW":c=t(a,b,"GLOW");break;case "DEPTH":if("LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type)c=!1;else if(r(a,b),a.Ha)c=!1;else{l=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==l?t(a,b,"DEPTH"):K(a,"depth.glslv","depth.glslf");u(a,"a_position");u(a,"a_normal");
g(a,"ALPHA","OPAQUE"===l?0:1);a.Ff.set([1,1,1]);if((c=w("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===l){a.Ff.set(c.scale);g(a,"TEXTURE_COLOR",1);u(a,"a_texcoord");if("IMAGE"==c.texture.l.source||"ENVIRONMENT_MAP"==c.texture.l.source)l=y(c),Q(a,l,"u_colormap0");"NONE"==c.texture.l.source&&(l=y(c),Q(a,l,"u_colormap0"))}else g(a,"TEXTURE_COLOR",0);c=!0}break;case "PHYSICS":b.b4w_collision?(a.mD=b.b4w_use_ghost,a.Va=b.b4w_collision_id,a.Cq=b.b4w_collision_margin,a.Bq=b.b4w_collision_group,a.Dq=
b.b4w_collision_mask,a.gj=b.physics.friction,a.aj=b.physics.elasticity,c=!0):b.b4w_water?(a.Lf=!0,a.ED=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=
b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if("LENS_FLARES"===b.name||b.b4w_do_not_render||"HALO"===b.type)c=!1;else{r(a,b);a.Ke=R.Wd;a.ba=!0;a.Ha=!1;l=b.game_settings.alpha_blend;a.Ie=b.b4w_render_above_all&&"OPAQUE"!=l&&"CLIP"!=l;b.use_nodes&&"CLIP"==l?t(a,b,"COLOR_ID"):K(a,"color_id.glslv","color_id.glslf");u(a,"a_position");g(a,"ALPHA","OPAQUE"===l?0:1);a.Ff.set([1,1,1]);if((c=w("use_map_color_diffuse",
b.texture_slots)[0])&&"CLIP"===l){a.Ff.set(c.scale);g(a,"TEXTURE_COLOR",1);u(a,"a_texcoord");if("IMAGE"==c.texture.l.source||"ENVIRONMENT_MAP"==c.texture.l.source)l=y(c),Q(a,l,"u_colormap0");"NONE"==c.texture.l.source&&(l=y(c),Q(a,l,"u_colormap0"))}else g(a,"TEXTURE_COLOR",0);c=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?c=!1:(r(a,b),a.Ha=!1,a.Ke=R.Wd,a.ba=!0,K(a,"grass_map.glslv","grass_map.glslf"),u(a,"a_position"),c=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,l=b.b4w_dynamic_grass_color?
b.b4w_dynamic_grass_color:null,a.yb.a_grass_size={lg:!0,src:[]},c?(a.yb.a_grass_size.src.push({name:c,Zc:4}),g(a,"DYNAMIC_GRASS_SIZE",1)):g(a,"DYNAMIC_GRASS_SIZE",0),a.yb.a_grass_color={lg:!0,src:[]},l?(a.yb.a_grass_color.src.push({name:l,Zc:7}),g(a,"DYNAMIC_GRASS_COLOR",1)):g(a,"DYNAMIC_GRASS_COLOR",0),c=!0);break;case "WIREFRAME":"LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type?c=!1:(K(a,"wireframe.glslv","wireframe.glslf"),u(a,"a_position"),u(a,"a_normal"),u(a,"a_polyindex"),
a.ba=!0,a.wireframe_mode=0,a.wireframe_edge_color=[0,0,0],c=!0);break;case "PARTICLES":if(b.b4w_do_not_render)c=!1;else{c=b.texture_slots;if(a.og)K(a,"particles_color.glslv","particles_color.glslf");else if(K(a,"particles_texture.glslv","particles_texture.glslf"),c=w("use_map_color_diffuse",c)[0]){g(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":g(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":g(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Ye=c.diffuse_color_factor;
a.Ne=c.use_map_alpha?c.alpha_factor:0;c=y(c);Q(a,c)}ia.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Wc);a.Yd=b.ambient;a.Ze=b.diffuse_intensity;a.me=b.emit;a.Kd.set(b.specular_color);a.Mo=b.specular_alpha;u(a,"a_position");u(a,"a_normal");c=b.game_settings.alpha_blend;g(a,"ALPHA","OPAQUE"===c?0:1);g(a,"ALPHA_CLIP","CLIP"===c?1:0);g(a,"PARTICLES_SHADELESS",b.use_shadeless?1:0);D(a,b);G(a,b);r(a,b);c=b.game_settings.alpha_blend;a.Ie=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=
c;a.Gg=b.offset_z;c=!0}break;default:throw"Wrong batch type: "+a.type;}return c}function k(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":g(a,c,"TEXTURE_COORDS_UV_ORCO");g(a,"TEXCOORD",1);break;case "NORMAL":g(a,c,"TEXTURE_COORDS_NORMAL");g(a,"NORMAL_TEXCOORD",1);break;default:g(a,c,0)}}function r(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.Ha=!0;a.Ke=R.Gp;a.ba=!0;break;case "ALPHA":a.Ha=!0;a.Ke=R.Wd;a.ba=!0;break;case "CLIP":a.Ha=!1;a.Ke=R.Wd;a.ba=!0;break;case "ADD":a.Ha=
!0;a.Ke=R.Wd;a.ba=!1;break;case "OPAQUE":a.Ha=!1;a.Ke=R.Wd;a.ba=!0;break;default:throw Error("Unknown alpha blend mode: "+d);}a.Oa=c.use_backface_culling}function y(a,b){var c=a.texture,d=c.l,c=c.image;d&&b&&c&&fa.Sj(d,b,c.tc,c.filepath);return d}function w(a,b){for(var c=[],d=b.length,e=0;e<d;e++){var f=b[e];1==f[a]&&f.texture&&f.texture.l&&c.push(f)}return c}function C(a,b){var c=b.raytrace_transparency;a.nd[0]=c.fresnel;a.nd[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;a.reflect_factor=c.reflect_factor;
a.nd[2]=c.fresnel;a.nd[3]=1-c.fresnel_factor/5}function D(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":g(a,"SPECULAR_SHADER","SPECULAR_PHONG");c=b.specular_hardness;break;case "WARDISO":g(a,"SPECULAR_SHADER","SPECULAR_WARDISO");c=b.specular_slope;break;case "TOON":g(a,"SPECULAR_SHADER","SPECULAR_TOON");c=b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":g(a,"SPECULAR_SHADER","SPECULAR_BLINN");c=b.specular_ior;d=b.specular_hardness;break;default:Z.error("unsupported specular shader: "+
b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.qc[0]=b.specular_intensity;a.qc[1]=c;a.qc[2]=d}function G(a,b){switch(b.diffuse_shader){case "LAMBERT":g(a,"DIFFUSE_SHADER","DIFFUSE_LAMBERT");a.yc[0]=0;a.yc[1]=0;break;case "OREN_NAYAR":g(a,"DIFFUSE_SHADER","DIFFUSE_OREN_NAYAR");a.yc[0]=b.roughness;a.yc[1]=0;break;case "FRESNEL":g(a,"DIFFUSE_SHADER","DIFFUSE_FRESNEL");a.yc[0]=b.diffuse_fresnel;a.yc[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":g(a,"DIFFUSE_SHADER","DIFFUSE_MINNAERT");
a.yc[0]=b.darkness;a.yc[1]=0;break;case "TOON":g(a,"DIFFUSE_SHADER","DIFFUSE_TOON");a.yc[0]=b.diffuse_toon_size;a.yc[1]=b.diffuse_toon_smooth;break;default:Z.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.yc[0]=0,a.yc[1]=0}}function t(a,b,c){if(!b.use_nodes||b.b4w_do_not_render)return!1;var d;switch(c){case "MAIN":K(a,"main.glslv","main.glslf");d=!1;break;case "GLOW":K(a,"main.glslv","main.glslf");d=!0;break;case "DEPTH":K(a,"depth.glslv","depth.glslf");d=!1;break;
case "COLOR_ID":K(a,"color_id.glslv","color_id.glslf"),d=!1}c=ba.lx(b.node_tree,b.uuid,!1,b.name,c);if(!c)return Z.error('Failed to create node graph for material "'+b.name+'", disable nodes'),A(a,b),!0;a.Eh=!0;g(a,"NODES",1);g(a,"NODES_GLOW",d?1:0);var e=b.game_settings.alpha_blend;g(a,"ALPHA","OPAQUE"===e?0:1);g(a,"ALPHA_CLIP","CLIP"===e?1:0);g(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);u(a,"a_position");b.use_orco_tex_coord&&u(a,"a_orco_tex_coord");r(a,b);a.Gg=b.offset_z;e=b.game_settings.alpha_blend;
a.Ie=b.b4w_render_above_all&&"OPAQUE"!=e&&"CLIP"!=e;ia.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Wc);a.me=b.emit;a.Yd=b.ambient;C(a,b);b.b4w_wettable?g(a,"WETTABLE",1):g(a,"WETTABLE",0);a.Eb.lo=ba.mx(c);var f=!1;W.X(c,function(b,c){switch(c.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var d=c.data.name,h=c.data.value;a.bh||(a.bh={});a.bh[h]=d;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":d=c.data.name;
a.yb[d]={lg:!0,src:[{name:c.data.value}]};h=0;if("GEOMETRY_VC"==c.type)h=7;else for(var k=0;k<c.Ba.length;k++){var l="RGB".indexOf(c.Ba[k].identifier);-1<l&&(h|=1<<2-l)}a.yb[d].src[0].Zc=h;break;case "TEX_COORD_NO":case "GEOMETRY_NO":u(a,"a_normal");break;case "MATERIAL":case "MATERIAL_EXT":d=c.data.value;u(a,"a_normal");g(a,"DIFFUSE_SHADER","DIFFUSE_"+d.ly);g(a,"SPECULAR_SHADER","SPECULAR_"+d.jC);g(a,"SHADELESS_MAT",d.vd?1:0);a.vd=d.vd;f=!0;break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":d=
c.data.name;h=c.data.value;!1!==h.l.ik&&(h.l.ik="TEXTURE_ENVIRONMENT"!=c.type?!0:!1);Q(a,h.l,d);Y.fm&&"CLIP"==e&&fa.Kj(c.data.value.l,fa.sc,fa.sc);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":g(a,"CALC_TBN_SPACE",1);u(a,"a_normal");u(a,"a_tangent");d=c.data.name;h=c.data.value;h.l.ik=!1;Q(a,h.l,d);break;case "LAMP":c.data&&(a.Kh=c.data);break;case "B4W_REFRACTION":a.zo=!0}});f||(a.vd=!0);return!0}function A(a,b){switch(a.type){case "DEPTH":K(a,"depth.glslv","depth.glslf");break;case "COLOR_ID":K(a,
"color_id.glslv","color_id.glslf");break;default:K(a,"main.glslv","main.glslf")}g(a,"SHADELESS",1);u(a,"a_position");u(a,"a_normal");ia.set(1,0,1,1,a.Wc);if(b){var c=b.game_settings.alpha_blend;g(a,"ALPHA","OPAQUE"===c?0:1);g(a,"ALPHA_CLIP","CLIP"===c?1:0);g(a,"VERTEX_COLOR",0);a.Gg=b.offset_z;r(a,b)}return!0}function x(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.$k?g(a,"AU_QUALIFIER","attribute"):g(a,"AU_QUALIFIER","uniform"),g(a,"STATIC_BATCH",0)):(g(a,"AU_QUALIFIER","attribute"),g(a,"STATIC_BATCH",
1));"WIREFRAME"==a.type&&(aa.Az()?g(a,"WIREFRAME_QUALITY",1):g(a,"WIREFRAME_QUALITY",0),a.dg?(g(a,"DEBUG_SPHERE",1),a.Rq?g(a,"DEBUG_SPHERE_DYNAMIC",1):g(a,"DEBUG_SPHERE_DYNAMIC",0)):g(a,"DEBUG_SPHERE",0),g(a,"ALPHA",1));b.Qd&&(a.Qd=b.Qd);b.Qc?(""!==b.te?(a.yb.a_bending_col_main={lg:!0,src:[{name:b.te,Zc:4}]},u(a,"a_bending_col_main"),""!==b.Rb.fs&&""!==b.Rb.es&&""!==b.Rb.Fs?(a.yb.a_bending_col_detail={lg:!0,src:[{name:b.Rb.fs,Zc:4},{name:b.Rb.es,Zc:2},{name:b.Rb.Fs,Zc:1}]},u(a,"a_bending_col_detail"),
u(a,"a_normal"),g(a,"DETAIL_BEND",1)):g(a,"DETAIL_BEND",0),g(a,"MAIN_BEND_COL",1)):g(a,"MAIN_BEND_COL",0),g(a,"WIND_BEND",1)):g(a,"WIND_BEND",0);b.pk?g(a,"BEND_CENTER_ONLY",1):g(a,"BEND_CENTER_ONLY",0);g(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.qm|0);b.hd?g(a,"BILLBOARD",1):g(a,"BILLBOARD",0);b.hd&&b.$k?g(a,"HAIR_BILLBOARD",1):g(a,"HAIR_BILLBOARD",0);b.Ii?g(a,"BILLBOARD_SPHERICAL",1):g(a,"BILLBOARD_SPHERICAL",0);switch(b.Ji){case "RANDOM":g(a,"BILLBOARD_RANDOM",1);g(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":g(a,
"BILLBOARD_RANDOM",0);g(a,"BILLBOARD_JITTERED",1);break;default:g(a,"BILLBOARD_RANDOM",0),g(a,"BILLBOARD_JITTERED",0)}b.Bb&&Y.cm?g(a,"DYNAMIC_GRASS",1):g(a,"DYNAMIC_GRASS",0);a.Bb=b.Bb;a.Cd=b.Cd;a.Jc=b.Jc;a.oc=b.oc;a.pc=b.pc&&!a.vd&&!(a.Ha&&Y.Uq);a.dc=b.dc;a.Ub=b.Ub;a.Hc=b.Hc;b.Jh?(u(a,"a_influence"),g(a,"SKINNED",1),b.fj?g(a,"FRAMES_BLENDING",1):g(a,"FRAMES_BLENDING",0),g(a,"MAX_BONES",b.ve)):(g(a,"SKINNED",0),g(a,"FRAMES_BLENDING",0));b.Ob?(g(a,"VERTEX_ANIM",1),Y.ku?g(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",
.5):g(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):g(a,"VERTEX_ANIM",0);if(b.Jh&&b.Ob)throw"Skinning and vertex animation are mutually exlusive";b.Gk?g(a,"DISABLE_FOG",1):g(a,"DISABLE_FOG",0);b.Sc&&(a.Sc=b.Sc);if(a.Eh){for(var c=a.Eb.lo,d=b.Ag,e=b.zg,f=0;f<c.length;f++){var h=c[f];switch(h.id){case "VALUE":var k=h.pl[0];if(k)for(var l=0;l<d.length;l+=2)if(d[l]==k){h.ie.push(["VALUE_IND",d[l+1]]);break}break;case "RGB":if(k=h.pl[0])for(l=0;l<e.length;l+=2)if(e[l]==k){h.ie.push(["RGB_IND",
e[l+1]]);break}}}g(a,"NUM_VALUES",b.ue.length);g(a,"NUM_RGBS",b.Cc.length)}}}function u(a,b){var c=a.Qi;-1==c.indexOf(b)&&c.push(b)}function g(a,b,c){ea.I(a.Eb,b,c)}function q(a,b){if("PHYSICS"==a.type)a.Lc=b;else{var c=a.Ke,d=a.le;a.Er&&(b=R.Cy(b));a.nu&&(b=S.Zy(a.ou,a.pu,a.mu));c=R.xC(b,c,d,a.yb);a.P=c;a.Cd||c.Vk||a.Qd||(c.gf=null,c.Pc=null);c=b.C.length;a.num_vertices=b.O*c;a:switch(a.le){case R.Bi:case R.bk:case R.ak:d=!0;break a;default:d=!1}d?R.$z(b)?a.num_triangles=b.ka.length/3*c:a.num_triangles=
b.O/3*c:a.num_triangles=0}}function L(a,b,d,e,f,g,h,k,l,m,n,r){var q=[],v=k.b4w_dynamic_grass;if(!m&&v)return q;for(var t="INSTANCE"==k.b4w_wind_bend_inheritance,y="INSTANCE"==k.b4w_shadow_inheritance,u="INSTANCE"==k.b4w_reflection_inheritance,w=[],p=[],H=0;H<f.length;H++){var A=f[H],C=B.Ni(b);C.hd=k.b4w_hair_billboard;C.Ji=k.b4w_hair_billboard_type;C.Ii="SPHERICAL"==k.b4w_hair_billboard_geometry;C.Bb=v;C.$k=!0;C.ue=A.c.g.ue;C.Ag=A.c.g.Ag;C.Cc=A.c.g.Cc;C.zg=A.c.g.zg;t?(C.Qc=A.c.g.Qc,C.Xj=A.c.g.Xj,
C.He=A.c.g.He,C.he=A.c.g.he,C.te=A.c.g.te,C.ge=A.c.g.ge,C.be=A.c.g.be,C.Sd=A.c.g.Sd,C.Rb=A.c.g.Rb,C.pk=!1):(C.Qc=a.c.g.Qc,C.Xj=a.c.g.Xj,C.He=a.c.g.He,C.he=a.c.g.he,C.te=a.c.g.te,C.ge=a.c.g.ge,C.be=a.c.g.be,C.Sd=a.c.g.Sd,C.Rb=a.c.g.Rb,C.pk=!0);y?(C.Jc=A.c.g.Jc,C.oc=A.c.g.oc,C.pc=A.c.g.pc):(C.Jc=a.c.g.Jc,C.oc=a.c.g.oc,C.pc=a.c.g.pc);u?(C.dc=A.c.g.dc,C.Ub=A.c.g.Ub,C.Hc=A.c.g.Hc,C.Uc=A.c.g.Uc,C.Ec=A.c.g.Ec,C.uf=A.c.g.uf):(C.dc=a.c.g.dc,C.Ub=a.c.g.Ub,C.Hc=a.c.g.Hc,C.Uc=a.c.g.Uc,C.Ec=a.c.g.Ec,C.uf=a.c.g.uf);
w.push(C);var D=h[H];D||(D=new Float32Array);r&&B.Wk(l.seed,n);var I=new Float32Array(3),G=new Float32Array([0,0,0,1]),P=[],L=oa.wq(Y.Yn)&&!k.b4w_initial_rand_rotation&&!k.b4w_hair_billboard,M=4;L&&(M=8);for(var K=0;K<D.length;K+=M){I[0]=D[K];I[1]=D[K+1];I[2]=D[K+2];var ja=D[K+3]*A.c.g.scale;if(k.b4w_initial_rand_rotation){switch(k.b4w_rotation_type){case "XYZ":var Q=new Float32Array([B.bd(n),B.bd(n),B.bd(n)]);N.normalize(Q,Q);break;case "Z":Q=new Float32Array([0,1,0]);break;default:throw"Unsupported random rotation type: "+
k.b4w_rotation_type;}ta.setAxisAngle(Q,k.b4w_rand_rotation_strength*(2*Math.PI*B.bd(n)-Math.PI),G)}else L&&(G.set(D.subarray(K+4,K+8)),B.vo(G,G),k.use_whole_group||(k.use_rotation_dupli?ta.multiply(G,A.c.g.quat,G):ta.multiply(G,sa,G)));var da=ga.create_sep(I,ja,G);P.push(da)}p.push(P)}for(var aa={},H=0;H<f.length;H++){var ea=g[H],C=w[H],fa={};C.Qc&&(fa.au_wind_bending_amp=[C.Sd],fa.au_wind_bending_freq=[C.He],fa.au_detail_bending_freq=[C.he],fa.au_detail_bending_amp=[C.ge],fa.au_branch_bending_amp=
[C.be],C.Sd=0,C.He=0,C.he=0,C.ge=0,C.be=0);var W=B.oh(C,0),P=p[H];if(P.length)for(var S=f[H].data,U=S.materials,ba=Array(U.length),K=0;K<U.length;K++)if(!R.Lr(S,K))for(var X=0;X<ea.length;X++){var ca=ea[X],Ea=c(ca),Ia=U[K];"MAIN"==ca&&(ba[K]=Ea);if(J(Ea,Ia)){"DEPTH"==ca&&ba[K]&&(Ea.vd=ba[K].vd);Ea.le=R.Bi;x(Ea,C);Ea.Wh=k.uuid;"JITTERED"==k.b4w_hair_billboard_type&&(Ea.as=k.b4w_hair_billboard_jitter_amp,Ea.bs=k.b4w_hair_billboard_jitter_freq);v&&(Ea.Cr=k.b4w_dynamic_grass_scale_threshold);t||(delete Ea.yb.a_bending_col_main,
delete Ea.yb.a_bending_col_detail);E(Ea,W);var Ua=R.br(S,K,Ea.Qi,Ea.Sc,Ea.yb,Ea.bh),gb=R.sA(Ua,fa,P),Ta=gb,yb=P;Ta.N.au_center_pos=new Float32Array(3*Ta.O);for(var vb=yb.length,wb=Ta.O/vb,Xa=0;Xa<vb;Xa++)for(var Fa=yb[Xa],kb=3*wb*Xa,ya=0;ya<wb;ya++)Ta.N.au_center_pos[kb+3*ya]=Fa[0],Ta.N.au_center_pos[kb+3*ya+1]=Fa[1],Ta.N.au_center_pos[kb+3*ya+2]=Fa[2];gb=Ta;if(C.Qc&&C.pk){var Wa=gb,Ga=a.c.g.Z;Wa.N.a_emitter_center=new Float32Array(3*Wa.O);var qa=ia.fromValues(0,0,0,1);ia.transformMat4(qa,Ga,qa);
for(var Wb=0;Wb<Wa.O;Wb++)Wa.N.a_emitter_center[3*Wb]=qa[0],Wa.N.a_emitter_center[3*Wb+1]=qa[1],Wa.N.a_emitter_center[3*Wb+2]=qa[2];gb=Wa}var Ub=k.b4w_vcol_from_name,wa=k.b4w_vcol_to_name,rc=Ea,V=d,Hb=!t,Lb=S,va=[];if(""!==Ub&&""!==wa){var za,zb=wa,Cc=rc.yb,db=[],hb=void 0;for(hb in Cc)for(var $a=Cc[hb].src,Ma=0,eb=0;eb<$a.length;eb++){var bc=$a[eb].Zc;zb==$a[eb].name&&db.push(hb,bc,Ma);Ma+=B.Rg(bc)}za=db;if(0<za.length)for(var Mb=0;Mb<za.length;Mb+=3)va.push({bj:Ub,Jk:7,ql:za[Mb],rl:za[Mb+1],Hk:za[Mb+
2]});else R.Lz(rc.Qi,"a_color")&&wa==Lb.active_vcol_name&&va.push({bj:Ub,Jk:7,ql:"a_color",rl:7,Hk:0})}Hb&&("a_bending_col_main"in V&&va.push({bj:"a_bending_col_main",Jk:4,ql:"a_bending_col_main",rl:4,Hk:0}),"a_bending_col_detail"in V&&va.push({bj:"a_bending_col_detail",Jk:7,ql:"a_bending_col_detail",rl:7,Hk:0}));for(var ab=gb,Nb=P,Mc=e,Ob=va,Nc=Ea.yb,Dc=!1,Ha=0;Ha<Ob.length;Ha++){var lb=Ob[Ha].bj,Bb=Mc.N[lb];if(Bb&&0<Bb.length){Dc=!0;break}}if(Dc){var bb,Vb=a.c.g.Hb,Cb=Mc.C[0].a_position,cc=Nb,Aa=
aa,Ra=new Float32Array(3),qb=new Float32Array(3),Xb=new Uint32Array(cc.length);if(!("verts_indices"in Aa)){Aa.ee=new Float32Array(3);Aa.ae=new Float32Array(3);Aa.pp=new Uint32Array(Cb.length/3);Aa.vj=new Uint32Array(Cb.length/3);Aa.ee[0]=(Vb.max_x-Vb.min_x)/20;Aa.ee[1]=(Vb.max_y-Vb.min_y)/20;Aa.ee[2]=(Vb.max_z-Vb.min_z)/20;Aa.ae[0]=Vb.min_x;Aa.ae[1]=Vb.min_y;Aa.ae[2]=Vb.min_z;for(var Ka=0;Ka<Cb.length/3;Ka++){var sc=B.trunc((Cb[3*Ka]-Aa.ae[0])/Aa.ee[0]),Pb=B.trunc((Cb[3*Ka+1]-Aa.ae[1])/Aa.ee[1]),
Ib=B.trunc((Cb[3*Ka+2]-Aa.ae[2])/Aa.ee[2]),sc=B.clamp(sc,0,19),Pb=B.clamp(Pb,0,19),Ib=B.clamp(Ib,0,19);Aa.pp[Ka]=Ka;Aa.vj[Ka]=Ib*Math.pow(20,2)+20*Pb+sc}R.zt(Aa.vj,Aa.pp,R.Xl,!0);Aa.dh=new Uint32Array(Math.pow(20,3));for(Ka=0;Ka<Aa.vj.length;Ka++)Aa.dh[Aa.vj[Ka]]++;delete Aa.vj;for(Ka=1;Ka<Aa.dh.length;Ka++)Aa.dh[Ka]+=Aa.dh[Ka-1]}for(var Ya=0;Ya<cc.length;Ya++){Ra[0]=cc[Ya][0];Ra[1]=cc[Ya][1];Ra[2]=cc[Ya][2];for(var jc=1E10,$b=-1,kc=B.trunc((Ra[0]-Aa.ae[0])/Aa.ee[0]),mb=B.trunc((Ra[1]-Aa.ae[1])/Aa.ee[1]),
rb=B.trunc((Ra[2]-Aa.ae[2])/Aa.ee[2]),kc=B.clamp(kc,0,19),mb=B.clamp(mb,0,19),rb=B.clamp(rb,0,19),Db=rb*Math.pow(20,2)+20*mb+kc,dc=Aa.dh[Db],Eb=0==Db?0:Aa.dh[Db-1];Eb<dc;Eb++){var Yb=Aa.pp[Eb];qb[0]=Cb[3*Yb];qb[1]=Cb[3*Yb+1];qb[2]=Cb[3*Yb+2];N.sub(qb,Ra,qb);var ac=N.sqrLen(qb);ac<=jc&&(jc=ac,$b=Yb)}if(-1==$b)for(Eb=0;Eb<Cb.length/3;Eb++)qb[0]=Cb[3*Eb],qb[1]=Cb[3*Eb+1],qb[2]=Cb[3*Eb+2],N.sub(qb,Ra,qb),ac=N.sqrLen(qb),ac<=jc&&(jc=ac,$b=Eb);Xb[Ya]=$b}bb=Xb;for(var sb=ab.O/Nb.length,Ha=0;Ha<Ob.length;Ha++){var xb=
Ob[Ha].ql,Qb=Ob[Ha].rl,lb=Ob[Ha].bj,Oc=Ob[Ha].Jk,Bb=Mc.N[lb];switch(xb){case "a_bending_col_main":var nb=1;break;case "a_bending_col_detail":nb=3;break;case "a_color":nb=3;break;default:for(var Na=nb=0;Na<Nc[xb].src.length;Na++)nb+=B.Rg(Nc[xb].src[Na].Zc)}if(Bb&&0<Bb.length){var Ec=B.Rg(Oc),Fb=B.Rg(Qb),lc=Oc&Qb,ec=B.et(lc);lc!=Qb&&Z.error("Wrong color extraction from "+lb+" to "+xb+".");if("a_bending_col_main"==xb||"a_bending_col_detail"==xb)ab.N[xb]=new Float32Array(ab.O*Fb);for(Na=0;Na<Nb.length;Na++){var Fc=
bb[Na],Gc=Fc*Ec,fb=Na*sb*nb;if(-1!=Fc)for(var Sa=0;Sa<sb;Sa++)for(var ad=Sa*nb,fc=0;fc<ec.length;fc++)ec[fc]&&(ab.N[xb][fb+ad+(Ob[Ha].Hk+B.Jj(Qb,fc))]=Bb[Gc+B.Jj(Oc,fc)])}}else ab.N[xb]=new Float32Array(0)}}gb=ab;q.push({D:Ea,Lc:gb,jc:[Ia.name],g:C,rd:[a]})}}}return q}function J(a,b){var c=!0;"NODES_GLOW"==a.type&&(c=ba.vq(b));return c=c&&f(a,b)}function E(a,b){for(var c=null,d=null,e=0;e<a.S.length;e++){var f=a.S[e].ce;f&&(c||(c={}),c[e]=f,a.S[e].ce=null);if(f=a.S[e].Ta)d||(d={}),d[e]=f,a.S[e].Ta=
null}a.id=0;a.hB=b;a.id=B.oh(a,b);if(c)for(var g in c)a.S[g].ce=c[g];if(d)for(g in d)a.S[g].Ta=d[g]}function M(a,b,d,e,f){var g=c("WIREFRAME");K(g,"wireframe.glslv","wireframe.glslf");g.wireframe_mode=0;g.dg=!0;g.ba=!0;g.Wh=d;f&&(g.Rq=!0);x(g,b);E(g,B.oh(b,0));e?(b=S.pn(1,a.F),R.gt(b,[a.Qe[0],a.Re[1],a.Se[2]],a.F)):b=S.pn(a.Ia,a.F);R.Jl(b,1,!0);b.N.a_polyindex=R.en(b);q(g,b);return g}function K(a,b,c){a.Eb={Vj:b,ej:c,$e:[],Un:[],lo:[]};ea.CB(a.Eb)}function Q(a,b,c){1==a.S.length&&0==a.Nb.length&&
a.Nb.push("default0");c=c||"default"+String(a.S.length);-1==a.Nb.indexOf(c)&&(a.S.push(b),a.Nb.push(c));a.ec&&X.Xp(a)}function I(a){if(!a.Eb)throw"No shaders info for batch "+a.name;a.ec=ea.kz(a.Eb);X.yw(a.ec);X.Vp(a);X.Xp(a)}var v=p("__boundings"),H=p("__camera"),P=p("__config"),Z=p("__print"),aa=p("__extensions"),R=p("__geometry"),W=p("__graph"),ba=p("__nodemat"),U=p("__obj_util"),ca=p("__particles"),S=p("__primitives"),oa=p("__reformer"),X=p("__renderer"),da=p("__scenegraph"),ea=p("__shaders"),
fa=p("__textures"),ga=p("__tsr"),B=p("__util"),N=p("vec3"),ia=p("vec4"),ta=p("quat"),Y=P.r,ja=["MAIN"],sa=new Float32Array([0,-Math.sqrt(.5),0,Math.sqrt(.5)]);a.oF=c;a.Yy=function(a,b,c,f){for(var g=[],h=a.l.jb,k=[],m=[],n=0;n<c.length;n++){var r=c[n];U.ab(r)?k.push(r):m.push(r)}n=[];n=n.concat(e(k,h));k=n=n.concat(l(m,h,b));n=[];r=[];m={};for(b=0;b<k.length;b++){var v=k[b].D,t=k[b].g,y=null;if(v.id in m){for(var u=m[v.id],x=r[u].D,w=r[u].g,p=null,N=null,h=0;h<v.S.length;h++){var H=v.S[h].ce;H&&(p||
(p={}),p[h]=H,v.S[h].ce=null);if(H=v.S[h].Ta)N||(N={}),N[h]=H,v.S[h].Ta=null}B.Kt(v,x)&&B.Kt(t,w)&&(y=r[u]);if(p)for(h in p)v.S[h].ce=p[h];if(N)for(h in N)v.S[h].Ta=N[h];if(!y){do v.id++;while(m[v.id])}}y||(y={D:v,g:k[b].g,rd:[],To:[],jc:[]},m[v.id]=r.length,r.push(y));y.rd=y.rd.concat(k[b].rd);k[b].Lc&&k[b].Lc.O&&y.To.push(k[b].Lc);if(y.jc.length)for(h=0;h<k[b].jc.length;h++)v=k[b].jc[h],-1==y.jc.indexOf(v)&&y.jc.push(v);else y.jc=k[b].jc;R.zt(y.jc,y.To,R.Gv,!1)}for(b=0;b<r.length;b++){k=r[b].To;
if(0==k.length)h=B.sb(B.Rj("%empty"));else if(1==k.length)h=k[0];else{m=[];for(h=0;h<k.length;h++)R.aA(k[h])||m.push(h);if(m.length<k.length)for(h=0;h<m.length;h++)R.Jl(k[m[h]]);h=R.wC(k)}n.push({D:r[b].D,g:r[b].g,Lc:h,jc:r[b].jc,rd:r[b].rd})}g.push.apply(g,n);for(n=0;n<g.length;n++)g[n].D.$c=g[n].jc,q(g[n].D,g[n].Lc);for(n=0;n<g.length;n++)if(b=g[n].D,"STATIC"==g[n].g.type&&"COLOR_ID"!=b.type)r=B.Rj("%meta%"),h=U.rh(r,"MESH"),h.c=U.rh(r,"MESH"),h.c.g=g[n].g,U.lk(h,a),h.c.p.push(b),f.push(h);else for(k=
[],h=0;h<g[n].rd.length;h++)if(r=g[n].rd[h],-1==k.indexOf(r.name)){for(m=0;m<r.c.p.length;m++)if(r.c.p[m]==b)throw"Batch already exist in object";r.c.p.push(b);k.push(r.name)}if(Y.wireframe_debug){for(n=0;n<g.length;n++)if(a=g[n].g,"DYNAMIC"==a.type&&(r=g[n].rd[0],-1<ja.indexOf(g[n].D.type))){b=!1;for(h=0;h<r.c.p.length;h++)r.c.p[h].dg&&(b=!0);b||(a=M(a.Te,a,r.name,!0,!0),r.c.p.push(a))}for(n=0;n<f.length;n++)r=f[n],a=r.c.g,-1<ja.indexOf(r.c.p[0].type)&&(a=M(a.Tc,a,r.name,!1),r.c.p.push(a))}for(n=
0;n<c.length;n++)for(h=0;h<c[n].c.p.length;h++)d(c[n].c.p[h]);for(n=0;n<f.length;n++)for(h=0;h<f[n].c.p.length;h++)d(f[n].c.p[h])};a.az=function(a,b){var e=a.l.up,f=c("MAIN");K(f,"special_skydome.glslv","special_skydome.glslf");if(b.procedural_skydome)g(f,"PROCEDURAL_SKYDOME",1),f.Rs=!0;else{var h=e.Io;if(h){g(f,"WO_SKYTEX",1);var k=y(e.wt,null);Q(f,k,"u_sky");h.invert&&g(f,"MTEX_NEGATIVE",1);h.rD&&g(f,"MTEX_RGBTOINT",1);g(f,"BLENDTYPE",h.Fw);h.nD&&g(f,"WOMAP_BLEND",1);h.oD&&g(f,"WOMAP_HORIZ",1);
h.qD&&g(f,"WOMAP_ZENUP",1);h.pD&&g(f,"WOMAP_ZENDOWN",1)}e.sD&&g(f,"WO_SKYBLEND",1);e.tD&&g(f,"WO_SKYPAPER",1);e.uD&&g(f,"WO_SKYREAL",1)}b.dc&&(f.dc=!0,b.Ub&&(f.Ub=!0));f.Gg=99999;u(f,"a_position");e=S.Wy();q(f,e);d(f);e=B.Rj("%meta_sky%");h=U.rh(e,"MESH");h.c=U.rh(e,"MESH");U.lk(h,a);h.c.g=U.sh("DYNAMIC");h.c.g.uh=!0;h.c.g.Hb=v.ed();h.c.g.Tc=v.Yj();h.c.g.hb=v.ed();h.c.g.Ib=v.Yj();h.c.p.push(f);return h};a.Lq=function(a,c){for(var d=[],e=da.Ya(c,"SHADOW_CAST"),f=da.Ya(c,"MAIN_PLANE_REFLECT"),g=da.Ya(c,
"MAIN_CUBE_REFLECT"),h=da.Ya(c,"OUTLINE_MASK"),k=da.Ya(c,"COLOR_PICKING"),l=0;l<a.c.p.length;l++){var m=a.c.p[l],n=null;"DEPTH"==m.type&&e&&m.Jc&&(n=b(m),n.Ma="SHADOW_CAST");"MAIN"!=m.type&&"PARTICLES"!=m.type||!f&&!g||m.Ha||!m.dc||(n=b(m),n.Ma="REFLECT");"COLOR_ID"==m.type&&(h&&k?(n=b(m),n.Ma="OUTLINE"):h&&!k&&(m.Ma="OUTLINE"));n&&(n.ig=!0,E(n,a.c.g.id),d.push(n))}a.c.p.push.apply(a.c.p,d)};a.JB=h;a.GD=function(a,b,c){if(b)b=c*(b.max_y-b.min_y);else throw"No bounding box for mesh";return 0==b?0:
.5*(Math.sqrt(2*Math.sqrt(4*b*Math.tan(a/180*Math.PI)+1)+2)/2-1)/b};a.Aw=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.hz=y;a.PC=A;a.Wp=function(a,b,c){c&&c.k.type==H.Pb&&g(a,"PERSPECTIVE_SHADOW_CAST",1);g(a,"CSM_SECTION0",0);g(a,"CSM_SECTION1",0);g(a,"CSM_SECTION2",0);g(a,"CSM_SECTION3",0);for(c=0;c<b.csm_num;c++)g(a,"CSM_SECTION"+String(c),1);g(a,"SHADOW_TEX_RES",ea.v(b.csm_resolution));g(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?
1:0);g(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)};a.ta=g;a.Cb=function(a,b){return ea.oz(a.Eb,b)};a.NC=q;a.OC=E;a.BE=M;a.kh=Q;a.mB=function(a,b,c){c=a.Nb.indexOf(c);-1<c&&(a.S[c]=b)};a.Ox=function(a,b){var d=c("MAIN");d.Ha=!0;ia.set(b[0],b[1],b[2],.5,d.Wc);d.le=R.bk;q(d,a);K(d,"main.glslv","main.glslf");g(d,"SHADELESS",1);I(d);return d};a.ob=I;a.Vw=function(a){return a.ec.Bj.length?a.ec.ro.u_cube_fog?!0:!1:!1};a.Ax=function(){var a=c("DEPTH_PACK");a.Oa=!0;a.ba=!1;var b=S.tb();q(a,
b);K(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");I(a);return a};a.Mq=function(a){var b=c("POSTPROCESSING");K(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":g(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":g(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":g(b,"POST_EFFECT","POST_EFFECT_X_BLUR");break;case "Y_BLUR":g(b,"POST_EFFECT","POST_EFFECT_Y_BLUR");break;case "X_GLOW_BLUR":g(b,"POST_EFFECT",
"POST_EFFECT_X_GLOW_BLUR");break;case "Y_GLOW_BLUR":g(b,"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR");break;case "X_EXTEND":g(b,"POST_EFFECT","POST_EFFECT_X_EXTEND");break;case "Y_EXTEND":g(b,"POST_EFFECT","POST_EFFECT_Y_EXTEND");break;default:throw"Wrong postprocessing effect: "+a;}b.Oa=!0;b.ba=!1;a=S.tb();q(b,a);I(b);return b};a.Rx=function(a){var b=c("SSAO");b.ba=!1;b.Oa=!0;var d=S.tb();q(b,d);K(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");g(b,"SSAO_QUALITY","SSAO_QUALITY_"+
a.Gt);g(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:fa.bz(a)};d={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};a=y(a,d);Q(b,a,"u_ssao_special_tex");I(b);return b};a.Sx=function(a){var b=c("SSAO_BLUR");b.ba=!1;b.Oa=!0;var d=S.tb();q(b,d);K(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");
g(b,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);I(b);return b};a.Bx=function(){var a=c("DOF");a.ba=!1;a.Oa=!0;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");g(a,"DEPTH_RGBA",1);I(a);return a};a.Jx=function(){var a=c("OUTLINE");a.ba=!1;a.Oa=!0;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");I(a);return a};a.Dx=function(){var a=c("GLOW_COMBINE");a.ba=!1;a.Oa=!0;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv",
"postprocessing/glow.glslf");I(a);return a};a.Ex=function(a,b,d){var e=c("GOD_RAYS");e.ba=!1;e.Oa=!0;var f=S.Ry();q(e,f);K(e,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");g(e,"DEPTH_RGBA",a?1:0);g(e,"WATER_EFFECTS",b?1:0);g(e,"STEPS_PER_PASS",ea.v(d,1));I(e);return e};a.Fx=function(){var a=c("GOD_RAYS_COM");a.ba=!1;a.Oa=!0;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");I(a);return a};a.Kx=function(){var a=c("SKY");a.ba=!1;
a.Oa=!0;var b=S.Sy();q(a,b);K(a,"procedural_skydome.glslv","procedural_skydome.glslf");g(a,"WATER_EFFECTS",1);I(a);return a};a.ux=function(){var a=c("ANTIALIASING");a.ba=!1;a.Oa=!0;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");g(a,"AA_METHOD","AA_METHOD_FXAA_QUALITY");I(a);return a};a.Px=function(a){var b=c("SMAA"),d=S.tb();q(b,d);K(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");g(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");g(b,"SMAA_PASS",
a);g(b,"SMAA_PREDICATION",0);g(b,"SMAA_REPROJECTION",0);I(b);b.ba=!1;b.Oa=!0;return b};a.yx=function(){var a=c("COMPOSITING");a.ba=!1;a.Oa=!0;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");I(a);return a};a.Ix=function(){var a=c("MOTION_BLUR");a.Oa=!0;a.ba=!1;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");I(a);return a};a.sx=function(){var a=c("ANAGLYPH");a.Oa=!0;a.ba=!1;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv",
"postprocessing/anaglyph.glslf");I(a);return a};a.Gx=function(){var a=c("LUMINANCE");a.ba=!1;a.Oa=!0;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");I(a);return a};a.vx=function(){var a=c("LUMINANCE");a.ba=!1;a.Oa=!0;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");I(a);return a};a.Hx=function(){var a=c("LUMINANCE_X_BLUR");a.ba=!1;a.Oa=!0;var b=S.tb();q(a,b);K(a,"postprocessing/luminance_trunced.glslv",
"postprocessing/luminance_trunced.glslf");I(a);return a};a.wx=function(){var a=c("POSTPROCESSING");a.Oa=!0;a.ba=!1;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");I(a);return a};a.xx=function(){var a=c("BLOOM");a.ba=!1;a.Oa=!0;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");I(a);return a};a.Vx=function(){var a=c("VELOCITY");a.ba=!1;a.Oa=!0;var b=S.tb();q(a,b);K(a,"postprocessing/postprocessing.glslv",
"postprocessing/velocity.glslf");I(a);return a};a.tx=function(){var a=c("ANCHOR_VISIBILITY");a.ba=!0;a.Oa=!0;a.le=R.yp;K(a,"anchors.glslv","anchors.glslf");var b=S.nr(1);q(a,b);g(a,"ANCHOR_NUM",1);I(a);a.Xh=new Float32Array([0,0,0]);return a};a.MC=function(a,b){var c=b.length/3;if(c!=a.Xh.length/3){var d=S.nr(c);q(a,d);g(a,"ANCHOR_NUM",c);I(a)}a.Xh=b};a.qa=function(a,b,c){for(var d=0;d<a.c.p.length;d++)if(a.c.p[d].type==c&&!a.c.p[d].ig&&-1!=a.c.p[d].$c.indexOf(b))return a.c.p[d];return null};a.zc=
function(a,b,c){for(var d=0;d<a.c.p.length;d++)if(a.c.p[d].type==c&&a.c.p[d].ig&&-1!=a.c.p[d].$c.indexOf(b))return a.c.p[d];return null};a.jt=function(a,b){a.Wc.set(b.Wc);a.Ze=b.Ze;a.Kd.set(b.Kd);a.qc.set(b.qc);a.me=b.me;a.Yd=b.Yd;a.Ye=b.Ye;a.Ne=b.Ne;a.reflect_factor=b.reflect_factor;a.nd.set(b.nd);a.parallax_scale=b.parallax_scale;a.shallow_water_col.set(b.shallow_water_col);a.shallow_water_col_fac=b.shallow_water_col_fac;a.shore_water_col.set(b.shore_water_col);a.shore_water_col_fac=b.shore_water_col_fac;
a.foam_factor=b.foam_factor;a.zi=b.zi};a.tE=function(a,b){for(var c=a.c.p,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.jx=function(a){for(var b=a.S,c=0;c<b.length;c++)fa.iy(b[c].fb);R.zq(a.P)}};b4w.module.__nodemat=function(a,p){function c(a,k,l,v,q){var y;a:switch(q){case "GLOW":y=k+"11";break a;case "COLOR_ID":case "DEPTH":y=k+"00";break a;default:y=k+"10"}if(y in F)return F[y];if("DEPTH"!=q&&"COLOR_ID"!=q){var t=B.create(),u=a.nodes,w=a.links;k=a.animation_data;for(var p=0;p<u.length;p++)if(!g(t,u[p],0,k,v,q))return F[y]=null;if(l&&-1==x(a,t,"GROUP_OUTPUT","group"))return null;p=ca(t);if(!S(t,w,p))return null;if(l)return t;for(p=0;p<w.length;p++){l=w[p];for(var u=n(l.from_node,t),N=n(l.to_node,
t),H=0;H<u.length;H++)for(var C=0;C<N.length;C++){var z=u[H],D=N[C],E=B.Za(t,z),I=B.Za(t,D);if(!ba(t,z,D,E,I,l))return F[y]=null}}h(t);a="GLOW"==q?x(a,t,"B4W_GLOW_OUTPUT","material",!0):x(a,t,"OUTPUT","material",!1,!0);-1==a&&(t=b(),a=0);f(t);a=B.So(t,a,B.Ul);e(a);r(a);A(a);m(a,k,v,q)}else v=c(a,k,l,v,"MAIN"),v=B.clone(v,function(a){var b=ia.Ni(a);b.J=ia.pa(a.J);b.Ba=ia.pa(a.Ba);return b}),a=x(a,v,"OUTPUT","material",!1,!0),d(v,a),a=B.So(v,a,B.Ul),e(a);return F[y]=a}function d(a,b){B.Pd(a,function(c,
d,e){var f=B.Za(a,d);d==b&&"Color"==f.J[e[1]].identifier&&B.bt(a,c,d,e)})}function b(){var a=B.create(),b={data:null,ie:[],T:[],J:[{za:new Float32Array([0,0,0]),identifier:"Color",ub:!1,name:"Color"},{za:1,identifier:"Alpha",ub:!1,name:"Alpha"}],Ba:[],type:"OUTPUT",yi:[]};B.kk(a,0,b);return a}function e(a){B.X(a,function(b,c){for(var d=c.J,e=c.Ba,f=0;f<d.length;f++)l(a,d[f],b,f,1);for(f=0;f<e.length;f++)l(a,e[f],b,f,0)})}function l(a,b,c,d,e){if(b.ub){var f=!0;B.Pd(a,function(a,b,g){if(!e&&a==c&&
g[0]==d||e&&b==c&&g[1]==d)f=!1});f&&(b.ub=!1)}}function m(a,b,c,d){var e=[];B.Pd(a,function(f,h,k){var l=B.Za(a,f),m=B.Za(a,h),l=ia.is_vector(l.Ba[k[0]].za),m=ia.is_vector(m.J[k[1]].za);if(l!=m){var n,r={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},v={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};l&&!m?n=u("vector_to_scalar","B4W_VECTOSCAL",[r],[v]):!l&&m&&(n=u("scalar_to_vector","B4W_SCALTOVEC",[v],[r]));g(a,n,0,b,c,d);e.push([f,h,a.U[a.U.length-2],k])}});
for(var f=0;f<e.length;++f)B.bt(a,e[f][0],e[f][1],e[f][3]),B.gd(a,e[f][0],e[f][2],[e[f][3][0],0]),B.gd(a,e[f][2],e[f][1],[0,e[f][3][1]])}function h(a){var b=[];B.X(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":B.Pd(a,function(a,e,f){a==c&&"Translucency"==d.Ba[f[0]].name&&b.push(a,e,[f[0]+1,f[1]+1])})}});for(var c=0;c<b.length;c+=3)B.gd(a,b[c],b[c+1],b[c+2])}function n(a,b){var c=[];B.X(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;throw"Node not found";}function f(a){var b=
[];B.X(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];if("B4W_PARALLAX"==e.type){var f=k(a,d);if(-1!=f){var g=B.Ok(a,f,0);B.Qg(a,f,d,-1);-1!=g&&B.Qg(a,g,f,-1);d=B.Za(a,f);e.data=d.data;e.T[0]=d.T[0];B.$h(a,f)}e.J.splice(1,1)}else if("REROUTE"==e.type){for(var e=B.Ok(a,d,0),h=B.Jg(a,d),f=[],g=[],l=[],m=0;m<h;m++){var n=B.ng(a,d,m),r=g.indexOf(n);-1!=r?l[r]+=1:(g.push(n),l.push(1),f.push(d,n))}if(-1!=e)for(h=B.mg(a,e,d,0)[0],
m=0;m<g.length;m++)for(n=0;n<l[m];n++)r=B.mg(a,d,g[m],n)[1],B.gd(a,e,g[m],[h,r]);for(m=0;m<f.length;m+=2)B.Qg(a,f[m],f[m+1],-1)}}}function k(a,b){for(var c=a.Y,d=0;d<c.length;d+=3)if(c[d+1]==b&&1==c[d+2][1])return c[d];return-1}function r(a){w(a);D(a);y(a)}function y(a){var b=[],c="",d="",e={};B.X(a,function(a,f){if("GEOMETRY_UV"==f.type||"UVMAP"==f.type||"TEX_COORD_UV"==f.type){b.push(a,f);var g=f.data.value;c?c==g||d||(d=g,e[d]=0):(c=g,e[c]=0);e[g]++}});for(var f in e)if(2>e[f]){for(var h=0;h<b.length;h+=
2)b[h+1].data.value==f&&b.splice(h,2);delete e[f];c==f&&(c=d,d="");d==f&&(d="")}if(!(3>b.length)){var h={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},k={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};f=u("merged_uv","UV_MERGED",[],[h,k]);f.uv_layer=c;g(a,f,0,null,"",void 0);var l=a.U[a.U.length-2];f=a.U[a.U.length-1];if(d){k=u("merged_uv","UV_MERGED",[],[h,k]);k.uv_layer=d;g(a,k,0,null,"",void 0);var m=a.U[a.U.length-2],k=a.U[a.U.length-1]}else k=
null;for(var n=-1,r=null,h=0;h<b.length;h+=2){var v=b[h],q=b[h+1];t(q,b[1])?(n=l,r=f):k&&(n=m,r=k);for(var y=[],w=B.Jg(a,v),x={},p=0;p<w;p++){var N=B.ng(a,v,p);N in x||(x[N]=0);var F=B.mg(a,v,N,x[N]++);y.push(v,N,F);F=F.splice(0,F.length);switch(q.type){case "GEOMETRY_UV":F[0]=0;r.Ba[0].ub=!0;break;case "UVMAP":case "TEX_COORD_UV":F[0]=1,r.Ba[1].ub=!0}B.gd(a,n,N,F)}for(var p=0;p<y.length;p+=3)B.Qg(a,y[p],y[p+1],0);B.$h(a,v)}}}function w(a){var b=[];B.X(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=
c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type||b.push(a,c)});for(var c=[],d=0;d<b.length;d+=2){for(var e=b[d],f=b[d+1],g=!0,h=0;h<c.length;h++){var k=c[h];if(G(f,k.vc)){g=[];h=B.Jg(a,e);for(n=0;n<h;n++){var l=B.ng(a,e,n),m=B.mg(a,e,l,0);g.push(e,l,m);B.gd(a,k.id,l,m)}for(var n=0;n<g.length;n+=3)B.Qg(a,g[n],g[n+1],0);B.$h(a,e);g=!1;break}}g&&(k={id:e,vc:f},c.push(k))}}function C(a){for(var b={},c=0;c<a.U.length;c+=2)b[a.U[c]]=
[];for(c=0;c<a.Y.length;c+=3){for(var d=a.Y[c],e=a.Y[c+1],f=b[e],g=d,h=0;h<=f.length;h++){if(h>=f.length||f[h]>g)f.splice(h,0,g);else if(f[h]!=g)continue;break}for(var e=b[e],d=b[d],g=f=0,h=e.length+d.length,k=[],l=0;l<h;l++)f>e.length||e[f]>d[g]?k.push(d[g++]):k.push(e[f++])}return b}function D(a){var b=[];B.X(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=C(a),d=[],e=0;e<b.length;e+=2){for(var f=b[e],g=b[e+1],h=!0,k=0;k<d.length;k++){var l=
d[k];if(!(3<=l.Rh.length||!G(g,l.vc)||-1<c[f].indexOf(l.id)||-1<c[l.id].indexOf(f))){for(var m=!1,n=0;n<l.Rh.length;n++){var r=l.Rh[n].id;if(-1<c[f].indexOf(r)||-1<c[r].indexOf(f)){m=!0;break}}if(!m){for(var k=[],r=B.Qr(a,f),v={},n=0;n<r;n++)m=B.Ok(a,f,n),m in v||(v[m]=0),h=B.mg(a,m,f,v[m]++),k.push(m,f,h);for(var r=[],v=B.Jg(a,f),q={},n=0;n<v;n++)m=B.ng(a,f,n),m in q||(q[m]=0),h=B.mg(a,f,m,q[m]++),r.push(f,m,h);h=k.concat(r);for(n=0;n<h.length;n+=3)B.Qg(a,h[n],h[n+1],0);B.$h(a,f);n={id:f,vc:g,qy:k,
ry:r};l.Rh.push(n);h=!1;break}}}h&&(l={id:f,vc:g,Rh:[]},d.push(l))}for(e=0;e<d.length;e++){l=d[e];c=l.Rh.length;for(k=0;k<c;k++){g=l.Rh[k];n=g.vc;f=g.qy;g=g.ry;l.vc.J[k+1].ub=n.J[0].ub;l.vc.J[k+1].za=n.J[0].za;l.vc.Ba[2*(k+1)].ub=n.Ba[0].ub;l.vc.Ba[2*(k+1)].za=n.Ba[0].za;l.vc.Ba[2*(k+1)+1].ub=n.Ba[1].ub;l.vc.Ba[2*(k+1)+1].za=n.Ba[1].za;for(n=0;n<f.length;n+=3)m=f[n],h=f[n+2],h[1]+=k+1,B.gd(a,m,l.id,h);for(n=0;n<g.length;n+=3)m=g[n+1],h=g[n+2],h[0]+=2*(k+1),B.gd(a,l.id,m,h);l.vc.ie.push(["USE_uv"+
(k+2),1])}B.$h(a,l.id);B.kk(a,l.id,l.vc)}}}function G(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":return!0;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value==b.data.value;default:return!1}}function t(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:
!1}function A(a){var b=[];B.X(a,function(a,c){"GEOMETRY_VC"==c.type&&b.push(a,c)});for(var c=0;c<b.length;c+=2){for(var d=b[c],e=b[c+1],f=!1,g=[],h=[],k=[[],[],[]],l=B.Jg(a,d),m=0;m<l;m++){var n=B.ng(a,d,m);if("SEPRGB"!=B.Za(a,n).type){f=!1;break}g.push(d,n);for(var r={},v=B.Jg(a,n),f=0;f<v;f++){var q=B.ng(a,n,f);q in r||(r[q]=0);var t=B.mg(a,n,q,r[q]++);g.push(n,q);k[t[0]].push(d,q,t)}h.push(n);f=!0}if(f){for(m=d=l=0;m<k.length;m++)k[m].length&&(l++,d|=1<<2-m);if(l){e.type+=l;e.Ba=[];for(m=0;m<k.length;m++)if(k[m].length)for(e.Ba.push({za:0,
identifier:"RGB"[m],ub:!0,name:"RGB"[m]}),f=0;f<k[m].length;f+=3)k[m][f+2][0]=ia.Jj(d,m);for(m=0;m<g.length;m+=2)B.Qg(a,g[m],g[m+1],0);for(m=0;m<h.length;m++)B.$h(a,h[m]);for(m=0;m<k.length;m++)for(f=0;f<k[m].length;f+=3)B.gd(a,k[m][f],k[m][f+1],k[m][f+2])}}}}function x(a,b,c,d,e,f){a=a.nodes;for(var g=null,h=0;h<a.length;h++){var k=a[h];e?"GROUP"==k.type&&k.node_tree_name==c&&(g=k):k.type==c&&(g=k)}return g?n(g,b)[0]:(f||ga.error('No "'+c+'" node in node '+d),-1)}function u(a,b,c,d){return{name:a,
type:b,inputs:c,outputs:d}}function g(a,b,c,d,e,f){var h=b.name,k=b.type,l=[],m=[],n=[],r=[],t=null,y=[];switch(k){case "BSDF_ANISOTROPIC":case "BSDF_DIFFUSE":case "BSDF_GLOSSY":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BUMP":case "NORMAL_MAP":case "VECT_TRANSFORM":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_IMAGE":case "TEX_ENVIRONMENT":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "LAYER_WEIGHT":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "PARTICLE_INFO":case "HAIR_INFO":case "OBJECT_INFO":case "SCRIPT":case "NEW_GEOMETRY":m=
aa(b);n=R(b);ga.warn(k+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":case "MIX_SHADER":m=aa(b);n=R(b);break;case "UVMAP":var t=E("param_"+k+"_a"),u=E("param_"+k+"_v");l.push(W(t));l.push(W(u));n=R(b);r.push(W(u));t={name:t,value:b.uv_layer};break;case "UV_MERGED":t=E("param_UV_MERGED_a");u=E("param_UV_MERGED_v");l.push(W(t));l.push(W(u));n.push(H(b,"UV_geom"));n.push(H(b,"UV_cycles"));r.push(W(u));t={name:t,value:b.uv_layer};break;case "CAMERA":m=[];n=R(b);break;case "COMBRGB":case "COMBHSV":m=
aa(b);n=R(b);break;case "CURVE_RGB":m=aa(b);n=R(b);ga.warn("CURVE_RGB node is not fully supported.");break;case "CURVE_VEC":m=aa(b);n=R(b);ga.warn("CURVE_VEC node is not fully supported.");break;case "GEOMETRY":if(!M(b))return!0;k=K(b,c);if(!k)return ga.error("Geometry output is not supported"),!1;switch(k){case "GEOMETRY_UV":if(!b.uv_layer)return ga.error('Missing uv layer in node "',b.name,'"'),!1;t=E("param_GEOMETRY_UV_a");u=E("param_GEOMETRY_UV_v");l.push(W(t));l.push(W(u));n.push(H(b,"UV"));
r.push(W(u));t={name:t,value:b.uv_layer};break;case "GEOMETRY_VC":if(!b.color_layer)return ga.error("Missing vertex color layer in node ",b.name),!1;t=E("param_GEOMETRY_VC_a");u=E("param_GEOMETRY_VC_v");l.push(W(t));l.push(W(u));n.push(H(b,"Vertex Color"));r.push(W(u));t={name:t,value:b.color_layer};break;case "GEOMETRY_NO":n.push(H(b,"Normal"));break;case "GEOMETRY_FB":n.push(H(b,"Front/Back"));break;case "GEOMETRY_VW":n.push(H(b,"View"));break;case "GEOMETRY_GL":n.push(H(b,"Global"));break;case "GEOMETRY_LO":n.push(H(b,
"Local"));break;case "GEOMETRY_OR":u=E("param_GEOMETRY_OR_v"),l.push(W(u)),n.push(H(b,"Orco")),r.push(W(u))}break;case "TEX_COORD":if(!M(b))return!0;k=Q(b,c);if(!k)return ga.error("Texture coordinate output is not supported"),!1;switch(k){case "TEX_COORD_UV":t=E("param_TEX_COORD_UV_a");u=E("param_TEX_COORD_UV_v");l.push(W(t));l.push(W(u));n.push(H(b,"UV"));r.push(W(u));t={name:t,value:b.uv_layer};break;case "TEX_COORD_NO":n.push(H(b,"Normal"));break;case "TEX_COORD_GE":u=E("param_TEX_COORD_GE_v");
l.push(W(u));n.push(H(b,"Generated"));r.push(W(u));break;case "TEX_COORD_OB":n.push(H(b,"Object"));ga.warn('Output "Object" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_CA":n.push(H(b,"Camera"));break;case "TEX_COORD_WI":n.push(H(b,"Window"));ga.warn('Output "Window" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_RE":n.push(H(b,"Reflection")),ga.warn('Output "Reflection" of node "Texture Coordinate" doesn\'t supported fully.')}break;
case "GROUP":u=b.node_tree_name;switch(u){case "B4W_LINEAR_TO_SRGB":if(!q(b,[1],[1])){t=L(b,e,f);break}k="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!q(b,[1],[1])){t=L(b,e,f);break}k="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!q(b,[1],[1])){t=L(b,e,f);break}k="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!q(b,[1,1],[1])){t=L(b,e,f);break}k="B4W_REFLECT";break;case "B4W_REFRACTION":if(!q(b,[1,0],[1])){t=L(b,e,f);break}k="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!q(b,
[1,1,0,0,0],[1])){t=L(b,e,f);break}var k="B4W_PARALLAX",w=E("temp_texture");r.push(W(w));break;case "B4W_CLAMP":if(!q(b,[1],[1])){t=L(b,e,f);break}k="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!q(b,[0,0,0,0,0],[0])){t=L(b,e,f);break}k="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!q(b,[],[0])){t=L(b,e,f);break}k="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!q(b,[0,0,0],[0])){t=L(b,e,f);break}k="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":k="B4W_GLOW_OUTPUT";break;default:t=L(b,e,f)}m=aa(b);n=R(b);"B4W_TRANSLUCENCY"==
u&&(u=Z("TranslucencyParams","TranslucencyParams",[0,0,0,0]),u.ub=n[0].ub,n.push(u));break;case "LAMP":t=b.lamp;if(!t)return ga.error("There is no lamp in node: "+b.name),!1;n.push(H(b,"Color"));n.push(H(b,"Light Vector"));n.push(H(b,"Distance"));n.push(H(b,"Visibility Factor"));t.uuid in ka?y.push(["LAMP_INDEX",String(ka[t.uuid])]):(ka[t.uuid]=ra,y.push(["LAMP_INDEX",String(ra++)]));t=ka;break;case "NORMAL":m=aa(b);n=R(b);u=H(b,"Normal");r.push(W(E("param_NORMAL_Normal"),u.za,3));break;case "MAPPING":u=
b.vector_type;k="MAPPING";m.push(v(b,"Vector"));n.push(H(b,"Vector"));var w=b.rotation,x=b.scale,p=b.translation,F=ja.create(),C=ia.vy(w);"TEXTURE"==u&&(x[0]=x[0]||1,x[1]=x[1]||1,x[2]=x[2]||1);var A=new Float32Array([x[0],0,0,0,x[1],0,0,0,x[2]]);ja.multiply(C,A,F);F=ia.uA(F,sa.create());switch(u){case "POINT":F[12]=p[0];F[13]=p[1];F[14]=p[2];break;case "TEXTURE":F[12]=p[0];F[13]=p[1];F[14]=p[2];F=sa.invert(F,F);break;case "NORMAL":sa.invert(F,F),sa.transpose(F,F)}switch(u){case "NORMAL":y.push(["MAPPING_IS_NORMAL",
1]);case "TEXTURE":y.push(["MAPPING_TRS_MATRIX",N.v(F,16)]);break;case "POINT":0!==Y.length(w)?y.push(["MAPPING_TRS_MATRIX",N.v(F,16)]):(0!==Y.length(x)&&y.push(["MAPPING_SCALE",N.v(x,3)]),0!==Y.length(p)&&y.push(["MAPPING_TRANSLATION",N.v(p,3)]));break;case "VECTOR":0!==Y.length(w)?y.push(["MAPPING_TRS_MATRIX",N.v(F,16)]):0!==Y.length(x)&&y.push(["MAPPING_SCALE",N.v(x,3)])}b.use_min&&y.push(["MAPPING_MIN_CLIP",N.v(b.min,3)]);b.use_max&&y.push(["MAPPING_MAX_CLIP",N.v(b.max,3)]);break;case "MATERIAL":case "MATERIAL_EXT":t=
v(b,"Color");t.za.splice(3);m.push(t);t=v(b,"Spec");t.za.splice(3);m.push(t);m.push(Z("DiffuseIntensity","DiffuseIntensity",b.diffuse_intensity));u=v(b,"Normal");u.za.splice(3);m.push(u);n.push(H(b,"Color"));n.push(H(b,"Alpha"));n.push(H(b,"Normal"));"MATERIAL_EXT"==k?((t=v(b,"Emit"))?m.push(t):m.push(Z("Emit","Emit",0)),t=v(b,"Translucency"),t.za=0,t.name="Translucency",t.identifier="Translucency",t?m.push(t):m.push(Z(t.name,t.identifier,t.za)),t=v(b,"Translucency"),t.za=[0,0,0,0],t.name="TranslucencyParams",
t.identifier="TranslucencyParams",t?m.push(t):m.push(Z(t.name,t.identifier,t.za)),t=v(b,"Reflectivity"),w=v(b,"Ray Mirror"),t?w="Reflectivity":w?(t=w,w="Ray Mirror"):w="Reflectivity",t?m.push(t):m.push(Z(w,w,0)),(t=v(b,"SpecTra"))?m.push(t):m.push(Z("SpecTra","SpecTra",0)),(t=v(b,"Alpha"))?m.push(t):m.push(Z("Alpha","Alpha",b.alpha)),n.push(H(b,"Diffuse")),n.push(H(b,"Spec"))):(r.push(W(E("param_MATERIAL_alpha"),b.alpha)),r.push(W(E("param_MATERIAL_spec_alpha"),b.specular_alpha)));w=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":t=
b.specular_hardness;break;case "WARDISO":t=b.specular_slope;break;case "TOON":t=b.specular_toon_size;w=b.specular_toon_smooth;break;case "BLINN":t=b.specular_ior;w=b.specular_hardness;break;default:ga.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+'")'),t=b.specular_hardness}switch(b.diffuse_shader){case "LAMBERT":p=x=0;break;case "OREN_NAYAR":x=b.roughness;p=0;break;case "FRESNEL":x=b.diffuse_fresnel;p=b.diffuse_fresnel_factor;break;case "MINNAERT":x=b.darkness;
p=0;break;case "TOON":x=b.diffuse_toon_size;p=b.diffuse_toon_smooth;break;default:ga.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),p=x=0}r.push(W(E("param_MATERIAL_diffuse"),[x,p],2));r.push(W(E("param_MATERIAL_spec"),[b.specular_intensity,t,w],3));t={name:b.name,value:{jC:b.specular_shader,ly:b.diffuse_shader,vd:b.use_shadeless}};u.ub&&y.push(["USE_MATERIAL_NORMAL",1]);b.use_diffuse&&y.push(["USE_MATERIAL_DIFFUSE",1]);b.use_specular&&y.push(["USE_MATERIAL_SPECULAR",
1]);break;case "MATH":switch(b.operation){case "ADD":k="MATH_ADD";break;case "SUBTRACT":k="MATH_SUBTRACT";break;case "MULTIPLY":k="MATH_MULTIPLY";break;case "DIVIDE":k="MATH_DIVIDE";break;case "SINE":k="MATH_SINE";break;case "COSINE":k="MATH_COSINE";break;case "TANGENT":k="MATH_TANGENT";break;case "ARCSINE":k="MATH_ARCSINE";break;case "ARCCOSINE":k="MATH_ARCCOSINE";break;case "ARCTANGENT":k="MATH_ARCTANGENT";break;case "POWER":k="MATH_POWER";break;case "LOGARITHM":k="MATH_LOGARITHM";break;case "MINIMUM":k=
"MATH_MINIMUM";break;case "MAXIMUM":k="MATH_MAXIMUM";break;case "ROUND":k="MATH_ROUND";break;case "LESS_THAN":k="MATH_LESS_THAN";break;case "GREATER_THAN":k="MATH_GREATER_THAN";break;case "MODULO":k="MATH_MODULO";break;case "ABSOLUTE":k="MATH_ABSOLUTE";break;default:return ga.error("Unsupported MATH operation: "+b.operation),!1}y.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);m=aa(b);n=R(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":k="MIX_RGB_MIX";break;case "ADD":k="MIX_RGB_ADD";break;case "MULTIPLY":k=
"MIX_RGB_MULTIPLY";break;case "SUBTRACT":k="MIX_RGB_SUBTRACT";break;case "SCREEN":k="MIX_RGB_SCREEN";break;case "DIVIDE":k="MIX_RGB_DIVIDE";break;case "DIFFERENCE":k="MIX_RGB_DIFFERENCE";break;case "DARKEN":k="MIX_RGB_DARKEN";break;case "LIGHTEN":k="MIX_RGB_LIGHTEN";break;case "OVERLAY":k="MIX_RGB_OVERLAY";break;case "DODGE":k="MIX_RGB_DODGE";break;case "BURN":k="MIX_RGB_BURN";break;case "HUE":k="MIX_RGB_HUE";break;case "SATURATION":k="MIX_RGB_SATURATION";break;case "VALUE":k="MIX_RGB_VALUE";break;
case "COLOR":k="MIX_RGB_COLOR";break;case "SOFT_LIGHT":k="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":k="MIX_RGB_LINEAR_LIGHT";break;default:return ga.error("Unsupported MIX_RGB blend type: "+b.blend_type),!1}y.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);m=aa(b);n=R(b);break;case "OUTPUT":m=aa(b);n=[];break;case "RGB":u=e+"%join%"+b.name;u={name:"-1",value:u};r.push(u);n.push(H(b,"Color"));break;case "SEPRGB":case "SEPHSV":m=aa(b);n=R(b);break;case "TEXTURE":k=I(b);if("TEXTURE_EMPTY"==k)n.push(H(b,
"Color")),n.push(H(b,"Normal")),n.push(H(b,"Value"));else if("TEXTURE_ENVIRONMENT"==k)m.push(v(b,"Vector")),n.push(H(b,"Color")),n.push(H(b,"Value"));else{if("TEXTURE_NORMAL"==k&&"ENVIRONMENT_MAP"==b.texture.type)return ga.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),!1;for(x=0;4>x;++x)x?(t=Z("Vector"+x,"Vector"+x,[0,0,0]),"TEXTURE_COLOR"==k&&(u=Z("Color"+x,"Color"+x,[0,0,0]),w=Z("Value"+x,"Value"+x,0)),"TEXTURE_NORMAL"==k&&(u=Z("Normal"+x,"Normal"+x,[0,0,0]),w=Z("Value"+x,"Value"+x,
0))):(t=v(b,"Vector"),"TEXTURE_COLOR"==k&&(u=H(b,"Color"),w=H(b,"Value")),"TEXTURE_NORMAL"==k&&(u=H(b,"Normal"),w=H(b,"Value"))),m.push(t),n.push(u),n.push(w)}w=E("param_TEXTURE_texture");r.push(W(w));t={name:w,value:b.texture};break;case "VALTORGB":m=aa(b);n=R(b);ga.warn("VALTORGB node is not fully supported.");break;case "VALUE":k="VALUE";u=e+"%join%"+b.name;u={name:"-1",value:u};r.push(u);n.push(H(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":k="VECT_MATH_ADD";break;case "SUBTRACT":k=
"VECT_MATH_SUBTRACT";break;case "AVERAGE":k="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":k="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":k="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":k="VECT_MATH_NORMALIZE";break;default:return ga.error("Unsupported VECT_MATH operation: "+b.operation),!1}m=aa(b);n=R(b);break;default:m=aa(b),n=R(b)}h={name:h,type:k,yi:l,J:m,Ba:n,T:r,data:t,ie:y};B.kk(a,B.lr(a),h);if(!(h="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type)){a:{h=b.outputs;for(l=k=0;l<h.length;l++)if(h[l].is_linked&&
k++>c){h=!0;break a}h=!1}h=!h}return h||g(a,b,++c,d,e,f)?!0:!1}function q(a,b,c){for(var d=a.inputs,e=a.outputs,f=a.node_tree_name,g=0;g<b.length;g++){var h=d[g],k=b[g];if(!h||h.default_value instanceof Array!=k)return ga.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(g=0;g<c.length;g++)if(b=e[g],d=c[g],!b||b.default_value instanceof Array!=d)return ga.warn('Wrong outputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),
!1;return!0}function L(a,b,d){var e=a.node_group.node_tree,f={},g;for(g in e)if("links"==g||"nodes"==g){f[g]=[];for(var h=0;h<e[g].length;h++){f[g][h]={};for(var k in e[g][h])if("links"==g){f[g][h][k]={};for(var l in e[g][h][k])f[g][h][k][l]=J(e[g][h][k][l])}else f[g][h][k]=J(e[g][h][k])}}else f[g]=J(e[g]);e=a.node_tree_name;if("B4W_REPLACE"==e||"B4W_LEVELS_OF_QUALITY"==e)g=u("Group input","GROUP_INPUT",[],a.inputs),h=u("Group output","GROUP_OUTPUT",a.outputs,[]),k=null,k="B4W_REPLACE"==e||"B4W_LEVELS_OF_QUALITY"==
e&&(O.quality==ta.P_LOW||O.jn)?{from_node:g,from_socket:g.outputs[1],to_node:h,to_socket:h.inputs[0]}:{from_node:g,from_socket:g.outputs[0],to_node:h,to_socket:h.inputs[0]},f.nodes=[g,h],f.links=[k];e=a.name;g=f.nodes;h=f.links;for(k=0;k<g.length;k++)g[k].name=U(g[k].type,e,g[k].name);for(k=0;k<h.length;k++)h[k].from_node.name=U(h[k].from_node.type,e,h[k].from_node.name),h[k].to_node.name=U(h[k].to_node.type,e,h[k].to_node.name);return{FA:c(f,a.node_group.uuid,!0,b,d),GA:f.links}}function J(a){var b=
typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?ia.Ni(a):a}function E(a){z[a]||(z[a]=0);var b=a+z[a],b=b.replace(/ /g,"_").replace(/\//g,"_");z[a]++;return b}function M(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function K(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";case "Normal":return"GEOMETRY_NO";case "Front/Back":return"GEOMETRY_FB";
case "View":return"GEOMETRY_VW";case "Global":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";default:return null}}}function Q(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";
default:return null}}}function I(a){if(!a.texture)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,e=!1,f=0;f<b.length;f++){var g=b[f];if(g.is_linked)switch(g.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":e=!0;break;default:throw"Unknown texture output";}}if(c)return d&&ga.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==
a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function v(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return P(e)}return null}function H(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return P(e)}return null}function P(a){var b=a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=ia.is_vector(a)?a.slice(0):a;return{name:b,identifier:c,ub:d,za:a}}function Z(a,b,c){return{name:a,identifier:b,ub:!1,za:c}}function aa(a){for(var b=[],c=
0;c<a.inputs.length;c++){var d=P(a.inputs[c]);d.za.length&&d.za.splice(3);b.push(d)}return b}function R(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=P(a.outputs[c]);b.push(d)}return b}function W(a,b,c){b=null===b||void 0===b?null:N.v(b,c);return{name:a,value:b}}function ba(a,b,c,d,e,f){var g=[],h=f.from_socket.identifier;f=f.to_socket.identifier;var k=d.Ba;for(d=0;d<k.length;d++)if(k[d].identifier==h){g.push(d);break}e=e.J;for(d=0;d<e.length;d++)if(e[d].identifier==f){g.push(d);break}2==g.length&&
B.gd(a,b,c,g);return!0}function U(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function ca(a){var b=[];B.X(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function S(a,b,c){for(var d=0;d<c.length;d++){var e=c[d].data.FA,f=c[d].data.GA;if(!e)return!1;B.X(e,function(b,c){B.kk(a,B.lr(a),c)});for(e=0;e<f.length;e++)b.push(f[e]);fa(c[d],b,a)}return!0}function oa(a,b,c,d,e,f){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+
"*GI*")||e.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(c)}}function X(a,b,c){for(var d=[],e=0;e<c.length;e++){for(var f=c[e],g=null,h=0;h<b.length;h++)if(f.from_socket.identifier==b[h].to_socket.identifier){g=b[h];break}g?(f.from_node=g.from_node,f.from_socket=g.from_socket):d.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return d}function da(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function ea(a,b,c,
d){for(var e=0;e<d.length;e++){for(var f=d[e],g,h=0;h<c.J.length;h++)if(f.from_socket.identifier==c.J[h].identifier){g=c.J[h].za;break}for(var h=f,k=b,l=g,m=n(h.to_node,k),r=0;r<m.length;r++)for(var v=B.Za(k,m[r]),t=0;t<v.J.length;t++)if(v.J[t].identifier==h.to_socket.identifier){v.J[t].za=l;break}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function fa(a,b,c){for(var d=a.name,e=[],f=[],g=[],h=[],k=0;k<b.length;k++){var l=b[k];oa(l.from_node,d,l,e,g,h);oa(l.to_node,d,l,f,g,h)}f=X(b,f,g);e=X(b,h,e);da(b,f);
ea(b,c,a,f);if(e.length){var m;B.X(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(m=b)});ea(b,c,m,e)}}var ga=p("__print"),B=p("__graph"),N=p("__shaders"),ia=p("__util"),ta=p("__config"),Y=p("vec3");p("vec4");var ja=p("mat3"),sa=p("mat4"),z={},F={},ka={},ra=0;new Float32Array(4);var O=ta.r;a.lx=c;a.mx=function(a){var b=[],c={};z={};var d=B.dp(a);B.X(d,function(a,d){var e;e=[];for(var f=[],g=[],h=[],k=[],l=[],m=0;m<d.J.length;m++){var n=d.J[m];if(n.ub)e.push(null),f.push(null);else{e.push(E("in_"+
d.type+"_"+n.identifier));var r=N.v(n.za,0);O.nt&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==n.identifier||"Color2"==n.identifier||"Fac"==n.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==n.identifier||"Value_001"==n.identifier)||0<=d.type.indexOf("VECT_MATH_")&&"Vector_001"==n.identifier)&&(n=r,n=n.replace(/(,)/g,"$1 "),n=n.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1ZERO_VALUE_NODES$3"),n=n.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1UNITY_VALUE_NODES$3"),r=n=n.replace(/\s+/g,""));f.push(r)}}for(m=
0;m<d.Ba.length;m++)n=d.Ba[m],n.ub?g.push(null):g.push(E("out_"+d.type+"_"+n.identifier));for(m=0;m<d.T.length;m++)n=d.T[m],h.push(n.name),k.push(n.value);for(m=0;m<d.yi.length;m++)l.push(d.yi[m].name);e={id:d.type,J:e,Hn:f,Ba:g,T:h,pl:k,yi:l,ie:JSON.parse(JSON.stringify(d.ie))};b.push(e);c[a]=e});B.Pd(d,function(a,b,e){var f=B.Za(d,a);B.Za(d,b);var g=f.Ba[e[0]];a=c[a].Ba;b=c[b].J;f=a[e[0]]||E("out_"+f.type+"_"+g.identifier);a[e[0]]=f;b[e[1]]=f});return b};a.vq=function(a){if(a.node_tree)for(var b=
0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.cleanup=function(){for(var a in F)delete F[a];for(var b in ka)delete ka[b];ra=0}};b4w.module.__animation=function(a,p){function c(a,b){var c=a.c.G[b];c&&c.gn&&c.cj&&(c.cj=!1,c.gn(a,b))}function d(a,b,c){c=a.c.G[c];c.type=30;var d=b.H,e=b.R-d+1;c.start=d;c.length=e;c.xc=d;c.Uf=b.name;for(e=d=0;e<a.c.Ob.length;e++){var f=a.c.Ob[e];if(f==b)break;else d+=f.R-f.H+1}c.iu=d}function b(a,b,c){for(var d=0;d<a.c.p.length;d++){var e=a.c.p[d].la;if(e&&e.name==b){var f=a.c.G[c];f.type=50;f.Uf=e.name;f.start=e.H;f.length=e.R-f.start;e.cyclic||(f.length+=e.Tn)}}}function e(a){return a.replace(/_B4W_BAKED$/,
"")}function l(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:X.ha("Wrong animation behavior")}}function m(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c].node_tree;d&&h(d,b)}return b}function h(a,b){if(a.animation_data){var c=a.animation_data.action;c&&X.Ed(c.fcurves)&&b.push(c)}for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];e.node_group&&(e=e.node_group.node_tree)&&h(e,b)}}function n(a){return X.is_mesh(a)&&a.c.g.Ob?
!0:!1}function f(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function k(a,b,d,e){x(a,b,d,e);c(a,d);a.c.g.Pe&&(q(a,b),g(a,b))}function r(a){if(!X.is_mesh(a))return null;a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}function y(a,b,c){var d=b.frame_range;if(d[0]>d[1])return U.warn('Incompatible action "'+b.name+'" has been applied to object "'+a.name+'"'),!1;var e=b.l,f=a.c.G[c];f.Uf=b.name;f.am=d;f.Np=e.OA;f.Mp=e.Cw;
f.wk=e.wk;f.start=d[0];f.length=d[1]-d[0];f.xc=d[0];d=X.Ed(e.sk);if(X.is_armature(a)&&d){f.type=10;var g=w(a,b);g||(g=L(a,b,G(a)),a.Xd.push(b,g));f.i=g.i;f.Ga=g.Ga;var f=a.c.g,g=f.Gl,h=a.c.G[c],e=h.Go,k;a:{k=f.rt;for(var l=0;l<k.length;l+=2)if(b==k[l]){k=k[l+1];break a}k=null}if(k)h.Go=k;else{for(h=0;h<g.length;h++)k=L(a,b,g[h].Sc),e.push(k);f.rt.push(b,e)}f.Pe&&(b=f.Ll,c>b[1]?(f=b[1],b[1]=c,b[0]=f):c>b[0]&&c<b[1]&&(b[0]=c),C(a))}else if(ca.re(a)&&(e.T.volume||e.T.pitch))f.volume=e.T.volume||null,
f.pitch=e.T.pitch||null,f.type=40;else if("MESH"==a.type&&A(b)){f.type=60;e=w(a,b);if(!e){e=[];h=[];k=[];var l=[],m=b.l,n=a.c.g.dl,r=a.c.g.el;for(g in m.T){var B=b.name+"%join%"+g;t(g,B,m,h,e,n);t(g,B,m,l,k,r)}e={vD:e,values:h,nB:k,oB:l};a.Xd.push(b,e)}f.ss=e.vD;f.us=e.values;f.rs=e.nB;f.ts=e.oB}else if(g=e.T.tsr){f.type=20;e=w(a,b);if(!e){e=b.l.As;h=[];k=[];for(l=0;l<e;l++)h.push(g.subarray(8*l,8*l+4)),k.push(g.subarray(8*l+4,8*l+8));e={i:h,Ga:k};a.Xd.push(b,e)}f.i=e.i;f.Ga=e.Ga;W.Vh(a)&&W.gD(a,
f.i[0],f.Ga[0])}else return U.warn('Incompatible action "'+b.name+'" has been applied to object "'+a.name+'"'),!1;X.is_armature(a)&&!d&&D(a,c);return!0}function w(a,b){for(var c=a.Xd,d=0;d<c.length;d+=2)if(b==c[d])return c[d+1];return null}function C(a){var b=a.c.g.Ll;if(-1!=b[0]&&-1!=b[1]){var c=a.c.G;a=c[b[1]].xc;var d=Math.floor(a),e=a-d,b=c[b[0]];a=b.xc;d=Math.floor(a);b.xc=d+e}}function D(a,b){var c=a.c.g.Ll,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var e=a.c.G;0<=d;d--){var f=e[d];if(f&&10==f.type)if(d>
c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function G(a){var b=a.data.bones;a=a.pose.bones;for(var c={},d=0;d<b.length;d++){var e=b[d].name;c[e]={jq:d,Vi:d,so:X.un(a,"name",e),lu:-1}}return c}function t(a,b,c,d,e,f){for(var g=0;g<f.length;g+=2)b==f[g]&&(e.push(f[g+1]),d.push(new Float32Array(c.T[a])))}function A(a){a=a.l;for(var b in a.T)if(-1!=b.indexOf("nodes"))return!0;return!1}function x(a,b,c,d){if((c=a.c.G[c])&&null!=c.type&&(c.play||d)){var e=a.c.g,f=c.xc,g=c.start,h=c.length,f=f+c.speed*b*
ga.Ra,k=c.type,l=c.speed;if(0<=l&&f>=g+h||0>l&&f<g)switch(d||(c.cj=!0),c.behavior){case 10:f=0<=l?(f-g)%h+g:g+h-1E-6;break;case 20:f=0<=l?g:g+h-1E-6;c.play=!1;break;case 30:f=0<=l?g+h-1E-6:g,c.play=!1}c.xc=f;switch(k){case 10:if(!e.Pe){d=u(c,f,B);b=d[0];f=d[1];d=d[2];e.Gc=c.Ga[b];e.Fc=c.Ga[f];e.Oc=c.i[b];e.Nc=c.i[f];e.jg=d;e=e.Gl;c=c.Go;for(g=0;g<e.length;g++)h=e[g],k=c[g],h.Gc=k.Ga[b],h.Fc=k.Ga[f],h.Oc=k.i[b],h.Nc=k.i[f],h.jg=d;S.A(a)}break;case 20:h=d=u(c,f,B);(e=N)||(e=new Float32Array(4));var f=
h[0],g=h[1],h=h[2],k=c.i,l=k[f][1],m=k[f][2],n=k[g][1],r=k[g][2];e[0]=(1-h)*k[f][0]+h*k[g][0];e[1]=(1-h)*l+h*n;e[2]=(1-h)*m+h*r;f=d;(g=ta)||(g=new Float32Array(4));h=c.Ga;ea.slerp(h[f[0]].subarray(0,4),h[f[1]].subarray(0,4),f[2],g);f=g;g=d[2];h=c.i;d=(1-g)*h[d[0]][3]+g*h[d[1]][3];c.ep&&(g=ia,S.get_translation(a,g),X.smooth_v(e,g,b,c.ep,e));c.wo&&(g=Y,S.get_rotation(a,g),X.yt(f,g,b,c.wo,f));c=c.wk;c[0]&&S.set_translation(a,e);c[1]&&S.set_rotation(a,f);c[2]&&S.set_scale(a,d);S.A(a);ba.sync_transform(a);
break;case 30:(a=B)||(a=Array(3));f-=c.start;0>f&&(f=0);f>=c.length&&(f=c.length);b=Math.floor(f);d=b+1;f-=b;10!=c.behavior&&d==c.length&&(d=--b,f=1);c=c.iu;a[0]=b+c;a[1]=d+c;a[2]=f;d=B;e.lp=d[0];e.hu=d[2];break;case 40:d=u(c,f,B);b=d[0];e=d[1];d=d[2];c.volume&&ca.set_volume(a,(1-d)*c.volume[b]+d*c.volume[e]);c.pitch&&ca.playrate(a,(1-d)*c.pitch[b]+d*c.pitch[e]);break;case 50:W.NB(a,c.Uf,f/ga.Ra);break;case 60:d=u(c,f,B);b=d[0];e=d[1];d=d[2];k=c.us;l=c.ss;f=c.ts;c=c.rs;for(g=0;g<l.length;g++)m=k[g],
h=l[g],a.c.g.ue[h]=(1-d)*m[b]+d*m[e];for(g=0;g<c.length;g++)k=f[g],h=c[g],k=fa.lerp(k.subarray(3*b,3*b+3),k.subarray(3*e,3*e+3),d,N),a.c.g.Cc[h]=k[0],a.c.g.Cc[h+1]=k[1],a.c.g.Cc[h+2]=k[2];break;default:X.ha("Unknown animation type:"+k)}}}function u(a,b,c){c||(c=Array(3));var d=a.am[0],e=a.am[1]-d;b-=d;0>b&&(b=0);b>=e&&(b=e);b/=a.Np;e=Math.floor(b);a=a.Mp[e]?b-e:0;b=Math.ceil(e+a);c[0]=e;c[1]=b;c[2]=a;return c}function g(a,b){var c=a.c.g,d=c.Oe,e=c.Ll,f=e[0],e=e[1];if(-1!=e){if(-1!=f){var g=a.c.G[f];
if(g.play||0==b)var h=u(g,g.xc,B),k=h[0],l=h[1],h=h[2],m=g.Ga[k],n=g.Ga[l],k=g.i[k],l=g.i[l];else d=1}else d=1;e=a.c.G[e];if(e.play||0==b)var h=u(e,e.xc,B),r=h[0],v=h[1],h=h[2];else if(-1!=f&&g.play)d=0;else return;f=e.Ga[r];g=e.Ga[v];r=e.i[r];e=e.i[v];if(1==d)c.Gc.set(f),c.Fc.set(g),c.Oc.set(r),c.Nc.set(e);else if(0==d)c.Gc.set(m),c.Fc.set(n),c.Oc.set(k),c.Nc.set(l);else{for(v=0;v<m.length;v+=4){for(var t=ta,q=Y,y=0;4>y;y++)t[y]=m[v+y],q[y]=f[v+y];ea.slerp(t,q,d,t);for(y=0;4>y;y++)c.Gc[v+y]=t[y];
for(y=0;4>y;y++)t[y]=n[v+y],q[y]=g[v+y];ea.slerp(t,q,d,t);for(y=0;4>y;y++)c.Fc[v+y]=t[y]}X.gq(k,r,d,c.Oc);X.gq(l,e,d,c.Nc)}S.A(a);d=c.Gl;m=c.os;for(v=0;v<d.length;v++){n=d[v];k=m[v];for(l=0;l<k.length;l+=2)for(r=k[l],f=k[l+1],g=0;4>g;g++)n.Gc[r+g]=c.Gc[f+g],n.Fc[r+g]=c.Fc[f+g],n.Oc[r+g]=c.Oc[f+g],n.Nc[r+g]=c.Nc[f+g];n.jg=h}}}function q(a,b){var c=a.c.g,d=c.Oe,e=c.em;if(0!=e){var d=c.dm-d,f=e*b;X.sign(d)==X.sign(e)&&Math.abs(f)<Math.abs(d)?c.Oe+=f:(c.Oe=c.dm,c.em=0)}}function L(a,b,c){for(var d=a.pose.bones,
e=[],f=[],g=b.l.As,h=0;h<g;h++){for(var k=0;k<d.length;k++){var l=d[k],m=oa.create(),n=b.l.sk[l.name];n&&oa.copy(n.subarray(8*h,8*h+8),m);l.Jp=m;l.gk=!1}k=J(a,c);e.push(k.i);f.push(k.Ga)}return{i:e,Ga:f}}function J(a,b){var c=[],d=[],e=a.pose.bones,f=new Float32Array(4),g=new Float32Array(4),h;for(h in b){var k=b[h],l=k.Vi,m=e[k.so],k=f,n=g,r=m.Nv,B=r[r.length-1],v=B.$l;B.gk||oa.identity(v);for(B=r.length-1;0<=B;B--){var m=r[B],t=m.$l;if(m.gk)v=t;else{var q=m.Kp,y=m.Jp;oa.invert(q,ja);oa.multiply(y,
ja,ja);oa.multiply(q,ja,ja);oa.multiply(v,ja,t);v=t;m.gk=!0}}m=m.$l;k[0]=m[0];k[1]=m[1];k[2]=m[2];k[3]=m[3];n[0]=m[4];n[1]=m[5];n[2]=m[6];n[3]=m[7];ea.normalize(n,n);for(k=0;4>k;k++)n=4*l+k,c[n]=f[k],d[n]=g[k]}c=new Float32Array(c);d=new Float32Array(d);return{i:c,Ga:d}}function E(a){var b=[0,0,0],c;for(c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1);return b}function M(a,b,c,d,e,f,g){var h=a+(b-a)/2,k=K(h,d,e,f,g)-c;return.02>Math.abs(k)?h:0<k?M(a,h,c,d,e,f,g):M(h,
b,c,d,e,f,g)}function K(a,b,c,d,e){var f=1-a;return b*f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}function Q(a,b){if(!a.c.G.length)for(var c=0;8>c;c++)a.c.G.push(null);a.c.G[b]={type:null,Uf:null,am:null,Np:0,Mp:null,wk:null,Ga:null,i:null,Go:[],play:!1,behavior:20,xc:0,start:0,length:0,ep:0,wo:0,cj:!1,iu:null,speed:1,volume:null,pitch:null,us:[],ss:[],ts:[],rs:[]};a.Xd=a.Xd||[];-1==sa.indexOf(a)&&sa.push(a)}function I(a,b){S.A(a);ba.sync_transform(a);k(a,0,b,!0)}function v(a,c,e){e=e||0;if(X.is_mesh(a)){var f=
Z(a,c);if(f)return Q(a,e),d(a,f,e),I(a,e),!0;if((f=aa(a,c))&&"EMITTER"==f.po)return Q(a,e),b(a,f.name,e),I(a,e),!0}if(f=X.keysearch("name",c,z)||X.keysearch("name",c+"_B4W_BAKED",z)){Q(a,e);if(y(a,f,e))return I(a,e),!0;a.c.G[e]=null}U.error('Unsupported object: "'+a.name+'" or animation name: "'+c+'"');return!1}function H(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c.use_nodes&&d&&P(d))return!0}return!1}function P(a){if(a.animation_data)return!0;
a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if(c.node_group&&(c=c.node_group.node_tree)&&P(c))return!0}return!1}function Z(a,b){for(var c=0;c<a.c.Ob.length;c++){var d=a.c.Ob[c];if(d.name===b)return d}return null}function aa(a,b){for(var c=0;c<a.c.p.length;c++){var d=a.c.p[c].la;if(d&&d.name===b)return d}return null}var R=p("__config"),W=p("__particles"),ba=p("__physics"),U=p("__print");p("__scenes");var ca=p("__sfx"),S=p("__transform"),oa=p("__tsr"),X=p("__util"),da=p("__reformer");p("mat4");
var ea=p("quat");p("vec4");var fa=p("vec3"),ga=R.Zd;a.Nu=1E-6;a.OBJ_ANIM_TYPE_NONE=0;a.OBJ_ANIM_TYPE_ARMATURE=10;a.OBJ_ANIM_TYPE_OBJECT=20;a.OBJ_ANIM_TYPE_VERTEX=30;a.OBJ_ANIM_TYPE_SOUND=40;a.OBJ_ANIM_TYPE_PARTICLES=50;a.OBJ_ANIM_TYPE_MATERIAL=60;a.SLOT_0=0;a.SLOT_1=1;a.SLOT_2=2;a.SLOT_3=3;a.SLOT_4=4;a.SLOT_5=5;a.SLOT_6=6;a.SLOT_7=7;a.SLOT_ALL=-1;a.AB_CYCLIC=10;a.AB_FINISH_RESET=20;a.AB_FINISH_STOP=30;var B=Array(3),N=new Float32Array(3),ia=new Float32Array(3),ta=new Float32Array(4),Y=new Float32Array(4),
ja=new Float32Array(8);new Float32Array(16);var sa=[],z=[];a.vr=function(){return X.trunc((R.r.ns-50)/4)};a.frame_to_sec=function(a){return a/ga.Ra};a.update=function(a){for(var b=0;b<sa.length;b++){for(var d=sa[b],e=0;8>e;e++)x(d,a,e);d.c.g.Pe&&(q(d,a),g(d,a))}for(b=0;b<sa.length;b++)for(d=sa[b],e=0;8>e&&d.c.G.length;e++)c(d,e)};a.or=function(){return z};a.get_anim_names=function(a){var b=[];if(n(a))for(var c=0;c<a.c.Ob.length;c++)b.push(a.c.Ob[c].name);var d,c=[];for(d=0;d<z.length;d++){var f=z[d],
g=f.l;X.Ed(f.l.sk)?"ARMATURE"==a.type&&c.push(f):g.T.volume||g.T.pitch?ca.re(a)&&c.push(f):!A(f)&&X.Ed(f.fcurves)&&c.push(f)}"MESH"==a.type&&(c=c.concat(m(a)));d=c;for(c=0;c<d.length;c++)b.push(e(d[c].name));if(W.Vh(a)&&W.oo(a))for(c=0;c<a.c.p.length;c++)(d=a.c.p[c].la)&&b.push(d.name);return b};a.tC=e;a.get_anim_type=function(a,b){var c=a.c.G[b];return c?c.type:0};a.apply_def=function(a){var c=0,e;e=[];var f=a.animation_data;if(f&&f.action&&(f=f.action,X.Ed(f.fcurves))){var g=X.Ed(f.l.sk);"ARMATURE"!=
a.type&&g||e.push(f)}ca.re(a)&&a.data.animation_data&&a.data.animation_data.action&&e.push(a.data.animation_data.action);"MESH"==a.type&&(e=e.concat(m(a)));for(f=0;f<a.c.p.length;f++)(g=a.c.p[f].la)&&"EMITTER"==g.po&&(Q(a,c),b(a,g.name,c),I(a,c),a.c.G[c].behavior=l(a.b4w_anim_behavior),g.cyclic&&(a.c.G[c].behavior=10),c++);for(f=0;f<e.length;f++)g=e[f],Q(a,c),y(a,g,c)?(I(a,c),a.c.G[c].behavior=l(a.b4w_anim_behavior),c++):a.c.G[c]=null;n(a)&&(Q(a,c),d(a,a.c.Ob[0],c),I(a,c),a.c.G[c].behavior=l(a.b4w_anim_behavior))};
a.play=function(a,b,c){f(a.c.G,c,function(a){a.play=!0;a.gn=b?b:null;a.cj=!1});a.c.g.Pe&&C(a)};a.stop=function(a,b){f(a.c.G,b,function(a){a.play=!1;a.gn=null;a.cj=!1})};a.is_play=function(a,b){var c=a.c.G[b];return c?c.play:!1};a.set_frame=function(a,b,c){var d=a.c.G;if(-1==c)for(c=0;8>c;c++){var e=d[c];e&&(e.xc=b,k(a,0,c,!0))}else if(e=d[c])e.xc=b,k(a,0,c,!0)};a.get_current_frame_float=function(a,b){var c=a.c.G[b];return c&&c.xc?c.xc:0};a.is_cyclic=function(a,b){var c=a.c.G[b];return c&&10==c.behavior};
a.set_behavior=function(a,b,c){f(a.c.G,c,function(a){a.behavior=b})};a.get_behavior=function(a,b){var c=a.c.G[b];return c&&c.behavior};a.apply_smoothing=function(a,b,c,d){f(a.c.G,d,function(a){a.ep=b||0;a.wo=c||0})};a.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.c.G[c]=null;else a.c.G[b]=null;a.c.g.Pe&&D(a,b)};a.update_object_animation=k;a.Cs=function(a){if("ARMATURE"==a.type||r(a))return!0;var b=a.animation_data;return b&&b.action||"SPEAKER"==a.type&&a.data.animation_data&&
a.data.animation_data.action||W.Vh(a)&&W.oo(a)||"MESH"==a.type&&a.c.Ob.length||H(a)?!0:!1};a.kq=function(a){if("ARMATURE"==a.type||r(a))return!0;var b=a.animation_data;return b&&b.action||"SPEAKER"==a.type&&a.data.animation_data&&a.data.animation_data.action||W.Lw(a)&&W.Kw(a)||"MESH"==a.type&&a.data.b4w_vertex_anim.length||H(a)?!0:!1};a.get_first_armature_object=r;a.is_animated=function(a){return Boolean(a.c.G.length)};a.Nw=G;a.mq=J;a.Yv=function(a){function b(a,c){for(var d=0;d<c;d++){var e=a.subarray(8*
d+4,8*d+8);ea.normalize(e,e)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,e=b;else-1<a.indexOf("rotation_quaternion")?(d=4,e=0==b?3:b-1):-1<a.indexOf("scale")?(d=3,e=0):(d=0,e=b);return d+e}function d(a,b,c,e,h){if(-1<c.search(f)){a=b;c=c.split('"')[1];var k=g}else 8==h?(c="tsr",k=g):k=1<h?new Float32Array(h):0;if(!a[c]){h=a;b=c;if("object"==typeof k&&k.length)for(var l=k.length,m=new Float32Array(e*l),n=0;n<e;n++)for(var r=0;r<l;r++)m[n*l+r]=k[r];else if("number"==typeof k)for(m=new Float32Array(e),
n=0;n<e;n++)m[n]=k;else X.ha("Wrong storage default value");h[b]=m}return a[c]}a.l={};var e=a.l;e.OA=1/ga.kg;var f=new RegExp(/pose.bones\[\".+\"\]/g),g=oa.create(),h=a.fcurves,k={},l={},m=0,n;for(n in h){var r=h[n],B;for(B in r){var v=r[B],t=v.uc;da.Uw(v,a);v=v.num_channels;m||(m=t.length);for(var v=d(k,l,n,m,v),q=v.length/m,y=c(n,B|0),u=0;u<m;u++)v[u*q+y]=t[u]}}for(var x in k)"tsr"==x&&b(k[x],m);for(var w in l)b(l[w],m);e.T=k;e.sk=l;e.Cw=a.Mv;e.As=m;e.wk="tsr"in k?E(h):null;z.push(a)};a.gz=function(a,
b){return(b-a)*ga.kg+1};a.rw=function(a,b,c,d,e,f){var g,h,k=new Float32Array(2),l=new Float32Array(2),m=new Float32Array(2),n=new Float32Array(2),r=b[1],B=b[2],v=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var t=0,q=0,y=null;e<=f;e++)if(e<r)for(var u=0;u<ga.kg;u++)c[t++]=B;else if(e>v)for(u=0;u<ga.kg;u++)c[t++]=a;else{var x=b[q],w=3;0===x&&(w+=2);0===y&&(w+=2);var p=2===x?0:1;if(b[q+1]==b[q+w+1])y=x,q+=w;else{u=0;e==b[q+1]&&(p&&(d[t]=1),c[t]=b[q+2],t++,u++);if(e==v)for(;u<ga.kg;u++)c[t++]=
a;else for(k[0]=b[q+1],k[1]=b[q+2],0!==x?(l[0]=0,l[1]=0):0===y?(l[0]=b[q+5],l[1]=b[q+6]):(l[0]=b[q+3],l[1]=b[q+4]),0!==x?(m[0]=0,m[1]=0):(m[0]=b[q+w+3],m[1]=b[q+w+4]),n[0]=b[q+w+1],n[1]=b[q+w+2];u<ga.kg;u++){var N=e+u/ga.kg;switch(x){case 0:g=k;h=l;var H=m,C=n,A=[],ia=[],z=void 0,D=void 0,E=void 0,z=void 0;A[0]=g[0]-h[0];A[1]=g[1]-h[1];ia[0]=C[0]-H[0];ia[1]=C[1]-H[1];E=C[0]-g[0];z=Math.abs(A[0]);D=Math.abs(ia[0]);0!=z+D&&z+D>E&&(z=E/(z+D),h[0]=g[0]-z*A[0],h[1]=g[1]-z*A[1],H[0]=C[0]-z*ia[0],H[1]=C[1]-
z*ia[1]);p&&(d[t]=1);c[t]=K(M(0,1,N,k[0],l[0],m[0],n[0]),k[1],l[1],m[1],n[1]);t++;break;case 1:h=k[0];H=k[1];g=C=(n[1]-H)/(n[0]-h);h=H-C*h;p&&(d[t]=1);c[t]=g*N+h;t++;break;case 2:p&&(d[t]=1);c[t]=b[q+2];t++;break;default:X.ha("Unknown keyframe intepolation mode: "+x)}}e+1==b[q+w+1]&&(y=x,q+=w)}}};a.apply=v;a.mw=function(a,b,c){c=c||0;var d=X.keysearch("uuid",b,z);if(d){Q(a,c);if(y(a,d,c)){I(a,c);return}a.c.G[c]=null}U.error('Unsupported object: "'+a.name+'" or animation uuid: "'+b+'"')};a.wD=function(a,
b){var c=X.keysearch("name",b,z)||X.keysearch("name",b+"_B4W_BAKED",z);if(c){if(!X.Ed(c.fcurves))return!1}else if(!(aa(a,b)||X.is_mesh(a)&&Z(a,b)))return!1;return!0};a.get_slot_num_by_anim=function(a,b){for(var c=a.c.G,d=0;d<c.length;d++){var f=c[d];if(f&&e(f.Uf)==e(b))return d}return-1};a.ez=function(a,b){var c=a.c.G[b];return c&&c.Uf?e(c.Uf):null};a.remove=function(a){a.c.G.length=0;a=sa.indexOf(a);-1!=a&&sa.splice(a,1)};a.eB=function(a){for(var b=z.length-1;0<=b;b--)z[b].Ov==a&&z.splice(b,1)};
a.apply_to_first_empty_slot=function(a,b){if(!a.c.G.length)return v(a,b,0)?0:-1;for(var c=0;c<a.c.G.length;c++)if(!a.c.G[c])return v(a,b,c)?c:-1};a.set_skel_mix_factor=function(a,b,c){a.c.g.em=(b-a.c.g.Oe)/c;a.c.g.dm=b};a.set_speed=function(a,b,c){f(a.c.G,c,function(a){a.speed=b})};a.get_speed=function(a,b){return a.c.G[b].speed};a.get_anim_start_frame=function(a,b){return a.c.G[b].start};a.get_anim_length=function(a,b){return a.c.G[b].length};a.Kz=H;a.cleanup=function(){sa.length=0;z.length=0};a.Fy=
function(a){var b=(a[0]||a[1]||a[2]).uc.length,c=ta,d=N,e=Boolean(a[0]);e||(a[0]={uc:new Float32Array(b),num_channels:8});var f=Boolean(a[1]);f||(a[1]={uc:new Float32Array(b),num_channels:8});var g=Boolean(a[2]);g||(a[2]={uc:new Float32Array(b),num_channels:8});a[3]={uc:new Float32Array(b),num_channels:8};for(var h=0;h<b;h++)d[0]=e?a[0].uc[h]:0,d[1]=f?a[1].uc[h]:0,d[2]=g?a[2].uc[h]:0,X.euler_to_quat(d,c),a[0].uc[h]=c[3],a[1].uc[h]=c[0],a[2].uc[h]=c[1],a[3].uc[h]=c[2]}};b4w.module.__time=function(a,p){p("__util");var c=0,d=0,b=[],e=0,l=0,m=[];a.kt=function(a){c=a;d=performance.now();for(a=0;a<b.length;a++){var e=b[a];c>e.an&&(b.splice(a,1),a--,e.callback())}for(a=0;a<m.length;a++){var e=m[a],f=1-(e.an-c)/e.duration,f=Math.min(f,1);e.callback(e.V+f*(e.ua-e.V));1==f&&(m.splice(a,1),a--)}};a.get_timeline=function(){return c};a.set_timeout=function(a,l){var f;e++;f=e;b.push({id:f,callback:a,an:c+(performance.now()-d+l)/1E3});return f};a.clear_timeout=function(a){for(var c=
0;c<b.length;c++)if(b[c].id==a){b.splice(c,1);break}};a.clear_animation=function(a){for(var b=m.length;b--;)if(m[b].id==a){m.splice(b,1);break}};a.animate=function(a,b,d,e){d/=1E3;var r;l++;r=l;m.push({id:r,callback:e,V:a,ua:b,an:c+d,duration:d});e(a);return r};a.reset=function(){d=c=0;b.length=0;l=e=m.length=0}};b4w.module.__transform=function(a,p){function c(a,b){var c=a.c.g;c.i[0]=b[0];c.i[1]=b[1];c.i[2]=b[2];c.scale=b[3];c.quat[0]=b[4];c.quat[1]=b[5];c.quat[2]=b[6];c.quat[3]=b[7]}function d(a){var c=a.c.g,h=a.c.Tg,u=a.type;"CAMERA"==u&&e.ip(a);l.WC(a,q);"CAMERA"==u&&e.TC(a);var x=c.i,p=c.scale,A=c.quat;w.set_sep(x,p,A,c.Fb);var v=c.Z;n.fromQuat(A,v);"CAMERA"!=u&&C.uB(v,p,v);v[12]=x[0];v[13]=x[1];v[14]=x[2];n.invert(v,c.Sr);a.c.G.length&&f.oo(a)&&f.XC(a);c.Hb&&c.hb&&(b.tm(c.Hb,v,c.hb),b.vm(c.Tc,v,c.Ib),
b.um(c.Te,c.Fb,c.Vf));switch(u){case "SPEAKER":y.iC(a,q);break;case "EMPTY":a.field&&r.Zt(a);break;case "MESH":if(p=a.c.Up)w.invert(p.c.g.Fb,g),w.multiply(g,c.Fb,g),t.set(g[0],g[1],g[2],g[3],c.im),k.set(g[4],g[5],g[6],g[7],c.hm);break;case "CAMERA":e.UC(a);r.ia()&&(p=r.get_active(),r.kj(p)==a&&y.nA(p,x,A,q));break;case "LAMP":m.YC(a)}for(p=0;p<h.length;p++){var H=h[p],v=H.Sg;"LAMP"==u&&r.Yg(a,v);if("LAMP"==u||"CAMERA"==u)r.Eo(v),r.wB(v);if(c.Hb&&c.hb){c.Jc&&r.Eo(v);var G=H.Xe;null!=c.Uc&&G&&r.Yt(G,
x)}H=H.rf;G=a.c.Pg;if(G.length&&H){var Z=H.k;r.au(H,x,A);D.bu(G,Z.cc);e.QB(Z,r.kj(v))}}a=a.c.kd;for(p=0;p<a.length;p++)d(a[p]);c.mn=!0}var b=p("__boundings"),e=p("__camera"),l=p("__constraints"),m=p("__lights"),h=p("__mat3"),n=p("__mat4"),f=p("__particles"),k=p("__quat"),r=p("__scenes"),y=p("__sfx"),w=p("__tsr"),C=p("__util"),D=p("__obj_util"),G=p("__vec3"),t=p("__vec4"),A=new Float32Array(3),x=new Float32Array(4),u=new Float32Array(9),g=new Float32Array(8),q=0;a.SPACE_WORLD=0;a.SPACE_LOCAL=1;a.update=
function(a){q=a};a.set_translation=function(a,b){l.pe(a)==l.Ud?w.set_trans(b,l.oe(a)):G.copy(b,a.c.g.i)};a.get_translation=function(a,b){l.pe(a)==l.Ud?G.copy(w.get_trans_view(l.oe(a)),b):G.copy(a.c.g.i,b)};a.set_rotation=function(a,b){l.pe(a)==l.Ud?w.set_quat(b,l.oe(a)):k.copy(b,a.c.g.quat)};a.get_rotation=function(a,b){l.pe(a)==l.Ud?k.copy(w.get_quat_view(l.oe(a)),b):k.copy(a.c.g.quat,b)};a.set_rotation_euler=function(a,b){if(l.pe(a)==l.Ud){var c=C.euler_to_quat(b,x);w.set_quat(c,l.oe(a))}else C.euler_to_quat(b,
a.c.g.quat)};a.set_scale=function(a,b){l.pe(a)==l.Ud?w.set_scale(b,l.oe(a)):a.c.g.scale=b};a.get_scale=function(a){return l.pe(a)==l.Ud?w.get_scale(l.oe(a)):a.c.g.scale};a.get_tsr=function(a,b){if(l.pe(a)==l.Ud)w.copy(l.oe(a),b);else{var c=a.c.g;w.set_sep(c.i,c.scale,c.quat,b)}};a.set_tsr=function(a,b){l.pe(a)==l.Ud?w.copy(b,l.oe(a)):c(a,b)};a.OB=c;a.get_object_size=function(a){var b=a.c.g,c=b.lh;a=b.scale*(c.max_x-c.min_x);var d=b.scale*(c.max_y-c.min_y),b=b.scale*(c.max_z-c.min_z);return.5*Math.sqrt(a*
a+d*d+b*b)};a.get_object_center=function(a,b,c){c||(c=new Float32Array(3));b?(a=a.c.g,G.copy(a.Ib.F,c)):(a=a.c.g,b=a.lh,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,G.transformMat4(c,a.Z,c));return c};a.move_local=function(a,b,c,d){a=a.c.g;A[0]=b;A[1]=c;A[2]=d;b=h.fromMat4(a.Z,u);G.transformMat3(A,b,A);G.add(a.i,A,a.i)};a.A=d;a.distance=function(a,b){return G.dist(a.c.g.i,b.c.g.i)};a.IA=function(a,b){return G.dist(a.c.g.i,b)};a.get_object_bounding_box=function(a){return{max_x:a.c.g.hb.max_x,
min_x:a.c.g.hb.min_x,max_y:a.c.g.hb.max_y,min_y:a.c.g.hb.min_y,max_z:a.c.g.hb.max_z,min_z:a.c.g.hb.min_z}}};b4w.module.__tsr=function(a,p){function c(a,b,c,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b;d[4]=c[0];d[5]=c[1];d[6]=c[2];d[7]=c[3]}function d(a,b,c){var d=b[0],e=b[1],h=b[2],l=b[3],m=b[4],n=b[5],p=b[6];b=b[7];var x=a[0]*l,u=a[1]*l,g=a[2]*l;a=b*x+n*g-p*u;var l=b*u+p*x-m*g,q=b*g+m*u-n*x,x=-m*x-n*u-p*g;c[0]=a*b+x*-m+l*-p-q*-n;c[1]=l*b+x*-n+q*-m-a*-p;c[2]=q*b+x*-p+a*-n-l*-m;c[0]+=d;c[1]+=e;c[2]+=h;return c}var b=p("__mat4"),e=p("__quat"),l=p("__util"),m=p("__vec3"),h=new Float32Array(3),n=new Float32Array(4);
new Float32Array(16);a.create=function(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a};a.from_values=function(a,b,c,d,e,h,l,m){var n=new Float32Array(8);n[0]=a;n[1]=b;n[2]=c;n[3]=d;n[4]=e;n[5]=h;n[6]=l;n[7]=m;return n};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b};a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.create_sep=function(a,b,d,e){e||(e=new Float32Array(8));c(a,b,d,e);return e};
a.set_sep=c;a.set_trans=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2]};a.set_scale=function(a,b){b[3]=a};a.set_transcale=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.set_quat=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3]};a.get_trans_view=function(a){return a.subarray(0,3)};a.get_scale=function(a){return a[3]};a.get_quat_view=function(a){return a.subarray(4)};a.invert=function(a,b){var c=1/a[3];if(!c)return null;var d=a[0],h=a[1],l=a[2];n[0]=a[4];n[1]=a[5];n[2]=a[6];n[3]=a[7];e.invert(n,
n);var m=n[0],p=n[1],t=n[2],A=n[3],d=d*c,h=h*c,x=l*c,l=A*d+p*x-t*h,u=A*h+t*d-m*x,g=A*x+m*h-p*d,d=-m*d-p*h-t*x;b[0]=-(l*A+d*-m+u*-t-g*-p);b[1]=-(u*A+d*-p+g*-m-l*-t);b[2]=-(g*A+d*-t+l*-p-u*-m);b[3]=c;b[4]=m;b[5]=p;b[6]=t;b[7]=A;return b};a.to_mat4=function(a,c){var d=a[3];b.fromRotationTranslation(a.subarray(4),a.subarray(0,3),c);for(var e=0;12>e;e++)c[e]*=d;return c};a.from_mat4=function(a,b){var d=l.Nh(a,h),e=l.ao(a),m=l.matrix_to_quat(a,n);c(d,e,m,b);return b};a.multiply=function(a,b,c){d(b,a,c);
c[3]=a[3]*b[3];var e=a[4],h=a[5],l=a[6];a=a[7];var m=b[4],n=b[5],t=b[6];b=b[7];c[4]=e*b+a*m+h*t-l*n;c[5]=h*b+a*n+l*m-e*t;c[6]=l*b+a*t+e*n-h*m;c[7]=a*b-e*m-h*n-l*t;return c};a.transform_vec3=d;a.transform_vec3_inv=function(a,b,c){var d=b[3],e=a[0]-b[0],h=a[1]-b[1],l=a[2]-b[2];a=b[4];var m=b[5],n=b[6];b=b[7];var p=a*a+m*m+n*n+b*b,p=p?1/p:0;a=-a*p;m=-m*p;n=-n*p;b*=p;var p=b*e+m*l-n*h,x=b*h+n*e-a*l,u=b*l+a*h-m*e,e=-a*e-m*h-n*l;c[0]=p*b+e*-a+x*-n-u*-m;c[1]=x*b+e*-m+u*-a-p*-n;c[2]=u*b+e*-n+p*-m-x*-a;c[0]/=
d;c[1]/=d;c[2]/=d;return c};a.transform_vectors=function(a,b,c,d){d||(d=0);var e=a.length,h=b[0],l=b[1],m=b[2],n=b[3],p=b[4],x=b[5],u=b[6];b=b[7];for(var g=0;g<e;g+=3){var q=a[g]*n,L=a[g+1]*n,J=a[g+2]*n,E=b*q+x*J-u*L,M=b*L+u*q-p*J,K=b*J+p*L-x*q,q=-p*q-x*L-u*J;c[d+g]=E*b+q*-p+M*-u-K*-x;c[d+g+1]=M*b+q*-x+K*-p-E*-u;c[d+g+2]=K*b+q*-u+E*-x-M*-p;c[d+g]+=h;c[d+g+1]+=l;c[d+g+2]+=m}return c};a.transform_dir_vectors=function(a,b,c,d){d||(d=0);var e=a.length,h=b[3],l=b[4],m=b[5],n=b[6];b=b[7];for(var p=0;p<
e;p+=3){var x=a[p]*h,u=a[p+1]*h,g=a[p+2]*h,q=b*x+m*g-n*u,L=b*u+n*x-l*g,J=b*g+l*u-m*x,x=-l*x-m*u-n*g;c[d+p]=q*b+x*-l+L*-n-J*-m;c[d+p+1]=L*b+x*-m+J*-l-q*-n;c[d+p+2]=J*b+x*-n+q*-m-L*-l}return c};a.transform_dir_vec3=function(a,b,c){var d=b[3],e=b[4],h=b[5],l=b[6];b=b[7];var m=a[0]*d,n=a[1]*d,p=a[2]*d;a=b*m+h*p-l*n;var d=b*n+l*m-e*p,x=b*p+e*n-h*m,m=-e*m-h*n-l*p;c[0]=a*b+m*-e+d*-l-x*-h;c[1]=d*b+m*-h+x*-e-a*-l;c[2]=x*b+m*-l+a*-h-d*-e;return c};a.transform_tangents=function(a,b,c,d){d||(d=0);var e=a.length,
h=b[3],l=b[4],m=b[5],n=b[6];b=b[7];for(var p=0;p<e;p+=4){var x=a[p]*h,u=a[p+1]*h,g=a[p+2]*h,q=b*x+m*g-n*u,L=b*u+n*x-l*g,J=b*g+l*u-m*x,x=-l*x-m*u-n*g;c[d+p]=q*b+x*-l+L*-n-J*-m;c[d+p+1]=L*b+x*-m+J*-l-q*-n;c[d+p+2]=J*b+x*-n+q*-m-L*-l;c[d+p+3]=a[p+3]}return c};a.translate=function(a,b,c){var d=a[3],e=a[4],h=a[5],l=a[6],m=a[7],n=b[0]*d,p=b[1]*d,x=b[2]*d;b=m*n+h*x-l*p;var d=m*p+l*n-e*x,u=m*x+e*p-h*n,n=-e*n-h*p-l*x;c[0]=a[0]+b*m+n*-e+d*-l-u*-h;c[1]=a[1]+d*m+n*-h+u*-e-b*-l;c[2]=a[2]+u*m+n*-l+b*-h-d*-e;c[3]=
a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.interpolate=function(a,b,c,d){d||(d=new Float32Array(8));m.lerp(a.subarray(0,3),b.subarray(0,3),c,d.subarray(0,3));var h=a[3];d[3]=h+c*(b[3]-h);e.slerp(a.subarray(4),b.subarray(4),c,d.subarray(4));return d};a.PE=function(a,b,c,d){d||(d=new Float32Array(8));var h=a.subarray(0,3),l=b.subarray(0,3),m=d.subarray(0,3);m[0]=l[0]*(c+1)-h[0]*c;m[1]=l[1]*(c+1)-h[1]*c;m[2]=l[2]*(c+1)-h[2]*c;d[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4);b=b.subarray(4);h=d.subarray(4);
h[0]=b[0]*(c+1)-a[0]*c;h[1]=b[1]*(c+1)-a[1]*c;h[2]=b[2]*(c+1)-a[2]*c;h[3]=b[3]*(c+1)-a[3]*c;e.normalize(h,h);return d};a.Uz=function(a,b,c,d,e){e[0]=a[0]+b*c[0];e[1]=a[1]+b*c[1];e[2]=a[2]+b*c[2];e[3]=a[3];c=d[0];var h=d[1];d=d[2];var l=a[4],m=a[5],n=a[6],p=a[7];e[4]=.5*(c*p+h*n-d*m);e[5]=.5*(h*p+d*l-c*n);e[6]=.5*(d*p+c*m-h*l);e[7]=.5*(-c*l-h*m-d*n);e[4]=a[4]+e[4]*b;e[5]=a[5]+e[5]*b;e[6]=a[6]+e[6]*b;e[7]=a[7]+e[7]*b;a=e[4];b=e[5];c=e[6];h=e[7];a=a*a+b*b+c*c+h*h;0<a&&(a=1/Math.sqrt(a),e[4]*=a,e[5]*=
a,e[6]*=a,e[7]*=a)}};b4w.module.__util=function(a,p){function c(a){return 0<a?1:0>a?-1:0}function d(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=Math.sqrt(b*b+c*c+d*d),f=1/f;a[0]=b*f;a[1]=c*f;a[2]=d*f;a[3]=e*f}function b(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]}function e(a,b){var c=b;switch(typeof a){case "number":return l(a,c);case "string":return m(a,c);case "boolean":return l(a|0,c);case "function":case "undefined":return l(0,c);case "object":if(a){var d=a instanceof Array;if(a.buffer instanceof ArrayBuffer&&"undefined"!==
a.byteLength)for(d=0;d<a.length;d++)c=l(a[d],c);else if(d)for(d=0;d<a.length;d++)c=e(a[d],c);else for(var f in a)c=e(a[f],c)}else c=l(0,c)}return c}function l(a,b){var c=b;P[0]=a;c=(c<<5)-c+Z[0];c&=c;c=(c<<5)-c+Z[1];return c&c}function m(a,b){for(var c=b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),c&=c;return c}function h(a){return(34*a+1)*a%289}function n(a){return a-Math.floor(a)}function f(a){return k((34*a+5)*a)}function k(a){return a-289*Math.floor(a/289)}function r(a){return a-7*Math.floor(a/
7)}function y(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function w(a){return y(a,0,2*Math.PI)}function C(a,b){if(a&&b){var c=a instanceof Array,d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength,e=b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength;if(c!=b instanceof Array||d!=e)return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!D(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{for(var f in a)if(!D(a[f],
b[f]))return!1;for(f in b)if(!(f in a))return!1}return!0}return!(a||b)}function D(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return C(a,b);default:return!0}}function G(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var e=a[d];""!=e&&"."!=e&&(".."!=e||!b&&!c.length||c.length&&".."==c[c.length-1]?c.push(e):c.length&&c.pop())}a=
c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}var t=p("__print"),A=p("vec3"),x=p("vec4"),u=p("quat"),g=p("mat3"),q=p("mat4"),L=0,J={},E=new Float32Array(3),M=new Float32Array(3),K=new Float32Array(4),Q=new Float32Array(4),I=new Float32Array(9),v=new Float32Array(16),H=new Float32Array(16),P=new Float64Array(1),Z=new Uint32Array(P.buffer),aa=new Float32Array([0,0,0]),R=new Float32Array([0,0,0,1]),W=new Float32Array([0,0,0,1,0,0,0,1]),ba=new Float32Array([1,1,1]),U=new Float32Array([1,0,0]),ca=
new Float32Array([0,1,0]),S=new Float32Array([0,0,1]),oa=new Float32Array([-1,0,0]),X=new Float32Array([0,-1,0]),da=new Float32Array([0,0,-1]),ea=Math.floor(44488.07041494893),fa=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];
a.Lv=aa;a.Fv=R;a.$D=W;a.Ep=ba;a.AXIS_X=U;a.AXIS_Y=ca;a.AXIS_Z=S;a.AXIS_MX=oa;a.AXIS_MY=X;a.AXIS_MZ=da;a.wu=fa;a.keyfind=function(a,b,c){for(var d=[],e=c.length,f=0;f<e;f++){var g=c[f];g[a]==b&&d.push(g)}return d};a.Hy=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.JC=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.Zw=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};
a.sw=function(a,b){var c=[],d={},e=b.length,f,g;for(f=0;f<e;f++)d[b[f]]=!0;e=a.length;for(f=0;f<e;f++)g=a[f],g in d&&c.push(g);return c};a.sign=c;a.zF=function(a,b,c){for(var d=c.length,e=0;e<d;e++)if(c[e][a]==b)return!0;return!1};a.keysearch=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];if(e[a]===b)return e}return null};a.yF=function(a,b,c,d,e){for(var f=0;f<e.length;f++){var g=e[f];if(g[a]==b&&g[c]==d)return g}return null};a.un=function(a,b,c){for(var d=0;d<a.length;d++)if(a[d][b]==c)return d;
return-1};a.lw=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.wE=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;return!0};a.JF=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];e.type==b&&c.push(e)}return c};a.FC=function(a,b,c,d){d||(d=new Float32Array(16));q.identity(d);d[12]=a;d[13]=b;d[14]=c};var ga=1;a.aB=function(){ga=(69069*ga+5)%Math.pow(2,32);return Math.round(ga/65536)%32768/32767};a.pC=function(a){ga=a};
a.bd=function(a){var b=a[0]%ea*48271-3399*Math.floor(a[0]/ea);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.Wk=function(a,b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));var c=Math.cos(a[1]/2),d=Math.cos(a[2]/2),e=Math.cos(a[0]/2),f=Math.sin(a[1]/2),g=Math.sin(a[2]/2),h=Math.sin(a[0]/2);b[0]=f*g*e+c*d*h;b[1]=f*d*e+c*g*h;b[2]=c*g*e-f*d*h;b[3]=c*d*e-f*g*h;return b};a.vy=function(a){var b=g.create(),c=Math.cos(a[0]),d=Math.cos(a[1]),e=Math.cos(a[2]),
f=Math.sin(a[0]),h=Math.sin(a[1]);a=Math.sin(a[2]);var k=c*e,l=c*a,m=f*e,n=f*a;b[0]=d*e;b[1]=d*a;b[2]=-h;b[3]=h*m-l;b[4]=h*n+k;b[5]=d*f;b[6]=h*k+n;b[7]=h*l-m;b[8]=d*c;return b};a.quat_to_euler=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=e*e,h=c*d+e*f;.499999<h?(b[0]=0,b[1]=2*Math.atan2(c,f),b[2]=Math.PI/2):-.499999>h?(b[0]=0,b[1]=-2*Math.atan2(c,f),b[2]=-Math.PI/2):(b[0]=Math.atan2(2*c*f-2*d*e,1-2*c*c-2*g),b[1]=Math.atan2(2*d*f-2*c*e,1-2*d*d-2*g),b[2]=Math.asin(2*c*d+2*e*f));return b};a.quat_to_dir=
function(a,b,c){c||(c=new Float32Array(3));A.transformQuat(b,a,c);return c};a.KE=function(a,b,c){c||(c=new Float32Array(4));a=A.normalize(a,E);var d=A.dot(b,a);a=A.cross(b,a,M);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.GC=function(a,b,c,d){d||(d=new Float32Array(4));A.transformQuat(c,b,d);d[3]=-A.dot(a,d)};a.my=function(a){var b=a.c.g.quat;switch(a.type){case "CAMERA":E[0]=0;E[1]=-1;E[2]=0;A.transformQuat(E,b,E);M[0]=0;M[1]=
0;M[2]=-1;break;case "MESH":E[0]=0;E[1]=0;E[2]=1;A.transformQuat(E,b,E);M[0]=0;M[1]=0;M[2]=1;break;case "EMPTY":E[0]=0,E[1]=1,E[2]=0,A.transformQuat(E,b,E),M[0]=0,M[1]=1,M[2]=0}E[1]=0;A.normalize(E,E);a=A.dot(E,M);return Math.acos(a)*(0<-E[0]*M[2]?-1:1)};a.gq=function(a,b,c,d){if(0!=c){d=d||[];for(var e=0;e<a.length;e++)d[e]=(1-c)*a[e]+c*b[e]}};a.bG=function(){L++;return L.toString(16)};a.Rj=function(a){J[a]||(J[a]=0);var b=a+J[a];J[a]++;return b};a.jd=function(){return{a_position:new Float32Array(0),
a_tangent:new Float32Array(0),a_normal:new Float32Array(0)}};a.sb=function(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,O:0,ka:null,C:[],N:b,aa:[]}};a.Zf=function(a){return JSON.parse(JSON.stringify(a))};a.pa=function(b){if(!(b instanceof Object))return b;var c;c=b.constructor;switch(c){case Float32Array:case Uint32Array:case Uint16Array:c=new c(b);break;case Array:c=new c(b.length);for(var d=0;d<b.length;d++)c[d]=a.pa(b[d]);break;
default:for(d in c=new c,b)c[d]=a.pa(b[d])}return c};a.Ni=function(a){var b=a instanceof Array?[]:{},c;for(c in a)if(a[c]instanceof Object){var d=a[c].constructor;switch(d){case Float32Array:case Uint32Array:case Uint16Array:b[c]=new d(a[c]);break;case Array:b[c]=a[c].slice(0);break;default:b[c]=a[c]}}else b[c]=a[c];return b};a.is_mesh=function(a){return"MESH"===a.type?!0:!1};a.Yk=function(a){return"EMPTY"===a.type?!0:!1};a.is_armature=function(a){return"ARMATURE"===a.type?!0:!1};a.matrix_to_quat=
function(a,b){b||(b=new Float32Array(4));g.fromMat4(a,I);var c=I[0],d=I[3],e=I[6],f=I[1],h=I[4],k=I[7],l=I[2],m=I[5],n=I[8],c=Math.sqrt(c*c+d*d+e*e)||1,f=Math.sqrt(f*f+h*h+k*k)||1,l=Math.sqrt(l*l+m*m+n*n)||1;I[0]/=c;I[3]/=c;I[6]/=c;I[1]/=f;I[4]/=f;I[7]/=f;I[2]/=l;I[5]/=l;I[8]/=l;u.fromMat3(I,b);return b};a.Nh=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.ao=function(a){K[0]=.577350269189626;K[1]=.577350269189626;K[2]=.577350269189626;K[3]=0;x.transformMat4(K,
a,K);return x.length(K)};a.dn=function(a,b){var c=b.left,e=b.right,f=b.top,g=b.bottom,h=b.bb,k=b.Xa;c[0]=a[3]+a[0];c[1]=a[7]+a[4];c[2]=a[11]+a[8];c[3]=a[15]+a[12];e[0]=a[3]-a[0];e[1]=a[7]-a[4];e[2]=a[11]-a[8];e[3]=a[15]-a[12];f[0]=a[3]-a[1];f[1]=a[7]-a[5];f[2]=a[11]-a[9];f[3]=a[15]-a[13];g[0]=a[3]+a[1];g[1]=a[7]+a[5];g[2]=a[11]+a[9];g[3]=a[15]+a[13];h[0]=a[3]+a[2];h[1]=a[7]+a[6];h[2]=a[11]+a[10];h[3]=a[15]+a[14];k[0]=a[3]-a[2];k[1]=a[7]-a[6];k[2]=a[11]-a[10];k[3]=a[15]-a[14];d(c);d(e);d(f);d(g);d(h);
d(k)};a.kC=function(a,c,d){return d<-b(a,c.left)||d<-b(a,c.right)||d<-b(a,c.top)||d<-b(a,c.bottom)||d<-b(a,c.bb)||d<-b(a,c.Xa)?!0:!1};a.ty=function(a,c,d,e,f){g=A.dot(d,c.Xa);h=A.dot(e,c.Xa);k=A.dot(f,c.Xa);g=Math.sqrt(g*g+h*h+k*k);if(g<-b(a,c.bb)||g<-b(a,c.Xa))return!0;var g=A.dot(d,c.left),h=A.dot(e,c.left),k=A.dot(f,c.left);if(Math.sqrt(g*g+h*h+k*k)<-b(a,c.left))return!0;g=A.dot(d,c.right);h=A.dot(e,c.right);k=A.dot(f,c.right);if(Math.sqrt(g*g+h*h+k*k)<-b(a,c.right))return!0;g=A.dot(d,c.top);h=
A.dot(e,c.top);k=A.dot(f,c.top);if(Math.sqrt(g*g+h*h+k*k)<-b(a,c.top))return!0;g=A.dot(d,c.bottom);h=A.dot(e,c.bottom);k=A.dot(f,c.bottom);return Math.sqrt(g*g+h*h+k*k)<-b(a,c.bottom)?!0:!1};a.sf=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k+b[12];c[d+f+1]=b[1]*g+b[5]*h+b[9]*k+b[13];c[d+f+2]=b[2]*g+b[6]*h+b[10]*k+b[14]}};a.zD=function(a,b,c){for(var d=0,d=0,e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*
h+b[8]*k;c[d+f+1]=b[1]*g+b[5]*h+b[9]*k;c[d+f+2]=b[2]*g+b[6]*h+b[10]*k}};a.CC=function(a,b,c){for(var d=0,d=0,e=a.length,f=0;f<e;f+=4){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k;c[d+f+1]=b[1]*g+b[5]*h+b[9]*k;c[d+f+2]=b[2]*g+b[6]*h+b[10]*k;c[d+f+3]=a[f+3]}};a.xD=function(a,b,c){c||(c=new Float32Array(3));K[0]=a[0];K[1]=a[1];K[2]=a[2];K[3]=0;x.transformMat4(K,b,K);c[0]=K[0];c[1]=K[1];c[2]=K[2]};a.SE=function(a,b){var c=a.length;if(!c)throw"flatten(): Wrong or empty array";var d=a[0].length;
if(!d)throw"flatten(): Wrong or empty subarray";b||(b=new Float32Array(c*d));for(var e=0;e<c;e++)for(var f=0;f<d;f++)b[e*d+f]=a[e][f];return b};a.yD=function(a){for(var b=[],c=0;c<a.length;c+=3){var d=new Float32Array([a[c],a[c+1],a[c+2]]);b[c/3]=d}return b};a.qk=function(b,c,d,e){if(e<d)return d;var f=d+Math.floor((e-d)/2);return b[f]>c?a.qk(b,c,d,f-1):b[f]<c?a.qk(b,c,f+1,e):f};a.We=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0};a.yE=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-
b[d])>c)return!1;return!0};a.uB=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15]};a.fp=function(a,b,c,d){d||(d=new Float32Array(16));b=q.fromRotationTranslation(b,c,v);q.multiply(b,a,d)};a.transform_vec3=function(a,b,c,d,e){e||(e=new Float32Array(3));c=q.fromRotationTranslation(c,d,v);1!==b&&(d=q.identity(H),b=A.set(b,b,b,E),q.scale(d,b,d),q.multiply(c,d,c));A.transformMat4(a,c,e);return e};a.gp=function(a,b,c,d){d||(d=new Float32Array(4));
b=q.fromRotationTranslation(b,c,v);x.transformMat4(a,b,d)};a.rF=function(a,b,c,d,e){e||(e=new Float32Array(3));b=q.fromRotationTranslation(c,d,v);q.invert(b,b);A.transformMat4(a,b,e);return e};a.$F=function(a,b,c){c||(c=new Float32Array(16));q.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.IF=function(b,c,d){a.Nh(b,c);c[3]=a.ao(b);a.matrix_to_quat(b,d)};a.eE=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};a.pB=function(a,b,c,d){d||(d=
new Float32Array(3));A.subtract(b,a,E);A.transformQuat(E,c,E);A.subtract(b,E,d)};a.Ty=function(){E[0]=0;E[1]=0;E[2]=0;var a=new Float32Array(16),b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16);q.lookAt(E,[-1,0,0],[0,-1,0],a);q.scale(a,[-1,1,1],a);q.scale(a,[-1,1,-1],b);q.lookAt(E,[0,-1,0],[0,0,-1],c);q.scale(c,[1,1,-1],c);q.scale(c,[1,-1,-1],d);q.lookAt(E,[0,0,-1],[0,-1,0],e);q.scale(e,[-1,1,1],e);q.scale(e,[-1,1,-1],f);return[a,b,
c,d,e,f]};a.Xy=function(){E[0]=0;E[1]=0;E[2]=0;var a=new Float32Array(16),b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16);q.lookAt(E,[1,0,0],[0,-1,0],a);q.scale(a,[-1,1,-1],b);q.lookAt(E,[0,1,0],[0,0,1],c);q.scale(c,[1,-1,-1],d);q.lookAt(E,[0,0,1],[0,-1,0],e);q.scale(e,[-1,1,-1],f);return[a,b,c,d,e,f]};a.oh=function(a,b){return e(a,b)};a.hash_code=e;a.lF=m;a.HF=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f,g,h,k,l,m,n,v,q,r,t,u;if(!c||
a===c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;f=a[0];g=a[1];h=a[2];k=a[3];l=a[4];m=a[5];n=a[6];v=a[7];q=a[8];r=a[9];t=a[10];u=a[11];c[0]=f;c[1]=g;c[2]=h;c[3]=k;c[4]=l;c[5]=m;c[6]=n;c[7]=v;c[8]=q;c[9]=r;c[10]=t;c[11]=u;c[12]=f*d+l*e+q*b+a[12];c[13]=g*d+m*e+r*b+a[13];c[14]=h*d+n*e+t*b+a[14];c[15]=k*d+v*e+u*b+a[15];return c};a.uA=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=
a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.quat_to_angle_axis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.wl=function(a){return a*Math.PI/180};a.gy=function(a){return 180*a/Math.PI};a.Ko=function(a){var b=.366025403784439*a[0]+.366025403784439*
a[1],c=Math.floor(a[0]+b),d=Math.floor(a[1]+b),e=.211324865405187*c+.211324865405187*d,b=a[0]-c+e;a=a[1]-d+e;var f=b>a?1:0,g=1-f,e=b+.211324865405187-f,k=a+.211324865405187-g,l=b+-.577350269189626,m=a+-.577350269189626,c=c%289,d=d%289,v=h(h(d)+c),g=h(h(d+g)+c+f),q=h(h(d+1)+c+1),c=Math.max(.5-(b*b+a*a),0),d=Math.max(.5-(e*e+k*k),0),f=Math.max(.5-(l*l+m*m),0),r=2*n(.024390243902439*v)-1,t=2*n(.024390243902439*g)-1,u=2*n(.024390243902439*q)-1,v=Math.abs(r)-.5,g=Math.abs(t)-.5,q=Math.abs(u)-.5,r=r-Math.floor(r+
.5),t=t-Math.floor(t+.5),u=u-Math.floor(u+.5),c=c*c*c*c*(1.79284291400159-.85373472095314*(r*r+v*v)),d=d*d*d*d*(1.79284291400159-.85373472095314*(t*t+g*g)),f=f*f*f*f*(1.79284291400159-.85373472095314*(u*u+q*q));return 130*(c*(r*b+v*a)+d*(t*e+g*k)+f*(u*l+q*m))};a.sq=function(a){var b=1/7,c=b/2,d=k(Math.floor(a[0])),e=k(Math.floor(a[1])),g=n(a[0]);a=n(a[1]);var h=g-.5,l=g-1.5,g=a-.5;a-=1.5;var m=f(d),v=f(d+1),q=m,d=v,m=f(m+e),v=f(v+e),q=f(q+e+1),d=f(d+e+1),e=h+.7*(r(m)*b+c),t=l+.7*(r(v)*b+c),h=h+.7*
(r(q)*b+c),l=l+.7*(r(d)*b+c),m=g+.7*(r(Math.floor(m*b))*b+c),g=g+.7*(r(Math.floor(v*b))*b+c),q=a+.7*(r(Math.floor(q*b))*b+c),b=a+.7*(r(Math.floor(d*b))*b+c);return Math.min(e*e+m*m,t*t+g*g,h*h+q*q,l*l+b*b)};a.quat_project=function(a,b,c,d,e){e||(e=new Float32Array(4));a=A.transformQuat(b,a,E);b=c[0];var f=c[1];c=c[2];I[0]=f*f+c*c;I[1]=-f*b;I[2]=-c*b;I[3]=-b*f;I[4]=b*b+c*c;I[5]=-c*f;I[6]=-b*c;I[7]=-f*c;I[8]=b*b+f*f;A.transformMat3(a,I,a);A.normalize(a,a);u.rotationTo(d,a,e);return e};a.cam_quat_to_mesh_quat=
function(a,b){b||(b=new Float32Array(4));var c=K,d=Q,c=u.setAxisAngle([0,1,0],Math.PI,u.create()),d=u.setAxisAngle([1,0,0],Math.PI/2,u.create());u.multiply(c,d,c);u.multiply(a,c,b);return b};a.cleanup=function(){L=0;J={}};a.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};a.smooth=function(a,b,c,d){c=Math.exp(-c/d);return(1-c)*a+c*b};a.smooth_v=function(a,b,c,d,e){e||(e=new Float32Array(a.length));c=Math.exp(-c/d);for(d=0;d<e.length;d++)e[d]=(1-c)*a[d]+c*b[d];return e};a.yt=function(a,b,c,
d,e){e||(e=new Float32Array(a.length));u.slerp(a,b,Math.exp(-c/d),e)};a.sF=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.is_vector=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.correct_cam_quat_up=function(a,b){var c=g.fromQuat(a,I);M[0]=0;M[1]=1;M[2]=0;E[0]=c[3];E[1]=c[4];E[2]=c[5];var d=A.cross(M,E,E);A.normalize(d,d);var e=c[7];!b&&0<e&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);M[0]=c[0];
M[1]=c[1];M[2]=c[2];A.normalize(M,M);u.rotationTo(M,d,Q);u.multiply(Q,a,a)};a.pr=function(a,b,c,d){c=c*b-.5;var e=d*b-.5;d=c-Math.floor(c);var f=e-Math.floor(e);c=Math.floor(c);var e=Math.floor(e),g=b-1,h=a[e*b+c],k=a[e*b+Math.min(c+1,g)],l=a[Math.min(e+1,g)*b+c];a=a[Math.min(e+1,g)*b+Math.min(c+1,g)];return(h*(1-d)+k*d)*(1-f)+(l*(1-d)+a*d)*f};a.Rg=function(a){for(var b=0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.et=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<c)&&(b[2-c]=1);return b};a.Jj=function(a,
b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.mr=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.Ed=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.random_from_array=function(a){if(!a.length)return null;var b=Math.floor(Math.random()*a.length);return a[b]};a.xz_direction=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-b[0];c[1]=0;c[2]=a[2]-b[2];A.normalize(c,
c)};a.HC=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1],h=b[2];b=b[3];var k=g*a-h*e,l=h*d-f*a,m=f*e-g*d,n=g*m-h*l,h=h*k-f*m,f=f*l-g*k;c[0]=d+2*k*b+2*n;c[1]=e+2*l*b+2*h;c[2]=a+2*m*b+2*f};a.assert=function(a){if(!a)throw Error("Assertion failed");};a.ha=function(a){a&&t.error.apply(t,arguments);throw"panic: see above for possible error messages";};a.angle_wrap_periodic=y;a.angle_wrap_0_2pi=w;a.sn=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.Kt=function(a,b){for(var c in a){var d=!0,
e=a[c],f=b[c];switch(typeof e){case "number":case "string":case "boolean":d=e==f;break;case "object":d=C(e,f)}if(!d)return!1}return!0};a.vo=function(a,b){var c=a[0],d=a[2],e=a[3];b[0]=a[1];b[1]=d;b[2]=e;b[3]=c};a.kr=function(a){a+=1;132651<a&&t.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var c=Math.floor(a/51);return new Float32Array([b/51,c/51,a%51/51])};a.line_plane_intersect=function(a,b,c,d,e){K.set(a);K[3]=b;Q.set(d);Q[3]=0;a=x.dot(K,Q);if(0==a)return null;Q.set(c);Q[3]=
1;a=-x.dot(K,Q)/a;e[0]=c[0]+a*d[0];e[1]=c[1]+a*d[1];e[2]=c[2]+a*d[2];return e};a.vz=function(a,b,c,d){var e=b[0]-a[0],f=c[0]-a[0],g=b[1]-a[1],h=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=g*a-b*h;d[1]=f*b-e*a;d[2]=e*h-g*f;return d};a.AE=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.rB=function(a,b,c){var d=A.dot(a,b);-.9999999>d?(A.cross(U,a,E),1E-6>A.length(E)&&A.cross(ca,a,E),A.normalize(E,E),u.setAxisAngle(E,Math.PI,c)):(A.cross(a,b,E),c.set(E),c[3]=1+d,u.normalize(c,c));return c};
a.Ue=function(a,b,c){if(b==c)return c-a;a=w(a);b=w(b);c=w(c);var d=Math.abs(b-c);if(.001>d||.001>Math.abs(d-2*Math.PI))return 0;b=2*Math.PI-b;c=w(c+b);a=w(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.smooth_step=function(a,b,c){isFinite(b)&&isFinite(c)&&(a=clamp(a,b,c));return a*a*(3-2*a)};a.lerp=function(a,b,c){return b+a*(c-b)};a.tw=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;return!1};a.EE=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return b};
a.ju=function(a,b){for(var d=Math.max(a.length,b.length),e=0;e<d;e++){var f=c((e>=a.length?0:a[e])-(e>=b.length?0:b[e]));if(f)return f}return 0};a.Jf=function(a){return a.join(".")};a.Jt=function(a){return a.split(".").map(function(a){return a|0})};a.Ft=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2)};a.Vn=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.il=function(a){var b=a.split("://",2);return 1<b.length?
(b[1]=G(b[1]),b.join("://")):G(a)}};b4w.module.__sfx=function(a,p){function c(){var a=window.AudioContext||window.webkitAudioContext;if(a){a=new a;if(a.createGain)return a;D.warn("deprecated WebAudio implementation");return null}D.warn("WebAudio is not supported");return null}function d(a,c,d){var e=a.c.o;if("NONE"!=e.behavior){d||(d=0);var f=e.loop,g=e.pitch;if(e.src&&(f||0<=d)){e.km=Math.floor(5E4*Math.random());var k=E.currentTime+c;e.Kc=k;e.state=20;b(a);"POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior?(c=E.createBufferSource(),
c.buffer=e.src,c.playbackRate.value=g,f?(e.xb&&e.xb.disconnect(),c.loop=!0,c.start(k),e.duration=0):(f=c.buffer?c.buffer.duration:0,d>f?(f=k+d+e.Xc,c.loop=!0,c.start(k),c.stop(f),e.duration=d):(c.loop=!1,c.start(k),e.duration=f)),c.connect(e.lc),e.xb=c,l(e),m(e)):"BACKGROUND_MUSIC"==e.behavior&&(G.clear_timeout(e.om),G.clear_timeout(e.pm),d=function(){var b=a.c.o,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.xb=b.xb||E.createMediaElementSource(c),b.xb.connect(b.lc),20==b.state&&(c.currentTime&&(c.currentTime=
0),c.play()))},0==c?d():e.om=G.set_timeout(d,1E3*c),e.duration=f?0:w(a));h(e,k)}}}function b(a){var b=a.c.o;if(!b.lc){var c=a.c.g.i;a=a.c.g.quat;if(x.fl){var d=E.createBiquadFilter();d.type="peaking"}else d=null;var e=E.createGain();switch(b.behavior){case "POSITIONAL":var f=E.createPanner();"string"!=typeof f.panningModel?(f.panningModel=f.EQUALPOWER,f.distanceModel=f.INVERSE_DISTANCE):(f.panningModel="equalpower",f.distanceModel="inverse");f.setPosition(c[0],c[1],c[2]);A.copy(c,b.Rn);c=u;t.quat_to_dir(a,
t.AXIS_MY,c);f.setOrientation(c[0],c[1],c[2]);A.copy(c,b.direction);f.refDistance=b.dist_ref;f.maxDistance=b.dist_max;f.rolloffFactor=b.attenuation;f.coneInnerAngle=b.ox;f.coneOuterAngle=b.px;f.coneOuterGain=b.qx;var g=E.createGain();g.gain.value=y(b);d?(f.connect(d),d.connect(g)):f.connect(g);g.connect(e);b.lc=f;if(b.xi){var h=E.createGain();e.connect(h);h.connect(E?M.ca.lc:null)}else h=null,e.connect(E?M.ca.lc:null);break;case "BACKGROUND_SOUND":f=null;g=E.createGain();g.gain.value=y(b);d?(b.lc=
d,d.connect(g)):b.lc=g;g.connect(e);b.xi?(h=E.createGain(),e.connect(h),h.connect(E?M.ca.lc:null)):(h=null,e.connect(E?M.ca.lc:null));break;case "BACKGROUND_MUSIC":h=f=null,g=E.createGain(),g.gain.value=y(b),d?(b.lc=d,d.connect(g)):b.lc=g,g.connect(e),e.connect(E?M.ca.lc:null)}b.zj=f;b.Dd=d;b.Bh=g;b.gg=e;b.Us=h}}function e(a){var b=a.c.o,c=b.duration,b=b.delay+b.hy*Math.random();d(a,b,c)}function l(a){a.xi&&a.Us.gain.cancelScheduledValues(a.Kc);a.Cj&&a.xb.playbackRate.cancelScheduledValues(a.Kc);
a.Wj=a.Kc}function m(a){if(a.xi||a.Cj){var b=a.Us,c=a.xb,d=c.buffer?c.buffer.duration:0;if(d){var e=a.Kc;Q[0]=a.km;for(var f=0;5>f;){var g=a.pitch+a.Cj*t.bd(Q);if(e>=a.Wj){if(a.xi){var h=1-t.clamp(a.xi,0,1)*Math.random();b.gain.setValueAtTime(h,e)}a.Cj&&c.playbackRate.setValueAtTime(g,e);f++}e+=d/g}a.Wj=e-.001}}}function h(a,b){if(a.xh||a.Xc){var c=a.gg;c.gain.cancelScheduledValues(b);a.xh?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.xh)):c.gain.setValueAtTime(1,b);a.Xc&&!a.loop&&
(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.Xc))}}function n(a){if("SPEAKER"!=a.type)throw"Wrong object type";var b=a.c.o;if(20==b.state||40==b.state){var c=b.gg,d=E.currentTime;b.Xc&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.Xc));"BACKGROUND_MUSIC"==b.behavior?b.src&&(G.clear_timeout(b.om),G.clear_timeout(b.pm),b.pm=G.set_timeout(function(){var b=a.c.o.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.Xc)):(c=b.xb,
b.duration<c.buffer.duration?b.Xc&&20==b.state?c.stop(d+b.Xc):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.Kc=0,b.qo=0,b.wm=0);b.state=30}}function f(a){a=a.c.o;if(20==a.state){var b=E.currentTime;a.qo=b;if("BACKGROUND_MUSIC"==a.behavior){var c=a.src;c&&c.pause()}else{if(b>a.Kc){Q[0]=a.km;for(var d=a.xb.buffer.duration,e=a.Kc;e<b;)c=a.pitch+a.Cj*t.bd(Q),e+=d/c;c*=d/c-(e-b)}else c=0;a.wm=c;a.xb.stop(0);a.xb.disconnect();l(a)}a.state=40}}function k(a){var b=a.c.o;if(40==b.state){var c=E.currentTime;
b.Kc+=c-b.qo;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();else{a=a.c.o;var d=E.createBufferSource();d.loop=a.xb.loop;d.buffer=a.xb.buffer;d.playbackRate.value=a.xb.playbackRate.value;a.zj?d.connect(a.zj):d.connect(a.Bh);a.xb=d;b.Wj=c;b.xb.start(b.Kc,b.wm);m(b)}h(b,b.Kc);b.state=20}}function r(a){return!a.c.o||20!=a.c.o.state&&40!=a.c.o.state&&30!=a.c.o.state?!1:!0}function y(a){return a.muted?0:a.volume}function w(a){a=a.c.o;return(a=a.src)?a.duration:0}var C=p("__config"),D=p("__print"),G=p("__time"),
t=p("__util"),A=p("__vec3"),x=C.o;a.wp=10;a.Tl=20;a.vp=30;var u=new Float32Array(3),g=new Float32Array(3),q=new Float32Array(3),L=[],J=[],E=null,M=null,K=[],Q=[1],I=null;a.init=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(L.push("ogg"),L.push("ogv")),""!=a.canPlayType("audio/mpeg")&&L.push("mp3"),""!=a.canPlayType("audio/mp4")&&(L.push("mp4"),L.push("m4v")),""!=a.canPlayType("audio/webm")&&L.push("webm"));b.canPlayType&&
(""!=b.canPlayType("video/ogg")&&J.push("ogv"),""!=b.canPlayType("video/mp4")&&J.push("m4v"),""!=b.canPlayType("video/webm")&&J.push("webm"));(E=x.rp?c():null)&&D.log("%cINIT WEBAUDIO: "+E.sampleRate+"Hz","color: #00a")};a.Zp=function(a){var b={wg:new Float32Array(3),js:new Float32Array(3),Lh:new Float32Array(3)};a.ca=b;if(E){var c=E.createGain(),d=E.createGain();b.Bh=c;b.gg=d;c.connect(d);d.connect(E.destination);if(a.b4w_enable_dynamic_compressor){var d=E.createDynamicsCompressor(),e=a.b4w_dynamic_compressor_settings;
d.threshold.value=e.threshold;d.knee.value=e.knee;d.ratio.value=e.ratio;d.attack.value=e.attack;d.release.value=e.release;d.connect(c);b.Ri=d;b.lc=d}else b.Ri=null,b.lc=c;c=E.listener;b.th=C.r.Cm;b.th||(c.dopplerFactor=a.audio_doppler_factor,c.speedOfSound=a.audio_doppler_speed);b.muted=!1;b.volume=1;b.fg=0}};a.BB=function(a){M=a};a.detect_audio_container=function(a){a||(a="ogg");return-1<L.indexOf(a)?a:"ogg"==a&&-1<L.indexOf("mp4")?"mp4":"mp3"==a&&-1<L.indexOf("ogg")?"ogg":"mp4"==a&&-1<L.indexOf("ogg")?
"ogg":"ogv"==a&&-1<L.indexOf("m4v")?"m4v":"webm"==a&&-1<L.indexOf("m4v")?"m4v":"m4v"==a&&-1<L.indexOf("webm")?"webm":""};a.detect_video_container=function(a){a||(a="webm");return-1<J.indexOf(a)?a:"ogv"==a&&-1<J.indexOf("m4v")?"m4v":"webm"==a&&-1<J.indexOf("m4v")?"m4v":"m4v"==a&&-1<J.indexOf("webm")?"webm":""};a.append_object=function(a){if("SPEAKER"!=a.type)throw"Wrong speaker object";var b=a.data;a.c.o={};switch(b.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":a.c.o.behavior=E?b.b4w_behavior:
"NONE";break;case "BACKGROUND_MUSIC":var c=a.c.o,d;E?(window.MediaElementAudioSourceNode?d=!0:(D.warn("MediaElementAudioSourceNode not found"),d=!1),d=d?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):d="NONE";c.behavior=d;break;default:throw"Wrong speaker behavior";}b.sound||(a.c.o.behavior="NONE");a.c.o.th=b.b4w_disable_doppler&&C.r.Cm;a.c.o.muted=b.muted;a.c.o.volume=b.volume;a.c.o.pitch=b.pitch;a.c.o.attenuation=b.attenuation;a.c.o.dist_ref=b.distance_reference;a.c.o.dist_max=b.distance_max||1E4;a.c.o.ox=
b.cone_angle_inner;a.c.o.px=b.cone_angle_outer;a.c.o.qx=b.cone_volume_outer;a.c.o.cyclic=b.b4w_cyclic_play;a.c.o.loop=b.b4w_loop;a.c.o.delay=b.b4w_delay;a.c.o.hy=b.b4w_delay_random;a.c.o.xi=b.b4w_volume_random;a.c.o.Cj=b.b4w_pitch_random;a.c.o.xh=b.b4w_fade_in;a.c.o.Xc=b.b4w_fade_out;a.c.o.Kc=0;a.c.o.qo=0;a.c.o.wm=0;a.c.o.duration=0;a.c.o.Wj=0;a.c.o.km=1;a.c.o.src=null;a.c.o.state=10;a.c.o.Rn=new Float32Array(3);a.c.o.direction=new Float32Array(3);a.c.o.No=new Float32Array(3);a.c.o.om=-1;a.c.o.pm=
-1;a.c.o.fg=0;K.push(a)};a.At=function(b){if("SPEAKER"!=b.type)throw"Wrong object type";switch(b.c.o.behavior){case "POSITIONAL":return a.Tl;case "BACKGROUND_SOUND":return a.Tl;case "BACKGROUND_MUSIC":return a.vp;case "NONE":return a.wp;default:throw"Wrong speaker behavior";}};a.fD=function(a,b){var c=a.c.o;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:throw"Wrong speaker behavior";}};a.RA=function(){var a=E.createBufferSource();
a.buffer=E.createBuffer(1,22050,22050);a.connect(E.destination);a.start(0)};a.dy=function(a,b,c){E?E.decodeAudioData(a,b,c):c()};a.gC=function(a){n(a);a.c.o=null;K.splice(K.indexOf(a),1)};a.cleanup=function(){for(var a=0;a<K.length;a++){var b=K[a].c.o;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():b.xb&&b.xb.disconnect()}M&&M.ca&&(a=M.ca,a.wg[0]=0,a.wg[1]=0,a.wg[2]=0,a.Lh[0]=0,a.Lh[1]=0,a.Lh[2]=0);M=null;K.splice(0);I=null};a.update=function(a){if(E&&0!=K.length){for(var b=0;b<K.length;b++){var c=
K[b],d=c.c.o,f=E.currentTime;E&&!d.loop&&d.cyclic&&20==d.state&&d.duration&&d.Kc+d.duration<f&&e(c);20==d.state&&3>d.Wj-f&&m(d)}I&&I.Ce.length&&(-1==I.Ua||a>I.Op+I.Wq[I.Ua])&&(b=I,-1<b.Ua&&n(b.Ce[b.Ua]),-1==b.Ua&&b.random?c=Math.round(Math.random()*(b.Ce.length-1)):b.random?(c=1+Math.round(Math.random()*(b.Ce.length-2)),c=(b.Ua+c)%b.Ce.length):c=(b.Ua+1)%b.Ce.length,e(b.Ce[c]),b.Ua=c,b.Op=a)}};a.play=d;a.play_def=e;a.stop=n;a.is_play=function(a){return 20==a.c.o.state};a.fC=f;a.hC=k;a.playrate=function(a,
b){var c=a.c.o;c.pitch=b;!r(a)||"POSITIONAL"!=c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.xb.playbackRate.value=b,l(c),m(c))};a.get_playrate=function(a){return a.c.o.pitch};a.cyclic=function(a,b){a.c.o.cyclic=Boolean(b)};a.is_cyclic=function(a){return a.c.o.cyclic};a.nA=function(a,b,c,d){if(E&&a.ca){var e=u;e[0]=0;e[1]=-1;e[2]=0;A.transformQuat(e,c,e);g[0]=0;g[1]=0;g[2]=-1;A.transformQuat(g,c,g);c=E.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(e[0],e[1],e[2],g[0],g[1],g[2]);A.copy(e,
a.ca.js);!a.ca.th&&d&&(q[0]=(b[0]-a.ca.wg[0])/d,q[1]=(b[1]-a.ca.wg[1])/d,q[2]=(b[2]-a.ca.wg[2])/d,t.smooth_v(q,a.ca.Lh,d,.3,q),c.setVelocity(q[0],q[1],q[2]),A.copy(q,a.ca.Lh));A.copy(b,a.ca.wg)}};a.listener_reset_speed=function(a,b){if(E&&M.ca&&!M.ca.th){var c=u;b?A.copy(b,c):A.copy(M.ca.js,c);A.scale(c,a,c);E.listener.setVelocity(c[0],c[1],c[2]);A.copy(c,M.ca.Lh)}};a.iC=function(a,b){var c=a.c.o;if(r(a)&&"POSITIONAL"==c.behavior){var d=a.c.g.i,e=c.zj;e.setPosition(d[0],d[1],d[2]);var f=u;t.quat_to_dir(a.c.g.quat,
t.AXIS_MY,f);e.setOrientation(f[0],f[1],f[2]);f=c.Rn;!c.th&&b&&(g[0]=(d[0]-f[0])/b,g[1]=(d[1]-f[1])/b,g[2]=(d[2]-f[2])/b,t.smooth_v(g,c.No,b,.3,g),e.setVelocity(g[0],g[1],g[2]),A.copy(g,c.No));A.copy(d,f)}};a.speaker_reset_speed=function(a,b,c){var d=a.c.o;if(r(a)&&"POSITIONAL"==d.behavior&&!d.th){var e=u;c?A.copy(c,e):A.copy(d.direction,e);A.scale(e,b,e);d.zj.setVelocity(e[0],e[1],e[2]);A.copy(e,d.No);A.copy(a.c.g.i,d.Rn)}};a.re=function(a){return a.c.o?!0:!1};a.wn=function(a){return a.c.o.behavior};
a.check_active_speakers=function(){for(var a=0;a<K.length;a++)if(r(K[a]))return!0;return!1};a.KB=function(a){var b=M.ca;b&&(b.volume=a,E&&(b.Bh.gain.value=y(b)))};a.uz=function(){var a=M.ca;return a?a.volume:0};a.set_volume=function(a,b){var c=a.c.o;c.volume=b;r(a)&&(c.Bh.gain.value=y(c))};a.get_volume=function(a){return a.c.o.volume};a.mute=function(a,b){a.c.o.muted=Boolean(b);r(a)&&(a.c.o.Bh.gain.value=y(a.c.o))};a.is_muted=function(a){return a.c.o.muted};a.DA=function(a){var b=M.ca;b&&(b.muted=
Boolean(a),E&&(b.Bh.gain.value=y(b)))};a.bA=function(){var a=M.ca;return a?a.muted:!1};a.get_speaker_objects=function(){return K};a.pause=function(){for(var a=0;a<K.length;a++)f(K[a])};a.resume=function(){for(var a=0;a<K.length;a++)k(K[a])};a.set_compressor_params=function(a,b){if(a.ca&&a.ca.Ri){var c=a.ca.Ri;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};a.get_compressor_params=function(a){if(!a.ca||!a.ca.Ri)return null;
a=a.ca.Ri;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.duck=function(a,b,c){if(r(a)){a=a.c.o;var d=a.gg,e=E.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,e+c);a.fg=c}};a.unduck=function(a){if(r(a)){a=a.c.o;var b=a.gg,c=E.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.fg);a.fg=0}};a.oy=function(a,b){if(E){var c=M.ca,d=c.gg,e=E.currentTime;d.gain.setValueAtTime(d.gain.value,
e);d.gain.linearRampToValueAtTime(a,e+b);c.fg=b}};a.KC=function(){if(E){var a=M.ca,b=a.gg,c=E.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.fg);a.fg=0}};a.apply_playlist=function(a,b,c){I={Ua:-1,Op:0,random:c,Ce:[],Wq:[]};for(c=0;c<a.length;c++){var d=a[c],e=w(d);0==e?D.warn("Ignoring speaker with zero duration: "+d.name):(n(d),d.c.o.cyclic=!1,I.Ce.push(d),I.Wq.push(e+b))}};a.get_duration=w;a.clear_playlist=function(){if(I)for(var a=I.Ce,b=0;b<a.length;b++)n(a[b]);
I=null};a.get_positional_params=function(a){return(a=a.c.o)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.set_positional_params=function(a,b){var c=a.c.o;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=b.dist_ref;c.dist_max=b.dist_max;c.attenuation=b.attenuation;var d=c.zj;d&&(d.refDistance=c.dist_ref,d.maxDistance=c.dist_max,d.rolloffFactor=c.attenuation)}};a.set_filter_params=function(a,b){var c=a.c.o;c&&c.Dd&&(c.Dd.frequency.value=b.freq,c.Dd.Q.value=
b.Q,c.Dd.gain.value=b.gain)};a.get_filter_params=function(a){return(a=a.c.o)&&a.Dd?{freq:a.Dd.frequency.value,Q:a.Dd.Q.value,gain:a.Dd.gain.value}:null};a.get_filter_freq_response=function(a,b,c,d){a=a.c.o;if(!a||!a.Dd)return null;a.Dd.getFrequencyResponse(b,c,d)}};b4w.module.__vec3=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array,c=Math.random;a.create=function(){var a=new p(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new p(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,c){var l=new p(3);l[0]=a;l[1]=b;l[2]=c;return l};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,c,l){l[0]=a;l[1]=b;l[2]=c;return l};a.add=function(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];
return c};a.subtract=function(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c};a.sub=a.subtract;a.multiply=function(a,b,c){c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];return c};a.mul=a.multiply;a.divide=function(a,b,c){c[0]=a[0]/b[0];c[1]=a[1]/b[1];c[2]=a[2]/b[2];return c};a.div=a.divide;a.min=function(a,b,c){c[0]=Math.min(a[0],b[0]);c[1]=Math.min(a[1],b[1]);c[2]=Math.min(a[2],b[2]);return c};a.max=function(a,b,c){c[0]=Math.max(a[0],b[0]);c[1]=Math.max(a[1],b[1]);c[2]=Math.max(a[2],
b[2]);return c};a.scale=function(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c};a.scaleAndAdd=function(a,b,c,l){l[0]=a[0]+b[0]*c;l[1]=a[1]+b[1]*c;l[2]=a[2]+b[2]*c;return l};a.distance=function(a,b){var c=b[0]-a[0],l=b[1]-a[1],m=b[2]-a[2];return Math.sqrt(c*c+l*l+m*m)};a.dist=a.distance;a.squaredDistance=function(a,b){var c=b[0]-a[0],l=b[1]-a[1],m=b[2]-a[2];return c*c+l*l+m*m};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var c=a[0],l=a[1],m=a[2],c=c*c+l*l+m*m;0<c&&(c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,c){var l=a[0],m=a[1];a=a[2];var h=b[0],n=b[1];b=b[2];
c[0]=m*b-a*n;c[1]=a*h-l*b;c[2]=l*n-m*h;return c};a.lerp=function(a,b,c,l){var m=a[0],h=a[1];a=a[2];l[0]=m+c*(b[0]-m);l[1]=h+c*(b[1]-h);l[2]=a+c*(b[2]-a);return l};a.random=function(a,b){a=a||1;var e=2*c()*Math.PI,l=2*c()-1,m=Math.sqrt(1-l*l)*a;b[0]=Math.cos(e)*m;b[1]=Math.sin(e)*m;b[2]=l*a;return b};a.transformMat4=function(a,b,c){var l=a[0],m=a[1];a=a[2];var h=b[3]*l+b[7]*m+b[11]*a+b[15],h=h||1;c[0]=(b[0]*l+b[4]*m+b[8]*a+b[12])/h;c[1]=(b[1]*l+b[5]*m+b[9]*a+b[13])/h;c[2]=(b[2]*l+b[6]*m+b[10]*a+b[14])/
h;return c};a.transformMat3=function(a,b,c){var l=a[0],m=a[1];a=a[2];c[0]=l*b[0]+m*b[3]+a*b[6];c[1]=l*b[1]+m*b[4]+a*b[7];c[2]=l*b[2]+m*b[5]+a*b[8];return c};a.transformQuat=function(a,b,c){var l=a[0],m=a[1],h=a[2];a=b[0];var n=b[1],f=b[2];b=b[3];var k=b*l+n*h-f*m,r=b*m+f*l-a*h,p=b*h+a*m-n*l,l=-a*l-n*m-f*h;c[0]=k*b+l*-a+r*-f-p*-n;c[1]=r*b+l*-n+p*-a-k*-f;c[2]=p*b+l*-f+k*-n-r*-a;return c};a.rotateX=function(a,b,c,l){var m=[],h=[];m[0]=a[0]-b[0];m[1]=a[1]-b[1];m[2]=a[2]-b[2];h[0]=m[0];h[1]=m[1]*Math.cos(c)-
m[2]*Math.sin(c);h[2]=m[1]*Math.sin(c)+m[2]*Math.cos(c);l[0]=h[0]+b[0];l[1]=h[1]+b[1];l[2]=h[2]+b[2];return l};a.rotateY=function(a,b,c,l){var m=[],h=[];m[0]=a[0]-b[0];m[1]=a[1]-b[1];m[2]=a[2]-b[2];h[0]=m[2]*Math.sin(c)+m[0]*Math.cos(c);h[1]=m[1];h[2]=m[2]*Math.cos(c)-m[0]*Math.sin(c);l[0]=h[0]+b[0];l[1]=h[1]+b[1];l[2]=h[2]+b[2];return l};a.rotateZ=function(a,b,c,l){var m=[],h=[];m[0]=a[0]-b[0];m[1]=a[1]-b[1];m[2]=a[2]-b[2];h[0]=m[0]*Math.cos(c)-m[1]*Math.sin(c);h[1]=m[0]*Math.sin(c)+m[1]*Math.cos(c);
h[2]=m[2];l[0]=h[0]+b[0];l[1]=h[1]+b[1];l[2]=h[2]+b[2];return l};a.forEach=function(){var c=a.create();return function(a,e,l,m,h,n){e||(e=3);l||(l=0);for(m=m?Math.min(m*e+l,a.length):a.length;l<m;l+=e)c[0]=a[l],c[1]=a[l+1],c[2]=a[l+2],h(c,n,c),a[l]=c[0],a[l+1]=c[1],a[l+2]=c[2];return a}}();a.cE=function(c,b){var e=a.fromValues(c[0],c[1],c[2]),l=a.fromValues(b[0],b[1],b[2]);a.normalize(e,e);a.normalize(l,l);e=a.dot(e,l);return 1<e?0:Math.acos(e)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+
a[2]+")"};"undefined"!==typeof a&&(a.vec3=a)};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array,c=Math.random;a.create=function(){var a=new p(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new p(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,c,l){var m=new p(4);m[0]=a;m[1]=b;m[2]=c;m[3]=l;return m};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,c,l,m){m[0]=a;m[1]=b;m[2]=c;m[3]=l;return m};a.add=function(a,b,c){c[0]=
a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c};a.subtract=function(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];return c};a.sub=a.subtract;a.multiply=function(a,b,c){c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];c[3]=a[3]*b[3];return c};a.mul=a.multiply;a.divide=function(a,b,c){c[0]=a[0]/b[0];c[1]=a[1]/b[1];c[2]=a[2]/b[2];c[3]=a[3]/b[3];return c};a.div=a.divide;a.min=function(a,b,c){c[0]=Math.min(a[0],b[0]);c[1]=Math.min(a[1],b[1]);c[2]=Math.min(a[2],b[2]);c[3]=
Math.min(a[3],b[3]);return c};a.max=function(a,b,c){c[0]=Math.max(a[0],b[0]);c[1]=Math.max(a[1],b[1]);c[2]=Math.max(a[2],b[2]);c[3]=Math.max(a[3],b[3]);return c};a.scale=function(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c};a.scaleAndAdd=function(a,b,c,l){l[0]=a[0]+b[0]*c;l[1]=a[1]+b[1]*c;l[2]=a[2]+b[2]*c;l[3]=a[3]+b[3]*c;return l};a.distance=function(a,b){var c=b[0]-a[0],l=b[1]-a[1],m=b[2]-a[2],h=b[3]-a[3];return Math.sqrt(c*c+l*l+m*m+h*h)};a.dist=a.distance;a.squaredDistance=
function(a,b){var c=b[0]-a[0],l=b[1]-a[1],m=b[2]-a[2],h=b[3]-a[3];return c*c+l*l+m*m+h*h};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],c=a[1],l=a[2];a=a[3];return Math.sqrt(b*b+c*c+l*l+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],c=a[1],l=a[2];a=a[3];return b*b+c*c+l*l+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var c=a[0],l=a[1],m=a[2],h=a[3],c=c*c+l*l+m*m+h*h;0<c&&(c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c,b[3]=a[3]*c);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,c,l){var m=a[0],h=a[1],n=a[2];a=a[3];l[0]=m+c*(b[0]-m);l[1]=h+c*(b[1]-h);l[2]=n+c*(b[2]-n);l[3]=a+c*(b[3]-a);return l};a.random=function(d,b){d=d||1;b[0]=c();b[1]=c();b[2]=c();b[3]=c();a.normalize(b,b);a.scale(b,d,b);return b};a.transformMat4=function(a,b,c){var l=a[0],
m=a[1],h=a[2];a=a[3];c[0]=b[0]*l+b[4]*m+b[8]*h+b[12]*a;c[1]=b[1]*l+b[5]*m+b[9]*h+b[13]*a;c[2]=b[2]*l+b[6]*m+b[10]*h+b[14]*a;c[3]=b[3]*l+b[7]*m+b[11]*h+b[15]*a;return c};a.transformQuat=function(a,b,c){var l=a[0],m=a[1],h=a[2],n=b[0],f=b[1],k=b[2];b=b[3];var r=b*l+f*h-k*m,p=b*m+k*l-n*h,w=b*h+n*m-f*l,l=-n*l-f*m-k*h;c[0]=r*b+l*-n+p*-k-w*-f;c[1]=p*b+l*-f+w*-n-r*-k;c[2]=w*b+l*-k+r*-f-p*-n;c[3]=a[3];return c};a.forEach=function(){var c=a.create();return function(a,e,l,m,h,n){e||(e=4);l||(l=0);for(m=m?Math.min(m*
e+l,a.length):a.length;l<m;l+=e)c[0]=a[l],c[1]=a[l+1],c[2]=a[l+2],c[3]=a[l+3],h(c,n,c),a[l]=c[0],a[l+1]=c[1],a[l+2]=c[2],a[l+3]=c[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=a)};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,p){var c=p("__vec3"),d=p("__vec4"),b=p("__mat3"),e="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=c.create(),d=c.fromValues(1,0,0),e=c.fromValues(0,1,0);return function(n,f,k){var r=c.dot(n,f);if(-.9999999>r)return c.cross(d,n,b),1E-6>c.length(b)&&c.cross(e,n,b),c.normalize(b,b),a.setAxisAngle(b,Math.PI,k),k;if(.9999999<r)return k[0]=0,k[1]=0,k[2]=0,k[3]=1,k;c.cross(n,
f,b);k[0]=b[0];k[1]=b[1];k[2]=b[2];k[3]=1+r;return a.normalize(k,k)}}();a.setAxes=function(){var c=b.create();return function(b,d,e,f){c[0]=d[0];c[3]=d[1];c[6]=d[2];c[1]=e[0];c[4]=e[1];c[7]=e[2];c[2]=-b[0];c[5]=-b[1];c[8]=-b[2];return a.normalize(a.fromMat3(c,f),f)}}();a.clone=d.clone;a.fromValues=d.fromValues;a.copy=d.copy;a.set=d.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,c){b*=.5;var d=Math.sin(b);c[0]=d*a[0];c[1]=d*a[1];c[2]=d*a[2];c[3]=Math.cos(b);
return c};a.add=d.add;a.multiply=function(a,b,c){var d=a[0],e=a[1],k=a[2];a=a[3];var r=b[0],p=b[1],w=b[2];b=b[3];c[0]=d*b+a*r+e*w-k*p;c[1]=e*b+a*p+k*r-d*w;c[2]=k*b+a*w+d*p-e*r;c[3]=a*b-d*r-e*p-k*w;return c};a.mul=a.multiply;a.scale=d.scale;a.rotateX=function(a,b,c){b*=.5;var d=a[0],e=a[1],k=a[2];a=a[3];var r=Math.sin(b);b=Math.cos(b);c[0]=d*b+a*r;c[1]=e*b+k*r;c[2]=k*b-e*r;c[3]=a*b-d*r;return c};a.rotateY=function(a,b,c){b*=.5;var d=a[0],e=a[1],k=a[2];a=a[3];var r=Math.sin(b);b=Math.cos(b);c[0]=d*
b-k*r;c[1]=e*b+a*r;c[2]=k*b+d*r;c[3]=a*b-e*r;return c};a.rotateZ=function(a,b,c){b*=.5;var d=a[0],e=a[1],k=a[2];a=a[3];var r=Math.sin(b);b=Math.cos(b);c[0]=d*b+e*r;c[1]=e*b-d*r;c[2]=k*b+a*r;c[3]=a*b-k*r;return c};a.calculateW=function(a,b){var c=a[0],d=a[1],e=a[2];b[0]=c;b[1]=d;b[2]=e;b[3]=Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};a.dot=d.dot;a.lerp=d.lerp;a.slerp=function(a,b,c,d){var e=a[0],k=a[1],r=a[2];a=a[3];var p=b[0],w=b[1],C=b[2];b=b[3];var D,G,t;G=e*p+k*w+r*C+a*b;0>G&&(G=-G,p=-p,w=-w,
C=-C,b=-b);1E-6<1-G?(D=Math.acos(G),t=Math.sin(D),G=Math.sin((1-c)*D)/t,c=Math.sin(c*D)/t):G=1-c;d[0]=G*e+c*p;d[1]=G*k+c*w;d[2]=G*r+c*C;d[3]=G*a+c*b;return d};a.invert=function(a,b){var c=a[0],d=a[1],e=a[2],k=a[3],r=c*c+d*d+e*e+k*k,r=r?1/r:0;b[0]=-c*r;b[1]=-d*r;b[2]=-e*r;b[3]=k*r;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};a.length=d.length;a.len=a.length;a.squaredLength=d.squaredLength;a.sqrLen=a.squaredLength;a.normalize=d.normalize;a.fromMat3=function(a,
b){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),b[3]=.5*c,c=.5/c,b[0]=(a[5]-a[7])*c,b[1]=(a[6]-a[2])*c,b[2]=(a[1]-a[3])*c;else{var d=0;a[4]>a[0]&&(d=1);a[8]>a[3*d+d]&&(d=2);var e=(d+1)%3,k=(d+2)%3,c=Math.sqrt(a[3*d+d]-a[3*e+e]-a[3*k+k]+1);b[d]=.5*c;c=.5/c;b[3]=(a[3*e+k]-a[3*k+e])*c;b[e]=(a[3*e+d]+a[3*d+e])*c;b[k]=(a[3*k+d]+a[3*d+k])*c}return b};a.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.quat=a)};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new p(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[4];d[4]=a[5];d[5]=a[6];d[6]=a[8];d[7]=a[9];d[8]=a[10];return d};a.clone=function(a){var d=new p(9);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.copy=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=
a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,d){if(d===a){var b=a[1],e=a[2],l=a[5];d[1]=a[3];d[2]=a[6];d[3]=b;d[5]=a[7];d[6]=e;d[7]=l}else d[0]=a[0],d[1]=a[3],d[2]=a[6],d[3]=a[1],d[4]=a[4],d[5]=a[7],d[6]=a[2],d[7]=a[5],d[8]=a[8];return d};a.invert=function(a,d){var b=a[0],e=a[1],l=a[2],m=a[3],h=a[4],n=a[5],f=a[6],k=a[7],r=a[8],p=r*h-n*k,w=-r*m+n*f,C=
k*m-h*f,D=b*p+e*w+l*C;if(!D)return null;D=1/D;d[0]=p*D;d[1]=(-r*e+l*k)*D;d[2]=(n*e-l*h)*D;d[3]=w*D;d[4]=(r*b-l*f)*D;d[5]=(-n*b+l*m)*D;d[6]=C*D;d[7]=(-k*b+e*f)*D;d[8]=(h*b-e*m)*D;return d};a.adjoint=function(a,d){var b=a[0],e=a[1],l=a[2],m=a[3],h=a[4],n=a[5],f=a[6],k=a[7],r=a[8];d[0]=h*r-n*k;d[1]=l*k-e*r;d[2]=e*n-l*h;d[3]=n*f-m*r;d[4]=b*r-l*f;d[5]=l*m-b*n;d[6]=m*k-h*f;d[7]=e*f-b*k;d[8]=b*h-e*m;return d};a.determinant=function(a){var d=a[3],b=a[4],e=a[5],l=a[6],m=a[7],h=a[8];return a[0]*(h*b-e*m)+a[1]*
(-h*d+e*l)+a[2]*(m*d-b*l)};a.multiply=function(a,d,b){var e=a[0],l=a[1],m=a[2],h=a[3],n=a[4],f=a[5],k=a[6],r=a[7];a=a[8];var p=d[0],w=d[1],C=d[2],D=d[3],G=d[4],t=d[5],A=d[6],x=d[7];d=d[8];b[0]=p*e+w*h+C*k;b[1]=p*l+w*n+C*r;b[2]=p*m+w*f+C*a;b[3]=D*e+G*h+t*k;b[4]=D*l+G*n+t*r;b[5]=D*m+G*f+t*a;b[6]=A*e+x*h+d*k;b[7]=A*l+x*n+d*r;b[8]=A*m+x*f+d*a;return b};a.mul=a.multiply;a.translate=function(a,d,b){var e=a[0],l=a[1],m=a[2],h=a[3],n=a[4],f=a[5],k=a[6],r=a[7];a=a[8];var p=d[0];d=d[1];b[0]=e;b[1]=l;b[2]=m;
b[3]=h;b[4]=n;b[5]=f;b[6]=p*e+d*h+k;b[7]=p*l+d*n+r;b[8]=p*m+d*f+a;return b};a.rotate=function(a,d,b){var e=a[0],l=a[1],m=a[2],h=a[3],n=a[4],f=a[5],k=a[6],r=a[7];a=a[8];var p=Math.sin(d);d=Math.cos(d);b[0]=d*e+p*h;b[1]=d*l+p*n;b[2]=d*m+p*f;b[3]=d*h-p*e;b[4]=d*n-p*l;b[5]=d*f-p*m;b[6]=k;b[7]=r;b[8]=a;return b};a.scale=function(a,d,b){var e=d[0];d=d[1];b[0]=e*a[0];b[1]=e*a[1];b[2]=e*a[2];b[3]=d*a[3];b[4]=d*a[4];b[5]=d*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.Ny=function(a,d){d[0]=1;d[1]=0;d[2]=
0;d[3]=0;d[4]=1;d[5]=0;d[6]=a[0];d[7]=a[1];d[8]=1;return d};a.Ly=function(a,d){var b=Math.sin(a),e=Math.cos(a);d[0]=e;d[1]=b;d[2]=0;d[3]=-b;d[4]=e;d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.My=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=a[1];d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.fromMat2d=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=0;d[3]=a[2];d[4]=a[3];d[5]=0;d[6]=a[4];d[7]=a[5];d[8]=1;return d};a.fromQuat=function(a,d){var b=a[0],e=a[1],l=a[2],m=a[3],h=b+b,n=e+e,f=l+l,b=b*h,k=e*h,e=e*n,r=l*h,p=
l*n,l=l*f,h=m*h,n=m*n,m=m*f;d[0]=1-e-l;d[3]=k-m;d[6]=r+n;d[1]=k+m;d[4]=1-b-l;d[7]=p-h;d[2]=r-n;d[5]=p+h;d[8]=1-b-e;return d};a.normalFromMat4=function(a,d){var b=a[0],e=a[1],l=a[2],m=a[3],h=a[4],n=a[5],f=a[6],k=a[7],r=a[8],p=a[9],w=a[10],C=a[11],D=a[12],G=a[13],t=a[14],A=a[15],x=b*n-e*h,u=b*f-l*h,g=b*k-m*h,q=e*f-l*n,L=e*k-m*n,J=l*k-m*f,E=r*G-p*D,M=r*t-w*D,r=r*A-C*D,K=p*t-w*G,p=p*A-C*G,w=w*A-C*t,C=x*w-u*p+g*K+q*r-L*M+J*E;if(!C)return null;C=1/C;d[0]=(n*w-f*p+k*K)*C;d[1]=(f*r-h*w-k*M)*C;d[2]=(h*p-n*
r+k*E)*C;d[3]=(l*p-e*w-m*K)*C;d[4]=(b*w-l*r+m*M)*C;d[5]=(e*r-b*p-m*E)*C;d[6]=(G*J-t*L+A*q)*C;d[7]=(t*g-D*J-A*u)*C;d[8]=(D*L-G*g+A*x)*C;return d};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.Ky=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=a)};
b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new p(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var d=new p(16);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.copy=function(a,d){d[0]=a[0];
d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,d){if(d===a){var b=a[1],e=a[2],l=a[3],m=a[6],h=a[7],n=a[11];d[1]=a[4];d[2]=a[8];d[3]=a[12];d[4]=b;d[6]=a[9];d[7]=a[13];d[8]=e;d[9]=m;d[11]=a[14];d[12]=l;d[13]=
h;d[14]=n}else d[0]=a[0],d[1]=a[4],d[2]=a[8],d[3]=a[12],d[4]=a[1],d[5]=a[5],d[6]=a[9],d[7]=a[13],d[8]=a[2],d[9]=a[6],d[10]=a[10],d[11]=a[14],d[12]=a[3],d[13]=a[7],d[14]=a[11],d[15]=a[15];return d};a.invert=function(a,d){var b=a[0],e=a[1],l=a[2],m=a[3],h=a[4],n=a[5],f=a[6],k=a[7],r=a[8],p=a[9],w=a[10],C=a[11],D=a[12],G=a[13],t=a[14],A=a[15],x=b*n-e*h,u=b*f-l*h,g=b*k-m*h,q=e*f-l*n,L=e*k-m*n,J=l*k-m*f,E=r*G-p*D,M=r*t-w*D,K=r*A-C*D,Q=p*t-w*G,I=p*A-C*G,v=w*A-C*t,H=x*v-u*I+g*Q+q*K-L*M+J*E;if(!H)return null;
H=1/H;d[0]=(n*v-f*I+k*Q)*H;d[1]=(l*I-e*v-m*Q)*H;d[2]=(G*J-t*L+A*q)*H;d[3]=(w*L-p*J-C*q)*H;d[4]=(f*K-h*v-k*M)*H;d[5]=(b*v-l*K+m*M)*H;d[6]=(t*g-D*J-A*u)*H;d[7]=(r*J-w*g+C*u)*H;d[8]=(h*I-n*K+k*E)*H;d[9]=(e*K-b*I-m*E)*H;d[10]=(D*L-G*g+A*x)*H;d[11]=(p*g-r*L-C*x)*H;d[12]=(n*M-h*Q-f*E)*H;d[13]=(b*Q-e*M+l*E)*H;d[14]=(G*u-D*q-t*x)*H;d[15]=(r*q-p*u+w*x)*H;return d};a.adjoint=function(a,d){var b=a[0],e=a[1],l=a[2],m=a[3],h=a[4],n=a[5],f=a[6],k=a[7],r=a[8],p=a[9],w=a[10],C=a[11],D=a[12],G=a[13],t=a[14],A=a[15];
d[0]=n*(w*A-C*t)-p*(f*A-k*t)+G*(f*C-k*w);d[1]=-(e*(w*A-C*t)-p*(l*A-m*t)+G*(l*C-m*w));d[2]=e*(f*A-k*t)-n*(l*A-m*t)+G*(l*k-m*f);d[3]=-(e*(f*C-k*w)-n*(l*C-m*w)+p*(l*k-m*f));d[4]=-(h*(w*A-C*t)-r*(f*A-k*t)+D*(f*C-k*w));d[5]=b*(w*A-C*t)-r*(l*A-m*t)+D*(l*C-m*w);d[6]=-(b*(f*A-k*t)-h*(l*A-m*t)+D*(l*k-m*f));d[7]=b*(f*C-k*w)-h*(l*C-m*w)+r*(l*k-m*f);d[8]=h*(p*A-C*G)-r*(n*A-k*G)+D*(n*C-k*p);d[9]=-(b*(p*A-C*G)-r*(e*A-m*G)+D*(e*C-m*p));d[10]=b*(n*A-k*G)-h*(e*A-m*G)+D*(e*k-m*n);d[11]=-(b*(n*C-k*p)-h*(e*C-m*p)+r*
(e*k-m*n));d[12]=-(h*(p*t-w*G)-r*(n*t-f*G)+D*(n*w-f*p));d[13]=b*(p*t-w*G)-r*(e*t-l*G)+D*(e*w-l*p);d[14]=-(b*(n*t-f*G)-h*(e*t-l*G)+D*(e*f-l*n));d[15]=b*(n*w-f*p)-h*(e*w-l*p)+r*(e*f-l*n);return d};a.determinant=function(a){var d=a[0],b=a[1],e=a[2],l=a[3],m=a[4],h=a[5],n=a[6],f=a[7],k=a[8],r=a[9],p=a[10],w=a[11],C=a[12],D=a[13],G=a[14];a=a[15];return(d*h-b*m)*(p*a-w*G)-(d*n-e*m)*(r*a-w*D)+(d*f-l*m)*(r*G-p*D)+(b*n-e*h)*(k*a-w*C)-(b*f-l*h)*(k*G-p*C)+(e*f-l*n)*(k*D-r*C)};a.multiply=function(a,d,b){var e=
a[0],l=a[1],m=a[2],h=a[3],n=a[4],f=a[5],k=a[6],r=a[7],p=a[8],w=a[9],C=a[10],D=a[11],G=a[12],t=a[13],A=a[14];a=a[15];var x=d[0],u=d[1],g=d[2],q=d[3];b[0]=x*e+u*n+g*p+q*G;b[1]=x*l+u*f+g*w+q*t;b[2]=x*m+u*k+g*C+q*A;b[3]=x*h+u*r+g*D+q*a;x=d[4];u=d[5];g=d[6];q=d[7];b[4]=x*e+u*n+g*p+q*G;b[5]=x*l+u*f+g*w+q*t;b[6]=x*m+u*k+g*C+q*A;b[7]=x*h+u*r+g*D+q*a;x=d[8];u=d[9];g=d[10];q=d[11];b[8]=x*e+u*n+g*p+q*G;b[9]=x*l+u*f+g*w+q*t;b[10]=x*m+u*k+g*C+q*A;b[11]=x*h+u*r+g*D+q*a;x=d[12];u=d[13];g=d[14];q=d[15];b[12]=x*e+
u*n+g*p+q*G;b[13]=x*l+u*f+g*w+q*t;b[14]=x*m+u*k+g*C+q*A;b[15]=x*h+u*r+g*D+q*a;return b};a.mul=a.multiply;a.translate=function(a,d,b){var e=d[0],l=d[1];d=d[2];var m,h,n,f,k,r,p,w,C,D,G,t;a===b?(b[12]=a[0]*e+a[4]*l+a[8]*d+a[12],b[13]=a[1]*e+a[5]*l+a[9]*d+a[13],b[14]=a[2]*e+a[6]*l+a[10]*d+a[14],b[15]=a[3]*e+a[7]*l+a[11]*d+a[15]):(m=a[0],h=a[1],n=a[2],f=a[3],k=a[4],r=a[5],p=a[6],w=a[7],C=a[8],D=a[9],G=a[10],t=a[11],b[0]=m,b[1]=h,b[2]=n,b[3]=f,b[4]=k,b[5]=r,b[6]=p,b[7]=w,b[8]=C,b[9]=D,b[10]=G,b[11]=t,
b[12]=m*e+k*l+C*d+a[12],b[13]=h*e+r*l+D*d+a[13],b[14]=n*e+p*l+G*d+a[14],b[15]=f*e+w*l+t*d+a[15]);return b};a.scale=function(a,d,b){var e=d[0],l=d[1];d=d[2];b[0]=a[0]*e;b[1]=a[1]*e;b[2]=a[2]*e;b[3]=a[3]*e;b[4]=a[4]*l;b[5]=a[5]*l;b[6]=a[6]*l;b[7]=a[7]*l;b[8]=a[8]*d;b[9]=a[9]*d;b[10]=a[10]*d;b[11]=a[11]*d;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,d,b,e){var l=b[0],m=b[1];b=b[2];var h=Math.sqrt(l*l+m*m+b*b),n,f,k,r,p,w,C,D,G,t,A,x,u,g,q,L,J,E,M,K;if(1E-7>Math.abs(h))return null;
h=1/h;l*=h;m*=h;b*=h;n=Math.sin(d);f=Math.cos(d);k=1-f;d=a[0];h=a[1];r=a[2];p=a[3];w=a[4];C=a[5];D=a[6];G=a[7];t=a[8];A=a[9];x=a[10];u=a[11];g=l*l*k+f;q=m*l*k+b*n;L=b*l*k-m*n;J=l*m*k-b*n;E=m*m*k+f;M=b*m*k+l*n;K=l*b*k+m*n;l=m*b*k-l*n;m=b*b*k+f;e[0]=d*g+w*q+t*L;e[1]=h*g+C*q+A*L;e[2]=r*g+D*q+x*L;e[3]=p*g+G*q+u*L;e[4]=d*J+w*E+t*M;e[5]=h*J+C*E+A*M;e[6]=r*J+D*E+x*M;e[7]=p*J+G*E+u*M;e[8]=d*K+w*l+t*m;e[9]=h*K+C*l+A*m;e[10]=r*K+D*l+x*m;e[11]=p*K+G*l+u*m;a!==e&&(e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]);
return e};a.rotateX=function(a,d,b){var e=Math.sin(d);d=Math.cos(d);var l=a[4],m=a[5],h=a[6],n=a[7],f=a[8],k=a[9],r=a[10],p=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=l*d+f*e;b[5]=m*d+k*e;b[6]=h*d+r*e;b[7]=n*d+p*e;b[8]=f*d-l*e;b[9]=k*d-m*e;b[10]=r*d-h*e;b[11]=p*d-n*e;return b};a.rotateY=function(a,d,b){var e=Math.sin(d);d=Math.cos(d);var l=a[0],m=a[1],h=a[2],n=a[3],f=a[8],k=a[9],r=a[10],p=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=l*d-f*e;b[1]=m*d-k*e;b[2]=h*d-r*e;b[3]=n*d-p*e;b[8]=l*e+f*d;b[9]=m*e+k*d;b[10]=h*e+r*d;b[11]=n*e+p*d;return b};a.rotateZ=function(a,d,b){var e=Math.sin(d);d=Math.cos(d);var l=a[0],m=a[1],h=a[2],n=a[3],f=a[4],k=a[5],r=a[6],p=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=l*d+f*e;b[1]=m*d+k*e;b[2]=h*d+r*e;b[3]=n*d+p*e;b[4]=f*d-l*e;b[5]=k*d-m*e;b[6]=r*d-h*e;b[7]=p*d-n*e;return b};
a.Ny=function(a,d){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=a[0];d[13]=a[1];d[14]=a[2];d[15]=1;return d};a.My=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=a[1];d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=a[2];d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.Ly=function(a,d,b){var e=d[0],l=d[1];d=d[2];var m=Math.sqrt(e*e+l*l+d*d),h;if(1E-7>Math.abs(m))return null;m=1/m;e*=m;l*=m;d*=m;m=Math.sin(a);a=Math.cos(a);h=1-a;b[0]=e*e*h+a;b[1]=l*e*h+d*
m;b[2]=d*e*h-l*m;b[3]=0;b[4]=e*l*h-d*m;b[5]=l*l*h+a;b[6]=d*l*h+e*m;b[7]=0;b[8]=e*d*h+l*m;b[9]=l*d*h-e*m;b[10]=d*d*h+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.UE=function(a,d){var b=Math.sin(a),e=Math.cos(a);d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=e;d[6]=b;d[7]=0;d[8]=0;d[9]=-b;d[10]=e;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.VE=function(a,d){var b=Math.sin(a),e=Math.cos(a);d[0]=e;d[1]=0;d[2]=-b;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=b;d[9]=0;d[10]=e;d[11]=0;d[12]=0;d[13]=0;
d[14]=0;d[15]=1;return d};a.WE=function(a,d){var b=Math.sin(a),e=Math.cos(a);d[0]=e;d[1]=b;d[2]=0;d[3]=0;d[4]=-b;d[5]=e;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.fromRotationTranslation=function(a,d,b){var e=a[0],l=a[1],m=a[2],h=a[3],n=e+e,f=l+l,k=m+m;a=e*n;var r=e*f,e=e*k,p=l*f,l=l*k,m=m*k,n=h*n,f=h*f,h=h*k;b[0]=1-(p+m);b[1]=r+h;b[2]=e-f;b[3]=0;b[4]=r-h;b[5]=1-(a+m);b[6]=l+n;b[7]=0;b[8]=e+f;b[9]=l-n;b[10]=1-(a+p);b[11]=0;b[12]=d[0];b[13]=d[1];b[14]=d[2];
b[15]=1;return b};a.fromQuat=function(a,d){var b=a[0],e=a[1],l=a[2],m=a[3],h=b+b,n=e+e,f=l+l,b=b*h,k=e*h,e=e*n,r=l*h,p=l*n,l=l*f,h=m*h,n=m*n,m=m*f;d[0]=1-e-l;d[1]=k+m;d[2]=r-n;d[3]=0;d[4]=k-m;d[5]=1-b-l;d[6]=p+h;d[7]=0;d[8]=r+n;d[9]=p-h;d[10]=1-b-e;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.frustum=function(a,d,b,e,l,m,h){var n=1/(d-a),f=1/(e-b),k=1/(l-m);h[0]=2*l*n;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*l*f;h[6]=0;h[7]=0;h[8]=(d+a)*n;h[9]=(e+b)*f;h[10]=(m+l)*k;h[11]=-1;h[12]=0;h[13]=0;h[14]=
m*l*2*k;h[15]=0;return h};a.perspective=function(a,d,b,e,l){a=1/Math.tan(a/2);var m=1/(b-e);l[0]=a/d;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=a;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=(e+b)*m;l[11]=-1;l[12]=0;l[13]=0;l[14]=2*e*b*m;l[15]=0;return l};a.MF=function(a,d,b,e){var l=Math.tan(a.cG*Math.PI/180),m=Math.tan(a.LE*Math.PI/180),h=Math.tan(a.AF*Math.PI/180);a=Math.tan(a.OF*Math.PI/180);var n=2/(h+a),f=2/(l+m);e[0]=n;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=f;e[6]=0;e[7]=0;e[8]=-((h-a)*n*.5);e[9]=(l-m)*f*.5;e[10]=b/
(d-b);e[11]=-1;e[12]=0;e[13]=0;e[14]=b*d/(d-b);e[15]=0;return e};a.ortho=function(a,d,b,e,l,m,h){var n=1/(a-d),f=1/(b-e),k=1/(l-m);h[0]=-2*n;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=-2*f;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=2*k;h[11]=0;h[12]=(a+d)*n;h[13]=(e+b)*f;h[14]=(m+l)*k;h[15]=1;return h};a.lookAt=function(c,d,b,e){var l,m,h,n,f,k,r,p,w=c[0],C=c[1];c=c[2];h=b[0];n=b[1];m=b[2];r=d[0];b=d[1];l=d[2];if(1E-7>Math.abs(w-r)&&1E-7>Math.abs(C-b)&&1E-7>Math.abs(c-l))return a.identity(e);d=w-r;b=C-b;r=c-l;p=1/Math.sqrt(d*
d+b*b+r*r);d*=p;b*=p;r*=p;l=n*r-m*b;m=m*d-h*r;h=h*b-n*d;(p=Math.sqrt(l*l+m*m+h*h))?(p=1/p,l*=p,m*=p,h*=p):h=m=l=0;n=b*h-r*m;f=r*l-d*h;k=d*m-b*l;(p=Math.sqrt(n*n+f*f+k*k))?(p=1/p,n*=p,f*=p,k*=p):k=f=n=0;e[0]=l;e[1]=n;e[2]=d;e[3]=0;e[4]=m;e[5]=f;e[6]=b;e[7]=0;e[8]=h;e[9]=k;e[10]=r;e[11]=0;e[12]=-(l*w+m*C+h*c);e[13]=-(n*w+f*C+k*c);e[14]=-(d*w+b*C+r*c);e[15]=1;return e};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+
a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.Ky=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=a)};b4w.module.mat4=b4w.module.__mat4;b4w.module.__md5=function(a){function p(a,h){var l=a[0],f=a[1],k=a[2],r=a[3],l=d(l,f,k,r,h[0],7,-680876936),r=d(r,l,f,k,h[1],12,-389564586),k=d(k,r,l,f,h[2],17,606105819),f=d(f,k,r,l,h[3],22,-1044525330),l=d(l,f,k,r,h[4],7,-176418897),r=d(r,l,f,k,h[5],12,1200080426),k=d(k,r,l,f,h[6],17,-1473231341),f=d(f,k,r,l,h[7],22,-45705983),l=d(l,f,k,r,h[8],7,1770035416),r=d(r,l,f,k,h[9],12,-1958414417),k=d(k,r,l,f,h[10],17,-42063),f=d(f,k,r,l,h[11],22,-1990404162),l=d(l,f,k,r,h[12],7,1804603682),r=d(r,l,f,k,
h[13],12,-40341101),k=d(k,r,l,f,h[14],17,-1502002290),f=d(f,k,r,l,h[15],22,1236535329),l=b(l,f,k,r,h[1],5,-165796510),r=b(r,l,f,k,h[6],9,-1069501632),k=b(k,r,l,f,h[11],14,643717713),f=b(f,k,r,l,h[0],20,-373897302),l=b(l,f,k,r,h[5],5,-701558691),r=b(r,l,f,k,h[10],9,38016083),k=b(k,r,l,f,h[15],14,-660478335),f=b(f,k,r,l,h[4],20,-405537848),l=b(l,f,k,r,h[9],5,568446438),r=b(r,l,f,k,h[14],9,-1019803690),k=b(k,r,l,f,h[3],14,-187363961),f=b(f,k,r,l,h[8],20,1163531501),l=b(l,f,k,r,h[13],5,-1444681467),r=
b(r,l,f,k,h[2],9,-51403784),k=b(k,r,l,f,h[7],14,1735328473),f=b(f,k,r,l,h[12],20,-1926607734),l=c(f^k^r,l,f,h[5],4,-378558),r=c(l^f^k,r,l,h[8],11,-2022574463),k=c(r^l^f,k,r,h[11],16,1839030562),f=c(k^r^l,f,k,h[14],23,-35309556),l=c(f^k^r,l,f,h[1],4,-1530992060),r=c(l^f^k,r,l,h[4],11,1272893353),k=c(r^l^f,k,r,h[7],16,-155497632),f=c(k^r^l,f,k,h[10],23,-1094730640),l=c(f^k^r,l,f,h[13],4,681279174),r=c(l^f^k,r,l,h[0],11,-358537222),k=c(r^l^f,k,r,h[3],16,-722521979),f=c(k^r^l,f,k,h[6],23,76029189),l=
c(f^k^r,l,f,h[9],4,-640364487),r=c(l^f^k,r,l,h[12],11,-421815835),k=c(r^l^f,k,r,h[15],16,530742520),f=c(k^r^l,f,k,h[2],23,-995338651),l=e(l,f,k,r,h[0],6,-198630844),r=e(r,l,f,k,h[7],10,1126891415),k=e(k,r,l,f,h[14],15,-1416354905),f=e(f,k,r,l,h[5],21,-57434055),l=e(l,f,k,r,h[12],6,1700485571),r=e(r,l,f,k,h[3],10,-1894986606),k=e(k,r,l,f,h[10],15,-1051523),f=e(f,k,r,l,h[1],21,-2054922799),l=e(l,f,k,r,h[8],6,1873313359),r=e(r,l,f,k,h[15],10,-30611744),k=e(k,r,l,f,h[6],15,-1560198380),f=e(f,k,r,l,h[13],
21,1309151649),l=e(l,f,k,r,h[4],6,-145523070),r=e(r,l,f,k,h[11],10,-1120210379),k=e(k,r,l,f,h[2],15,718787259),f=e(f,k,r,l,h[9],21,-343485551);a[0]=l+a[0]&4294967295;a[1]=f+a[1]&4294967295;a[2]=k+a[2]&4294967295;a[3]=r+a[3]&4294967295}function c(a,b,c,d,e,l){b=(b+a&4294967295)+(d+l&4294967295)&4294967295;return(b<<e|b>>>32-e)+c&4294967295}function d(a,b,d,e,k,l,p){return c(b&d|~b&e,a,b,k,l,p)}function b(a,b,d,e,k,l,p){return c(b&e|d&~e,a,b,k,l,p)}function e(a,b,d,e,k,l,p){return c(d^(b|~e),a,b,k,
l,p)}var l="0123456789abcdef".split("");a.Or=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var d;for(d=64;d<=b.length;d+=64){for(var e=b.substring(d-64,d),r=[],y=void 0,y=0;64>y;y+=4)r[y>>2]=e.charCodeAt(y)+(e.charCodeAt(y+1)<<8)+(e.charCodeAt(y+2)<<16)+(e.charCodeAt(y+3)<<24);p(a,r)}b=b.substring(d-64);e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<b.length;d++)e[d>>2]|=b.charCodeAt(d)<<(d%4<<3);e[d>>2]|=128<<(d%4<<3);if(55<d)for(p(a,e),d=0;16>d;d++)e[d]=0;e[14]=8*
c;p(a,e);for(b=0;b<a.length;b++){c=a[b];d="";for(e=0;4>e;e++)d+=l[c>>8*e+4&15]+l[c>>8*e&15];a[b]=d}return a.join("")}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"void main ( ) { gl_FragColor = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={type:"group",a:[{type:"var",name:"ANCHOR_NUM",b:["0"]},{type:"textline",b:"attribute float a_index ; uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec4 a ; a = u_view_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_Position = u_proj_matrix * a ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",
name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"pack.glslf"},{type:"include",file:"fog.glslf"},{type:"include",file:"lighting.glslf"},
{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",d:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",a:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform",
"mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform",
"vec4","u_diffuse_color",";"]},{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]}]}}]},{type:"textline",b:["uniform","vec3","u_color_id",";"]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",
a:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",
a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["USE_OUTLINE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_outline_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",
b:"varying vec3 fa ; varying vec4 fb ;".split(" ")},{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:5}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fc",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fd",";"]}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",
e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","ff",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_perspective_cast_far_bound ; varying vec4 fg ; varying vec4 fh ; varying vec4 fi ; varying vec4 fj ; uniform float u_perspective_cast_far_bound ; uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform sampler2D u_shadow_map0 ; uniform sampler2D u_shadow_map1 ; uniform sampler2D u_shadow_map2 ; uniform sampler2D u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fk",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
d:["USE_REFRACTION"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",b:"void main ( ) { float tl , tm ; vec3 tn , to , tp , tq ;".split(" ")},{type:"condition",a:[{type:"if",d:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["NODES"],group:{type:"group",a:[{type:"textline",b:"tn = u_camera_eye_frag - fa ; tn = normalize ( tn ) ; tk ( tn , to , tp , tq , tl , tm ) ; tm = tm ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"tm = ( texture2D ( u_sampler , fk ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"tm = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( tm < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["USE_OUTLINE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["color_id.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},
{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],
group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",
";"]},{type:"condition",a:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",
b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",
d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:5}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},
{type:"condition",a:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",d:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",
d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",a:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 fa ; varying vec4 fb ;".split(" ")},{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL",
"USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fc",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fd",";"]}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","ff",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fk",";"]}]}}]}]}}]},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},
{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 vU ; float vV , vW , vX ; mat4 vY ; vec3 vZ , v_ , wa , wb , wc , wd ; vZ = a_position ;".split(" ")},{type:"condition",a:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",
e:3},{type:"logical_or_expr",e:6},{type:"logical_and_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["v_","=","a_normal",";"]},{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"wa = vec3 ( a_tangent ) ; wb = a_tangent [ 3 ] * cross ( v_ , wa ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wa = vec3 ( 0.0 ) ; wb = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"v_ = vec3 ( 0.0 ) ; wa = vec3 ( 0.0 ) ; wb = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"vZ = mix ( vZ , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:5}],group:{type:"group",a:[{type:"textline",b:"v_ = mix ( v_ , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"wc = vec3 ( a_tangent ) ; wd = a_tangent_next [ 3 ] * cross ( a_normal_next , wc ) ; wa = mix ( wa , wc , u_va_frame_factor ) ; wb = mix ( wb , wd , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"u_ ( vZ , wa , wb , v_ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:["wb","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wb = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"wa = ( u_model_matrix * vec4 ( wb , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:"vY = tT ( u_camera_eye , wa , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vY = tN ( u_camera_eye , wa , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wd = ( u_model_matrix * vec4 ( wb , 1.0 ) ) . xyz ; vY = vY * tF ( u_wind , u_time , u_jitter_amp , u_jitter_freq , wd ) ;".split(" ")}]}}]},
{type:"textline",b:"es we = t_ ( vZ - wb , wb , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vY ) ; we . b = wa ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"es we = t_ ( vZ , wb , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"vO ( we . a , we . b , v_ ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["v_","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"v_ = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:"vO ( we . a , we . b , v_ ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1}],group:{type:"group",
a:[{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"fk = uc ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"fa = we . a ;".split(" ")},{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",
e:3},{type:"logical_or_expr",e:6}],group:{type:"group",a:[{type:"textline",b:"fc = we . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"vV = ( dot ( cross ( we . e , we . c ) , we . d ) < 0.0 ) ? - 1.0 : 1.0 ; fd = vec4 ( we . c , vV ) ;".split(" ")}]}}]},{type:"textline",b:"fb = u_view_matrix * vec4 ( we . a , 1.0 ) ; vU = u_proj_matrix * fb ;".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",
b:"vU . xy += u_subpixel_jitter * vU . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"vV = vU . x ; vW = vU . y ; vX = vU . w ; fe . x = ( vV + vX ) / 2.0 ; fe . y = ( vW + vX ) / 2.0 ; fe . z = vX ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:"ff = - fb . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:["vT","(",")",";"]}]}}]},{type:"textline",b:"gl_Position = u_proj_matrix * u_view_matrix * vec4 ( we . a , 1.0 ) ; }".split(" ")}]};a["depth.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",
b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},
{type:"condition",a:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1},"NODES","ALPHA",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"include",file:"procedural.glslf"}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"include",file:"pack.glslf"},{type:"include",file:"fog.glslf"},{type:"include",file:"lighting.glslf"},
{type:"condition",a:[{type:"if",d:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",a:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",
d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform",
"samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},
{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_colormap0",";"]}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_diffuse_color",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},
{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",a:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fa",";"]},{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:5}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fc",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fd",";"]}]}}]}]}},{type:"else",
group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fk",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fg",";"]},{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fh",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fi",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fj",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE",
"REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","ff",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["SHADELESS",
{type:"logic_negative_expr",e:1},"NODES","ALPHA",{type:"logical_and_expr",e:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",
a:[{type:"condition",a:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",b:"void main ( ) { float vU , vV ; vec3 vW , vX , vY , vZ ;".split(" ")},{type:"condition",a:[{type:"if",d:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["NODES"],group:{type:"group",a:[{type:"textline",b:"vW = u_camera_eye_frag - fa ; vW = normalize ( vW ) ; tk ( vW , vX , vY , vZ , vU , vV ) ; vV = vV ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"vV = ( texture2D ( u_colormap0 , fk ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vV = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( vV < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","NO_SHADOWS",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",
e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( g_ ( fb . z ) , 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",
a:[{type:"textline",b:"gl_FragColor . a += 0.00001 * fd . r ;".split(" ")}]}}]}]}}]},{type:"textline",b:["}"]}]};a["depth.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},
{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},{type:"logical_or_expr",e:7}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",
a:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",
a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},
{type:"condition",a:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS",
"CALC_TBN_SPACE",{type:"logical_or_expr",e:5}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1},"TEXTURE_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["attribute",
"vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},
{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",d:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_shadow_cast_billboard_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",
b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",
d:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logic_negative_expr",e:1},"TEXTURE_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",
a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fa",";"]},{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS",
"CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fc",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fd",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fk",";"]}]}}]}]}}]},{type:"condition",
a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fg",";"]},{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying",
"vec4","fh",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fi",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fj",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},
{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","ff",";"]}]}}]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",
{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec2 wJ ; vec4 wK , wL ; float wM ; mat4 wN , wO ; vec3 wP , wQ , wR , wS , wT , wU ; wP = a_position ;".split(" ")},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",
e:3},{type:"logical_or_expr",e:7}],group:{type:"group",a:[{type:"textline",b:["wQ","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wQ = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",e:3}],group:{type:"group",a:[{type:"textline",b:"wR = vec3 ( a_tangent ) ; wS = a_tangent [ 3 ] * cross ( wQ , wR ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wR = vec3 ( 0.0 ) ; wS = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"wP = mix ( wP , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:5}],group:{type:"group",a:[{type:"textline",b:"wQ = mix ( wQ , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"wT = vec3 ( a_tangent ) ; wU = a_tangent_next [ 3 ] * cross ( a_normal_next , wT ) ; wR = mix ( wR , wT , u_va_frame_factor ) ; wS = mix ( wS , wU , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"u_ ( wP , wR , wS , wQ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",
{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["wS","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wS = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"es wV = wy ( wP , vec3 ( 0.0 ) , vec3 ( 0.0 ) , wQ , wS , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"wR = ( u_model_matrix * vec4 ( wS , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",d:["HAIR_BILLBOARD",{type:"logic_negative_expr",e:1},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["wN","=","u_shadow_cast_billboard_view_matrix",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:["wN","=","u_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wO = tT ( u_camera_eye , wR , wN , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wO = tN ( u_camera_eye , wR , wN ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:"wU = ( u_model_matrix * vec4 ( wS , 1.0 ) ) . xyz ; wO = wO * tF ( u_wind , u_time , u_jitter_amp , u_jitter_freq , wU ) ;".split(" ")}]}}]},{type:"textline",b:"es wV = t_ ( wP - wS , wS , vec3 ( 0.0 ) , vec3 ( 0.0 ) , wQ , wO ) ; wV . b = wR ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"es wV = t_ ( wP , wS , vec3 ( 0.0 ) , vec3 ( 0.0 ) , wQ , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["wQ","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wQ = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:"vO ( wV . a , wV . b , wQ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"fa = wV . a ;".split(" ")},
{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:6}],group:{type:"group",a:[{type:"textline",b:"fc = wV . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"wM = ( dot ( cross ( wV . e , wV . c ) , wV . d ) < 0.0 ) ? - 1.0 : 1.0 ; fd = vec4 ( wV . c , wM ) ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"wK = u_view_matrix * vec4 ( wV . a , 1.0 ) ; wL = u_proj_matrix * wK ;".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"wL . xy += u_subpixel_jitter * wL . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NODES","ALPHA",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],
group:{type:"group",a:[{type:"textline",b:"fe = e_ ( wL ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"ff = - fb . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:["vT","(",")",";"]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"fk = uc ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wI ( wV . a , wV . e ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"NODES","ALPHA",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["fb","=","wK",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:"wJ = ( u_proj_matrix * u_view_matrix [ 3 ] ) . xy ; wM = SHADOW_TEX_RES / 2.0 ; wJ = floor ( wJ * wM + 0.5 ) / wM - wJ ; wL . xy += wJ ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","wL",";","}"]}]};a["grass_map.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",
a:[{type:"textline",b:["varying","vec4","wJ",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","wJ",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","wJ",";"]}]}}]}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],
group:{type:"group",a:[{type:"textline",b:["gl_FragColor","=","wJ",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( wJ , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , wJ ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",
b:["}"]}]};a["grass_map.glslv"]={type:"group",a:[{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_grass_size",";"]}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_grass_color",";"]}]}}]},{type:"condition",a:[{type:"if",
d:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",d:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",
{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","wJ",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","wJ",";"]}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","wJ",";"]}]}}]}]}}]},{type:"textline",b:"void main ( ) { vec4 wK ; mat4 wL ; vec3 wM ;".split(" ")},{type:"condition",a:[{type:"if",d:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"wM = ( u_model_matrix * vec4 ( vec3 ( 0.0 ) , 1.0 ) ) . xyz ; wL = tN ( u_camera_eye , wM , u_view_matrix ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["WIND_BEND",
"BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wL = wL * tF ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:"es wN = t_ ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , wL ) ; wN . b = wM ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"es wN = t_ ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},
{type:"textline",b:"wK = u_proj_matrix * u_view_matrix * vec4 ( wN . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:"wJ = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["wJ","=","a_grass_size",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS_COLOR"],
group:{type:"group",a:[{type:"textline",b:["wJ","=","a_grass_color",";"]}]}}]}]}}]},{type:"textline",b:["gl_Position","=","wK",";","}"]}]};a["halo.glslf"]={type:"group",a:[{type:"var",name:"NUM_LINES",b:["0"]},{type:"var",name:"NUM_RINGS",b:["0"]},{type:"var",name:"NUM_STARS",b:["0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ; varying vec4 wK ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 fk ; varying float wL ;".split(" ")},
{type:"condition",a:[{type:"if",d:["NUM_RINGS","NUM_LINES",{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"const int wM = NUM_RINGS ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const int wM = NUM_LINES ;".split(" ")}]}}]},{type:"textline",b:"float wO ( float wN ) { return wN - floor ( wN * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{type:"condition",a:[{type:"if",d:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"void wX ( inout float wP , in float wQ [ wM ] , in float wR ) { float wS , wT , wU , wV ; for ( int wW = 0 ; wW < NUM_RINGS ; wW ++ ) { wS = 40.0 * wQ [ wW ] ; wT = 300.0 * ( wO ( wS ) - 0.005 ) ; wU = wS ; wV = abs ( wU * ( u_halo_size * wT - wR ) ) ; wP += 1.0 - min ( wV , 1.0 ) ; } }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"void xf ( inout float wY , in float wZ [ wM ] , in float w_ ) { float xa , xb , xc , xd ; for ( int xe = 0 ; xe < NUM_LINES ; xe ++ ) { xa = wZ [ xe ] ; xb = xa ; xc = 1000.0 * ( wO ( xa ) - 0.005 ) ; xd = 20.0 * abs ( xb * fk . x + xc * fk . y ) ; wY += 1.0 - min ( xd , 1.0 ) ; } wY *= w_ ; }".split(" ")}]}}]},{type:"textline",b:"void xm ( inout float xg , in vec2 xh ) { float xi , xj , xk , xl ; xj = atan ( xh . y , xh . x ) ; xj *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; xk = cos ( xj ) ; xl = sin ( xj ) ; xj = ( xk * xh . x + xl * xh . y ) * ( xk * xh . y - xl * xh . x ) ; xi = abs ( xj ) ; if ( xi < 1.0 ) { xi = ( 0.01 * u_halo_size ) / ( xi ) ; xg *= sqrt ( min ( xi , 1.0 ) ) ; } } void main ( ) { vec3 xn ; float xo , xp , xq , xr ; xo = ( fk . x * fk . x + fk . y * fk . y ) ; xp = sqrt ( xo ) ; xo = max ( 1.0 - xo , 0.0 ) ; xo = pow ( xo , u_halo_hardness ) ; xq = u_diffuse_color . a ;".split(" ")},
{type:"condition",a:[{type:"if",d:["NUM_RINGS","NUM_LINES",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"float xs [ wM ] ; for ( int xt = 0 ; xt < wM ; xt ++ ) { xs [ xt ] = fract ( wL / ( float ( xt ) + 0.01 ) ) - 1.0 ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"xr = 0.0 ; wX ( xr , xs , xp ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"xp = 0.0 ; xf ( xp , xs , xo ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["NUM_STARS"],group:{type:"group",a:[{type:"textline",b:"xm ( xo , fk ) ;".split(" ")}]}}]},{type:"textline",b:"xo *= xq ; xn = u_diffuse_color . rgb ;".split(" ")},{type:"condition",a:[{type:"if",d:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"xr *= xo ; xn += u_halo_rings_color * xr ; xo += xr ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"xp *= xq ; xn += u_halo_lines_color * xp ; xo += xp ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"xo *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"xp = u_halo_stars_blend * ( wK . y - u_halo_stars_height ) ; xo *= clamp ( xp , 0.0 , 1.0 ) ; xo *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"em ( xn ) ; ep ( xn , xo ) ; gl_FragColor = vec4 ( xn , xo ) ; }".split(" ")}]};a["halo.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec2 a_halo_bb_vertex ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform PRECISION float u_halo_size ; varying vec2 fk ; varying float wL ;".split(" ")},{type:"condition",a:[{type:"if",
d:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","wK",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 wM , wN ; mat4 wO , wP ; vec3 wQ ; wQ = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; fk = a_halo_bb_vertex * 2.0 ; wL = fract ( wQ . x + wQ . y + wQ . z ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"wO = tr ( wQ , u_view_matrix ) ; wP = u_view_matrix ; wP [ 3 ] [ 0 ] = 0.0 ; wP [ 3 ] [ 1 ] = 0.0 ; wP [ 3 ] [ 2 ] = 0.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wO = tr ( wQ , u_view_matrix ) ;".split(" ")}]}}]},{type:"textline",b:"wM = vec4 ( a_halo_bb_vertex * 2.0 * u_halo_size , 0.0 , 1.0 ) ; wM = wO * wM ;".split(" ")},{type:"condition",a:[{type:"if",d:["SKY_STARS"],group:{type:"group",
a:[{type:"textline",b:"wN = u_proj_matrix * wP * wM ; wN . z = 0.99999 * wN . w ;".split(" ")},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["wK","=","wM",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wN = u_proj_matrix * u_view_matrix * wM ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","wN",";","}"]}]};a["line.glslf"]={type:"group",a:[{type:"include",
file:"precision_statement.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; void main ( ) { gl_FragColor = u_diffuse_color ; }".split(" ")}]};a["line.glslv"]={type:"group",a:[{type:"var",name:"NUM_POINTS",b:["0"]},{type:"textline",b:"attribute float a_point ; uniform vec3 u_line_points [ NUM_POINTS ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec3 wM ; wM = u_line_points [ int ( a_point ) ] ; gl_Position = u_proj_matrix * u_view_matrix * vec4 ( wM , 1.0 ) ; }".split(" ")}]};
a["main.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"PARALLAX_STEPS",b:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},
{type:"include",file:"pack.glslf"},{type:"include",file:"fog.glslf"},{type:"condition",a:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"include",file:"lighting.glslf"},{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",d:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",
a:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",
e:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform",
"vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["NODES"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"USE_NODE_B4W_VECTOR_VIEW",{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",
e:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]}]}}]},
{type:"condition",a:[{type:"if",d:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_direction",";"]}]}}]},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"PROCEDURAL_FOG",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:["uniform",
"sampler2D","u_colormap0",";"]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_SPEC","ALPHA_AS_SPEC",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",a:[{type:"textline",
b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform",
"float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},
{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_B4W_REFRACTION","USE_REFRACTION","NODES",{type:"logical_and_expr",
e:3},{type:"logical_or_expr",e:2},"REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},
{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_VALUE"],group:{type:"group",a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_normal_factor",";"]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR0_CO"],
group:{type:"group",a:[{type:"textline",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{type:"textline",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",
b:["uniform","float","u_parallax_scale",";"]}]}}]},{type:"condition",a:[{type:"if",d:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_refr_bump",";"]}]}}]}]}}]},{type:"textline",b:["varying","vec3","fa",";"]},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",
{type:"logical_or_expr",e:8}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fc",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fd",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","wM",";"]},{type:"condition",a:[{type:"if",d:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fk",";"]}]}}]},{type:"condition",a:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying",
"vec3","wN",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fg",";"]},{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fh",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fi",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],
group:{type:"group",a:[{type:"textline",b:["varying","vec4","fj",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},{type:"condition",a:[{type:"if",d:["REFRACTIVE","NODES",{type:"logic_negative_expr",e:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",
e:2},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","ff",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"include",file:"mirror.glslf"},{type:"condition",a:[{type:"if",d:["REFRACTIVE","NODES",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2},"USE_NODE_B4W_REFRACTION","USE_REFRACTION","NODES",{type:"logical_and_expr",e:3},{type:"logical_or_expr",
e:2}],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",d:["NODES"],group:{type:"group",a:[{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",b:"void main ( ) { vec4 wO , wP , wQ , wR ; mat3 wS ; vec2 wT , wU , wV , wW ; vec3 wX , wY , wZ , w_ , xa , xb , xc , xd , xe ; float xf , xg , xh , xi , xj , xk , xl ;".split(" ")},{type:"condition",a:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",
e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:"xf = length ( fb ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"xg = fa . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",
e:2},{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["wX","=","u_sun_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES"],group:{type:"group",a:[{type:"textline",b:"wY = normalize ( u_camera_eye_frag - fa ) ; tk ( wY , wZ , w_ , xa , xh , xi ) ; wZ = wZ ; xi = xi ; xa = xa ; xh = xh ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["wT","=","fk",";"]}]}}]},{type:"textline",
b:["w_","=","fc",";"]},{type:"condition",a:[{type:"if",d:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) w_ = w_ ; else w_ = - w_ ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"xb = cross ( w_ , fd . xyz ) * fd . w ; wS = mat3 ( fd . xyz , xb , w_ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wU = normalize ( u_view_matrix_frag * vec4 ( fc , 0.0 ) ) . st ; wU = wU * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"if ( xf < PARALLAX_LOD_DIST ) { xj = clamp ( 0.5 * ( PARALLAX_LOD_DIST - xf ) , 0.0 , 1.0 ) ; xj = u_parallax_scale * xj ; xb = normalize ( wM * wS ) ; xk = 1.0 / PARALLAX_STEPS ; wV = xb . xy * xj / ( PARALLAX_STEPS * xb . z ) ; xj = 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:["wW","=","wU",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["wW","=","wT",";"]}]}}]},{type:"textline",b:"xl = texture2D ( u_normalmap0 , wW ) . a ; for ( float xm = 1.0 ; xm <= PARALLAX_STEPS ; xm ++ ) { if ( xl < xj ) { xj -= xk ; wW -= wV ; xl = texture2D ( u_normalmap0 , wW ) . a ; } } wV = wW + wV ; xk = texture2D ( u_normalmap0 , wV ) . a - ( xj + xk ) ; xj = xl - xj ; xk = xj / ( xj - xk ) ; wW = xk * wV + ( 1.0 - xk ) * wW ;".split(" ")},{type:"condition",
a:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wT += wW - wU ;".split(" ")}]}}]},{type:"textline",b:["wU","=","wW",";"]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wU += wW - wT ;".split(" ")}]}}]},{type:"textline",b:["wT","=","wW",";"]}]}}]},{type:"textline",
b:["}"]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wO = texture2D ( u_normalmap0 , wU ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wO = texture2D ( u_normalmap0 , wT ) ;".split(" ")}]}}]},{type:"textline",b:"xb = wO . rgb - 0.5 ; xb = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , xb , u_normal_factor ) ; xa = wS * xb ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["xa","=","w_",";"]}]}}]},{type:"textline",b:"xa = normalize ( xa ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"wU = normalize ( u_view_matrix_frag * vec4 ( xa , 0.0 ) ) . st ; wU = wU * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:"wY = normalize ( wM ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:"w_ = wN ; ek ( w_ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wO = vec4 ( w_ , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["wO","=","u_diffuse_color",";"]}]}}]},{type:"textline",b:["xk","=","1.0",";"]},{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:"wP = texture2D ( u_colormap0 , wU ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wP = texture2D ( u_colormap0 , wT ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:"ek ( wP . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",
a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wQ = texture2D ( u_colormap1 , wU ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wQ = texture2D ( u_colormap1 , wT ) ;".split(" ")}]}}]},{type:"textline",b:"ek ( wQ . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:"wR = texture2D ( u_stencil0 , wU ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wR = texture2D ( u_stencil0 , wT ) ;".split(" ")}]}}]},{type:"textline",b:"wP = mix ( wP , wQ , wR . r ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wO . rgb = mix ( wO . rgb , wP . rgb , u_diffuse_color_factor ) ; xj = u_alpha_factor * wP . a ; xj += ( 1.0 - step ( 0.0 , xj ) ) ; wO . a = mix ( xj , 1.0 , u_diffuse_color . a ) ; xk = wP . a ;".split(" ")}]}},
{type:"elif",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wO . rgb *= mix ( vec3 ( 1.0 ) , wP . rgb , u_diffuse_color_factor ) ; wO . a = wP . a ; xk = wP . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"w_ = u_diffuse_intensity * wO . rgb ;".split(" ")},{type:"condition",a:[{type:"if",d:["SHADELESS"],group:{type:"group",a:[{type:"textline",b:["wZ","=","w_",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xb = u_environment_energy * hB ( xa ) ; xb = u_ambient * xb ; xh = he ( w_ ) ; xc = u_emit * wO . rgb ; xd = u_specular_color ;".split(" ")},
{type:"condition",a:[{type:"if",d:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["ALPHA_AS_SPEC"],group:{type:"group",a:[{type:"textline",b:"xe = vec3 ( xk ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"xe = texture2D ( u_specmap0 , wU ) . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xe = texture2D ( u_specmap0 , wT ) . rgb ;".split(" ")}]}}]},
{type:"textline",b:"ek ( xe . rgb ) ; xd = mix ( xd , xe , u_specular_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"xk = u_specular_params [ 0 ] ; wT = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; xd = xk * xd ;".split(" ")},{type:"condition",a:[{type:"if",d:["NUM_LIGHTS",0,{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"am xn = cZ ( xc , xb , w_ ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"am xn = cU ( xc , xb , w_ , xd , fa , xa , wY , wT , u_diffuse_params , xh , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}}]},
{type:"textline",b:"wZ = xn . a . rgb ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"hy ( wZ , wY , xa , u_reflect_factor ) ;".split(" ")}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"hy ( wZ , wY , xa , 0.0 ) ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"wZ += xn . b ;".split(" ")}]}}]},{type:"textline",b:"xi = wO . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["WETTABLE"],group:{type:"group",a:[{type:"textline",b:"wZ = max ( wZ - sqrt ( 0.01 * - min ( xg , 0.0 ) ) , 0.5 * wZ ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["CAUSTICS"],group:{type:"group",a:[{type:"textline",b:"ei ( wZ , xg , u_time , xh , xa , u_sun_direction , wX , u_sun_quaternion , fa , xf ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"if ( xi <= 0.5 ) discard ; xi = 1.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["SHADELESS",
{type:"logic_negative_expr",e:1},"NODES",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"xh = max ( max ( xn . b . r , xn . b . g ) , xn . b . b ) * u_specular_alpha ; xi = wO . a * ( 1.0 - xh ) + xh ;".split(" ")}]}}]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["NODES_GLOW",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:["xi","=","1.0",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"wZ = mix ( hP ( fe , xa . xz * u_refr_bump ) , wZ , xi ) ; xi = 1.0 ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"PROCEDURAL_FOG",{type:"logic_negative_expr",e:1},"WATER_EFFECTS",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",
b:"xh = clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"xa = L ( u_cube_fog , wY ) ; wO = vec4 ( xa , u_fog_color_density . a ) ; ek ( wO . rgb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wO = u_fog_color_density ; wO . rgb *= xh ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"aa ( wZ , xf , wY , u_cam_water_depth , u_underwater_fog_color_density , wO , xg , xh ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"z ( wZ , xf , fa . y , wO ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["NODES"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},{type:"logical_and_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:"wT = texture2DProj ( u_shadow_mask , fe ) . rg ; xf = wT . g ; wZ = vec3 ( xf ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"SHADELESS",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:3}],group:{type:"group",a:[{type:"textline",b:"wZ = vec3 ( fl . a ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["em","(","wZ",")",
";"]},{type:"condition",a:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2},"NODES_GLOW",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"ep ( wZ , xi ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( wZ , xi ) ; }".split(" ")}]};a["main.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",
b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",
{type:"logical_or_expr",e:8}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",
{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:7}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"condition",
a:[{type:"if",d:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",d:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_color",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},
{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",
a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",
a:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},
{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["REFRACTIVE","USE_NODE_B4W_REFRACTION",
{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"textline",b:["varying","vec3","fa",";"]},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:8}],group:{type:"group",a:[{type:"textline",
b:["varying","vec3","fc",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES","DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying",
"vec4","fd",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","wM",";"]},{type:"condition",a:[{type:"if",d:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fk",";"]}]}}]},{type:"condition",a:[{type:"if",d:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","wN",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fg",";"]},{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fh",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fi",";"]}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4",
"fj",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},{type:"condition",a:[{type:"if",d:["REFRACTIVE","NODES",{type:"logic_negative_expr",e:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:["varying","float","ff",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",a:[{type:"if",d:["NODES"],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 wO , wP ; float wQ ; mat4 wR ; vec3 wS , wT , wU , wV , wW , wX , wY ; wS = a_position ;".split(" ")},{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE",
"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},"NODES",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:7}],group:{type:"group",a:[{type:"textline",b:["wT","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wT = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",
{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wU = vec3 ( a_tangent ) ; wV = a_tangent [ 3 ] * cross ( wT , wU ) ;".split(" ")}]}},{type:"elif",d:["NODES",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wW = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; wX = normalize ( ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ) ; wW = wW - u_camera_eye ; wV = cross ( wW , wX ) ; wU = cross ( wX , wV ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"wU = vec3 ( 0.0 ) ; wV = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"wS = mix ( wS , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",e:6}],group:{type:"group",a:[{type:"textline",
b:"wT = mix ( wT , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"wX = vec3 ( a_tangent ) ; wW = a_tangent_next [ 3 ] * cross ( a_normal_next , wX ) ; wU = mix ( wU , wX , u_va_frame_factor ) ; wV = mix ( wV , wW , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"u_ ( wS , wU , wV , wT ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["wW","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"wW = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"es wZ = wy ( wS , wU , wV , wT , wW , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"wX = ( u_model_matrix * vec4 ( wW , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wR = tT ( u_camera_eye , wX , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"wR = tN ( u_camera_eye , wX , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wY = ( u_model_matrix * vec4 ( wW , 1.0 ) ) . xyz ; wR = wR * tF ( u_wind , u_time , u_jitter_amp , u_jitter_freq , wY ) ;".split(" ")}]}}]},{type:"textline",b:"es wZ = t_ ( wS - wW , wW , wU , wV , wT , wR ) ; wZ . b = wX ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"es wZ = t_ ( wS , wW , wU , wV , wT , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wQ = ( dot ( cross ( wZ . e , wZ . c ) , wZ . d ) < 0.0 ) ? - 1.0 : 1.0 ; fd = vec4 ( wZ . c , wQ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"vO ( wZ . a , wZ . b , wT ) ;".split(" ")}]}}]},{type:"textline",
b:"fa = wZ . a ;".split(" ")},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1},"USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",e:3},{type:"logical_or_expr",e:7}],group:{type:"group",a:[{type:"textline",b:"fc = wZ . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NODES",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"wM = u_camera_eye - wZ . a ;".split(" ")},
{type:"condition",a:[{type:"if",d:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"fk = uc ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"wN = wZ . f ;".split(" ")}]}},{type:"elif",d:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["wN","=","a_color",";"]}]}}]}]}}]},{type:"textline",b:"wO = u_view_matrix * vec4 ( wZ . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["NODES",
"DISABLE_FOG",{type:"logic_negative_expr",e:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",e:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:["fb","=","wO",";"]}]}}]},{type:"textline",b:"wP = u_proj_matrix * wO ;".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"wP . xy += u_subpixel_jitter * wP . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:"fe = e_ ( wP ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wI ( wZ . a , wZ . e ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["REFRACTIVE","NODES",
{type:"logic_negative_expr",e:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"ff = - wO . z / u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NODES"],group:{type:"group",a:[{type:"textline",b:["vT","(",")",";"]}]}}]},{type:"textline",b:["gl_Position","=","wP",";","}"]}]};a["particles_color.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"fog.glslf"},
{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"SOFT_STRENGTH",b:["1.0"]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform float u_p_alpha_start ; uniform float u_p_alpha_end ; uniform vec2 u_texel_size ; uniform vec4 u_fog_color_density ;".split(" ")},{type:"condition",a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},
{type:"textline",b:"varying float wO ; varying vec3 wN ;".split(" ")},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"SOFT_PARTICLES",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},{type:"textline",b:"varying float wP ; void main ( ) { vec4 wQ ; vec3 wR ; float wS , wT , wU ; vec2 wV , wW ; wV = gl_PointCoord - 0.5 ; wS = 2.0 * length ( wV ) ; wS = smoothstep ( u_p_alpha_start , u_p_alpha_end , wS ) ; wS = u_diffuse_color . a * wO * ( 1.0 - wS ) ; wR = wN * u_diffuse_color . rgb ;".split(" ")},
{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"E ( wR , length ( fb ) , u_fog_color_density ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"wW = fe . xy / fe . z ; wV = vec2 ( wV . x , - wV . y ) * wP * u_texel_size ; wV = vec2 ( wW + wV ) ; wQ = texture2D ( u_scene_depth , wV ) ; wT = k ( wQ ) ; wU = - fb . z / u_view_max_depth ; wU = wT - wU ; wU = u_view_max_depth / SOFT_STRENGTH * wU ; wS = wS * min ( wU , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["em","(","wR",")",";"]},{type:"condition",a:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"ep ( wR , wS ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( wR , wS ) ; }".split(" ")}]};a["particles_color.glslv"]={type:"group",a:[{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ;".split(" ")},
{type:"condition",a:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SIZE_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform vec3 u_p_wind ; uniform float u_p_max_lifetime ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",d:["WORLD_SPACE",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float wO ; varying vec3 wN ;".split(" ")},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"SOFT_PARTICLES",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",
a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},{type:"textline",b:["varying","float","wP",";"]},{type:"include",file:"particles.glslv"},{type:"textline",b:"void main ( ) { float xC , xD , xE , xF ; vec4 xG , xH ; wQ xI ; xI = xB ( ) ; xG = u_view_matrix * vec4 ( xI . b , 1.0 ) ; xH = u_proj_matrix * xG ; gl_Position = xH ; wO = xI . c ; wN = xI . d ;".split(" ")},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"SOFT_PARTICLES",{type:"logical_or_expr",e:2}],
group:{type:"group",a:[{type:"textline",b:["fb","=","xG",";"]}]}}]},{type:"textline",b:"xC = u_height * u_proj_matrix [ 1 ] [ 1 ] * u_p_size / gl_Position . z ; xC = xI . a * xC ;".split(" ")},{type:"condition",a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"xD = xH . x ; xE = xH . y ; xF = xH . w ; fe . x = ( xD + xF ) / 2.0 ; fe . y = ( xE + xF ) / 2.0 ; fe . z = xF ; wP = xC ;".split(" ")}]}}]},{type:"textline",b:["gl_PointSize","=","xC",";","}"]}]};a["particles_texture.glslf"]=
{type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"lighting.glslf"},{type:"include",file:"fog.glslf"},{type:"condition",a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"PARTICLES_SHADELESS",b:["0"]},{type:"var",name:"SOFT_STRENGTH",b:["1.0"]},{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",
b:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",
e:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{type:"condition",a:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; varying float wO ; varying vec3 wN ; varying vec2 fk ; varying vec3 wM ; varying vec3 fa ;".split(" ")},
{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"SOFT_PARTICLES",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},{type:"include",file:"environment.glslf"},{type:"textline",b:"void main ( ) { vec2 xC ; float xD , xE , xF ; vec3 xG , xH , xI , xJ , xK , xL ; vec4 xM , xN ; xM = u_diffuse_color ;".split(" ")},
{type:"condition",a:[{type:"if",d:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"xN = texture2D ( u_sampler , fk ) ; ek ( xN . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"xM . rgb = mix ( xM . rgb , xN . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{type:"elif",d:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:"xM . rgb *= mix ( vec3 ( 1.0 ) , xN . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"xM . a = xN . a ;".split(" ")}]}}]},{type:"textline",b:"xM . rgb *= wN ; xG = u_diffuse_intensity * xM . rgb ;".split(" ")},{type:"condition",a:[{type:"if",d:["PARTICLES_SHADELESS",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"xH = u_emit * xM . rgb ; xI = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["USE_ENVIRONMENT_LIGHT",
"SKY_TEXTURE",{type:"logic_negative_expr",e:1},"SKY_COLOR",{type:"logical_and_expr",e:3}],group:{type:"group",a:[{type:"textline",b:"xJ = u_environment_energy * hB ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xJ = u_environment_energy * hB ( xI ) ;".split(" ")}]}}]},{type:"textline",b:"xJ = u_ambient * xJ ; xD = u_specular_params [ 0 ] ; xC = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; xK = xD * u_specular_color ; xL = normalize ( wM ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"am xO = cU ( xH , xJ , xG , xK , fa , xI , xL , xC , u_diffuse_params , 1.0 , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"am xO = cZ ( xH , xJ , xG ) ;".split(" ")}]}}]},{type:"textline",b:"xJ = xO . a . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:["xJ","=","xG",";"]}]}}]},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"E ( xJ , length ( fb ) , u_fog_color_density ) ;".split(" ")}]}}]},{type:"textline",b:"xD = xM . a * wO ;".split(" ")},{type:"condition",a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"xE = - fb . z / u_view_max_depth ; xM = texture2DProj ( u_scene_depth , fe ) ; xF = k ( xM ) ; xE = xF - xE ; xE = u_view_max_depth / SOFT_STRENGTH * xE ; xD = xD * min ( xE , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["em","(","xJ",")",";"]},{type:"condition",a:[{type:"if",d:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"ep ( xJ , xD ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( xJ , xD ) ; }".split(" ")}]};a["particles_texture.glslv"]={type:"group",a:[{type:"var",name:"BILLBOARD_ALIGN",b:["0"]},{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"include",
file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"define",name:"BILLBOARD_ALIGN_VIEW",b:["1"]},{type:"define",name:"BILLBOARD_ALIGN_XY",b:["2"]},{type:"define",name:"BILLBOARD_ALIGN_YZ",b:["3"]},{type:"define",name:"BILLBOARD_ALIGN_ZX",b:["4"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ; attribute vec2 a_p_bb_vertex ;".split(" ")},{type:"condition",a:[{type:"if",d:["COLOR_RAMP_LENGTH",
0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SIZE_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform vec3 u_p_wind ; uniform float u_p_max_lifetime ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform vec3 u_camera_eye ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",d:["WORLD_SPACE",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float wO ; varying vec3 wN ; varying vec2 fk ; varying vec3 wM ; varying vec3 fa ;".split(" ")},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"SOFT_PARTICLES",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","fb",";"]}]}}]},{type:"condition",
a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},{type:"include",file:"particles.glslv"},{type:"textline",b:"float xE ( vec2 xC , vec2 xD ) { return ( atan ( xD . y , xD . x ) - atan ( xC . y , xC . x ) ) ; } void main ( ) { vec4 xF , xG , xH ; mat4 xI ; float xJ , xK , xL ; wQ xM ; xM = xB ( ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { xJ = xM . e ; xI = tr ( xM . b , u_view_matrix ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { xJ = xM . e ; xI = eM ( ) ; xI [ 3 ] = vec4 ( xM . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { xJ = xM . e ; xI = eQ ( radians ( 90.0 ) ) ; xI [ 3 ] = vec4 ( xM . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { xJ = xE ( vec2 ( EPSILON , 1.0 ) , vec2 ( a_normal . x , a_normal . z ) ) + xM . e ; xI = eO ( radians ( - 90.0 ) ) ; xI [ 3 ] = vec4 ( xM . b , 1.0 ) ; } xF = vec4 ( a_p_bb_vertex * 2.0 * xM . a * u_p_size , 0.0 , 1.0 ) ; xF = xI * eS ( xJ ) * xF ; xG = u_view_matrix * xF ; xH = u_proj_matrix * xG ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"xJ = xH . x ; xK = xH . y ; xL = xH . w ; fe . x = ( xJ + xL ) / 2.0 ; fe . y = ( xK + xL ) / 2.0 ; fe . z = xL ;".split(" ")}]}}]},{type:"textline",b:"gl_Position = xH ; wO = xM . c ; wN = xM . d ; fk = a_p_bb_vertex + 0.5 ; fa = xF . xyz ; wM = u_camera_eye - xF . xyz ;".split(" ")},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"SOFT_PARTICLES",{type:"logical_or_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:["fb","=","xG",";"]}]}}]},{type:"textline",b:["}"]}]};a["procedural_skydome.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; varying vec3 xC ; const float xD = 0.99 ; const float xE = 1.8 ; const int xF = 8 ; float xL ( vec3 xG , vec3 xH ) { float xI , xJ , xK ; xI = dot ( xH , xH ) ; xJ = 2.0 * dot ( xH , xG ) ; xK = dot ( xG , xG ) - 1.0 ; xI = xJ * xJ - 4.0 * xI * xK ; xI = sqrt ( xI ) ; xI = ( - xJ - xI ) / 2.0 ; xI = xK / xI ; return xI ; } float xS ( float xM , float xN ) { float xO , xP , xQ , xR ; xO = 3.0 * ( 1.0 - xN * xN ) ; xP = 2.0 * ( 2.0 + xN * xN ) ; xQ = 1.0 + xM * xM ; xR = pow ( 1.0 + xN * xN - 2.0 * xN * xM , 1.5 ) ; xR = max ( xR , 0.00001 ) ; return ( xO / xP ) * ( xQ / xR ) ; } float xY ( vec3 xT , vec3 xU , float xV ) { vec3 xW ; float xX ; xX = dot ( xU , - xT ) ; if ( xX < 0.0 ) { return 1.0 ; } xW = xT + xX * xU ; if ( length ( xW ) < xV ) { return 0.0 ; } else if ( length ( xW ) >= xV ) { xW = normalize ( xW ) * xV - xT ; xX = acos ( dot ( normalize ( xW ) , xU ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( xX * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 yb ( float xZ , vec3 x_ , float ya ) { return x_ - x_ * pow ( u_sky_color , vec3 ( ya / xZ ) ) ; } void main ( ) { float yc , yd , ye , yf , yg , yh , yi , yj , yk ; vec3 yl , ym , yn , yo , yp , yq , yr ; yl = normalize ( xC ) ; ym = u_sun_direction ; yc = dot ( yl , ym ) ; yd = xS ( yc , - 0.01 ) * u_rayleigh_brightness * ym . y ; ye = xS ( yc - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - ym . y ) ; yc = smoothstep ( 0.0 , 100.0 , xS ( yc , 0.9995 ) ) * u_spot_brightness ; yn = vec3 ( 0.0 , xD , 0.0 ) ; yf = xL ( yn , yl ) ; yg = yf / float ( xF ) ; yh = xY ( yn , yl , xD - 0.3 ) ; yo = vec3 ( 0.0 , 0.0 , 0.0 ) ; yp = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int ys = 0 ; ys < xF ; ys ++ ) { yi = yg * float ( ys ) ; yq = yn + yl * yi ; yj = xY ( yq , ym , xD - 0.2 ) ; yk = xL ( yq , ym ) ; yr = yb ( yk , vec3 ( xE ) , u_scatter_strength ) * yj ; yo += yb ( sqrt ( yi ) , u_sky_color * yr , u_rayleigh_strength ) ; yp += yb ( yi , yr , u_mie_strength ) ; } yo = yo * yh * pow ( yf , u_rayleigh_collection_power ) / float ( xF ) ; yp = ( yp * yh * pow ( yf , u_mie_collection_power ) ) / float ( xF ) ; yo = vec3 ( yc * yp + ye * yp + yd * yo ) ; em ( yo ) ; gl_FragColor = vec4 ( yo , 1.0 ) ; }".split(" ")}]};
a["procedural_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_cube_view_matrix ; varying vec3 xC ; void main ( ) { vec4 xD , xE ; xD = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; xE = u_cube_view_matrix * xD ; xC = xE . xyz ; gl_Position = xD ; }".split(" ")}]};a["special_lens_flares.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform sampler2D u_sampler ; varying vec2 fk ; void main ( ) { vec4 xD ; xD = texture2D ( u_sampler , fk ) ; em ( xD . rgb ) ; ep ( xD . rgb , xD . a ) ; gl_FragColor = xD ; }".split(" ")}]};
a["special_lens_flares.glslv"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"define",name:"LIGHT_INDEX",b:["0"]},{type:"textline",b:"attribute float a_lf_dist ; attribute vec2 a_lf_bb_vertex ; attribute vec2 a_texcoord ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; varying vec2 fk ; void main ( ) { vec2 xD ; float xE ; vec4 xF ; vec3 xG ; fk = a_texcoord ; xG = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; xF = u_proj_matrix * u_view_matrix * vec4 ( xG , 0.0 ) ; xF . x /= xF . w ; xF . y /= xF . w ; xF += 99999.0 * step ( xF . z , 0.0 ) ; xF += 100.0 * ( step ( 1.0 , abs ( xF . x ) ) + step ( 1.0 , abs ( xF . y ) ) ) ; xF . x = - a_lf_dist * xF . x ; xF . y = - a_lf_dist * xF . y ; xE = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; xD = vec2 ( a_lf_bb_vertex . x / xE , a_lf_bb_vertex . y ) ; if ( a_lf_dist > - 0.999 ) { const float xH = 1.9 ; xD *= ( 1.0 + xH * length ( xF . xy ) ) ; } gl_Position = vec4 ( xF . xy + xD , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"define",name:"INV_PI",b:["0.318309886"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",d:["WO_SKYTEX","PROCEDURAL_SKYDOME",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky",";"]}]}}]},{type:"condition",a:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX",
{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"blending.glslf"},{type:"textline",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; vec3 zJ ( vec3 zE , vec3 zF , float zG , float zH ) { float zI ; zI = zG * zH ;".split(" ")},{type:"condition",a:[{type:"if",d:["BLENDTYPE","MIX",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return xT ( zF , zE , zI ) ;".split(" ")}]}},
{type:"elif",d:["BLENDTYPE","ADD",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return xX ( zE , zF , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SUBTRACT",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return ya ( zE , zF , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yf ( zE , zF , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SCREEN",{type:"equal_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:"return yk ( zE , zF , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","OVERLAY",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yp ( zE , zF , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yt ( zE , zF , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIVIDE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",
b:"return yx ( zE , zF , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DARKEN",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yB ( zE , zF , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LIGHTEN",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yF ( zE , zF , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","HUE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yL ( zF , zE , zI ) ;".split(" ")}]}},{type:"elif",
d:["BLENDTYPE","SATURATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yR ( zF , zE , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","VALUE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yX ( zF , zE , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","COLOR",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return zc ( zF , zE , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SOFT_LIGHT",{type:"equal_expr",e:2}],
group:{type:"group",a:[{type:"textline",b:"return zh ( zF , zE , zI ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return zl ( zF , zE , zI ) ;".split(" ")}]}}]},{type:"textline",b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float zR ( float zK , float zL , float zM , float zN ) { float zO ; vec3 zP , zQ ; zP = vec3 ( zK ) , zQ = vec3 ( zL ) ; zO = zM * zN ;".split(" ")},{type:"condition",a:[{type:"if",d:["BLENDTYPE","MIX",
{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return xT ( zQ , zP , zO ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","ADD",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return xX ( zP , zQ , zO ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SUBTRACT",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return ya ( zP , zQ , zO ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","MULTIPLY",{type:"equal_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:"return zr ( zK , zL , zO , zN ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SCREEN",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return zx ( zK , zL , zO , zN ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","OVERLAY",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return zD ( zK , zL , zO , zN ) ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yt ( zP , zQ , zO ) . x ;".split(" ")}]}},
{type:"elif",d:["BLENDTYPE","DIVIDE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yx ( zP , zQ , zO ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","DARKEN",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yB ( zP , zQ , zO ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LIGHTEN",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return yF ( zP , zQ , zO ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","SOFT_LIGHT",
{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return zh ( zQ , zP , zO ) . x ;".split(" ")}]}},{type:"elif",d:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return zl ( zQ , zP , zO ) . x ;".split(" ")}]}}]},{type:"textline",b:["return","0.0",";","}"]}]}}]},{type:"condition",a:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_camera_eye_frag ; uniform vec3 u_sun_intensity ; uniform float u_environment_energy ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{type:"textline",b:["varying","vec3","xC",";"]},{type:"condition",a:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",
e:2},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fk",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 zS ; float zT , zU , zV ; vec3 zW , zX , zY , zZ , z_ ; zX = normalize ( xC ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["PROCEDURAL_SKYDOME"],group:{type:"group",a:[{type:"textline",b:"zW = textureCube ( u_sky , zX ) . rgb ;".split(" ")}]}},{type:"elif",d:["WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logic_negative_expr",
e:1}],group:{type:"group",a:[{type:"textline",b:"zW = u_horizon_color ; em ( zW ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",d:["WO_SKYPAPER"],group:{type:"group",a:[{type:"textline",b:"zY = vec3 ( fk , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zY = vec3 ( xC . xy , 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:["zT","=","0.0",";"]},{type:"condition",a:[{type:"if",d:["WO_SKYBLEND"],group:{type:"group",
a:[{type:"condition",a:[{type:"if",d:["WO_SKYPAPER"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"zT = abs ( fk . y ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zT = ( fk . y + 1.0 ) * 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zU = acos ( zX . y ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"zT = abs ( zU * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zT = 1.0 - zU * INV_PI ;".split(" ")}]}}]}]}}]}]}}]},{type:"textline",b:"zZ = u_horizon_color ; z_ = u_zenith_color ;".split(" ")},{type:"condition",a:[{type:"if",d:["WO_SKYTEX"],group:{type:"group",a:[{type:"textline",b:"zU = 1.0 ; zS = textureCube ( u_sky , zX ) ; ek ( zS . rgb ) ; zU = zS . a ;".split(" ")},{type:"condition",a:[{type:"if",d:["MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"zU = dot ( zS . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["MTEX_NEGATIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["MTEX_RGBTOINT",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"zS = vec4 ( vec3 ( 1.0 ) - zS . rgb , zS . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zU = 1.0 - zU ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"condition",
a:[{type:"if",d:["MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"zS = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zU = zS . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WOMAP_HORIZ"],group:{type:"group",a:[{type:"textline",b:"zZ = zJ ( zS . rgb , zZ , zU , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",
b:["zV","=","0.0",";"]},{type:"condition",a:[{type:"if",d:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"if ( dot ( zY , vec3 ( 0.0 , 1.0 , 0.0 ) ) >= 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",d:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"zV = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:[";"]}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",d:["WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",
b:"else zV = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"zV = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"elif",d:["WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",b:"zV = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( zV != 0.0 ) z_ = zJ ( zS . rgb , z_ , zU , zV ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["WOMAP_BLEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["MTEX_RGBTOINT",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"zU = dot ( zS . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{type:"textline",b:"zT = zR ( u_sky_tex_dvar , zT , zU , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"zW = mix ( zZ , z_ , zT ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:["zW","=","zZ",";"]}]}}]},{type:"textline",b:["em","(","zW",")",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"em ( zZ ) ; em ( z_ ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"zW = mix ( zZ , z_ , zT ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["zW","=","zZ",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",e:1},"REFLECTION_PASS",
{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:3}],group:{type:"group",a:[{type:"textline",b:"ek ( zW ) ; zT = u_camera_eye_frag . y - WATER_LEVEL ; zT = min ( - zT * 0.03 , 0.8 ) ; zU = clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ; zZ = vec3 ( 0.0 ) ; zS = u_underwater_fog_color_density ; zS . rgb = mix ( zS . rgb , zZ , min ( - zX . y + zT , 1.0 ) ) * zU ; zT = clamp ( sign ( zX . y - 0.05 * zT ) , 0.0 , 1.0 ) ; zW = mix ( zS . rgb , zW , zT ) ; em ( zW ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( zW , 1.0 ) ; }".split(" ")}]};a["special_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_sky_vp_inverse ; varying vec3 xC ;".split(" ")},{type:"condition",a:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fk",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 zE , zF ; zE = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; zF = u_sky_vp_inverse * zE ; xC = zF . xyz ;".split(" ")},
{type:"condition",a:[{type:"if",d:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",e:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"fk = a_position . xy ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","zE",";","}"]}]};a["special_water.glslf"]={type:"group",a:[{type:"var",name:"ABSORB",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"SSS_STRENGTH",b:["6.0"]},{type:"var",name:"SSS_WIDTH",
b:["0.0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"fog.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"lighting.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"},{type:"define",name:"REFL_BUMP",b:["0.001"]},{type:"define",name:"REFR_BUMP",b:["0.0005"]},{type:"textline",b:["uniform","float","u_time",";"]},
{type:"condition",a:[{type:"if",d:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",d:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",d:["NUM_LIGHTS",
0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","WATER_EFFECTS",{type:"logical_or_expr",
e:3}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",
e:1},"PROCEDURAL_FOG",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",d:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",
{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"condition",a:[{type:"if",d:["FOAM"],group:{type:"group",
a:[{type:"textline",b:["uniform","sampler2D","u_foam",";"]}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",
b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",1,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap1_scale",";"]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",2,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap2_scale",";"]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",3,{type:"g_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:2}],
group:{type:"group",a:[{type:"textline",b:["uniform","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["FOAM"],group:{type:"group",a:[{type:"textline",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",d:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_refr_bump",";"]}]}}]},{type:"condition",a:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"const float zE = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",b:"varying vec3 wM ; varying vec3 fa ;".split(" ")},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH",{type:"logic_negative_expr",
e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fk",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 fd ; varying vec3 zF ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fc",";"]}]}}]},{type:"condition",a:[{type:"if",
d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zG",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zH",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:3}],group:{type:"group",
a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:["varying","float","ff",";"]}]}}]},{type:"condition",a:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zI",";"]}]}}]},{type:"include",file:"environment.glslf"},
{type:"condition",a:[{type:"if",d:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",e:3}],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"textline",b:"vec3 zU ( in vec2 zJ , in vec3 zK , in vec3 zL , in vec3 zM , out float zN ) { float zO , zP , zQ ; vec2 zR ; vec3 zS , zT ; zN = 0.0 ; zS = reflect ( - zL , zK ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:"zR = zJ . xy + zK . xz * REFL_BUMP / ff ; zN = u_reflect_factor ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1},"WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"zT = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zT = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"textline",b:"zO = dot ( zL , zK ) ; zN *= max ( 1.0 - 1.0 / zO , 1.0 ) ; } else { zT = texture2D ( u_plane_reflection , zR ) . rgb ; ek ( zT ) ; }".split(" ")}]}},
{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"zN = u_mirror_factor ; zT = zM * textureCube ( u_mirrormap , zS ) . rgb ; ek ( zT ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zN = u_reflect_factor ; zT = zM * vec3 ( 0.3 , 0.5 , 1.0 ) ; ek ( zT ) ;".split(" ")}]}}]},{type:"textline",b:"zS = normalize ( zS + zL ) ; zO = 1.0 - dot ( zL , zS ) ; zP = u_fresnel_params [ 3 ] ; zQ = u_fresnel_params [ 2 ] ; zQ = zP + ( 1.0 - zP ) * pow ( zO , zQ ) ; zN = min ( zN * zQ , 1.0 ) ; return zT ; } void main ( ) { vec4 zV ; vec2 zW , zX , zY ; float zZ , z_ , Aa , Ab , Ac , Ad ; vec3 Ae , Af , Ag , Ah , Ai , Aj , Ak ; mat3 Al ;".split(" ")},
{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"Al = mat3 ( fd , zF , fc ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"Ae = normalize ( fc ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ae = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC","FOAM",{type:"logical_and_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:"zZ = fa . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"zW = vec2 ( zG . x , - zG . z ) + 0.5 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zW = vec2 ( fa . x , - fa . z ) + 0.5 ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["zW","=","fk",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"Af = vec3 ( 0.0 ) ; Ag = texture2D ( u_normalmap0 , zW * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Af += Ag ;".split(" ")},{type:"condition",a:[{type:"if",d:["FOAM"],group:{type:"group",a:[{type:"textline",b:"Ah = vec3 ( 0.0 ) ;".split(" ")},{type:"condition",
a:[{type:"if",d:["NORM_FOAM0"],group:{type:"group",a:[{type:"textline",b:["Ah","+=","Ag",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",1,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"Ag = texture2D ( u_normalmap0 , zW * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Af += Ag ;".split(" ")},{type:"condition",a:[{type:"if",d:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["NORM_FOAM1"],group:{type:"group",
a:[{type:"textline",b:["Ah","+=","Ag",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",2,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"Ag = texture2D ( u_normalmap0 , zW * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Af += Ag ;".split(" ")},{type:"condition",a:[{type:"if",d:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["NORM_FOAM2"],group:{type:"group",a:[{type:"textline",b:["Ah","+=","Ag",
";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",3,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"Ag = texture2D ( u_normalmap0 , zW * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Af += Ag ;".split(" ")},{type:"condition",a:[{type:"if",d:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["NORM_FOAM3"],group:{type:"group",a:[{type:"textline",b:["Ah","+=","Ag",";"]}]}}]}]}}]}]}}]},{type:"condition",
a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["FOAM"],group:{type:"group",a:[{type:"textline",b:"Ah = Al * Ah ; if ( ! ev ( Ah , vec3 ( 0.0 ) ) ) Ah = normalize ( Ah ) ; Ah = mix ( Ae , Ah , 0.2 ) ; Ah = normalize ( Ah ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"Ae = mix ( Ae , normalize ( Al * Af ) , 0.3 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"Ae = mix ( Ae , normalize ( Al * Af ) , 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:"Ae = normalize ( Ae ) ;".split(" ")}]}}]},{type:"textline",b:"Af = normalize ( wM ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"zX = fe . xy / fe . z ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING","DISABLE_FOG",{type:"logic_negative_expr",
e:1},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"z_ = ff * u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"Aa = u_diffuse_color . a ; zV = texture2DProj ( u_scene_depth , fe ) ; Ab = k ( zV ) ; Ac = max ( Ab - ff , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"zY = zX + Ae . xz * u_refr_bump / ff ; Ab = hH ( Ab , zY , zX ) ; Ab = max ( Ab - ff , 0.0 ) ; Ab = u_view_max_depth / ABSORB * Ab ; if ( u_cam_water_depth < 0.0 ) Ad = 0.0 ; else Ad = min ( Aa * Ab , 1.0 ) ; Ab = u_view_max_depth / ABSORB * Ac ; Aa = min ( 15.0 * Aa * u_view_max_depth * Ac , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"Ab = u_view_max_depth / ABSORB * Ac ; if ( u_cam_water_depth > 0.0 ) Aa = min ( Aa * Ab , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"Aa *= min ( 5.0 * z_ , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Aa = u_diffuse_color . a ;".split(" ")},{type:"condition",a:[{type:"if",d:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"Ad = 1.0 - Aa ; zY = zX + Ae . xz * u_refr_bump / ff ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",d:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"Ag = texture2D ( u_refractmap , zY ) . rgb ; ek ( Ag ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"Ab = pow ( min ( zH . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; Ai = mix ( u_shallow_water_col , u_diffuse_color . rgb , Ab ) ; Ab = pow ( min ( zH . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; Ai = mix ( u_shore_water_col , Ai , Ab ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"Ai = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"Ac = max ( 1.0 - u_view_max_depth * Ac , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ac = 1.0 - Aa ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC"],group:{type:"group",a:[{type:"textline",
b:"zZ = max ( zZ / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"Aj = normalize ( vec3 ( zH . r , 0.0 , zH . g ) ) ; Aj = normalize ( mix ( vec3 ( 0.0 , 1.0 , 0.0 ) , Aj , 0.8 ) ) ; Ab = 1.25 * max ( dot ( Ah , Aj ) - 0.2 , 0.0 ) ; Ab += max ( dot ( Ah , vec3 ( 0.0 , - 1.0 , 0.0 ) ) , 0.0 ) ; Ac += Ab * ( 1.0 - zH . b ) ; zZ *= ( 1.0 - 0.95 * pow ( zH . b , 0.1 ) ) ;".split(" ")}]}}]},{type:"textline",b:"Ac += zZ ; Ac = min ( u_foam_factor * Ac , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"zV = texture2D ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + zW * u_foam_scale ) ;".split(" ")}]}}]},{type:"textline",b:"zZ = u_specular_params [ 0 ] ; zW = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; Ah = zZ * u_specular_color ; Aj = u_environment_energy * hB ( Ae ) ; Aj = u_ambient * Aj ; Aj = Aj + u_sun_intensity ;".split(" ")},{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",
b:"Ak = zU ( zX , Ae , Af , Aj , zZ ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ak = zU ( vec2 ( 0.0 ) , Ae , Af , Aj , zZ ) ;".split(" ")}]}}]},{type:"textline",b:"Ai = u_diffuse_intensity * Ai ;".split(" ")},{type:"condition",a:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"am Am = cU ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Ai , Ah , fa , Ae , Af , zW , u_diffuse_params , 1.0 , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"am Am = cZ ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Ai ) ;".split(" ")}]}}]},{type:"textline",b:"Ai = Am . a . rgb ;".split(" ")},{type:"condition",a:[{type:"if",d:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"Ab = max ( dot ( u_sun_direction , - fc ) + SSS_WIDTH , 0.0 ) * max ( dot ( - Af , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; Ab = clamp ( SSS_STRENGTH * Ab , 0.0 , 1.0 ) ; Ai = mix ( Ai , u_shallow_water_col , Ab ) ; Ai = mix ( Ai , u_shore_water_col , Ab ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"Ai = mix ( Ag , Ai , Ad ) ;".split(" ")}]}}]},{type:"textline",b:"Ai = mix ( Ai , Ak , zZ ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["FOAM"],group:{type:"group",a:[{type:"textline",b:"zZ = mix ( zV . g , zV . r , max ( 4.0 * ( Ac - 0.75 ) , 0.0 ) ) ; zZ = mix ( zV . b , zZ , max ( 2.0 * Ac - 1.0 , 0.0 ) ) ; zZ = mix ( 0.0 , zZ , Ac ) ; Ai = mix ( Ai , Aj , zZ ) ;".split(" ")}]}}]},{type:"textline",
b:"Ai += Am . b ;".split(" ")},{type:"condition",a:[{type:"if",d:["DISABLE_FOG",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"Af = L ( u_cube_fog , Af ) ; zV = vec4 ( Af , u_fog_color_density . a ) ; ek ( zV . rgb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["zV","=","u_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",
a:[{type:"textline",b:"if ( u_cam_water_depth < 0.0 ) { ai ( Ai , z_ , u_cam_water_depth , u_underwater_fog_color_density , clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ) ; } else { E ( Ai , z_ , zV ) ; }".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"E ( Ai , z_ , zV ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["em","(","Ai",")",";"]},{type:"condition",a:[{type:"if",d:["REFRACTIVE",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",
b:"Aa = max ( Aa , Am . b . r ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["FOAM"],group:{type:"group",a:[{type:"textline",b:["Aa","+=","zZ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"ep ( Ai , Aa ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",b:"Af = fwidth ( zI ) ; Af = smoothstep ( vec3 ( 0.0 ) , Af * zE , zI ) ; zZ = min ( min ( Af . x , Af . y ) , Af . z ) ; zZ = clamp ( zZ , 0.0 , 1.0 ) ; Ai = mix ( u_wireframe_edge_color , Ai , zZ ) ; Aa = mix ( 1.0 , Aa , zZ ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( Ai , Aa ) ; }".split(" ")}]};a["special_water.glslv"]={type:"group",a:[{type:"var",name:"DIR_MIN_SHR_FAC",b:["0.0"]},{type:"var",name:"DIR_FREQ",b:["0.0"]},{type:"var",name:"DIR_NOISE_SCALE",b:["0.0"]},{type:"var",name:"DIR_NOISE_FREQ",b:["0.0"]},{type:"var",name:"DIR_MIN_NOISE_FAC",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_0",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_0",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_1",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_1",
b:["0.0"]},{type:"var",name:"DST_MIN_FAC",b:["0.0"]},{type:"var",name:"MAX_SHORE_DIST",b:["0.0"]},{type:"var",name:"PRECISION",b:["mediump"]},{type:"var",name:"SHORE_MAP_CENTER_X",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_X",b:["0.0"]},{type:"var",name:"SHORE_MAP_CENTER_Y",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_Y",b:["0.0"]},{type:"var",name:"WAVES_HOR_FAC",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"WAVES_LENGTH",b:["0.0"]},
{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"include",file:"procedural.glslf"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"DYNAMIC",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_normal ; attribute vec3 a_tangent ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
d:["GENERATED_MESH",{type:"logic_negative_expr",e:1},"NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_polyindex",";"]}]}}]},{type:"condition",a:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{type:"condition",a:[{type:"if",d:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",
"DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{type:"textline",b:"varying vec3 wM ; varying vec3 fa ;".split(" ")},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},
"GENERATED_MESH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","fk",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 fd ; varying vec3 zF ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3",
"fc",";"]}]}}]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zG",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zH",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",
{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","fe",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:["varying","float","ff",";"]}]}}]},{type:"condition",a:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zI",";"]}]}}]},
{type:"condition",a:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"vec3 zN ( in vec2 zE ) { float zJ ; vec4 zK ; vec2 zL ; zL = 0.5 + vec2 ( ( zE . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , - ( zE . y + SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; zK = texture2D ( u_shore_dist_map , zL ) ; const vec2 zM = vec2 ( 1.0 / 255.0 , 1.0 ) ; zJ = dot ( zK . ba , zM ) ; zL = normalize ( zK . rg * 2.0 - 1.0 ) ; return vec3 ( zL , zJ ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",
d:["DYNAMIC"],group:{type:"group",a:[{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"define",name:"SMALL_WAVES_FAC",b:["0.3"]},{type:"textline",b:"void zZ ( inout vec3 zO , in float zP , in vec3 zQ ) { vec2 zR , zS , zT ; float zU , zV , zW , zX , zY ; zU = dN ( DST_NOISE_SCALE_0 * ( zO . xz + DST_NOISE_FREQ_0 * zP ) ) * dN ( DST_NOISE_SCALE_1 * ( zO . zx - DST_NOISE_FREQ_1 * zP ) ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"zV = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; zW = zQ . b ; zX = sqrt ( zW ) ; zV = max ( zW , DIR_MIN_SHR_FAC ) * sin ( zX / zV + DIR_FREQ * zP ) ; zY = max ( dN ( DIR_NOISE_SCALE * ( zO . xz + DIR_NOISE_FREQ * zP ) ) , DIR_MIN_NOISE_FAC ) ; zV *= zY ; zX = WAVES_HEIGHT * mix ( zV , zU , max ( zX , DST_MIN_FAC ) ) ; zR = zQ . rg ; zV = WAVES_HOR_FAC * zV * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - zW ) , 0.0 ) ; zR = zV * zR ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zX = WAVES_HEIGHT * zU ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"zS = 2.0 * ( zO . xz - 0.1 * zP ) ; zT = 1.3 * ( zO . zx + 0.03 * zP ) ; zU = dr ( 0.5 * zS ) . x + dr ( 0.5 * zT ) . x - 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"zO . xz += zR ; zU *= zW ;".split(" ")}]}}]},{type:"textline",b:"zX += SMALL_WAVES_FAC * zU ;".split(" ")}]}}]},
{type:"textline",b:"zO . y += zX ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { vec4 z_ , Aa ; vec2 Ab ; float Ac , Ad , Ae ; vec3 Af , Ag , Ah , Ai ;".split(" ")},{type:"condition",a:[{type:"if",d:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"if ( a_polyindex == 0.0 ) zI = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) zI = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) zI = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["Af","=",
"a_position",";"]},{type:"condition",a:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"Ac = abs ( Af . y ) ; Ab = u_camera_eye . xz - mod ( u_camera_eye . xz , Ac ) ; Af . y = WATER_LEVEL ; Af . xz += Ab ;".split(" ")}]}},{type:"elif",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["fk","=","a_texcoord",";"]}]}}]},{type:"textline",b:"es Aj = t_ ( Af , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"zH = zN ( Aj . a . xz ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"Ad = length ( u_wind ) ; Ae = u_time ; Ae *= Ad ;".split(" ")},{type:"condition",a:[{type:"if",d:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"Ac = Ac ; Af = Aj . a + vec3 ( Ac , 0.0 , 0.0 ) ; Ag = Aj . a + vec3 ( 0.0 , 0.0 , Ac ) ; if ( a_position . y < 0.0 ) { Aj . a . y = WATER_LEVEL - 1.0 ; Af . y = Aj . a . y ; Ag . y = Aj . a . y ; }".split(" ")},
{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",0,{type:"g_expr",e:2},"FOAM",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"zG = Aj . a ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Af = Aj . a + vec3 ( 0.05 , 0.0 , 0.0 ) ; Ag = Aj . a + vec3 ( 0.0 , 0.0 , 0.05 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"Ah = zN ( Af . xz ) ; Ai = zN ( Ag . xz ) ; zZ ( Af , Ae , Ah ) ; zZ ( Ag , Ae , Ai ) ; zZ ( Aj . a , Ae , zH ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"zZ ( Af , Ae , vec3 ( 0.0 ) ) ; zZ ( Ag , Ae , vec3 ( 0.0 ) ) ; zZ ( Aj . a , Ae , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:"Af = normalize ( Af - Aj . a ) ; Ag = normalize ( Ag - Aj . a ) ; fc = normalize ( cross ( Ag , Af ) ) ; Ae = dot ( fc , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; Ae = clamp ( 0.8 - Ae , 0.0 , 1.0 ) ; fc = mix ( fc , vec3 ( 0.0 , 1.0 , 0.0 ) , Ae ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["NUM_NORMALMAPS",
0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DYNAMIC",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"Ag = a_tangent ; fc = a_normal ;".split(" ")}]}}]},{type:"textline",b:"fd = Ag ; zF = cross ( fc , fd ) ;".split(" ")}]}}]},{type:"textline",b:"fa = Aj . a ; wM = u_camera_eye - Aj . a ; z_ = u_view_matrix * vec4 ( Aj . a , 1.0 ) ; Aa = u_proj_matrix * z_ ;".split(" ")},{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE",
"REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE",{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:"Ae = Aa . x ; Ac = Aa . y ; Ad = Aa . w ; fe . x = ( Ae + Ad ) / 2.0 ; fe . y = ( Ac + Ad ) / 2.0 ; fe . z = Ad ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",e:1},{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:"ff = - z_ . z / u_view_max_depth ;".split(" ")}]}}]},
{type:"textline",b:["gl_Position","=","Aa",";","}"]}]};a["wireframe.glslf"]={type:"group",a:[{type:"define",name:"WM_OPAQUE_WIREFRAME",b:["0"]},{type:"define",name:"WM_TRANSPARENT_WIREFRAME",b:["1"]},{type:"define",name:"WM_FRONT_BACK_VIEW",b:["2"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"uniform int u_wireframe_mode ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},
{type:"textline",b:"varying vec3 zI ; const float zE = 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DEBUG_SPHERE_DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"const vec3 zJ = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 zJ = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 zK = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 zL = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 zM = vec3 ( 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"void main ( ) { float zN , zO ; vec3 zP , zQ ; zP = vec3 ( 0.0 ) ; zN = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"zQ = sign ( zI - vec3 ( 0.02 * zE ) ) ; if ( zQ . x < 0.0 || zQ . y < 0.0 || zQ . z < 0.0 ) { zP = zJ ; zN = 1.0 ; } else discard ;".split(" ")}]}},{type:"elif",d:["WIREFRAME_QUALITY",0,{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"zQ = sign ( zI - vec3 ( 0.02 * zE ) ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { if ( zQ . x < 0.0 || zQ . y < 0.0 || zQ . z < 0.0 ) zP = u_wireframe_edge_color ; else zP = zM ; zN = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { if ( zQ . x < 0.0 || zQ . y < 0.0 || zQ . z < 0.0 ) zN = 1.0 ; else zN = 0.0 ; zP = u_wireframe_edge_color ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( zQ . x < 0.0 || zQ . y < 0.0 || zQ . z < 0.0 ) zP = u_wireframe_edge_color ; else if ( gl_FrontFacing ) zP = zK ; else zP = zL ; zN = 1.0 ; }".split(" ")}]}},
{type:"elif",d:["WIREFRAME_QUALITY",1,{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",b:"zQ = fwidth ( zI ) ; zQ = smoothstep ( vec3 ( 0.0 ) , zQ * zE , zI ) ; zO = min ( min ( zQ . x , zQ . y ) , zQ . z ) ; zO = clamp ( zO , 0.0 , 1.0 ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { zP = vec3 ( mix ( u_wireframe_edge_color , zM , zO ) ) ; zN = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { zP = u_wireframe_edge_color ; zN = mix ( 1.0 , 0.0 , zO ) ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( gl_FrontFacing ) zP = mix ( u_wireframe_edge_color , zK , zO ) ; else zP = mix ( u_wireframe_edge_color , zL , zO ) ; zN = 1.0 ; }".split(" ")}]}}]},
{type:"textline",b:["em","(","zP",")",";"]},{type:"condition",a:[{type:"if",d:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"ep ( zP , zN ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( zP , zN ) ; }".split(" ")}]};a["wireframe.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_polyindex ;".split(" ")},
{type:"condition",a:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],
group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ;".split(" ")},
{type:"condition",a:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},{type:"condition",a:[{type:"if",d:["BILLBOARD","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{type:"condition",
a:[{type:"if",d:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",a:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{type:"textline",b:["varying","vec3","zI",";"]},{type:"condition",a:[{type:"if",d:["DEBUG_SPHERE",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"include",file:"dynamic_grass.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 zE ; mat4 zJ ; vec3 zK , zL , zM , zN , zO ; if ( a_polyindex == 0.0 ) zI = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) zI = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) zI = vec3 ( 0.0 , 0.0 , 1.0 ) ; zK = a_position ; zL = a_normal ;".split(" ")},
{type:"condition",a:[{type:"if",d:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"es zP = t_ ( zK , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"zK = mix ( zK , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"zM = vec3 ( 0.0 ) ; zN = vec3 ( 0.0 ) ; u_ ( zK , zM , zN , zL ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:["zN","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zN = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"es zP = wy ( zK , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , zN , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"zM = ( u_model_matrix * vec4 ( zN , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"zJ = tT ( u_camera_eye , zM , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"zJ = tN ( u_camera_eye , zM , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"zO = ( u_model_matrix * vec4 ( zN , 1.0 ) ) . xyz ; zJ = zJ * tF ( u_wind , u_time , u_jitter_amp , u_jitter_freq , zO ) ;".split(" ")}]}}]},{type:"textline",b:"es zP = t_ ( zK - zN , zN , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , zJ ) ; zP . b = zM ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"es zP = t_ ( zK , zN , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"vO ( zP . a , zP . b , zL ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"zE = u_view_matrix * vec4 ( zP . a , 1.0 ) ; gl_Position = u_proj_matrix * zE ; }".split(" ")}]};a["postprocessing/anaglyph.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",
b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; varying vec2 fk ; void main ( ) { vec4 zE , zJ ; zE = texture2D ( u_sampler_left , fk ) ; zJ = texture2D ( u_sampler_right , fk ) ; gl_FragColor = vec4 ( zE [ 0 ] , zJ [ 1 ] , zJ [ 2 ] , zE [ 3 ] + zJ [ 3 ] ) ; }".split(" ")}]};a["postprocessing/antialiasing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"AA_METHOD_PASS",b:["1"]},{type:"define",name:"AA_METHOD_FXAA_LIGHT",b:["2"]},
{type:"define",name:"AA_METHOD_FXAA_QUALITY",b:["3"]},{type:"define",name:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{type:"define",name:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{type:"define",name:"FXAA_SPAN_MAX",b:["8.0"]},{type:"textline",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; varying vec2 fk ; vec4 zL ( float zE , float zJ ) { vec2 zK ; zK = fk + vec2 ( zE , zJ ) * u_texel_size ; return texture2D ( u_color , zK ) ; } float zP ( vec4 zM ) { float zN ; vec3 zO ; zO = vec3 ( 0.299 , 0.587 , 0.114 ) ; zN = dot ( zM . rgb , zO ) ; return zN ; } vec4 Ab ( ) { vec2 zQ ; float zR , zS , zT , zU , zV , zW ; vec4 zX , zY , zZ , z_ , Aa ; zX = zL ( - 1.0 , - 1.0 ) ; zY = zL ( 1.0 , - 1.0 ) ; zZ = zL ( - 1.0 , 1.0 ) ; z_ = zL ( 1.0 , 1.0 ) ; Aa = zL ( 0.0 , 0.0 ) ; zR = zP ( zX ) ; zS = zP ( zY ) ; zT = zP ( zZ ) ; zU = zP ( z_ ) ; zV = zP ( Aa ) ; zW = min ( zV , min ( min ( zR , zS ) , min ( zT , zU ) ) ) ; zV = max ( zV , max ( max ( zR , zS ) , max ( zT , zU ) ) ) ; zQ . x = - ( ( zR + zS ) - ( zT + zU ) ) ; zQ . y = ( ( zR + zT ) - ( zS + zU ) ) ; zU = max ( ( zR + zS + zT + zU ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; zU = 1.0 / ( min ( abs ( zQ . x ) , abs ( zQ . y ) ) + zU ) ; zQ = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , zQ * zU ) ) * u_texel_size ; Aa = 0.5 * ( texture2D ( u_color , fk + zQ * ( 1.0 / 3.0 - 0.5 ) ) + texture2D ( u_color , fk + zQ * ( 2.0 / 3.0 - 0.5 ) ) ) ; z_ = Aa * 0.5 + 0.25 * ( texture2D ( u_color , fk + zQ * - 0.5 ) + texture2D ( u_color , fk + zQ * 0.5 ) ) ; zU = zP ( z_ ) ; if ( ( zU < zW ) || ( zU > zV ) ) return Aa ; else return z_ ; }".split(" ")},
{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",b:["(","1.0","/","6.0",")"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["(","1.0","/","12.0",")"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",b:["(","3.0","/","4.0",")"]},{type:"textline",b:"vec4 AG ( ) { bool Ac , Ad , Ae , Af , Ag ; float Ah , Ai , Aj , Ak , Al , Am , An , Ao , Ap , Aq , Ar , As , At , Au , Av ; vec4 Aw , Ax , Ay , Az , AA ; vec2 AB , AC , AD , AE , AF ; AB . x = fk . x ; AB . y = fk . y ; Aw = texture2D ( u_color , AB ) ; Ax = zL ( 0.0 , 1.0 ) ; Ay = zL ( 1.0 , 0.0 ) ; Az = zL ( 0.0 , - 1.0 ) ; AA = zL ( - 1.0 , 0.0 ) ; Ah = zP ( Ax ) ; Ai = zP ( Ay ) ; Aj = zP ( Az ) ; Ak = zP ( AA ) ; Al = zP ( Aw ) ; Am = max ( Ah , Al ) ; An = min ( Ah , Al ) ; Am = max ( Ai , Am ) ; An = min ( Ai , An ) ; Ao = max ( Aj , Ak ) ; Ap = min ( Aj , Ak ) ; Am = max ( Ao , Am ) ; An = min ( Ap , An ) ; Ap = Am * FXAA_QUALITY_EDGE_THRESHOLD ; An = Am - An ; Ap = max ( FXAA_QUALITY_EDGE_THRESHOLD_MIN , Ap ) ; Ac = An < Ap ; if ( Ac ) return Aw ; Aw = zL ( - 1.0 , - 1.0 ) ; AA = zL ( 1.0 , 1.0 ) ; Az = zL ( 1.0 , - 1.0 ) ; Ay = zL ( - 1.0 , 1.0 ) ; Ap = zP ( Aw ) ; Am = zP ( AA ) ; Ao = zP ( Az ) ; Aq = zP ( Ay ) ; Ar = Aj + Ah ; As = Ak + Ai ; An = 1.0 / An ; At = Ar + As ; Ar = ( - 2.0 * Al ) + Ar ; As = ( - 2.0 * Al ) + As ; Au = Ao + Am ; Ao = Ap + Ao ; Av = ( - 2.0 * Ai ) + Au ; Ao = ( - 2.0 * Aj ) + Ao ; Ap = Ap + Aq ; Am = Aq + Am ; Av = ( abs ( Ar ) * 2.0 ) + abs ( Av ) ; Ao = ( abs ( As ) * 2.0 ) + abs ( Ao ) ; As = ( - 2.0 * Ak ) + Ap ; Am = ( - 2.0 * Ah ) + Am ; Av = abs ( As ) + Av ; Ao = abs ( Am ) + Ao ; Au = Ap + Au ; Ap = u_texel_size . x ; Ac = Av >= Ao ; Au = At * 2.0 + Au ; if ( ! Ac ) Aj = Ak ; if ( ! Ac ) Ah = Ai ; if ( Ac ) Ap = u_texel_size . y ; Au = ( Au * ( 1.0 / 12.0 ) ) - Al ; Ai = Aj - Al ; Ak = Ah - Al ; Aj = Aj + Al ; Ah = Ah + Al ; Ad = abs ( Ai ) >= abs ( Ak ) ; Ak = max ( abs ( Ai ) , abs ( Ak ) ) ; if ( Ad ) Ap = - Ap ; An = clamp ( abs ( Au ) * An , 0.0 , 1.0 ) ; AC . x = AB . x ; AC . y = AB . y ; AD . x = ( ! Ac ) ? 0.0 : u_texel_size . x ; AD . y = ( Ac ) ? 0.0 : u_texel_size . y ; if ( ! Ac ) AC . x += Ap * 0.5 ; if ( Ac ) AC . y += Ap * 0.5 ; AE . x = AC . x - AD . x ; AE . y = AC . y - AD . y ; AF . x = AC . x + AD . x ; AF . y = AC . y + AD . y ; Au = ( ( - 2.0 ) * An ) + 3.0 ; Ai = zP ( texture2D ( u_color , AE ) ) ; An = An * An ; At = zP ( texture2D ( u_color , AF ) ) ; if ( ! Ad ) Aj = Ah ; Ak = Ak * 1.0 / 4.0 ; Al = Al - Aj * 0.5 ; An = Au * An ; Ad = Al < 0.0 ; Ai -= Aj * 0.5 ; At -= Aj * 0.5 ; Ae = abs ( Ai ) >= Ak ; Af = abs ( At ) >= Ak ; if ( ! Ae ) AE . x -= AD . x * 1.5 ; if ( ! Ae ) AE . y -= AD . y * 1.5 ; Ag = ( ! Ae ) || ( ! Af ) ; if ( ! Af ) AF . x += AD . x * 1.5 ; if ( ! Af ) AF . y += AD . y * 1.5 ; if ( Ag ) { if ( ! Ae ) Ai = zP ( texture2D ( u_color , AE . xy ) ) ; if ( ! Af ) At = zP ( texture2D ( u_color , AF . xy ) ) ; if ( ! Ae ) Ai = Ai - Aj * 0.5 ; if ( ! Af ) At = At - Aj * 0.5 ; Ae = abs ( Ai ) >= Ak ; Af = abs ( At ) >= Ak ; if ( ! Ae ) AE . x -= AD . x * 2.0 ; if ( ! Ae ) AE . y -= AD . y * 2.0 ; Ag = ( ! Ae ) || ( ! Af ) ; if ( ! Af ) AF . x += AD . x * 2.0 ; if ( ! Af ) AF . y += AD . y * 2.0 ; if ( Ag ) { if ( ! Ae ) Ai = zP ( texture2D ( u_color , AE . xy ) ) ; if ( ! Af ) At = zP ( texture2D ( u_color , AF . xy ) ) ; if ( ! Ae ) Ai = Ai - Aj * 0.5 ; if ( ! Af ) At = At - Aj * 0.5 ; Ae = abs ( Ai ) >= Ak ; Af = abs ( At ) >= Ak ; if ( ! Ae ) AE . x -= AD . x * 2.0 ; if ( ! Ae ) AE . y -= AD . y * 2.0 ; Ag = ( ! Ae ) || ( ! Af ) ; if ( ! Af ) AF . x += AD . x * 2.0 ; if ( ! Af ) AF . y += AD . y * 2.0 ; if ( Ag ) { if ( ! Ae ) Ai = zP ( texture2D ( u_color , AE . xy ) ) ; if ( ! Af ) At = zP ( texture2D ( u_color , AF . xy ) ) ; if ( ! Ae ) Ai = Ai - Aj * 0.5 ; if ( ! Af ) At = At - Aj * 0.5 ; Ae = abs ( Ai ) >= Ak ; Af = abs ( At ) >= Ak ; if ( ! Ae ) AE . x -= AD . x * 4.0 ; if ( ! Ae ) AE . y -= AD . y * 4.0 ; Ag = ( ! Ae ) || ( ! Af ) ; if ( ! Af ) AF . x += AD . x * 4.0 ; if ( ! Af ) AF . y += AD . y * 4.0 ; if ( Ag ) { if ( ! Ae ) Ai = zP ( texture2D ( u_color , AE . xy ) ) ; if ( ! Af ) At = zP ( texture2D ( u_color , AF . xy ) ) ; if ( ! Ae ) Ai = Ai - Aj * 0.5 ; if ( ! Af ) At = At - Aj * 0.5 ; Ae = abs ( Ai ) >= Ak ; Af = abs ( At ) >= Ak ; if ( ! Ae ) AE . x -= AD . x * 2.0 ; if ( ! Ae ) AE . y -= AD . y * 2.0 ; if ( ! Af ) AF . x += AD . x * 2.0 ; if ( ! Af ) AF . y += AD . y * 2.0 ; } } } } Ak = AB . x - AE . x ; Aj = AF . x - AB . x ; if ( ! Ac ) Ak = AB . y - AE . y ; if ( ! Ac ) Aj = AF . y - AB . y ; Af = ( Ai < 0.0 ) != Ad ; Ai = ( Aj + Ak ) ; Ad = ( At < 0.0 ) != Ad ; Ai = 1.0 / Ai ; Ae = Ak < Aj ; Aj = min ( Ak , Aj ) ; Ad = Ae ? Af : Ad ; An = An * An ; Ai = ( Aj * ( - Ai ) ) + 0.5 ; An = An * FXAA_QUALITY_SUBPIX ; Ai = Ad ? Ai : 0.0 ; An = max ( Ai , An ) ; if ( ! Ac ) AB . x += An * Ap ; if ( Ac ) AB . y += An * Ap ; return texture2D ( u_color , AB ) ; }".split(" ")},
{type:"define",name:"FXAA_CONSOLE_EDGE_SHARPNESS",b:["8.0"]},{type:"define",name:"FXAA_CONSOLE_EDGE_THRESHOLD",b:["0.125"]},{type:"define",name:"FXAA_CONSOLE_EDGE_THRESHOLD_MIN",b:["0.05"]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",d:["AA_METHOD","AA_METHOD_PASS",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = texture2D ( u_color , fk ) ;".split(" ")}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{type:"equal_expr",e:2}],
group:{type:"group",a:[{type:"textline",b:"gl_FragColor = Ab ( ) ;".split(" ")}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = AG ( ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , 1.0 , 0.0 , 1.0 ) * texture2D ( u_color , fk ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},
{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 fk ; void main ( ) { vec4 zE ; vec2 zJ , zK ; zJ = vec2 ( 0.0 , 0.0 ) ; zK = u_texel_size ; zE = texture2D ( u_color , fk ) ; gl_FragColor = zE * 0.0875447373698 ; zJ += zK ; gl_FragColor += texture2D ( u_color , fk + zJ ) * 0.0858112354248 ; gl_FragColor += texture2D ( u_color , fk - zJ ) * 0.0858112354248 ; zJ += zK ; gl_FragColor += texture2D ( u_color , fk + zJ ) * 0.0808139781061 ; gl_FragColor += texture2D ( u_color , fk - zJ ) * 0.0808139781061 ; zJ += zK ; gl_FragColor += texture2D ( u_color , fk + zJ ) * 0.0731235112908 ; gl_FragColor += texture2D ( u_color , fk - zJ ) * 0.0731235112908 ; zJ += zK ; gl_FragColor += texture2D ( u_color , fk + zJ ) * 0.0635705267419 ; gl_FragColor += texture2D ( u_color , fk - zJ ) * 0.0635705267419 ; zJ += zK ; gl_FragColor += texture2D ( u_color , fk + zJ ) * 0.0530985673112 ; gl_FragColor += texture2D ( u_color , fk - zJ ) * 0.0530985673112 ; zJ += zK ; gl_FragColor += texture2D ( u_color , fk + zJ ) * 0.0426125984122 ; gl_FragColor += texture2D ( u_color , fk - zJ ) * 0.0426125984122 ; zJ += zK ; gl_FragColor += texture2D ( u_color , fk + zJ ) * 0.0328565115809 ; gl_FragColor += texture2D ( u_color , fk - zJ ) * 0.0328565115809 ; zJ += zK ; gl_FragColor += texture2D ( u_color , fk + zJ ) * 0.0243407024472 ; gl_FragColor += texture2D ( u_color , fk - zJ ) * 0.0243407024472 ; gl_FragColor = max ( 0.7 * zE , gl_FragColor ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; varying vec2 fk ; void main ( ) { vec4 zE , zJ ; zE = texture2D ( u_main , fk ) ; zJ = texture2D ( u_bloom , fk ) ; zE = zE ; zE += zJ ; gl_FragColor = vec4 ( zE . rgb , 1.0 ) ; }".split(" ")}]};a["postprocessing/compositing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"PI_4",
b:["0.785398163"]},{type:"textline",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; varying vec2 fk ; void main ( ) { float zE ; vec3 zJ , zK ; vec4 zL ; zL = texture2D ( u_color , fk ) ; zJ = zL . rgb ; if ( u_brightness < 0.0 ) zJ = zJ * ( 1.0 + u_brightness ) ; else zJ = zJ + ( ( 1.0 - zJ ) * u_brightness ) ; zJ = ( zJ - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * PI_4 ) ) + 0.5 ; zJ *= u_exposure ; zK = vec3 ( 0.299 , 0.587 , 0.114 ) ; zE = dot ( zJ , zK ) ; zJ = mix ( vec3 ( zE ) , zJ , u_saturation ) ; gl_FragColor = vec4 ( zJ , zL . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; varying vec2 fk ; void main ( ) { gl_FragColor = g ( clamp ( zP ( u_depth , fk , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};a["postprocessing/dof.glslf"]=
{type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front ; uniform float u_dof_rear ; uniform vec2 u_camera_range ; varying vec2 fk ; void main ( ) { float zE , zQ ; vec4 zR , zS ; zR = texture2D ( u_sharp , fk ) ; if ( u_dof_dist > 0.0 ) { zE = zP ( u_depth , fk , u_camera_range ) ; zE *= u_view_max_depth ; if ( zE < u_dof_dist ) zQ = ( u_dof_dist - zE ) / u_dof_front ; else zQ = ( zE - u_dof_dist ) / u_dof_rear ; zQ = clamp ( zQ , 0.0 , 1.0 ) ; zS = texture2D ( u_blurred , fk ) ; gl_FragColor = mix ( zR , zS , zQ ) ; } else gl_FragColor = zR ; }".split(" ")}]};
a["postprocessing/glow.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; varying vec2 fk ; void main ( ) { float zE ; vec4 zQ , zR , zS ; zQ = texture2D ( u_src_color , fk ) ; zR = texture2D ( u_glow_mask_small , fk ) ; zS = texture2D ( u_glow_mask_large , fk ) ; gl_FragColor = zQ ; if ( zS . a != 0.0 ) { zE = u_glow_mask_large_coeff * zS . a ; zE = clamp ( zE , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , zS . rgb / zS . a , zE ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , zE ) ; } if ( zR . a != 0.0 ) { zE = u_glow_mask_small_coeff * zR . a ; zE = clamp ( zE , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , zR . rgb / zR . a , zE ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , zE ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"var",name:"STEPS_PER_PASS",b:["0.0"]},{type:"textline",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{type:"condition",
a:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_camera_range",";"]},{type:"condition",a:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"varying float zQ ; varying vec2 zR ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 fk ; varying vec4 zS ; void main ( ) { vec4 zT ; float zU , zV , zW , zX , zY ; vec2 zZ , z_ , Aa ; zZ = ( zS . xy - fk ) ; zU = length ( zZ ) ; zZ = u_radial_blur_step * zZ / zU ; zV = zU / u_radial_blur_step ; zZ *= min ( zV , STEPS_PER_PASS ) / STEPS_PER_PASS ; zV = max ( zV , STEPS_PER_PASS ) ; z_ = fk ; zW = 0.0 ; for ( float Ab = 0.0 ; Ab < STEPS_PER_PASS ; Ab += 1.0 ) { if ( Ab <= zV ) {".split(" ")},
{type:"condition",a:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:"zX = zP ( u_input , z_ , u_camera_range ) ; zW += max ( ( 1.0 - pow ( zU , 0.3 ) ) * step ( 0.9 , zX ) , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zT = texture2D ( u_input , z_ ) ; zW += k ( zT ) ;".split(" ")}]}}]},{type:"textline",b:"} z_ += zZ ; }".split(" ")},{type:"condition",a:[{type:"if",d:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:"Aa = fk + zR ; zY = dr ( vec2 ( 2.5 * ( Aa . x ) , 2.5 * ( Aa . y ) + 1.0 * u_time ) ) . x + 0.75 * dr ( vec2 ( 5.0 * ( Aa . x ) - 0.66 * u_time , 5.0 * ( Aa . y ) + 0.66 * u_time ) ) . x + 0.5 * dN ( vec2 ( 7.5 * ( Aa . x ) + 0.33 * u_time , 7.5 * ( Aa . y ) - 0.33 * u_time ) ) ; zY *= clamp ( 1.2 - sqrt ( 0.2 * zU ) , 0.0 , 1.0 ) * zQ ; zW = max ( zY , zW ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = g ( zW / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]=
{type:"group",a:[{type:"include",file:"math.glslv"},{type:"textline",b:"attribute vec2 a_bb_vertex ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",d:["DEPTH_RGBA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ; varying float zQ ; varying vec2 zR ;".split(" ")}]}}]}]}}]},{type:"textline",
b:"varying vec2 fk ; varying vec4 zS ; void main ( ) { float zE , zT ; vec3 zU ; fk = a_bb_vertex + 0.5 ; zU = normalize ( u_sun_direction ) ; zS = u_proj_matrix * u_view_matrix * vec4 ( zU , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"if ( u_cam_water_depth < 0.0 ) { zQ = 1.0 ; zU = vec3 ( 0.0 , 1.0 , 0.0 ) ; zU = ey ( u_camera_quat , zU ) ; zU = normalize ( zU ) ; zE = dot ( zU , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; zT = atan ( zU . x , zU . z ) ; zR = vec2 ( - zT , acos ( zE ) ) ; } else { zQ = 0.0 ; }".split(" ")}]}}]},
{type:"textline",b:"zS . xy = 0.5 * ( zS . xy / zS . w + 1.0 ) ; zS += 99999.0 * step ( zS . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; varying vec2 fk ; void main ( ) { float zE ; vec3 zT ; vec4 zU ; zU = texture2D ( u_main , fk ) ; zT = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; ek ( zU . rgb ) ; zE = k ( texture2D ( u_god_rays , fk ) ) ; zT = zU . rgb + u_god_rays_intensity * vec3 ( zE ) * zT ; em ( zT ) ; gl_FragColor . rgb = zT ; gl_FragColor . a = zU . a ; }".split(" ")}]};
a["postprocessing/luminance.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; varying vec2 fk ; void main ( ) { float zE ; vec4 zT ; zT = texture2D ( u_input , fk ) ; zE = dot ( zT . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; gl_FragColor = vec4 ( vec3 ( zE ) , 1.0 ) ; }".split(" ")}]};a["postprocessing/luminance_av.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; void main ( ) { float zE , zT ; zT = 0.0 ; for ( float zU = 0.025 ; zU < 1.0 ; zU += 0.05 ) for ( float zV = 0.025 ; zV < 1.0 ; zV += 0.05 ) { zE = max ( texture2D ( u_input , vec2 ( zU , zV ) ) . r , 0.01 ) ; zT += log ( zE ) ; } zT = exp ( zT / 400.0 ) ; gl_FragColor = vec4 ( vec3 ( zT ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; varying vec2 fk ; varying float zT ; void main ( ) { vec4 zU ; float zV , zW ; zV = texture2D ( u_average_lum , vec2 ( 0.5 ) ) . r ; zW = texture2D ( u_luminance , fk ) . r ; zU = texture2D ( u_main , fk ) ; zV = zW / zV ; zW = u_bloom_edge_lum ; gl_FragColor = zU * max ( zV - zW , 0.0 ) * zT ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; varying vec2 fk ; varying float zT ; const vec3 zE = vec3 ( 0.0 , 1.0 , 0.0 ) ; void Aa ( in vec4 zU , in vec3 zV , out vec3 zW ) { float zX , zY , zZ , z_ ; zX = zU . w * zV . x + zU . y * zV . z - zU . z * zV . y ; zY = zU . w * zV . y + zU . z * zV . x - zU . x * zV . z ; zZ = zU . w * zV . z + zU . x * zV . y - zU . y * zV . x ; z_ = - zU . x * zV . x - zU . y * zV . y - zU . z * zV . z ; zW . x = zX * zU . w - z_ * zU . x - zY * zU . z + zZ * zU . y ; zW . y = zY * zU . w - z_ * zU . y - zZ * zU . x + zX * zU . z ; zW . z = zZ * zU . w - z_ * zU . z - zX * zU . y + zY * zU . x ; } void main ( ) { vec3 Ab ; fk = 2.0 * a_position ; Aa ( u_camera_quat , zE , Ab ) ; zT = dot ( - Ab , u_sun_direction ) * u_bloom_key ; zT *= max ( sign ( u_sun_direction . y ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; varying vec2 fk ; float zE = 0.0042 ; void main ( ) { vec4 zU , zV , zW , zX ; zU = texture2D ( u_mb_tex_curr , fk ) ; zV = texture2D ( u_mb_tex_accum , fk ) ; if ( length ( zU - zV ) > u_motion_blur_decay_threshold ) { zW = ( 1.0 - u_motion_blur_exp ) * zU + u_motion_blur_exp * zV ; zW = zW - zV ; zX = zU - zV ; zW = min ( max ( abs ( zW ) , vec4 ( zE ) ) , abs ( zX ) ) * sign ( zW ) ; gl_FragColor = zV + zW ; } else { gl_FragColor = zU ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; varying vec2 fk ; void main ( ) { vec3 zE ; float zU ; vec4 zV , zW , zX ; zV = texture2D ( u_outline_src , fk ) ; gl_FragColor = zV ; if ( u_draw_outline != 0.0 ) { zW = texture2D ( u_outline_mask , fk ) ; zX = texture2D ( u_outline_mask_blurred , fk ) ; zU = zX . a - zW . a ; if ( zU != 0.0 ) { zU = smoothstep ( 0.0 , 1.0 , zX . a ) ; if ( zW . a == 0.0 ) { zE = u_outline_color ; em ( zE ) ; zW = vec4 ( clamp ( zE , 0.0 , 1.0 ) , 1.0 ) ; gl_FragColor = mix ( zV , zW , zU ) ; } } } }".split(" ")}]};
a["postprocessing/postprocessing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"POST_EFFECT_NONE",b:["1"]},{type:"define",name:"POST_EFFECT_GRAYSCALE",b:["2"]},{type:"define",name:"POST_EFFECT_X_BLUR",b:["3"]},{type:"define",name:"POST_EFFECT_Y_BLUR",b:["4"]},{type:"define",name:"POST_EFFECT_X_EXTEND",b:["5"]},{type:"define",name:"POST_EFFECT_Y_EXTEND",b:["6"]},{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 fk ; void main ( ) { vec2 zE , zU ; vec4 zV ;".split(" ")},
{type:"condition",a:[{type:"if",d:["POST_EFFECT","POST_EFFECT_NONE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = texture2D ( u_color , fk ) ;".split(" ")}]}},{type:"elif",d:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"zV = texture2D ( u_color , fk ) ; gl_FragColor . rgb = vec3 ( ( zV . r + zV . g + zV . b ) / 3.0 ) ; gl_FragColor . a = 1.0 ;".split(" ")}]}},{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_BLUR",
{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_BLUR",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"zE = vec2 ( 0.0 , 0.0 ) ; zU = u_texel_size ; zV = texture2D ( u_color , fk ) ; gl_FragColor = zV * 0.2270270270 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * 0.1945945946 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * 0.1945945946 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * 0.1216216216 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * 0.1216216216 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * 0.0540540541 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * 0.0540540541 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * 0.0162162162 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * 0.0162162162 ;".split(" ")}]}},
{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_GLOW_BLUR",{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"zE = vec2 ( 0.0 , 0.0 ) ; zU = u_texel_size ; zV = texture2D ( u_color , fk ) ; gl_FragColor = zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.152507 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.141763 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.141763 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.113861 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.113861 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.079019 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.079019 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.047383 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.047383 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.024549 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.024549 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.01099 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.01099 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.00425 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.00425 ; zE += zU ; zV = texture2D ( u_color , fk + zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.00142 ; zV = texture2D ( u_color , fk - zE ) ; gl_FragColor += zV * ( 1.0 - step ( 0.0 , - zV . a ) ) * 0.00142 ; gl_FragColor = clamp ( gl_FragColor , 0.0 , 1.0 ) ;".split(" ")}]}},
{type:"elif",d:["POST_EFFECT","POST_EFFECT_X_EXTEND",{type:"equal_expr",e:2},"POST_EFFECT","POST_EFFECT_Y_EXTEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"zU = u_texel_size ; zV = texture2D ( u_color , fk ) ; gl_FragColor = zV ; if ( zV . a == 0.0 ) { zV = texture2D ( u_color , fk + zU ) ; if ( zV . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , zV . a ) ; else { zV = texture2D ( u_color , fk - zU ) ; if ( zV . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , zV . a ) ; } }".split(" ")}]}}]},
{type:"textline",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; varying vec2 fk ; void main ( ) { fk = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"pack.glslf"},{type:"define",name:"SMAA_RESOLVE",b:["1"]},{type:"define",
name:"SMAA_EDGE_DETECTION",b:["2"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:["uniform","sampler2D","u_color",";"]},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_blend",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",e:2},"SMAA_PREDICATION",{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{type:"textline",b:"uniform vec2 u_texel_size ; varying vec2 fk ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","zU",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 zV ; varying vec4 zW ; varying vec4 zX ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","zY",";"]}]}}]},{type:"condition",
a:[{type:"if",d:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.15"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_HIGH",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.05"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",
b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["16"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_DEPTH_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS_DIAG",
group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_CORNER_ROUNDING",group:{type:"group",a:[{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",group:{type:"group",a:[{type:"define",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION",group:{type:"group",a:[{type:"define",
name:"SMAA_PREDICATION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_SCALE",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_STRENGTH",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},
{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION",group:{type:"group",a:[{type:"define",name:"SMAA_REPROJECTION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION_WEIGHT_SCALE",group:{type:"group",a:[{type:"define",name:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},
{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{type:"define",name:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{type:"define",name:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{type:"define",name:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{type:"define",name:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{type:"define",name:"SMAA_CORNER_ROUNDING_NORM",b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},
{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"vec3 Ad ( vec2 zZ , sampler2D z_ ) { float Aa , Ab , Ac ; Aa = texture2D ( z_ , zZ ) . r ; Ab = texture2D ( z_ , zV . xy ) . r ; Ac = texture2D ( z_ , zV . zw ) . r ; return vec3 ( Aa , Ab , Ac ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"vec2 Ai ( vec2 Ae , sampler2D Af ) { vec2 Ag ; vec3 Ah ; Ah = Ad ( Ae , Af ) ; Ag = abs ( Ah . xx - Ah . yz ) ; Ag = step ( SMAA_PREDICATION_THRESHOLD , Ag ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * Ag ) ; }".split(" ")}]}}]},
{type:"textline",b:"void Am ( bvec2 Aj , inout vec2 Ak , vec2 Al ) { if ( Aj . x ) Ak . x = Al . x ; if ( Aj . y ) Ak . y = Al . y ; } void Am ( bvec4 An , inout vec4 Ao , vec4 Ap ) { Am ( An . xy , Ao . xy , Ap . xy ) ; Am ( An . zw , Ao . zw , Ap . zw ) ; } vec2 Ar ( vec2 Aq ) { return sign ( Aq ) * floor ( abs ( Aq ) + .5 ) ; } vec4 Ar ( vec4 As ) { return sign ( As ) * floor ( abs ( As ) + .5 ) ; }".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:"vec2 AF ( vec2 At , sampler2D Au".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","Av"]}]}}]},{type:"textline",b:") { vec4 Aw ; float Ax , Ay , Az , AA , AB ; vec3 AC ; vec2 AD , AE ;".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:"AD = Ai ( At , Av ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"AD = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{type:"textline",b:"AC = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; Ax = dot ( texture2D ( Au , At ) . rgb , AC ) ; Ay = dot ( texture2D ( Au , zV . xy ) . rgb , AC ) ; Az = dot ( texture2D ( Au , zV . zw ) . rgb , AC ) ; Aw . xy = abs ( Ax - vec2 ( Ay , Az ) ) ; AD = step ( AD , Aw . xy ) ; if ( dot ( AD , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; AA = dot ( texture2D ( Au , zW . xy ) . rgb , AC ) ; AB = dot ( texture2D ( Au , zW . zw ) . rgb , AC ) ; Aw . zw = abs ( Ax - vec2 ( AA , AB ) ) ; AE = max ( Aw . xy , Aw . zw ) ; AB = dot ( texture2D ( Au , zX . xy ) . rgb , AC ) ; AA = dot ( texture2D ( Au , zX . zw ) . rgb , AC ) ; Aw . zw = abs ( vec2 ( Ay , Az ) - vec2 ( AB , AA ) ) ; AE = max ( AE . xy , Aw . zw ) ; AA = max ( AE . x , AE . y ) ; AD . xy *= step ( AA , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * Aw . xy ) ; return AD ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"vec2 AH ( vec2 AG ) { AG . r = AG . r * abs ( 5.0 * AG . r - 5.0 * 0.75 ) ; return Ar ( AG ) ; } vec4 AH ( vec4 AI ) { AI . rb = AI . rb * abs ( 5.0 * AI . rb - 5.0 * 0.75 ) ; return Ar ( AI ) ; } vec2 AQ ( sampler2D AJ , vec2 AK , vec2 AL , out vec2 AM ) { vec3 AN ; vec4 AO ; AO = vec4 ( AK , - 1.0 , 1.0 ) ; AN = vec3 ( u_texel_size , 1.0 ) ; for ( int AP = 0 ; AP < SMAA_MAX_SEARCH_STEPS_DIAG ; AP ++ ) { if ( AO . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && AO . w > 0.9 ) { AO . xyz += AN * vec3 ( AL , 1.0 ) ; AM = texture2D ( AJ , AO . xy , 0.0 ) . rg ; AO . w = dot ( AM , vec2 ( 0.5 , 0.5 ) ) ; } } return AO . zw ; } vec2 AY ( sampler2D AR , vec2 AS , vec2 AT , out vec2 AU ) { vec3 AV ; vec4 AW ; AW = vec4 ( AS , - 1.0 , 1.0 ) ; AW . x += 0.25 * u_texel_size . x ; AV = vec3 ( u_texel_size , 1.0 ) ; for ( int AX = 0 ; AX < SMAA_MAX_SEARCH_STEPS_DIAG ; AX ++ ) { if ( AW . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && AW . w > 0.9 ) { AW . xyz = AV * vec3 ( AT , 1.0 ) + AW . xyz ; AU = texture2D ( AR , AW . xy , 0.0 ) . rg ; AU = AH ( AU ) ; AW . w = dot ( AU , vec2 ( 0.5 , 0.5 ) ) ; } } return AW . zw ; } vec2 Bd ( sampler2D AZ , vec2 A_ , vec2 Ba , float Bb ) { vec2 Bc ; Bc = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * Ba + A_ ; Bc = SMAA_AREATEX_PIXEL_SIZE * Bc + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; Bc . x += 0.5 ; Bc . y += SMAA_AREATEX_SUBTEX_SIZE * Bb ; return texture2D ( AZ , Bc , 0.0 ) . rg ; } vec2 Bp ( sampler2D Be , sampler2D Bf , vec2 Bg , vec2 Bh , vec4 Bi ) { vec4 Bj , Bk , Bl ; vec2 Bm , Bn , Bo ; Bm = vec2 ( 0.0 , 0.0 ) ; if ( Bh . r > 0.0 ) { Bj . xz = AQ ( Be , Bg , vec2 ( - 1.0 , 1.0 ) , Bn ) ; Bj . x += float ( Bn . y > 0.9 ) ; } else Bj . xz = vec2 ( 0.0 , 0.0 ) ; Bj . yw = AQ ( Be , Bg , vec2 ( 1.0 , - 1.0 ) , Bn ) ; if ( Bj . x + Bj . y > 2.0 ) { Bk = vec4 ( - Bj . x + 0.25 , Bj . x , Bj . y , - Bj . y - 0.25 ) * u_texel_size . xyxy + Bg . xyxy ; Bl . xy = texture2D ( Be , Bk . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; Bl . zw = texture2D ( Be , Bk . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; Bl . yxwz = AH ( Bl . xyzw ) ; Bo = vec2 ( 2.0 , 2.0 ) * Bl . xz + Bl . yw ; Am ( bvec2 ( step ( 0.9 , Bj . zw ) ) , Bo , vec2 ( 0.0 , 0.0 ) ) ; Bm += Bd ( Bf , Bj . xy , Bo , Bi . z ) ; } Bj . xz = AY ( Be , Bg , vec2 ( - 1 , - 1 ) , Bn ) ; if ( texture2D ( Be , Bg + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { Bj . yw = AY ( Be , Bg , vec2 ( 1 , 1 ) , Bn ) ; Bj . y += float ( Bn . y > 0.9 ) ; } else Bj . yw = vec2 ( 0.0 , 0.0 ) ; if ( Bj . x + Bj . y > 2.0 ) { Bl = vec4 ( - Bj . x , - Bj . x , Bj . y , Bj . y ) * u_texel_size . xyxy + Bg . xyxy ; Bk . x = texture2D ( Be , Bl . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; Bk . y = texture2D ( Be , Bl . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; Bk . zw = texture2D ( Be , Bl . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; Bn = vec2 ( 2.0 , 2.0 ) * Bk . xz + Bk . yw ; Am ( bvec2 ( step ( 0.9 , Bj . zw ) ) , Bn , vec2 ( 0 , 0 ) ) ; Bm += Bd ( Bf , Bj . xy , Bn , Bi . w ) . gr ; } return Bm ; }".split(" ")}]}}]},
{type:"textline",b:"float Bv ( sampler2D Bq , vec2 Br , float Bs ) { vec2 Bt , Bu ; Bt = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; Bu = SMAA_SEARCHTEX_SIZE * vec2 ( Bs , 1.0 ) ; Bt += vec2 ( - 1.0 , 1.0 ) ; Bu += vec2 ( 0.5 , - 0.5 ) ; Bt *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; Bu *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return texture2D ( Bq , Bt * Br + Bu , 0.0 ) . r ; } float BD ( sampler2D Bw , sampler2D Bx , vec2 By , float Bz ) { float BA ; vec2 BB ; BB = vec2 ( 0.0 , 1.0 ) ; for ( int BC = 0 ; BC < SMAA_MAX_SEARCH_STEPS ; BC ++ ) { if ( By . x > Bz && BB . g > 0.8281 && BB . r == 0.0 ) { BB = texture2D ( Bw , By , 0.0 ) . rg ; By = - vec2 ( 2.0 , 0.0 ) * u_texel_size + By ; } } BA = - ( 255.0 / 127.0 ) * Bv ( Bx , BB , 0.0 ) + 3.25 ; return u_texel_size . x * BA + By . x ; } float BL ( sampler2D BE , sampler2D BF , vec2 BG , float BH ) { float BI ; vec2 BJ ; BJ = vec2 ( 0.0 , 1.0 ) ; for ( int BK = 0 ; BK < SMAA_MAX_SEARCH_STEPS ; BK ++ ) { if ( BG . x < BH && BJ . g > 0.8281 && BJ . r == 0.0 ) { BJ = texture2D ( BE , BG , 0.0 ) . rg ; BG = vec2 ( 2.0 , 0.0 ) * u_texel_size + BG ; } } BI = - ( 255.0 / 127.0 ) * Bv ( BF , BJ , 0.5 ) + 3.25 ; return - u_texel_size . x * BI + BG . x ; } float BT ( sampler2D BM , sampler2D BN , vec2 BO , float BP ) { float BQ ; vec2 BR ; BR = vec2 ( 1.0 , 0.0 ) ; for ( int BS = 0 ; BS < SMAA_MAX_SEARCH_STEPS ; BS ++ ) { if ( BO . y > BP && BR . r > 0.8281 && BR . g == 0.0 ) { BR = texture2D ( BM , BO , 0.0 ) . rg ; BO = - vec2 ( 0.0 , 2.0 ) * u_texel_size + BO ; } } BQ = - ( 255.0 / 127.0 ) * Bv ( BN , BR . gr , 0.0 ) + 3.25 ; return u_texel_size . y * BQ + BO . y ; } float Ca ( sampler2D BU , sampler2D BV , vec2 BW , float BX ) { float BY ; vec2 BZ ; BZ = vec2 ( 1.0 , 0.0 ) ; for ( int B_ = 0 ; B_ < SMAA_MAX_SEARCH_STEPS ; B_ ++ ) { if ( BW . y < BX && BZ . r > 0.8281 && BZ . g == 0.0 ) { BZ = texture2D ( BU , BW , 0.0 ) . rg ; BW = vec2 ( 0.0 , 2.0 ) * u_texel_size + BW ; } } BY = - ( 255.0 / 127.0 ) * Bv ( BV , BZ . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * BY + BW . y ; } vec2 Ch ( sampler2D Cb , vec2 Cc , float Cd , float Ce , float Cf ) { vec2 Cg ; Cg = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * Ar ( 4.0 * vec2 ( Cd , Ce ) ) + Cc ; Cg = SMAA_AREATEX_PIXEL_SIZE * Cg + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; Cg . y = SMAA_AREATEX_SUBTEX_SIZE * Cf + Cg . y ; return texture2D ( Cb , Cg , 0.0 ) . rg ; } void Co ( sampler2D Ci , inout vec2 Cj , vec4 Ck , vec2 Cl ) { vec2 Cm , Cn ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"Cm = step ( Cl . xy , Cl . yx ) ; Cn = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * Cm ; Cn /= Cm . x + Cm . y ; Cm = vec2 ( 1.0 , 1.0 ) ; Cm . x -= Cn . x * texture2D ( Ci , Ck . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; Cm . x -= Cn . y * texture2D ( Ci , Ck . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; Cm . y -= Cn . x * texture2D ( Ci , Ck . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; Cm . y -= Cn . y * texture2D ( Ci , Ck . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; Cj *= clamp ( Cm , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"} void Cv ( sampler2D Cp , inout vec2 Cq , vec4 Cr , vec2 Cs ) { vec2 Ct , Cu ;".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"Ct = step ( Cs . xy , Cs . yx ) ; Cu = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * Ct ; Cu /= Ct . x + Ct . y ; Ct = vec2 ( 1.0 , 1.0 ) ; Ct . x -= Cu . x * texture2D ( Cp , Cr . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; Ct . x -= Cu . y * texture2D ( Cp , Cr . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; Ct . y -= Cu . x * texture2D ( Cp , Cr . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; Ct . y -= Cu . y * texture2D ( Cp , Cr . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; Cq *= clamp ( Ct , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"vec4 CJ ( vec2 Cw , vec2 Cx , sampler2D Cy , sampler2D Cz , sampler2D CA , vec4 CB ) { float CC , CD ; vec3 CE ; vec2 CF , CG , CH ; vec4 CI ; CI = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; CF = texture2D ( Cy , Cw ) . rg ; if ( CF . g > 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",
e:1}],group:{type:"group",a:[{type:"textline",b:"CI . rg = Bp ( Cy , Cz , Cw , CF , CB ) ; if ( CI . r == - CI . g ) {".split(" ")}]}}]},{type:"textline",b:"; CE . x = BD ( Cy , CA , zV . xy , zX . x ) ; CE . y = zW . y ; CG . x = CE . x ; CC = texture2D ( Cy , CE . xy , 0.0 ) . r ; CE . z = BL ( Cy , CA , zV . zw , zX . y ) ; CG . y = CE . z ; CG = abs ( Ar ( CG / u_texel_size . xx - Cx . xx ) ) ; CH = sqrt ( CG ) ; CD = texture2D ( Cy , CE . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; CI . rg = Ch ( Cz , CH , CC , CD , CB . y ) ; CE . y = Cw . y ; Co ( Cy , CI . rg , CE . xyzy , CG ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"} else CF . r = 0.0 ;".split(" ")}]}}]},{type:"textline",b:"} if ( CF . r > 0.0 ) { ; CE . y = BT ( Cy , CA , zW . xy , zX . z ) ; CE . x = zV . x ; CF . x = CE . y ; CD = texture2D ( Cy , CE . xy , 0.0 ) . g ; CE . z = Ca ( Cy , CA , zW . zw , zX . w ) ; CF . y = CE . z ; CF = abs ( Ar ( CF / u_texel_size . yy - Cx . yy ) ) ; CG = sqrt ( CF ) ; CC = texture2D ( Cy , CE . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; CI . ba = Ch ( Cz , CG , CD , CC , CB . x ) ; CE . x = Cw . x ; Cv ( Cy , CI . ba , CE . xyxz , CF ) ; } return CI ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"vec4 CV ( vec2 CK , sampler2D CL , sampler2D CM".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","CN"]}]}}]},{type:"textline",b:") { bool CO ; vec2 CP , CQ , CR ; vec4 CS , CT , CU ; CS . x = texture2D ( CM , zU . xy ) . a ; CS . y = texture2D ( CM , zU . zw ) . g ; CS . wz = texture2D ( CM , CK ) . xz ; if ( dot ( CS , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { CT = texture2D ( CL , CK , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"CU = texture2D ( CN , fk ) ; CP = 2.0 * s ( CU ) - 1.0 ; CT . a = sqrt ( 2.0 * length ( CP ) ) ;".split(" ")}]}}]},{type:"textline",b:"return CT ; } else { CO = max ( CS . x , CS . z ) > max ( CS . y , CS . w ) ; CT = vec4 ( 0.0 , CS . y , 0.0 , CS . w ) ; CP = CS . yw ; Am ( bvec4 ( CO , CO , CO , CO ) , CT , vec4 ( CS . x , 0.0 , CS . z , 0.0 ) ) ; Am ( bvec2 ( CO , CO ) , CP , CS . xz ) ; CP /= dot ( CP , vec2 ( 1.0 , 1.0 ) ) ; CT = CT * vec4 ( u_texel_size , - u_texel_size ) + CK . xyxy ; CS = CP . x * texture2D ( CL , CT . xy , 0.0 ) ; CS += CP . y * texture2D ( CL , CT . zw , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"CU = texture2D ( CN , CT . xy ) ; CQ = 2.0 * s ( CU ) - 1.0 ; CR = CP . x * CQ ; CU = texture2D ( CN , CT . zw ) ; CQ = 2.0 * s ( CU ) - 1.0 ; CR += CP . y * CQ ; CS . a = sqrt ( 2.0 * length ( CR ) ) ;".split(" ")}]}}]},{type:"textline",b:["return","CS",";","}","}"]}]}}]},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"vec4 De ( vec2 CW , sampler2D CX , sampler2D CY".split(" ")},
{type:"condition",a:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","CZ"]}]}}]},{type:"textline",b:") { float C_ ; vec2 Da ; vec4 Db , Dc , Dd ;".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"Db = texture2D ( CZ , fk ) ; Da = 2.0 * s ( Db ) - 1.0 ; Db = texture2D ( CX , CW ) ; Dc = texture2D ( CY , CW - Da ) ; C_ = abs ( Db . a * Db . a - Dc . a * Dc . a ) / 2.0 ; C_ = 0.5 * clamp ( 1.0 - sqrt ( C_ ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; Dd = mix ( Db , Dc , C_ ) ; Dd . a = 1.0 ; return Dd ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"Db = texture2D ( CX , CW ) ; Dc = texture2D ( CY , CW ) ; return mix ( Db , Dc , 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:"void main ( ) { vec4 Df ;".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"Df = vec4 ( AF ( fk , u_color".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_PREDICATION"],group:{type:"group",
a:[{type:"textline",b:[",","u_predication_tex"]}]}}]},{type:"textline",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"Df = CJ ( fk , zY , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"Df = CV ( fk , u_color , u_blend".split(" ")},
{type:"condition",a:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",";"]}]}},{type:"elif",d:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"Df = vec4 ( De ( fk , u_color , u_color_prev".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",")",";"]}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"Df = texture2D ( u_color , fk ) ;".split(" ")}]}}]},{type:"textline",b:["gl_FragColor","=","Df",";","}"]}]};a["postprocessing/smaa.glslv"]={type:"group",a:[{type:"define",name:"SMAA_EDGE_DETECTION",b:["1"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["2"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",
b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:"attribute vec2 a_position ; uniform vec2 u_texel_size ; varying vec2 fk ;".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","zU",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 zV ; varying vec4 zW ; varying vec4 zX ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","zY",";"]}]}}]},{type:"condition",a:[{type:"if",d:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{type:"elif",d:["AA_METHOD",
"AA_METHOD_SMAA_HIGH",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{type:"elif",d:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"void zZ ( vec2 zE ) { zV = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + zE . xyxy ; zW = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + zE . xyxy ; zX = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + zE . xyxy ; }".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"void Ab ( vec2 z_ , out vec2 Aa ) { Aa = z_ / u_texel_size ; zV = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + z_ . xyxy ; zW = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + z_ . xyxy ; zX = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( zV . xz , zW . yw ) ; }".split(" ")}]}},
{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"void Ad ( vec2 Ac ) { zU = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + Ac . xyxy ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { fk = 2.0 * a_position ;".split(" ")},{type:"condition",a:[{type:"if",d:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["zZ","(","fk",")",";"]}]}},{type:"elif",d:["SMAA_PASS",
"SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"Ab ( fk , zY ) ;".split(" ")}]}},{type:"elif",d:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["Ad","(","fk",")",";"]}]}}]},{type:"textline",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",
b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"define",name:"SSAO_QUALITY_8",b:["1"]},{type:"define",name:"SSAO_QUALITY_16",b:["2"]},{type:"define",name:"SSAO_QUALITY_24",b:["3"]},{type:"define",name:"SSAO_QUALITY_32",b:["4"]},{type:"textline",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; varying vec2 fk ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; float zZ ( in vec2 zE ) { return zP ( u_depth , zE , u_camera_range ) ; } void main ( ) { vec3 z_ , Aa , Ab ; float Ac , Ad , Ae , Af , Ag , Ah , Ai ; Ac = texture2D ( u_color , fk ) . r ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SSAO_WHITE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( Ac , 1.0 , 0.0 , 1.0 ) ; return ;".split(" ")}]}}]},{type:"textline",b:"z_ = normalize ( 2.0 * texture2D ( u_ssao_special_tex , fk * 0.25 / u_texel_size ) . rgb - 1.0 ) ; Ad = zZ ( fk ) ; Ae = Ad * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["SSAO_QUALITY","SSAO_QUALITY_8",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",
b:"const float Aj = 8.0 ; const int Ak = 1 ;".split(" ")}]}},{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_16",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"const float Aj = 16.0 ; const int Ak = 2 ;".split(" ")}]}},{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_24",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"const float Aj = 24.0 ; const int Ak = 3 ;".split(" ")}]}},{type:"elif",d:["SSAO_QUALITY","SSAO_QUALITY_32",{type:"equal_expr",e:2}],group:{type:"group",
a:[{type:"textline",b:"const float Aj = 32.0 ; const int Ak = 4 ;".split(" ")}]}}]},{type:"textline",b:"Af = u_ssao_radius_increase * 0.001 ; const float Al = 1.0 + 2.4 / Aj ; Ag = 0.0 ; for ( int Am = 0 ; Am < Ak ; Am ++ ) for ( int An = - 1 ; An <= 1 ; An += 2 ) for ( int Ao = - 1 ; Ao <= 1 ; Ao += 2 ) for ( int Ap = - 1 ; Ap <= 1 ; Ap += 2 ) { Aa = reflect ( normalize ( vec3 ( An , Ao , Ap ) ) , z_ ) * ( Af *= Al ) ; Ab = vec3 ( fk , Ae ) ; Ab += vec3 ( Aa . xy , Aa . z * Ae * 2.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"Ab . z -= 1.4 * ( Ab . z - Ae ) * step ( Ae , Ab . z ) ;".split(" ")}]}}]},{type:"textline",b:"Ah = zZ ( Ab . xy ) * ( u_camera_range . y - u_camera_range . x ) ; Ai = clamp ( ( Ae - Ah ) / Ah , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"Ag += mix ( 1.0 , Ai , step ( Ah , Ab . z ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"Ag += mix ( step ( Ab . z , Ah ) , 0.5 , Ai ) ;".split(" ")}]}}]},{type:"textline",b:"} Ag = Ag / Aj ;".split(" ")},{type:"condition",a:[{type:"if",d:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"Ag = clamp ( Ag * Ag + 0.6 * Ag , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ag = clamp ( Ag * Ag + Ag , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"Ad = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * Ad ) ; Ag = mix ( 1.0 , Ag , Ad ) ; gl_FragColor = vec4 ( Ac , Ag , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/ssao_blur.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"include",file:"depth_fetch.glslf"}]}}]},{type:"textline",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; varying vec2 fk ;".split(" ")},{type:"condition",a:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",
a:[{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float zZ ( in vec2 zE ) { return zP ( u_depth , zE , u_camera_range ) ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { vec2 z_ , Aa ; float Ab , Ac , Ad , Ae , Af , Ag , Ah ; Ab = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"Ac = zZ ( fk ) ; Ad = 0.0 ; Ae = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},
{type:"textline",b:"z_ = vec2 ( - 2.0 ) ; for ( int Ai = 0 ; Ai < 4 ; ++ Ai ) { for ( int Aj = 0 ; Aj < 4 ; ++ Aj ) { Aa = ( z_ + vec2 ( float ( Ai ) , float ( Aj ) ) ) * u_texel_size ; Af = texture2D ( u_ssao_mask , fk + Aa ) . g ;".split(" ")},{type:"condition",a:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"Ag = zZ ( fk + Aa ) ; Ah = 1.0 - clamp ( abs ( Ag - Ac ) * Ae , 0.0 , 1.0 ) ; Ab += Af * Ah ; Ad += Ah ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:["Ab","+=","Af",";"]}]}}]},{type:"textline",b:["}","}"]},{type:"condition",a:[{type:"if",d:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , fk ) . r , Ab / Ad , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , fk ) . r , Ab / 16.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/velocity.glslf"]={type:"group",a:[{type:"include",
file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; varying vec2 fk ; void main ( ) { vec2 zE ; vec4 zZ , z_ ; float Aa ; Aa = texture2D ( u_depth , fk ) . x ; zZ = vec4 ( fk * 2.0 - 1.0 , 2.0 * Aa - 1.0 , 1.0 ) ; z_ = u_view_proj_inverse * zZ ; z_ = z_ / z_ . w ; z_ = u_view_proj_prev * z_ ; z_ /= z_ . w ; zE = ( zZ . xy - z_ . xy ) / 4.0 + 0.5 ; zE = clamp ( zE , 0.0 , 1.0 ) ; gl_FragColor = g ( zE ) ; }".split(" ")}]};
a["include/precision_statement.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","float",";"]}]};a["include/std_enums.glsl"]={type:"group",a:[{type:"define",name:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{type:"define",name:"TEXTURE_COORDS_NORMAL",b:["2"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MULTIPLY",b:["2"]},{type:"define",name:"SHADOW_SRC_NONE",b:["1"]},{type:"define",name:"SHADOW_SRC_DEPTH",
b:["2"]},{type:"define",name:"SHADOW_SRC_MASK",b:["3"]},{type:"define",name:"SHADOW_DST_NONE",b:["1"]},{type:"define",name:"SHADOW_DST_DEPTH",b:["2"]},{type:"define",name:"SHADOW_DST_MASK",b:["3"]},{type:"define",name:"NO_SHADOWS",b:["1"]},{type:"define",name:"SHADOW_CASTING",b:["2"]},{type:"define",name:"SHADOW_MASK_GENERATION",b:["3"]},{type:"define",name:"SHADOW_MAPPING_OPAQUE",b:["4"]},{type:"define",name:"SHADOW_MAPPING_BLEND",b:["5"]},{type:"define",name:"SPECULAR_PHONG",b:["1"]},{type:"define",
name:"SPECULAR_COOKTORR",b:["2"]},{type:"define",name:"SPECULAR_WARDISO",b:["3"]},{type:"define",name:"SPECULAR_BLINN",b:["4"]},{type:"define",name:"DIFFUSE_LAMBERT",b:["1"]},{type:"define",name:"DIFFUSE_OREN_NAYAR",b:["2"]},{type:"define",name:"DIFFUSE_FRESNEL",b:["3"]},{type:"define",name:"DIFFUSE_MINNAERT",b:["4"]},{type:"define",name:"DIFFUSE_TOON",b:["5"]},{type:"define",name:"MAPPING_TYPE_TEXTURE",b:["0.0"]},{type:"define",name:"MAPPING_TYPE_POINT",b:["1.0"]},{type:"define",name:"MAPPING_TYPE_VECTOR",
b:["2.0"]},{type:"define",name:"MAPPING_TYPE_NORMAL",b:["3.0"]},{type:"define",name:"MIX",b:["0"]},{type:"define",name:"ADD",b:["1"]},{type:"define",name:"SUBTRACT",b:["2"]},{type:"define",name:"MULTIPLY",b:["3"]},{type:"define",name:"SCREEN",b:["4"]},{type:"define",name:"OVERLAY",b:["5"]},{type:"define",name:"DIFFERENCE",b:["6"]},{type:"define",name:"DIVIDE",b:["7"]},{type:"define",name:"DARKEN",b:["8"]},{type:"define",name:"LIGHTEN",b:["9"]},{type:"define",name:"HUE",b:["10"]},{type:"define",name:"SATURATION",
b:["11"]},{type:"define",name:"VALUE",b:["12"]},{type:"define",name:"COLOR",b:["13"]},{type:"define",name:"SOFT_LIGHT",b:["14"]},{type:"define",name:"LINEAR_LIGHT",b:["15"]},{type:"define",name:"REFL_NONE",b:["0"]},{type:"define",name:"REFL_MIRRORMAP",b:["1"]},{type:"define",name:"REFL_PLANE",b:["2"]},{type:"define",name:"REFL_CUBE",b:["3"]},{type:"define",name:"INVERSE_QUADRATIC",b:["0"]},{type:"define",name:"LINEAR",b:["1"]},{type:"define",name:"QUADRATIC",b:["2"]}]};a["include/pack.glslf"]={type:"group",
a:[{type:"textline",b:"float a = 255.0 ; float b = 0.0 ; float c = 1.0 ; vec4 g ( const in float d ) { vec4 e , f ; e = vec4 ( a * a * a , a * a , a , c ) ; f = vec4 ( b , c / a , c / a , c / a ) ; e = fract ( d * e ) ; e -= e . xxyz * f ; return e ; } float k ( const in vec4 h ) { vec4 i ; float j ; i = vec4 ( c / ( a * a * a ) , c / ( a * a ) , c / a , c ) ; j = dot ( h , i ) ; return j ; } vec4 g ( const in vec2 l ) { vec4 m ; vec2 n , o ; n = vec2 ( a , c ) ; o = vec2 ( b , c / a ) ; m = fract ( l . xxyy * n . xyxy ) ; m -= m . xxzz * o . xyxy ; if ( l . r == c ) m . rg = vec2 ( b , c ) ; if ( l . g == c ) m . ba = vec2 ( b , c ) ; return m ; } vec2 s ( const in vec4 p ) { vec2 q , r ; r = vec2 ( c / a , c ) ; q . r = dot ( p . rg , r ) ; q . g = dot ( p . ba , r ) ; return q ; }".split(" ")}]};
a["include/fog.glslf"]={type:"group",a:[{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"condition",a:[{type:"if",d:["USE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_params",";"]}]}}]},{type:"textline",b:"void z ( inout vec3 t , in float u , in float v , in vec4 w ) { float x , y ;".split(" ")},{type:"condition",a:[{type:"if",d:["USE_FOG"],group:{type:"group",a:[{type:"textline",b:"x = clamp ( ( u - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",
a:[{type:"if",d:["FOG_TYPE","QUADRATIC",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["x","*=","x",";"]}]}},{type:"elif",d:["FOG_TYPE","LINEAR",{type:"equal_expr",e:2}],group:{type:"group",a:[]}},{type:"elif",d:["FOG_TYPE","INVERSE_QUADRATIC",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"x = sqrt ( x ) ;".split(" ")}]}}]},{type:"textline",b:"if ( u_fog_params . w > 0.0 ) { if ( v > u_fog_params . w ) x = 0.0 ; else if ( v > 0.0 ) { y = ( u_fog_params . w - v ) / u_fog_params . w ; x *= y * y ; } } x = 1.0 - ( 1.0 - x ) * ( 1.0 - u_fog_params . x ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["x","=","0.0",";"]}]}}]},{type:"textline",b:"t = mix ( t , w . rgb , x ) ; } void E ( inout vec3 A , in float B , in vec4 C ) { float D ; D = C . w * B ; D = exp ( - D * D ) ; D = clamp ( D , 0.0 , 1.0 ) ; A = mix ( C . rgb , A , D ) ; }".split(" ")},{type:"condition",a:[{type:"if",d:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"vec3 L ( in mat4 F , in vec3 G ) { vec3 H , I , J ; H = mix ( F [ 0 ] . rgb , F [ 1 ] . rgb , max ( sign ( G . x ) , 0.0 ) ) ; I = mix ( F [ 2 ] . rgb , F [ 3 ] . rgb , max ( sign ( G . z ) , 0.0 ) ) ; J = vec3 ( F [ 0 ] . a , F [ 1 ] . a , F [ 2 ] . a ) ; I = mix ( H , I , abs ( G . z ) ) ; I = mix ( I , J , abs ( G . y ) ) ; return I ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"void N ( inout float M ) { M -= 0.5 ; M = 4.0 * ( M * M * M ) + 0.5 ; } void aa ( inout vec3 O , in float P , in vec3 Q , in float R , in vec4 S , in vec4 T , in float U , in float V ) { vec3 W , X ; float Y , Z , _ ; Y = T . w * P ; Y = exp ( - Y * Y ) ; Y = clamp ( Y , 0.0 , 1.0 ) ; Z = max ( Q . y , 0.0 ) ; P = max ( P - max ( R / Z , 0.0 ) , 0.0 ) ; _ = S . w * P ; _ = 1.0 - _ ; _ = max ( _ , 0.0 ) ; N ( _ ) ; _ += max ( U - 0.5 , 0.0 ) ; if ( _ < Y ) { W = vec3 ( 0.0 , 0.02 , 0.05 ) ; X = S . rgb ; R = clamp ( - R * 0.03 , 0.0 , 0.8 ) ; W = mix ( X , W , min ( Z , 1.0 ) ) ; W = mix ( W , vec3 ( 0.0 ) , R ) * V ; O = mix ( W , O , _ ) ; } if ( _ >= Y ) { O = mix ( T . rgb , O , Y ) ; } } void ai ( inout vec3 ab , in float ac , in float ad , in vec4 ae , in float af ) { vec3 ag ; float ah ; ah = ae . w * ac ; ah = 1.0 - ah ; ah = clamp ( ah , 0.0 , 1.0 ) ; N ( ah ) ; ad = clamp ( - ad * 0.03 , 0.0 , 0.8 ) ; ag = mix ( ae . rgb , vec3 ( 0.0 ) , ad ) * af ; ab = mix ( ag , ab , ah ) ; }".split(" ")}]}}]}]};
a["include/lighting.glslf"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"textline",
b:"float aj = 0.0 ; float ak = 1.0 ; float al = 0.5 ; struct am { vec4 a ; vec3 b ; } ;".split(" ")},{type:"condition",a:[{type:"if",d:["SPECULAR_SHADER","SPECULAR_PHONG",{type:"equal_expr",e:2},"SPECULAR_SHADER","SPECULAR_COOKTORR",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"float au ( vec3 an , vec3 ao , vec3 ap , float aq , float ar ) { float as ; vec3 at ; at = normalize ( an + ao ) ; as = ( ak - aq ) * max ( dot ( ap , at ) , aj ) + aq ; return pow ( as , ar ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["SPECULAR_SHADER","SPECULAR_WARDISO",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"float aE ( vec3 av , vec3 aw , vec3 ax , float ay ) { float az , aA , aB , aC ; vec3 aD ; aD = normalize ( av + aw ) ; az = max ( dot ( ax , aD ) , 0.001 ) ; aA = max ( dot ( ax , aw ) , 0.01 ) ; aB = max ( dot ( ax , av ) , 0.01 ) ; az = tan ( acos ( az ) ) ; aC = max ( ay , 0.001 ) ; return aB * ( ak / ( 4.0 * M_PI * aC * aC ) ) * ( exp ( - ( az * az ) / ( aC * aC ) ) / ( sqrt ( aA * aB ) ) ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["SPECULAR_SHADER","SPECULAR_TOON",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"float aM ( vec3 aF , vec3 aG , vec3 aH , float aI , float aJ ) { float aK ; vec3 aL ; aL = normalize ( aF + aG ) ; aK = acos ( dot ( aL , aH ) ) ; if ( aK < aI ) return ak ; else if ( aK >= aI + aJ || aJ == aj ) return aj ; else return ak - ( aK - aI ) / aJ ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SPECULAR_SHADER","SPECULAR_BLINN",{type:"equal_expr",
e:2}],group:{type:"group",a:[{type:"textline",b:"float aZ ( vec3 aN , vec3 aO , vec3 aP , float aQ , float aR , float aS ) { float aT , aU , aV , aW , aX ; vec3 aY ; if ( aQ < 1.0 || aR == aj ) return aj ; else { if ( aR < 100.0 ) aR = sqrt ( 1.0 / aR ) ; else aR = 10.0 / aR ; aY = normalize ( aO + aN ) ; aT = ( ak - aS ) * max ( dot ( aP , aY ) , aj ) + aS ; if ( aT < aj ) return aj ; else { aU = max ( dot ( aP , aO ) , 0.01 ) ; aV = dot ( aP , aN ) ; if ( aV <= 0.01 ) return aj ; else { aW = max ( dot ( aO , aY ) , 0.01 ) ; aX = ak ; aU = ( 2.0 * aT * aU ) / aW ; aV = ( 2.0 * aT * aV ) / aW ; aV = min ( min ( aX , aU ) , aV ) ; aU = sqrt ( pow ( aQ , 2.0 ) + pow ( aW , 2.0 ) - ak ) ; aW = pow ( aU - aW , 2.0 ) / pow ( aU + aW , 2.0 ) * ( ak + pow ( aW * ( aU + aW ) - ak , 2.0 ) / pow ( aW * ( aU - aW ) + ak , 2.0 ) ) ; aT = acos ( aT ) ; return max ( aW * aV * exp ( - pow ( aT , 2.0 ) / ( 2.0 * pow ( aR , 2.0 ) ) ) , aj ) ; } } } }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["DIFFUSE_SHADER","DIFFUSE_OREN_NAYAR",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"float bm ( float a_ , vec3 ba , vec3 bb , vec3 bc , float bd ) { vec3 be , bf ; float bg , bh , bi , bj , bk , bl ; if ( bd > aj ) { bg = max ( dot ( ba , bc ) , aj ) ; bh = bd * bd ; bi = ak - al * ( bh / ( bh + 0.33 ) ) ; be = bb - a_ * ba ; bf = bc - bg * ba ; if ( length ( be ) == aj || length ( bf ) == aj || abs ( a_ ) > ak || abs ( bg ) > ak ) return a_ * bi ; else { bj = acos ( a_ ) ; bg = acos ( bg ) ; be = normalize ( be ) ; bf = normalize ( bf ) ; bk = max ( bj , bg ) ; bl = min ( bj , bg ) ; bl *= 0.95 ; bg = max ( dot ( be , bf ) , aj ) ; bh = 0.45 * ( bh / ( bh + 0.09 ) ) ; return a_ * ( bi + ( bh * bg * sin ( bk ) * tan ( bl ) ) ) ; } } else return a_ ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["DIFFUSE_SHADER","DIFFUSE_MINNAERT",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"float bs ( float bn , vec3 bo , vec3 bp , float bq ) { float br ; br = max ( dot ( bo , bp ) , aj ) ; if ( bq <= ak ) return bn * pow ( max ( br * bn , 0.1 ) , bq - ak ) ; else return bn * pow ( 1.0001 - br , bq - ak ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DIFFUSE_SHADER","DIFFUSE_TOON",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",
b:"float bx ( float bt , float bu , float bv ) { float bw ; bw = acos ( bt ) ; if ( bw < bu ) return ak ; else if ( bw > ( bu + bv ) || bv == aj ) return aj ; else return ak - ( ( bw - bu ) / bv ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DIFFUSE_SHADER","DIFFUSE_FRESNEL",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"float bC ( float by , float bz , float bA ) { float bB ; if ( bz == aj ) { return ak ; } else { bB = ak + abs ( by ) ; bB = bA + ( ak - bA ) * pow ( bB , bz ) ; return clamp ( bB , aj , ak ) ; } }".split(" ")}]}}]},
{type:"textline",b:"void bK ( vec3 bD , vec3 bE , vec3 bF , vec2 bG , const float bH , out float bI ) { float bJ ; bJ = ( ak - bH ) * dot ( bD , bE ) + bH ; bI = bJ ; if ( bH == al ) return ;".split(" ")},{type:"condition",a:[{type:"if",d:["DIFFUSE_SHADER","DIFFUSE_FRESNEL",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"bI = bC ( bJ , bG [ 0 ] , bG [ 1 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["DIFFUSE_SHADER","DIFFUSE_OREN_NAYAR",
{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"bI = bm ( bJ , bD , bE , bF , bG [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DIFFUSE_SHADER","DIFFUSE_MINNAERT",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"bI = bs ( bJ , bD , bF , bG [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["DIFFUSE_SHADER","DIFFUSE_TOON",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"bI = bx ( bJ , bG [ 0 ] , bG [ 1 ] ) ;".split(" ")}]}}]},
{type:"textline",b:"bI = max ( bI , aj ) ;".split(" ")}]}}]},{type:"textline",b:"} void bR ( vec3 bL , vec3 bM , vec3 bN , float bO , vec2 bP , out float bQ ) {".split(" ")},{type:"condition",a:[{type:"if",d:["SPECULAR_SHADER","SPECULAR_PHONG",{type:"equal_expr",e:2},"SPECULAR_SHADER","SPECULAR_COOKTORR",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"bQ = au ( bL , bM , bN , bO , bP [ 0 ] ) ;".split(" ")}]}},{type:"elif",d:["SPECULAR_SHADER","SPECULAR_WARDISO",
{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"bQ = aE ( bL , bM , bN , bP [ 0 ] ) ;".split(" ")}]}},{type:"elif",d:["SPECULAR_SHADER","SPECULAR_TOON",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"bQ = aM ( bL , bM , bN , bP [ 0 ] , bP [ 1 ] ) ;".split(" ")}]}},{type:"elif",d:["SPECULAR_SHADER","SPECULAR_BLINN",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"bQ = aZ ( bL , bM , bN , bP [ 0 ] , bP [ 1 ] , bO ) ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:["bQ","=","aj",";"]}]}}]},{type:"textline",b:"} void cm ( vec3 bS , vec3 bT , vec3 bU , vec2 bV , vec4 bW , vec3 bX , vec3 bY , vec3 bZ , inout am b_ , float ca , vec2 cb , vec2 cc , float cd ) { float ce , cf , cg , ch , ci , cj , ck , cl ; ce = aj ; if ( bV . r != aj ) bK ( bU , bT , bS , cb , cd , ce ) ; cf = aj ; if ( bV . g != aj ) bR ( bT , bS , bU , cd , cc , cf ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_TRANSLUCENCY"],group:{type:"group",
a:[{type:"textline",b:"if ( dot ( bT , bU ) * dot ( bS , bU ) < aj ) { cg = bW . x ; ch = bW . y ; ci = bW . z ; cj = bW . w ; ck = clamp ( abs ( dot ( bT , bU ) ) , aj , ak ) ; cl = clamp ( dot ( bS , - bT ) , aj , ak ) ; ch = pow ( cl , ch ) ; b_ . a += ca * vec4 ( bZ * ck * pow ( bX , vec3 ( cg ) ) , ak ) ; b_ . a += ci * mix ( vec4 ( bX , ak ) , vec4 ( ak ) , cj ) * ca * vec4 ( bZ * ck * vec3 ( ch ) , ak ) ; } else { b_ . b += bZ * bY * cf ; b_ . a += vec4 ( bZ * bX * ce , cf ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"b_ . b += bZ * bY * cf ; b_ . a += vec4 ( bZ * bX * ce , cf ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"lamp",name:"POINT",h:[{type:"textline",b:"cP = cA [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; cH = cx [ LAMP_IND ] ; cI = cz [ LAMP_IND ] ; cD = aj ;".split(" ")},{type:"textline",b:"cI = cI ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) cI *= cw ; cH = cH - cr ;".split(" ")},{type:"textline",b:"cE = length ( cH ) ; cI *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + cE * cE ) ; cH = normalize ( cH ) ; cm ( ct , cH , cs , cP , cC , cp , cq , cI , cT , cB , cv , cu , cD ) ;".split(" ")}]},
{type:"lamp",name:"SPOT",h:[{type:"textline",b:"cQ = cA [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; cJ = cx [ LAMP_IND ] ; cK = cz [ LAMP_IND ] ; cL = cy [ LAMP_IND ] ; cE = aj ;".split(" ")},{type:"textline",b:"cK = cK ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) cK *= cw ; cJ = cJ - cr ;".split(" ")},{type:"textline",b:"cF = length ( cJ ) ; cK *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + cF * cF ) ; cJ = normalize ( cJ ) ;".split(" ")},{type:"textline",b:"cF = dot ( cJ , cL ) ; cF *= smoothstep ( aj , ak , ( cF - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; cK *= cF ; cm ( ct , cJ , cs , cQ , cC , cp , cq , cK , cT , cB , cv , cu , cE ) ;".split(" ")}]},
{type:"lamp",name:"SUN",h:[{type:"textline",b:"cR = cA [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; cL = cz [ LAMP_IND ] ; cM = cy [ LAMP_IND ] ; cF = aj ;".split(" ")},{type:"textline",b:"cL = cL ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) cL *= cw ; cm ( ct , cM , cs , cR , cC , cp , cq , cL , cT , cB , cv , cu , cF ) ;".split(" ")}]},{type:"lamp",name:"HEMI",h:[{type:"textline",b:"cS = cA [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; cN = cz [ LAMP_IND ] ; cO = cy [ LAMP_IND ] ; cG = al ;".split(" ")},
{type:"textline",b:"cN = cN ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) cN *= cw ; cm ( ct , cO , cs , cS , cC , cp , cq , cN , cT , cB , cv , cu , cG ) ;".split(" ")}]},{type:"condition",a:[{type:"if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"am cU ( vec3 cn , vec3 co , vec3 cp , vec3 cq , vec3 cr , vec3 cs , vec3 ct , vec2 cu , vec2 cv , float cw , vec3 cx [ NUM_LIGHTS ] , vec3 cy [ NUM_LIGHTS ] , vec3 cz [ NUM_LIGHTS ] , vec4 cA [ NUM_LFACTORS ] , float cB , vec4 cC ) { float cD , cE , cF , cG ; vec3 cH , cI , cJ , cK , cL , cM , cN , cO ; vec2 cP , cQ , cR , cS ; am cT ; cT . a = vec4 ( cn + cp * co , aj ) ; cT . b = vec3 ( aj ) ;".split(" ")},
{type:"lamps_main"},{type:"textline",b:["return","cT",";","}"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"am cZ ( vec3 cV , vec3 cW , vec3 cX ) { am cY ; cY . a = vec4 ( cV + cX * cW , aj ) ; cY . b = vec3 ( aj ) ; return cY ; }".split(" ")}]}}]}]};a["include/procedural.glslf"]={type:"group",a:[{type:"textline",b:"float c_ = 0.0 ; float da = 1.0 ; vec4 dc ( vec4 db ) { return db - floor ( db * ( da / 289.0 ) ) * 289.0 ; } vec3 dc ( vec3 dd ) { return dd - floor ( dd * ( da / 289.0 ) ) * 289.0 ; } vec2 dc ( vec2 de ) { return de - floor ( de * ( da / 289.0 ) ) * 289.0 ; } vec4 dg ( vec4 df ) { return df - floor ( df * ( da / 7.0 ) ) * 7.0 ; } vec4 di ( vec4 dh ) { return dc ( ( 34.0 * dh + 5.0 ) * dh ) ; }".split(" ")},
{type:"define",name:"K",b:["0.142857142857"]},{type:"define",name:"K2",b:["0.0714285714285"]},{type:"define",name:"JITTER",b:["0.7"]},{type:"textline",b:"vec2 dr ( vec2 dj ) { vec4 dk , dl , dm , dn ; vec2 dp , dq ; dp = dc ( floor ( dj ) ) ; dq = fract ( dj ) ; dk = dq . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; dl = dq . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; dm = di ( dp . x + vec4 ( c_ , da , c_ , da ) ) ; dm = di ( dm + dp . y + vec4 ( c_ , c_ , da , da ) ) ; dn = dg ( dm ) * K + K2 ; dm = dg ( floor ( dm * K ) ) * K + K2 ; dn = dk + JITTER * dn ; dm = dl + JITTER * dm ; dm = dn * dn + dm * dm ;".split(" ")},
{type:"condition",a:[{type:"if",d:[1],group:{type:"group",a:[{type:"textline",b:"dm . xy = min ( dm . xy , dm . zw ) ; dm . x = min ( dm . x , dm . y ) ; return dm . xx ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"dm . xy = ( dm . x < dm . y ) ? dm . xy : dm . yx ; dm . xz = ( dm . x < dm . z ) ? dm . xz : dm . zx ; dm . xw = ( dm . x < dm . w ) ? dm . xw : dm . wx ; dm . y = min ( dm . y , dm . z ) ; dm . y = min ( dm . y , dm . w ) ; return sqrt ( dm . xy ) ;".split(" ")}]}}]},
{type:"textline",b:"} vec3 dA ( vec2 ds , float dt ) { vec4 du , dv , dw , dx ; vec2 dy , dz ; dy = dc ( floor ( ds ) ) ; dz = fract ( ds ) ; du = dz . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; dv = dz . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; dw = di ( dy . x + vec4 ( c_ , da , c_ , da ) ) ; dw = di ( dw + dy . y + vec4 ( c_ , c_ , da , da ) ) ; dx = dg ( dw ) * K + K2 ; dw = dg ( floor ( dw * K ) ) * K + K2 ; dx = du + JITTER * dx ; dw = dv + JITTER * dw ; dv = dx * dx + dw * dw ; dx += dt ; dw += dt ; du = dx * dx + dw * dw ; dx += dt ; dw += dt ; dw = dx * dx + dw * dw ; dv . xy = min ( dv . xy , dv . zw ) ; dv . x = min ( dv . x , dv . y ) ; du . xy = min ( du . xy , du . zw ) ; du . x = min ( du . x , du . y ) ; dw . xy = min ( dw . xy , dw . zw ) ; dw . x = min ( dw . x , dw . y ) ; return vec3 ( dv . x , du . x , dw . x ) ; } vec3 dC ( vec3 dB ) { return dc ( ( ( dB * 34.0 ) + da ) * dB ) ; } float dN ( vec2 dD ) { vec3 dE , dF , dG , dH ; vec4 dI ; vec2 dJ , dK , dL ; const vec4 dM = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; dJ = floor ( dD + dot ( dD , dM . yy ) ) ; dK = dD - dJ + dot ( dJ , dM . xx ) ; dL = ( dK . x > dK . y ) ? vec2 ( da , c_ ) : vec2 ( c_ , da ) ; dI = dK . xyxy + dM . xxzz ; dI . xy -= dL ; dJ = dc ( dJ ) ; dE = dC ( dC ( dJ . y + vec3 ( c_ , dL . y , da ) ) + dJ . x + vec3 ( c_ , dL . x , da ) ) ; dF = max ( 0.5 - vec3 ( dot ( dK , dK ) , dot ( dI . xy , dI . xy ) , dot ( dI . zw , dI . zw ) ) , c_ ) ; dF = dF * dF ; dF = dF * dF ; dE = 2.0 * fract ( dE * dM . www ) - da ; dG = abs ( dE ) - 0.5 ; dH = floor ( dE + 0.5 ) ; dH = dE - dH ; dF *= 1.79284291400159 - 0.85373472095314 * ( dH * dH + dG * dG ) ; dE . x = dH . x * dK . x + dG . x * dK . y ; dE . yz = dH . yz * dI . xz + dG . yz * dI . yw ; return 130.0 * dot ( dF , dE ) ; } vec2 dR ( vec2 dO ) { float dP , dQ ; dP = dot ( dO , vec2 ( 12.9898 , 78.233 ) ) ; dQ = dot ( dO , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; dP = fract ( sin ( dP ) * 43758.5453 ) * 2.0 - da ; dQ = fract ( sin ( dQ ) * 43758.5453 ) * 2.0 - da ; return vec2 ( dP , dQ ) ; }".split(" ")}]};
a["include/caustics.glslf"]={type:"group",a:[{type:"var",name:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{type:"var",name:"CAUST_SCALE",b:["0.0"]},{type:"var",name:"CAUST_BRIGHT",b:["0.0"]},{type:"define",name:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{type:"textline",b:"void ei ( inout vec3 dS , float dT , float dU , float dV , vec3 dW , vec3 dX , vec3 dY , vec4 dZ , vec3 d_ , float ea ) { float eb , ec , ed ; vec2 ee , ef ; vec3 eg ; vec4 eh ; if ( ea > CAUSTICS_VIEW_DISTANCE ) return ; eh = dZ ; eg = d_ + dW ; eg . xz = 10.0 * sin ( 0.1 * eg . xz ) ; eg = eg + 2.0 * cross ( - eh . xyz , cross ( - eh . xyz , eg ) + eh . w * eg ) ; ee = eg . xz ; eg = dX ; eb = max ( dot ( dW , eg ) , 0.0 ) ; ec = 0.025 ; ef = CAUST_SPEED * dU ; ee . s += 0.25 * sin ( dot ( d_ + dU , vec3 ( 1.0 ) ) ) ; ee . t += 0.35 * ( - sin ( dot ( d_ - dU , vec3 ( - 0.7 ) ) ) ) ; ee . st += 0.15 * cos ( 4.0 * dT - ef . x ) + 1.5 * sin ( dT - 0.3 * ef . y ) ; ed = CAUST_SCALE * ( 1.0 + max ( 0.1 * dT , 0.0 ) ) ; eg = dA ( ( ee / ed ) , ec ) ; eg *= CAUST_BRIGHT ; eg *= eg ; ec = min ( 0.25 * dT , - dT ) + 1.0 ; ec = max ( ec , 0.0 ) ; eb = dV * eb ; ed = max ( sign ( dT ) , 0.0 ) ; eb = eb + max ( 0.5 * sign ( - dW . y ) * ed , 0.0 ) ; eb = min ( eb , 1.0 ) ; dS += dY * eg * ec * eb ; }".split(" ")}]};
a["include/gamma.glslf"]={type:"group",a:[{type:"define",name:"GAMMA",b:["1"]},{type:"define",name:"PREMULTIPLY_ALPHA",b:["1"]},{type:"textline",b:"void ek ( inout vec3 ej ) {".split(" ")},{type:"condition",a:[{type:"if",d:["GAMMA"],group:{type:"group",a:[{type:"textline",b:"ej = max ( vec3 ( 0.0 ) , ej ) ; ej = pow ( ej , vec3 ( 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void em ( inout vec3 el ) {".split(" ")},{type:"condition",a:[{type:"if",d:["GAMMA"],group:{type:"group",a:[{type:"textline",
b:"el = max ( vec3 ( 0.0 ) , el ) ; el = pow ( el , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void ep ( inout vec3 en , in float eo ) {".split(" ")},{type:"condition",a:[{type:"if",d:["PREMULTIPLY_ALPHA"],group:{type:"group",a:[{type:"textline",b:"en = en * eo ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["include/math.glslv"]={type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"float eq = 0.0 ; float er = 1.0 ; struct es { vec3 a ; vec3 b ; vec3 c ; vec3 d ; vec3 e ; vec3 f ; } ; bool ev ( vec3 et , vec3 eu ) { return any ( lessThan ( abs ( et - eu ) , vec3 ( EPSILON ) ) ) ; } vec3 ey ( in vec4 ew , in vec3 ex ) { return ex + 2.0 * cross ( ew . xyz , cross ( ew . xyz , ex ) + ew . w * ex ) ; } vec4 eA ( in vec4 ez ) { return vec4 ( - ez . xyz , ez . w ) / dot ( ez , ez ) ; } vec3 eF ( vec4 eB , vec4 eC , vec4 eD ) { vec3 eE ; eE = eD . xyz * eB . w ; eE = ey ( eC , eE ) ; eE += eB . xyz * eD . w ; return eE ; } vec3 eL ( vec4 eG , vec4 eH , vec4 eI ) { vec4 eJ ; vec3 eK ; eK = eI . xyz - eG . xyz * eI . w ; eJ = eA ( eH ) ; eK = ey ( eJ , eK ) ; eK /= eG . w ; return eK ; } mat4 eM ( ) { return mat4 ( er , eq , eq , eq , eq , er , eq , eq , eq , eq , er , eq , eq , eq , eq , er ) ; } mat4 eO ( float eN ) { return mat4 ( er , eq , eq , eq , eq , cos ( eN ) , sin ( eN ) , eq , eq , - sin ( eN ) , cos ( eN ) , eq , eq , eq , eq , er ) ; } mat4 eQ ( float eP ) { return mat4 ( cos ( eP ) , eq , - sin ( eP ) , eq , eq , er , eq , eq , sin ( eP ) , eq , cos ( eP ) , eq , eq , eq , eq , er ) ; } mat4 eS ( float eR ) { return mat4 ( cos ( eR ) , sin ( eR ) , eq , eq , - sin ( eR ) , cos ( eR ) , eq , eq , eq , eq , er , eq , eq , eq , eq , er ) ; } es eU ( in es eT ) { return es ( eT . a , eT . b , normalize ( eT . c ) , normalize ( eT . d ) , normalize ( eT . e ) , eT . f ) ; }".split(" ")},
{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",e:4}],group:{type:"group",a:[{type:"textline",b:"vec3 e_ ( vec4 eV ) { vec3 eW ; float eX , eY , eZ ; eX = eV . x ; eY = eV . y ; eZ = eV . w ; eW . x = ( eX + eZ ) / 2.0 ; eW . y = ( eY + eZ ) / 2.0 ; eW . z = eZ ; return eW ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={type:"group",
a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"CSM_BLEND_BETWEEN_CASCADES",b:["1.0"]},{type:"var",name:"CSM_FADE_LAST_CASCADE",b:["1.0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["vec4","fl",";"]}]}}]},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",
e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"const float fm = 0.1 ; const float fn = 0.1 ; const float fo = - 0.01 ; const float fp = 0.05 ; vec4 fq = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 fr = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 fs = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 ft = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 fu = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 fv = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 fw = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 fx = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ; bool fA ( vec2 fy , float fz ) { return all ( lessThanEqual ( fy , vec2 ( 1.0 + fz ) ) ) && all ( greaterThanEqual ( fy , vec2 ( 0.0 - fz ) ) ) ; } float fJ ( float fB , float fC , mat2 fD , vec3 fE , float fF , PRECISION sampler2D fG ) { vec2 fH , fI ; fI . x = fB ; fI . y = fC ; fI = fD * fI ; fH = fE . xy + fI * fF / SHADOW_TEX_RES ;".split(" ")},
{type:"condition",a:[{type:"if",d:["CSM_SECTION1",{type:"logic_negative_expr",e:1}],group:{type:"group",a:[{type:"textline",b:"if ( ! fA ( fH , fo ) ) return 1.0 ; else".split(" ")}]}}]},{type:"textline",b:"return step ( fE . z , texture2D ( fG , fH ) . r ) ; } void fX ( inout float fK , inout float fL , float fM , float fN , mat2 fO , vec3 fP , vec3 fQ , float fR , float fS , PRECISION sampler2D fT , PRECISION sampler2D fU ) { vec2 fV , fW ; fW . x = fM ; fW . y = fN ; fW = fO * fW ; fV = fP . xy + fW * fR / SHADOW_TEX_RES ; fK += step ( fP . z , texture2D ( fT , fV ) . r ) ; fV = fQ . xy + fW * fS / SHADOW_TEX_RES ; fL += step ( fQ . z , texture2D ( fU , fV ) . r ) ; } float gf ( vec3 fY , PRECISION sampler2D fZ , float f_ ) { mat2 ga ; float gb , gc , gd ;".split(" ")},
{type:"condition",a:[{type:"if",d:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:"if ( fY . z > u_perspective_cast_far_bound ) return 1.0 ; else {".split(" ")}]}}]},{type:"textline",b:"fY . z = clamp ( fY . z , 0.0 , 1.0 ) ; gb = 0.0 ; gc = dR ( fY . xy ) . x * M_PI ; gd = cos ( gc ) ; gc = sin ( gc ) ; ga = mat2 ( gd , gc , - gc , gd ) ; for ( int ge = 0 ; ge < 4 ; ge ++ ) { gb += fJ ( fq [ ge ] , fu [ ge ] , ga , fY , f_ , fZ ) ; gb += fJ ( fr [ ge ] , fv [ ge ] , ga , fY , f_ , fZ ) ; gb += fJ ( fs [ ge ] , fw [ ge ] , ga , fY , f_ , fZ ) ; gb += fJ ( ft [ ge ] , fx [ ge ] , ga , fY , f_ , fZ ) ; } gb /= 16.0 ; return clamp ( gb , 0.0 , 1.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["}"]}]}}]},{type:"textline",b:"return 1.0 ; } float gt ( vec3 gg , PRECISION sampler2D gh , vec3 gi , PRECISION sampler2D gj , float gk , float gl , float gm ) { mat2 gn ; float go , gp , gq , gr ; gg . z = clamp ( gg . z , 0.0 , 1.0 ) ; gi . z = clamp ( gi . z , 0.0 , 1.0 ) ; go = 0.0 ; gp = 0.0 ; gq = dR ( gg . xy ) . x * M_PI ; gr = cos ( gq ) ; gq = sin ( gq ) ; gn = mat2 ( gr , gq , - gq , gr ) ; for ( int gs = 0 ; gs < 4 ; gs ++ ) { fX ( go , gp , fq [ gs ] , fu [ gs ] , gn , gg , gi , gk , gl , gh , gj ) ; fX ( go , gp , fr [ gs ] , fv [ gs ] , gn , gg , gi , gk , gl , gh , gj ) ; fX ( go , gp , fs [ gs ] , fw [ gs ] , gn , gg , gi , gk , gl , gh , gj ) ; fX ( go , gp , ft [ gs ] , fx [ gs ] , gn , gg , gi , gk , gl , gh , gj ) ; } go = mix ( go , gp , gm ) ; go /= 16.0 ; return clamp ( go , 0.0 , 1.0 ) ; } float gx ( vec2 gu ) { float gv , gw ; gv = min ( gu . x , gu . y ) ; gw = min ( 1.0 - gu . x , 1.0 - gu . y ) ; return min ( gv , gw ) ; } float gA ( float gy , float gz ) { if ( gz >= 0.0 && gz <= fn ) gy = ( gy - 1.0 ) / fn * gz + 1.0 ; return gy ; } float gL ( vec3 gB , vec3 gC , PRECISION sampler2D gD , PRECISION sampler2D gE , float gF , float gG , float gH , float gI ) { float gJ , gK ;".split(" ")},
{type:"condition",a:[{type:"if",d:["CSM_BLEND_BETWEEN_CASCADES"],group:{type:"group",a:[{type:"textline",b:"gK = gx ( gB . xy ) ; if ( - gI > gH && gK >= 0.0 && gK <= fm && fA ( gC . xy , 0.0 ) ) { gK = 1.0 - gK / fm ; gJ = gt ( gB , gD , gC , gE , gF , gG , gK ) ; } else".split(" ")}]}}]},{type:"textline",b:"gJ = gf ( gB , gD , gF ) ; return gJ ; } float gT ( vec3 gM , PRECISION sampler2D gN , float gO , float gP , float gQ ) { float gR , gS ; gR = gf ( gM , gN , gO ) ;".split(" ")},{type:"condition",
a:[{type:"if",d:["CSM_FADE_LAST_CASCADE"],group:{type:"group",a:[{type:"textline",b:"if ( - gQ > gP ) { gS = gx ( gM . xy ) ; gR = gA ( gR , gS ) ; }".split(" ")}]}}]},{type:"textline",b:"return gR ; } float g_ ( float gU ) { vec3 gV , gW , gX , gY ; float gZ ; gZ = 1.0 ; gV = fg . xyz / fg . w ;".split(" ")},{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"gW = fh . xyz / fh . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",
a:[{type:"textline",b:"gX = fi . xyz / fi . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"gY = fj . xyz / fj . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"if ( fA ( gV . xy , 0.0 ) ) { gZ = gL ( gV , gW , u_shadow_map0 , u_shadow_map1 , u_pcf_blur_radii [ 0 ] , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 0 ] , gU ) ; }".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"if ( fA ( gV . xy , fp ) ) { gZ = gT ( gV , u_shadow_map0 , u_pcf_blur_radii [ 0 ] , u_csm_center_dists [ 0 ] , gU ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"else { if ( fA ( gW . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"gZ = gL ( gW , gX , u_shadow_map1 , u_shadow_map2 , u_pcf_blur_radii [ 1 ] , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 1 ] , gU ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gZ = gT ( gW , u_shadow_map1 , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 1 ] , gU ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"else { if ( fA ( gX . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"gZ = gL ( gX , gY , u_shadow_map2 , u_shadow_map3 , u_pcf_blur_radii [ 2 ] , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 2 ] , gU ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gZ = gT ( gX , u_shadow_map2 , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 2 ] , gU ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"else { if ( fA ( gY . xy , 0.0 ) ) gZ = gT ( gY , u_shadow_map3 , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 3 ] , gU ) ; }".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",
b:["return","gZ",";","}"]}]}}]},{type:"textline",b:"float he ( inout vec3 ha ) { float hb ; vec3 hc ; vec2 hd ;".split(" ")},{type:"condition",a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"hd = texture2DProj ( u_shadow_mask , fe ) . rg ; hc = vec3 ( hd . r ) ; hb = hd . g ; fl = vec4 ( hc , hb ) ; ha *= fl . a ; return fl . r ;".split(" ")}]}},{type:"elif",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},
"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"return g_ ( fb . z ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["return","1.0",";"]}]}}]},{type:"textline",b:["}"]}]};a["include/mirror.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2},"REFLECTION_TYPE","REFL_MIRRORMAP",
{type:"equal_expr",e:2},{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"define",name:"REFL_BUMP",b:["0.1"]},{type:"textline",b:"float hl ( in vec3 hf , vec3 hg , float hh , float hi ) { float hj ; vec3 hk ; hk = normalize ( hg + hf ) ; hj = 1.0 - dot ( hf , hk ) ; hj = hi + ( 1.0 - hi ) * pow ( hj , hh ) ; return hj ; } void hy ( inout vec3 hm , vec3 hn , vec3 ho , float hp ) { vec2 hq , hr ; float hs , ht , hu ; vec3 hv , hw , hx ; hv = reflect ( - hn , ho ) ; hs = u_fresnel_params [ 2 ] ; ht = u_fresnel_params [ 3 ] ; hu = 1.0 ; if ( hs != 0.0 ) hu = hl ( hn , hv , hs , ht ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"hw = textureCube ( u_cube_reflection , hv ) . xyz ;".split(" ")}]}},{type:"elif",d:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"hx = u_refl_plane . xyz * dot ( ho , u_refl_plane . xyz ) ; hx = ho - hx ; hq = ( u_view_matrix_frag * vec4 ( hx , 0.0 ) ) . xy ; hr = fe . xy / fe . z ; hr += hq * REFL_BUMP ; hw = texture2D ( u_plane_reflection , hr ) . rgb ;".split(" ")}]}},
{type:"elif",d:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"hw = textureCube ( u_mirrormap , hv ) . xyz ; hp = u_mirror_factor ;".split(" ")}]}}]},{type:"textline",b:"ek ( hw . rgb ) ; hm = mix ( hm , hw , hp * hu ) ; }".split(" ")}]}}]}]};a["include/environment.glslf"]={type:"group",a:[{type:"textline",b:"vec3 hB ( vec3 hz ) { float hA ;".split(" ")},{type:"condition",a:[{type:"if",d:["USE_ENVIRONMENT_LIGHT"],group:{type:"group",a:[{type:"condition",
a:[{type:"if",d:["SKY_TEXTURE"],group:{type:"group",a:[{type:"textline",b:"return textureCube ( u_sky_texture , hz ) . rgb ;".split(" ")}]}},{type:"elif",d:["SKY_COLOR"],group:{type:"group",a:[{type:"textline",b:"hA = 0.5 * hz . y + 0.5 ; return mix ( u_horizon_color , u_zenith_color , hA ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["}"]}]};a["include/refraction.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",d:["REFRACTIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",b:"float hH ( in float hC , inout vec2 hD , in vec2 hE ) { float hF ; vec4 hG ; hG = texture2D ( u_scene_depth , hD ) ; hF = k ( hG ) ; if ( hF < ff ) { hD = hE ; return hC ; } else { return hF ; } return hC ; }".split(" ")}]}}]},{type:"textline",b:"vec3 hP ( in vec3 hI , in vec2 hJ ) { vec3 hK ; float hL ; vec4 hM ; vec2 hN , hO ; hN = hI . xy / hI . z ; hO = hN + hJ ;".split(" ")},
{type:"condition",a:[{type:"if",d:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",b:"hM = texture2DProj ( u_scene_depth , hI ) ; hL = k ( hM ) ; hH ( hL , hO , hN ) ;".split(" ")}]}}]},{type:"textline",b:"hK = texture2D ( u_refractmap , hO ) . rgb ; ek ( hK ) ; return hK ; }".split(" ")}]}}]}]};a["include/nodes.glslf"]={type:"group",a:[{type:"var",name:"MAPPING_TRS_MATRIX",b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",
b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"condition",a:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","hQ",";"]}]}}]},{type:"textline",
b:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; vec3 hR = vec3 ( ZERO_VALUE_NODES ) ; vec3 hS = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"vec3 hW ( in vec3 hT , in float hU ) { vec3 hV ; hV = hR ;".split(" ")},{type:"condition",a:[{type:"if",d:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"hV = hP ( fe , hT . xz * hU ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"hV = texture2D ( u_refractmap , fe . xy / fe . z ) . rgb ; ek ( hV ) ;".split(" ")}]}}]},{type:"textline",b:["return","hV",";","}"]}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{type:"logical_or_expr",e:6}],group:{type:"group",a:[{type:"textline",b:"vec3 ia ( vec3 hX ) { float hY , hZ ; vec4 h_ ; h_ = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; h_ = mix ( vec4 ( hX . bg , h_ . wz ) , vec4 ( hX . gb , h_ . xy ) , step ( hX . b , hX . g ) ) ; h_ = mix ( vec4 ( h_ . xyw , hX . r ) , vec4 ( hX . r , h_ . yzx ) , step ( h_ . x , hX . r ) ) ; hY = h_ . x - min ( h_ . w , h_ . y ) ; hZ = 1.0e-10 ; return vec3 ( abs ( h_ . z + ( h_ . w - h_ . y ) / ( 6.0 * hY + hZ ) ) , hY / ( h_ . x + hZ ) , h_ . x ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{type:"logical_or_expr",e:6}],group:{type:"group",a:[{type:"textline",b:"vec3 ie ( vec3 ib ) { vec3 ic ; vec4 id ; id = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; ic = abs ( fract ( vec3 ( ib . r , ib . r , ib . r ) + id . xyz ) * 6.0 - id . www ) ; return ib . b * mix ( id . xxx , clamp ( ic - id . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , ib . g ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:"vec3 ih ( vec2 ig ) { return vec3 ( ig * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{type:"logical_or_expr",e:3}],group:{type:"group",a:[{type:"textline",b:"vec2 ij ( vec3 ii ) { return vec2 ( ii . xy * 0.5 + vec2 ( 0.5 , 0.5 ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",j:[{type:"node_out",name:"jl",qualifier:["vec3"],f:!0},{type:"node_out",name:"jm",qualifier:["float"],f:!0},{type:"node_out",name:"jn",qualifier:["float"],f:!0}],h:[{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_jl"],h:[{type:"textline",b:"jl = normalize ( iS . xyz ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_jm"],h:[{type:"textline",b:"jm = abs ( iS . z ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_jn"],
h:[{type:"textline",b:"jn = length ( iS . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",j:[{type:"node_in",name:"jo",qualifier:["float"],f:!1},{type:"node_in",name:"jp",qualifier:["float"],f:!1},{type:"node_in",name:"jq",qualifier:["float"],f:!1},{type:"node_out",name:"jr",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"jr = vec3 ( jo , jp , jq ) ;".split(" ")}]},{type:"node",name:"COMBHSV",j:[{type:"node_in",name:"js",qualifier:["float"],f:!1},{type:"node_in",name:"jt",qualifier:["float"],
f:!1},{type:"node_in",name:"ju",qualifier:["float"],f:!1},{type:"node_out",name:"jv",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"jv = ie ( vec3 ( js , jt , ju ) ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_UV",j:[{type:"node_out",name:"jw",qualifier:["vec3"],f:!1},{type:"node_param",name:"ik",qualifier:["varying","vec2"]}],h:[{type:"textline",b:"jw = ih ( ik ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",j:[{type:"node_out",name:"jx",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"jx = 2.0 * clamp ( hQ , 0.0 , 1.0 ) - hS ;".split(" ")}]},
{type:"node",name:"GEOMETRY_VC",j:[{type:"node_out",name:"jy",qualifier:["vec3"],f:!1},{type:"node_param",name:"il",qualifier:["varying","vec3"]}],h:[{type:"textline",b:["jy","=","il",";"]}]},{type:"node",name:"GEOMETRY_VC1",j:[{type:"node_out",name:"jz",qualifier:["float"],f:!1},{type:"node_param",name:"im",qualifier:["varying","float"]}],h:[{type:"textline",b:["jz","=","im",";"]}]},{type:"node",name:"GEOMETRY_VC2",j:[{type:"node_out",name:"jA",qualifier:["float"],f:!1},{type:"node_out",name:"jB",
qualifier:["float"],f:!1},{type:"node_param",name:"io",qualifier:["varying","vec2"]}],h:[{type:"textline",b:"jA = io [ 0 ] ; jB = io [ 1 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC3",j:[{type:"node_out",name:"jC",qualifier:["float"],f:!1},{type:"node_out",name:"jD",qualifier:["float"],f:!1},{type:"node_out",name:"jE",qualifier:["float"],f:!1},{type:"node_param",name:"ip",qualifier:["varying","vec3"]}],h:[{type:"textline",b:"jC = ip [ 0 ] ; jD = ip [ 1 ] ; jE = ip [ 2 ] ;".split(" ")}]},{type:"node",
name:"GEOMETRY_NO",j:[{type:"node_out",name:"jF",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["jF","=","iW",";"]}]},{type:"node",name:"GEOMETRY_FB",j:[{type:"node_out",name:"jG",qualifier:["float"],f:!1}],h:[{type:"textline",b:"jG = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_VW",j:[{type:"node_out",name:"jH",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["jH","=","iA",";"]}]},{type:"node",name:"GEOMETRY_LO",j:[{type:"node_out",name:"jI",
qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"jI [ 0 ] = iS [ 0 ] ; jI [ 1 ] = iS [ 1 ] ; jI [ 2 ] = iS [ 2 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_GL",j:[{type:"node_out",name:"jJ",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"jJ = vec3 ( iV . r , - iV . b , iV . g ) ;".split(" ")}]},{type:"node",name:"NEW_GEOMETRY",j:[{type:"node_out",name:"jK",qualifier:["vec3"],f:!1},{type:"node_out",name:"jL",qualifier:["vec3"],f:!1},{type:"node_out",name:"jM",qualifier:["vec3"],f:!1},{type:"node_out",
name:"jN",qualifier:["vec3"],f:!1},{type:"node_out",name:"jO",qualifier:["vec3"],f:!1},{type:"node_out",name:"jP",qualifier:["vec3"],f:!1},{type:"node_out",name:"jQ",qualifier:["float"],f:!1},{type:"node_out",name:"jR",qualifier:["float"],f:!1}],h:[{type:"textline",b:"jK = hR ; jL = hR ; jM = hR ; jN = hR ; jO = hR ; jP = hR ; jQ = ZERO_VALUE_NODES ; jR = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"HUE_SAT",j:[{type:"node_in",name:"jS",qualifier:["float"],f:!1},{type:"node_in",name:"jT",
qualifier:["float"],f:!1},{type:"node_in",name:"jU",qualifier:["float"],f:!1},{type:"node_in",name:"jV",qualifier:["float"],f:!1},{type:"node_in",name:"jW",qualifier:["vec3"],f:!1},{type:"node_out",name:"jX",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iX = ia ( jW ) ; iX [ 0 ] += ( jS - 0.5 ) ; if ( iX [ 0 ] > UNITY_VALUE_NODES ) iX [ 0 ] -= UNITY_VALUE_NODES ; else if ( iX [ 0 ] < ZERO_VALUE_NODES ) iX [ 0 ] += UNITY_VALUE_NODES ; iX *= vec3 ( UNITY_VALUE_NODES , jT , jU ) ; iX = mix ( hS , mix ( hR , iX , step ( hR , iX ) ) , step ( iX , hS ) ) ; jX = mix ( jW , ie ( iX ) , jV ) ;".split(" ")}]},
{type:"node",name:"INVERT",j:[{type:"node_in",name:"jY",qualifier:["float"],f:!1},{type:"node_in",name:"jZ",qualifier:["vec3"],f:!1},{type:"node_out",name:"j_",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"j_ = mix ( jZ , hS - jZ , jY ) ;".split(" ")}]},{type:"node",name:"LAMP",j:[{type:"node_out",name:"ka",qualifier:["vec3"],f:!0},{type:"node_out",name:"kb",qualifier:["vec3"],f:!1},{type:"node_out",name:"kc",qualifier:["float"],f:!1},{type:"node_out",name:"kd",qualifier:["float"],f:!0}],h:[{type:"node_condition",
a:[{type:"node_if",d:["USE_OUT_ka"],h:[{type:"textline",b:"ka = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{type:"textline",b:"iT = u_lamp_light_factors [ LAMP_INDEX ] ; iY = u_lamp_light_directions [ LAMP_INDEX ] ; iZ = u_lamp_light_positions [ LAMP_INDEX ] ; iK = iT . z ; if ( iK != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",b:"kb = iZ - fa ; kc = length ( kb ) ; kb = normalize ( kb ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_kd"],h:[{type:"textline",
b:"kd = iK / ( iK + kc * kc ) ; iK = iT . x ; iL = iT . y ; if ( iK > - UNITY_VALUE_NODES ) { iM = dot ( kb , iY ) ; iM *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( iM - iK ) / iL ) ; kd *= iM ; }".split(" ")}]}]},{type:"textline",b:["}","else","{"]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_kb"],h:[{type:"textline",b:["kb","=","iY",";"]}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_kc"],h:[{type:"textline",b:"kc = length ( iZ - fa ) ;".split(" ")}]}]},{type:"node_condition",
a:[{type:"node_if",d:["USE_OUT_kd"],h:[{type:"textline",b:["kd","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",b:["}"]}]},{type:"node",name:"NORMAL",j:[{type:"node_in",name:"ke",qualifier:["vec3"],f:!1},{type:"node_out",name:"kf",qualifier:["vec3"],f:!0},{type:"node_out",name:"kg",qualifier:["float"],f:!0},{type:"node_param",name:"iq",qualifier:["vec3"]}],h:[{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_kf"],h:[{type:"textline",b:["kf","=","iq",";"]}]}]},{type:"node_condition",a:[{type:"node_if",
d:["USE_OUT_kg"],h:[{type:"textline",b:"kg = - dot ( ke , iq ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",j:[{type:"node_in",name:"kh",qualifier:["vec3"],f:!1},{type:"node_out",name:"ki",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"ki = - ( u_view_matrix_frag * vec4 ( kh , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",name:"BSDF_ANISOTROPIC",j:[{type:"node_in",name:"kj",qualifier:["vec3"],f:!1},{type:"node_in",name:"kk",qualifier:["float"],f:!1},{type:"node_in",name:"kl",
qualifier:["float"],f:!1},{type:"node_in",name:"km",qualifier:["float"],f:!1},{type:"node_in",name:"kn",qualifier:["vec3"],f:!1},{type:"node_in",name:"ko",qualifier:["vec3"],f:!1},{type:"node_out",name:"kp",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["kp","=","kj",";"]},{type:"textline",b:"kk ; kl ; km ; kn ; ko ;".split(" ")}]},{type:"node",name:"BSDF_DIFFUSE",j:[{type:"node_in",name:"kq",qualifier:["vec3"],f:!1},{type:"node_in",name:"kr",qualifier:["float"],f:!1},{type:"node_in",name:"ks",
qualifier:["vec3"],f:!1},{type:"node_out",name:"kt",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["kt","=","kq",";"]},{type:"textline",b:["kr",";","ks",";"]}]},{type:"node",name:"BSDF_GLASS",j:[{type:"node_in",name:"ku",qualifier:["vec3"],f:!1},{type:"node_in",name:"kv",qualifier:["float"],f:!1},{type:"node_in",name:"kw",qualifier:["float"],f:!1},{type:"node_in",name:"kx",qualifier:["vec3"],f:!1},{type:"node_out",name:"ky",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["ky","=","ku",";"]},{type:"textline",
b:"kv ; kw ; kx ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",j:[{type:"node_in",name:"kz",qualifier:["vec3"],f:!1},{type:"node_in",name:"kA",qualifier:["float"],f:!1},{type:"node_in",name:"kB",qualifier:["vec3"],f:!1},{type:"node_out",name:"kC",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["kC","=","kz",";"]},{type:"textline",b:["kA",";","kB",";"]}]},{type:"node",name:"BSDF_HAIR",j:[{type:"node_in",name:"kD",qualifier:["vec3"],f:!1},{type:"node_in",name:"kE",qualifier:["float"],f:!1},{type:"node_in",
name:"kF",qualifier:["float"],f:!1},{type:"node_in",name:"kG",qualifier:["float"],f:!1},{type:"node_out",name:"kH",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["kH","=","kD",";"]},{type:"textline",b:"kE ; kF ; kG ;".split(" ")}]},{type:"node",name:"BSDF_TRANSPARENT",j:[{type:"node_in",name:"kI",qualifier:["vec3"],f:!1},{type:"node_out",name:"kJ",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["kJ","=","kI",";"]}]},{type:"node",name:"BSDF_TRANSLUCENT",j:[{type:"node_in",name:"kK",qualifier:["vec3"],
f:!1},{type:"node_in",name:"kL",qualifier:["vec3"],f:!1},{type:"node_out",name:"kM",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["kM","=","kK",";"]},{type:"textline",b:["kL",";"]}]},{type:"node",name:"BSDF_REFRACTION",j:[{type:"node_in",name:"kN",qualifier:["vec3"],f:!1},{type:"node_in",name:"kO",qualifier:["float"],f:!1},{type:"node_in",name:"kP",qualifier:["float"],f:!1},{type:"node_in",name:"kQ",qualifier:["vec3"],f:!1},{type:"node_out",name:"kR",qualifier:["vec3"],f:!1}],h:[{type:"textline",
b:"kR [ 0 ] = kR [ 1 ] = kR [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"kN ; kO ; kP ; kQ ;".split(" ")}]},{type:"node",name:"BSDF_TOON",j:[{type:"node_in",name:"kS",qualifier:["vec3"],f:!1},{type:"node_in",name:"kT",qualifier:["float"],f:!1},{type:"node_in",name:"kU",qualifier:["float"],f:!1},{type:"node_in",name:"kV",qualifier:["vec3"],f:!1},{type:"node_out",name:"kW",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["kW","=","kS",";"]},{type:"textline",b:"kT ; kU ; kV ;".split(" ")}]},
{type:"node",name:"BSDF_VELVET",j:[{type:"node_in",name:"kX",qualifier:["vec3"],f:!1},{type:"node_in",name:"kY",qualifier:["float"],f:!1},{type:"node_in",name:"kZ",qualifier:["vec3"],f:!1},{type:"node_out",name:"k_",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["k_","=","kX",";"]},{type:"textline",b:["kY",";","kZ",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",j:[{type:"node_in",name:"la",qualifier:["vec3"],f:!1},{type:"node_in",name:"lb",qualifier:["float"],f:!1},{type:"node_in",name:"lc",
qualifier:["vec3"],f:!1},{type:"node_in",name:"ld",qualifier:["float"],f:!1},{type:"node_in",name:"le",qualifier:["float"],f:!1},{type:"node_in",name:"lf",qualifier:["vec3"],f:!1},{type:"node_out",name:"lg",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"lg [ 0 ] = lg [ 1 ] = lg [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"la ; lc ; ld ; le ; lf ; lb ;".split(" ")}]},{type:"node",name:"EMISSION",j:[{type:"node_in",name:"lh",qualifier:["vec3"],f:!1},{type:"node_in",name:"li",qualifier:["float"],
f:!1},{type:"node_out",name:"lj",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["lj","=","lh",";"]},{type:"textline",b:["li",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",j:[{type:"node_in",name:"lk",qualifier:["vec3"],f:!1},{type:"node_out",name:"ll",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"ll [ 0 ] = ll [ 1 ] = ll [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["lk",";"]}]},{type:"node",name:"HOLDOUT",j:[{type:"node_out",name:"lm",qualifier:["vec3"],f:!1}],h:[{type:"textline",
b:"lm [ 0 ] = lm [ 1 ] = lm [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",j:[{type:"node_in",name:"ln",qualifier:["vec3"],f:!1},{type:"node_in",name:"lo",qualifier:["float"],f:!1},{type:"node_out",name:"lp",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"lp [ 0 ] = lp [ 1 ] = lp [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["ln",";","lo",";"]}]},{type:"node",name:"VOLUME_SCATTER",j:[{type:"node_in",name:"lq",qualifier:["vec3"],f:!1},{type:"node_in",
name:"lr",qualifier:["float"],f:!1},{type:"node_in",name:"ls",qualifier:["float"],f:!1},{type:"node_out",name:"lt",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"lt [ 0 ] = lt [ 1 ] = lt [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"lq ; lr ; ls ;".split(" ")}]},{type:"node",name:"BUMP",j:[{type:"node_in",name:"lu",qualifier:["float"],f:!1},{type:"node_in",name:"lv",qualifier:["float"],f:!1},{type:"node_in",name:"lw",qualifier:["float"],f:!1},{type:"node_in",name:"lx",qualifier:["vec3"],
f:!1},{type:"node_out",name:"ly",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["ly","=","lx",";"]},{type:"textline",b:"lu ; lv ; lw ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",j:[{type:"node_in",name:"lz",qualifier:["float"],f:!1},{type:"node_in",name:"lA",qualifier:["vec3"],f:!1},{type:"node_out",name:"lB",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["lB","=","lA",";"]},{type:"textline",b:["lz",";"]}]},{type:"node",name:"VECT_TRANSFORM",j:[{type:"node_in",name:"lC",qualifier:["vec3"],
f:!1},{type:"node_out",name:"lD",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"lD [ 0 ] = lD [ 1 ] = lD [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["lC",";"]}]},{type:"node",name:"BLACKBODY",j:[{type:"node_in",name:"lE",qualifier:["float"],f:!1},{type:"node_out",name:"lF",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"lF [ 0 ] = lF [ 1 ] = lF [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["lE",";"]}]},{type:"node",name:"WAVELENGTH",j:[{type:"node_in",name:"lG",qualifier:["float"],
f:!1},{type:"node_out",name:"lH",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"lH [ 0 ] = lH [ 1 ] = lH [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["lG",";"]}]},{type:"node",name:"SEPXYZ",j:[{type:"node_in",name:"lI",qualifier:["vec3"],f:!1},{type:"node_out",name:"lJ",qualifier:["float"],f:!1},{type:"node_out",name:"lK",qualifier:["float"],f:!1},{type:"node_out",name:"lL",qualifier:["float"],f:!1}],h:[{type:"textline",b:"lJ = lI [ 0 ] ; lK = lI [ 1 ] ; lL = lI [ 2 ] ;".split(" ")}]},
{type:"node",name:"COMBXYZ",j:[{type:"node_in",name:"lM",qualifier:["float"],f:!1},{type:"node_in",name:"lN",qualifier:["float"],f:!1},{type:"node_in",name:"lO",qualifier:["float"],f:!1},{type:"node_out",name:"lP",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"lP [ 0 ] = lM ; lP [ 1 ] = lN ; lP [ 2 ] = lO ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",j:[{type:"node_in",name:"lQ",qualifier:["vec3"],f:!1},{type:"node_in",name:"lR",qualifier:["float"],f:!1},{type:"node_in",name:"lS",qualifier:["float"],
f:!1},{type:"node_out",name:"lT",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iM = lR - lS * 0.5 ; lT = max ( ( UNITY_VALUE_NODES + lS ) * lQ + iM , hR ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",j:[{type:"node_in",name:"lU",qualifier:["float"],f:!1},{type:"node_in",name:"lV",qualifier:["float"],f:!1},{type:"node_out",name:"lW",qualifier:["float"],f:!1},{type:"node_out",name:"lX",qualifier:["float"],f:!1},{type:"node_out",name:"lY",qualifier:["float"],f:!1}],h:[{type:"textline",b:"lW = lX = lY = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["lU",";","lV",";"]}]},{type:"node",name:"TEX_IMAGE",j:[{type:"node_in",name:"lZ",qualifier:["vec3"],f:!1},{type:"node_out",name:"l_",qualifier:["vec3"],f:!1},{type:"node_out",name:"ma",qualifier:["float"],f:!1}],h:[{type:"textline",b:"l_ [ 0 ] = l_ [ 1 ] = l_ [ 2 ] = ZERO_VALUE_NODES ; ma = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["lZ",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",j:[{type:"node_in",name:"mb",qualifier:["vec3"],f:!1},{type:"node_out",name:"mc",qualifier:["vec3"],
f:!1}],h:[{type:"textline",b:"mc [ 0 ] = mc [ 1 ] = mc [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["mb",";"]}]},{type:"node",name:"TEX_SKY",j:[{type:"node_in",name:"md",qualifier:["vec3"],f:!1},{type:"node_out",name:"me",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"me [ 0 ] = me [ 1 ] = me [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["md",";"]}]},{type:"node",name:"TEX_NOISE",j:[{type:"node_in",name:"mf",qualifier:["vec3"],f:!1},{type:"node_in",name:"mg",qualifier:["float"],
f:!1},{type:"node_in",name:"mh",qualifier:["float"],f:!1},{type:"node_in",name:"mi",qualifier:["float"],f:!1},{type:"node_out",name:"mj",qualifier:["vec3"],f:!1},{type:"node_out",name:"mk",qualifier:["float"],f:!1}],h:[{type:"textline",b:"mj [ 0 ] = mj [ 1 ] = mj [ 2 ] = ZERO_VALUE_NODES ; mk = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"mf ; mg ; mh ; mi ;".split(" ")}]},{type:"node",name:"TEX_WAVE",j:[{type:"node_in",name:"ml",qualifier:["vec3"],f:!1},{type:"node_in",name:"mm",qualifier:["float"],
f:!1},{type:"node_in",name:"mn",qualifier:["float"],f:!1},{type:"node_in",name:"mo",qualifier:["float"],f:!1},{type:"node_in",name:"mp",qualifier:["float"],f:!1},{type:"node_out",name:"mq",qualifier:["vec3"],f:!1},{type:"node_out",name:"mr",qualifier:["float"],f:!1}],h:[{type:"textline",b:"mq [ 0 ] = mq [ 1 ] = mq [ 2 ] = ZERO_VALUE_NODES ; mr = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"ml ; mm ; mn ; mo ; mp ;".split(" ")}]},{type:"node",name:"TEX_VORONOI",j:[{type:"node_in",name:"ms",
qualifier:["vec3"],f:!1},{type:"node_in",name:"mt",qualifier:["float"],f:!1},{type:"node_out",name:"mu",qualifier:["vec3"],f:!1},{type:"node_out",name:"mv",qualifier:["float"],f:!1}],h:[{type:"textline",b:"mu [ 0 ] = mu [ 1 ] = mu [ 2 ] = ZERO_VALUE_NODES ; mv = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["ms",";","mt",";"]}]},{type:"node",name:"TEX_MUSGRAVE",j:[{type:"node_in",name:"mw",qualifier:["vec3"],f:!1},{type:"node_in",name:"mx",qualifier:["float"],f:!1},{type:"node_in",name:"my",
qualifier:["float"],f:!1},{type:"node_in",name:"mz",qualifier:["float"],f:!1},{type:"node_in",name:"mA",qualifier:["float"],f:!1},{type:"node_in",name:"mB",qualifier:["float"],f:!1},{type:"node_in",name:"mC",qualifier:["float"],f:!1},{type:"node_out",name:"mD",qualifier:["vec3"],f:!1},{type:"node_out",name:"mE",qualifier:["float"],f:!1}],h:[{type:"textline",b:"mD [ 0 ] = mD [ 1 ] = mD [ 2 ] = ZERO_VALUE_NODES ; mE = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"mw ; mx ; my ; mz ; mA ; mB ; mC ;".split(" ")}]},
{type:"node",name:"TEX_GRADIENT",j:[{type:"node_in",name:"mF",qualifier:["vec3"],f:!1},{type:"node_out",name:"mG",qualifier:["vec3"],f:!1},{type:"node_out",name:"mH",qualifier:["float"],f:!1}],h:[{type:"textline",b:"mG [ 0 ] = mG [ 1 ] = mG [ 2 ] = ZERO_VALUE_NODES ; mH = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["mF",";"]}]},{type:"node",name:"TEX_MAGIC",j:[{type:"node_in",name:"mI",qualifier:["vec3"],f:!1},{type:"node_in",name:"mJ",qualifier:["float"],f:!1},{type:"node_in",name:"mK",
qualifier:["float"],f:!1},{type:"node_out",name:"mL",qualifier:["vec3"],f:!1},{type:"node_out",name:"mM",qualifier:["float"],f:!1}],h:[{type:"textline",b:"mL [ 0 ] = mL [ 1 ] = mL [ 2 ] = ZERO_VALUE_NODES ; mM = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"mI ; mJ ; mK ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",j:[{type:"node_in",name:"mN",qualifier:["vec3"],f:!1},{type:"node_in",name:"mO",qualifier:["vec3"],f:!1},{type:"node_in",name:"mP",qualifier:["vec3"],f:!1},{type:"node_in",name:"mQ",
qualifier:["float"],f:!1},{type:"node_out",name:"mR",qualifier:["vec3"],f:!1},{type:"node_out",name:"mS",qualifier:["float"],f:!1}],h:[{type:"textline",b:"mR [ 0 ] = mR [ 1 ] = mR [ 2 ] = ZERO_VALUE_NODES ; mS = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"mN ; mO ; mP ; mQ ;".split(" ")}]},{type:"node",name:"TEX_BRICK",j:[{type:"node_in",name:"mT",qualifier:["vec3"],f:!1},{type:"node_in",name:"mU",qualifier:["vec3"],f:!1},{type:"node_in",name:"mV",qualifier:["vec3"],f:!1},{type:"node_in",
name:"mW",qualifier:["vec3"],f:!1},{type:"node_in",name:"mX",qualifier:["float"],f:!1},{type:"node_in",name:"mY",qualifier:["float"],f:!1},{type:"node_in",name:"mZ",qualifier:["float"],f:!1},{type:"node_in",name:"m_",qualifier:["float"],f:!1},{type:"node_in",name:"na",qualifier:["float"],f:!1},{type:"node_out",name:"nb",qualifier:["vec3"],f:!1},{type:"node_out",name:"nc",qualifier:["float"],f:!1}],h:[{type:"textline",b:"nb [ 0 ] = nb [ 1 ] = nb [ 2 ] = ZERO_VALUE_NODES ; nc = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"mT ; mU ; mV ; mW ; mX ; mY ; mZ ; m_ ; na ;".split(" ")}]},{type:"node",name:"ADD_SHADER",j:[{type:"node_in",name:"nd",qualifier:["vec3"],f:!1},{type:"node_in",name:"ne",qualifier:["vec3"],f:!1},{type:"node_out",name:"nf",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"nf = clamp ( nd + ne , hR , hS ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",j:[{type:"node_in",name:"ng",qualifier:["float"],f:!1},{type:"node_in",name:"nh",qualifier:["vec3"],f:!1},{type:"node_in",name:"ni",
qualifier:["vec3"],f:!1},{type:"node_out",name:"nj",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( ng , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; nj = iL * nh + ( UNITY_VALUE_NODES - iL ) * ni ;".split(" ")}]},{type:"node",name:"UV_MERGED",j:[{type:"node_out",name:"nk",qualifier:["vec3"],f:!1},{type:"node_out",name:"nl",qualifier:["vec3"],f:!1},{type:"node_param",name:"ir",qualifier:["varying","vec2"]}],h:[{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_nk"],h:[{type:"textline",
b:"nk = ih ( ir ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_nl"],h:[{type:"textline",b:"nl = vec3 ( ir , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",j:[{type:"node_out",name:"nm",qualifier:["vec3"],f:!1},{type:"node_param",name:"is",qualifier:["varying","vec2"]}],h:[{type:"textline",b:"nm = vec3 ( is , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",j:[{type:"node_out",name:"nn",qualifier:["vec3"],f:!1}],h:[{type:"textline",
b:["nn","=","iW",";"]}]},{type:"node",name:"TEX_COORD_GE",j:[{type:"node_out",name:"no",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"no = abs ( hQ ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_OB",j:[{type:"node_out",name:"np",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"np [ 0 ] = np [ 1 ] = np [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",j:[{type:"node_out",name:"nq",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"nq [ 0 ] = iS [ 0 ] ; nq [ 1 ] = iS [ 1 ] ; nq [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"TEX_COORD_WI",j:[{type:"node_out",name:"nr",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"nr [ 0 ] = nr [ 1 ] = nr [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",j:[{type:"node_out",name:"ns",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"ns [ 0 ] = ns [ 1 ] = ns [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",j:[{type:"node_out",name:"nt",qualifier:["vec3"],f:!1},{type:"node_param",name:"it",qualifier:["varying","vec2"]}],
h:[{type:"textline",b:"nt = vec3 ( it , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",j:[{type:"node_out",name:"nu",qualifier:["float"],f:!1},{type:"node_out",name:"nv",qualifier:["float"],f:!1},{type:"node_out",name:"nw",qualifier:["float"],f:!1},{type:"node_out",name:"nx",qualifier:["vec3"],f:!1},{type:"node_out",name:"ny",qualifier:["float"],f:!1},{type:"node_out",name:"nz",qualifier:["vec3"],f:!1},{type:"node_out",name:"nA",qualifier:["vec3"],f:!1}],h:[{type:"textline",
b:"nu = ZERO_VALUE_NODES ; nv = ZERO_VALUE_NODES ; nw = ZERO_VALUE_NODES ; nx = vec3 ( ZERO_VALUE_NODES ) ; ny = ZERO_VALUE_NODES ; nz = nx ; nA = nx ;".split(" ")}]},{type:"node",name:"HAIR_INFO",j:[{type:"node_out",name:"nB",qualifier:["float"],f:!1},{type:"node_out",name:"nC",qualifier:["float"],f:!1},{type:"node_out",name:"nD",qualifier:["float"],f:!1},{type:"node_out",name:"nE",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"nB = ZERO_VALUE_NODES ; nC = ZERO_VALUE_NODES ; nD = ZERO_VALUE_NODES ; nE = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"OBJECT_INFO",j:[{type:"node_out",name:"nF",qualifier:["vec3"],f:!1},{type:"node_out",name:"nG",qualifier:["float"],f:!1},{type:"node_out",name:"nH",qualifier:["float"],f:!1},{type:"node_out",name:"nI",qualifier:["float"],f:!1}],h:[{type:"textline",b:"nG = ZERO_VALUE_NODES ; nH = ZERO_VALUE_NODES ; nI = ZERO_VALUE_NODES ; nF = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"WIREFRAME",j:[{type:"node_in",name:"nJ",qualifier:["float"],f:!1},{type:"node_out",name:"nK",
qualifier:["float"],f:!1}],h:[{type:"textline",b:["nK","=","nJ",";"]}]},{type:"node",name:"TANGENT",j:[{type:"node_out",name:"nL",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"nL = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",j:[{type:"node_in",name:"nM",qualifier:["float"],f:!1},{type:"node_in",name:"nN",qualifier:["vec3"],f:!1},{type:"node_out",name:"nO",qualifier:["float"],f:!1},{type:"node_out",name:"nP",qualifier:["float"],f:!1}],h:[{type:"textline",b:"nO = nP = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["nN",";","nM",";"]}]},{type:"node",name:"LIGHT_PATH",j:[{type:"node_out",name:"nQ",qualifier:["float"],f:!1},{type:"node_out",name:"nR",qualifier:["float"],f:!1},{type:"node_out",name:"nS",qualifier:["float"],f:!1},{type:"node_out",name:"nT",qualifier:["float"],f:!1},{type:"node_out",name:"nU",qualifier:["float"],f:!1},{type:"node_out",name:"nV",qualifier:["float"],f:!1},{type:"node_out",name:"nW",qualifier:["float"],f:!1},{type:"node_out",name:"nX",qualifier:["float"],f:!1},{type:"node_out",
name:"nY",qualifier:["float"],f:!1},{type:"node_out",name:"nZ",qualifier:["float"],f:!1}],h:[{type:"textline",b:"nQ = nR = nS = ZERO_VALUE_NODES ; nT = nU = nV = ZERO_VALUE_NODES ; nW = nW = nY = nZ = ZERO_VALUE_NODES ; nX = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",j:[{type:"node_out",name:"n_",qualifier:["vec3"],f:!1},{type:"node_out",name:"oa",qualifier:["vec3"],f:!1},{type:"node_out",name:"ob",qualifier:["float"],f:!1}],h:[{type:"textline",b:"n_ = oa = vec3 ( ZERO_VALUE_NODES ) ; ob = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"SCRIPT",j:[],h:[]},{type:"node",name:"CURVE_VEC",j:[{type:"node_in",name:"oc",qualifier:["float"],f:!1},{type:"node_in",name:"od",qualifier:["vec3"],f:!1},{type:"node_out",name:"oe",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:["oe","=","od",";"]},{type:"textline",b:["oc",";"]}]},{type:"node",name:"CURVE_RGB",j:[{type:"node_in",name:"of",qualifier:["float"],f:!1},{type:"node_in",name:"og",qualifier:["vec3"],f:!1},{type:"node_out",name:"oh",qualifier:["vec3"],f:!1}],h:[{type:"textline",
b:["oh","=","og",";"]},{type:"textline",b:["of",";"]}]},{type:"node",name:"VALTORGB",j:[{type:"node_in",name:"oi",qualifier:["float"],f:!1},{type:"node_out",name:"oj",qualifier:["vec3"],f:!1},{type:"node_out",name:"ok",qualifier:["float"],f:!1}],h:[{type:"textline",b:"oj [ 0 ] = oj [ 1 ] = oj [ 2 ] = clamp ( oi , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; ok = oj [ 0 ] ;".split(" ")}]},{type:"node",name:"MAPPING",j:[{type:"node_in",name:"ol",qualifier:["vec3"],f:!1},{type:"node_out",name:"om",qualifier:["vec3"],
f:!1}],h:[{type:"textline",b:["om","=","ol",";"]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",h:[{type:"textline",b:"om = ( MAPPING_TRS_MATRIX * vec4 ( om , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_SCALE",h:[{type:"textline",b:"om = om * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",h:[{type:"textline",b:"om = om + MAPPING_TRANSLATION ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",h:[{type:"textline",b:"om = max ( om , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",h:[{type:"textline",b:"om = min ( om , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["MAPPING_IS_NORMAL"],h:[{type:"textline",b:"om = normalize ( om ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ADD",j:[{type:"node_in",name:"on",qualifier:["float"],
f:!1},{type:"node_in",name:"oo",qualifier:["float"],f:!1},{type:"node_out",name:"op",qualifier:["float"],f:!1}],h:[{type:"textline",b:"op = on + oo ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"op = clamp ( op , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",j:[{type:"node_in",name:"oq",qualifier:["float"],f:!1},{type:"node_in",name:"or",qualifier:["float"],f:!1},{type:"node_out",name:"os",qualifier:["float"],
f:!1}],h:[{type:"textline",b:"os = oq - or ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"os = clamp ( os , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MULTIPLY",j:[{type:"node_in",name:"ot",qualifier:["float"],f:!1},{type:"node_in",name:"ou",qualifier:["float"],f:!1},{type:"node_out",name:"ov",qualifier:["float"],f:!1}],h:[{type:"textline",b:"ov = ot * ou ;".split(" ")},{type:"node_condition",a:[{type:"node_if",
d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"ov = clamp ( ov , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",j:[{type:"node_in",name:"ow",qualifier:["float"],f:!1},{type:"node_in",name:"ox",qualifier:["float"],f:!1},{type:"node_out",name:"oy",qualifier:["float"],f:!1}],h:[{type:"textline",b:"oy = ( ox != ZERO_VALUE_NODES ) ? ow / ox : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"oy = clamp ( oy , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_SINE",j:[{type:"node_in",name:"oz",qualifier:["float"],f:!1},{type:"node_in",name:"oA",qualifier:["float"],f:!1},{type:"node_out",name:"oB",qualifier:["float"],f:!1}],h:[{type:"textline",b:"oB = sin ( oz ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"oB = clamp ( oB , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["oA",";"]}]},{type:"node",name:"MATH_COSINE",j:[{type:"node_in",name:"oC",
qualifier:["float"],f:!1},{type:"node_in",name:"oD",qualifier:["float"],f:!1},{type:"node_out",name:"oE",qualifier:["float"],f:!1}],h:[{type:"textline",b:"oE = cos ( oC ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"oE = clamp ( oE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["oD",";"]}]},{type:"node",name:"MATH_TANGENT",j:[{type:"node_in",name:"oF",qualifier:["float"],f:!1},{type:"node_in",name:"oG",qualifier:["float"],
f:!1},{type:"node_out",name:"oH",qualifier:["float"],f:!1}],h:[{type:"textline",b:"oH = tan ( oF ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"oH = clamp ( oH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["oG",";"]}]},{type:"node",name:"MATH_ARCSINE",j:[{type:"node_in",name:"oI",qualifier:["float"],f:!1},{type:"node_in",name:"oJ",qualifier:["float"],f:!1},{type:"node_out",name:"oK",qualifier:["float"],f:!1}],
h:[{type:"textline",b:"oK = ( oI <= UNITY_VALUE_NODES && oI >= - UNITY_VALUE_NODES ) ? asin ( oI ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"oK = clamp ( oK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["oJ",";"]}]},{type:"node",name:"MATH_ARCCOSINE",j:[{type:"node_in",name:"oL",qualifier:["float"],f:!1},{type:"node_in",name:"oM",qualifier:["float"],f:!1},{type:"node_out",name:"oN",qualifier:["float"],
f:!1}],h:[{type:"textline",b:"oN = ( oL <= UNITY_VALUE_NODES && oL >= - UNITY_VALUE_NODES ) ? acos ( oL ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"oN = clamp ( oN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["oM",";"]}]},{type:"node",name:"MATH_ARCTANGENT",j:[{type:"node_in",name:"oO",qualifier:["float"],f:!1},{type:"node_in",name:"oP",qualifier:["float"],f:!1},{type:"node_out",name:"oQ",
qualifier:["float"],f:!1}],h:[{type:"textline",b:"oQ = atan ( oO ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"oQ = clamp ( oQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["oP",";"]}]},{type:"node",name:"MATH_POWER",j:[{type:"node_in",name:"oR",qualifier:["float"],f:!1},{type:"node_in",name:"oS",qualifier:["float"],f:!1},{type:"node_out",name:"oT",qualifier:["float"],f:!1}],h:[{type:"textline",b:"if ( oR < ZERO_VALUE_NODES || oR == ZERO_VALUE_NODES && oS == ZERO_VALUE_NODES ) oT = ZERO_VALUE_NODES ; else oT = pow ( oR , oS ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"oT = clamp ( oT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",j:[{type:"node_in",name:"oU",qualifier:["float"],f:!1},{type:"node_in",name:"oV",qualifier:["float"],f:!1},{type:"node_out",name:"oW",qualifier:["float"],f:!1}],h:[{type:"textline",b:"oW = ( oU > ZERO_VALUE_NODES && oV > ZERO_VALUE_NODES ) ? log2 ( oU ) / log2 ( oV ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"oW = clamp ( oW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",j:[{type:"node_in",name:"oX",qualifier:["float"],f:!1},{type:"node_in",name:"oY",qualifier:["float"],f:!1},{type:"node_out",name:"oZ",qualifier:["float"],f:!1}],h:[{type:"textline",b:"oZ = min ( oX , oY ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"oZ = clamp ( oZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MAXIMUM",j:[{type:"node_in",name:"o_",qualifier:["float"],f:!1},{type:"node_in",name:"pa",qualifier:["float"],f:!1},{type:"node_out",name:"pb",qualifier:["float"],f:!1}],h:[{type:"textline",b:"pb = max ( o_ , pa ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"pb = clamp ( pb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",j:[{type:"node_in",name:"pc",qualifier:["float"],f:!1},
{type:"node_in",name:"pd",qualifier:["float"],f:!1},{type:"node_out",name:"pe",qualifier:["float"],f:!1}],h:[{type:"textline",b:"pe = floor ( pc + 0.5 ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"pe = clamp ( pe , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["pd",";"]}]},{type:"node",name:"MATH_LESS_THAN",j:[{type:"node_in",name:"pf",qualifier:["float"],f:!1},{type:"node_in",name:"pg",qualifier:["float"],f:!1},
{type:"node_out",name:"ph",qualifier:["float"],f:!1}],h:[{type:"textline",b:"ph = ( pf < pg ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"ph = clamp ( ph , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",j:[{type:"node_in",name:"pi",qualifier:["float"],f:!1},{type:"node_in",name:"pj",qualifier:["float"],f:!1},{type:"node_out",name:"pk",qualifier:["float"],
f:!1}],h:[{type:"textline",b:"pk = ( pi > pj ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"pk = clamp ( pk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MODULO",j:[{type:"node_in",name:"pl",qualifier:["float"],f:!1},{type:"node_in",name:"pm",qualifier:["float"],f:!1},{type:"node_out",name:"pn",qualifier:["float"],f:!1}],h:[{type:"textline",b:"pn = abs ( pm ) > 0.000001 ? mod ( pl , pm ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"pn = clamp ( pn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",j:[{type:"node_in",name:"po",qualifier:["float"],f:!1},{type:"node_in",name:"pp",qualifier:["float"],f:!1},{type:"node_out",name:"pq",qualifier:["float"],f:!1}],h:[{type:"textline",b:"pq = abs ( po ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MATH_USE_CLAMP"],h:[{type:"textline",b:"pq = clamp ( pq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",b:["pp",";"]}]},{type:"node",name:"MIX_RGB_MIX",j:[{type:"node_in",name:"pr",qualifier:["float"],f:!1},{type:"node_in",name:"ps",qualifier:["vec3"],f:!1},{type:"node_in",name:"pt",qualifier:["vec3"],f:!1},{type:"node_out",name:"pu",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( pr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pu = mix ( ps , pt , iL ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"pu = clamp ( pu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_ADD",j:[{type:"node_in",name:"pv",qualifier:["float"],f:!1},{type:"node_in",name:"pw",qualifier:["vec3"],f:!1},{type:"node_in",name:"px",qualifier:["vec3"],f:!1},{type:"node_out",name:"py",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( pv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; py = mix ( pw , pw + px , iL ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"py = clamp ( py , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_MULTIPLY",j:[{type:"node_in",name:"pz",qualifier:["float"],f:!1},{type:"node_in",name:"pA",qualifier:["vec3"],f:!1},{type:"node_in",name:"pB",qualifier:["vec3"],f:!1},{type:"node_out",name:"pC",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( pz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pC = mix ( pA , pA * pB , iL ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"pC = clamp ( pC , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SUBTRACT",j:[{type:"node_in",name:"pD",qualifier:["float"],f:!1},{type:"node_in",name:"pE",qualifier:["vec3"],f:!1},{type:"node_in",name:"pF",qualifier:["vec3"],f:!1},{type:"node_out",name:"pG",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( pD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pG = mix ( pE , pE - pF , iL ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"pG = clamp ( pG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",j:[{type:"node_in",name:"pH",qualifier:["float"],f:!1},{type:"node_in",name:"pI",qualifier:["vec3"],f:!1},{type:"node_in",name:"pJ",qualifier:["vec3"],f:!1},{type:"node_out",name:"pK",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( pH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iK = UNITY_VALUE_NODES - iL ; pK = hS - ( vec3 ( iK ) + iL * ( hS - pJ ) ) * ( hS - pI ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",
b:"pK = clamp ( pK , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",j:[{type:"node_in",name:"pL",qualifier:["float"],f:!1},{type:"node_in",name:"pM",qualifier:["vec3"],f:!1},{type:"node_in",name:"pN",qualifier:["vec3"],f:!1},{type:"node_out",name:"pO",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( pL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iK = UNITY_VALUE_NODES - iL ; pN += step ( pN , hR ) ; pO = iK * pM + iL * pM / pN ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"pO = clamp ( pO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",j:[{type:"node_in",name:"pP",qualifier:["float"],f:!1},{type:"node_in",name:"pQ",qualifier:["vec3"],f:!1},{type:"node_in",name:"pR",qualifier:["vec3"],f:!1},{type:"node_out",name:"pS",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( pP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pS = mix ( pQ , abs ( pQ - pR ) , iL ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"pS = clamp ( pS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",j:[{type:"node_in",name:"pT",qualifier:["float"],f:!1},{type:"node_in",name:"pU",qualifier:["vec3"],f:!1},{type:"node_in",name:"pV",qualifier:["vec3"],f:!1},{type:"node_out",name:"pW",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( pT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; pW = min ( pU . rgb , pV . rgb * iL ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"pW = clamp ( pW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",j:[{type:"node_in",name:"pX",qualifier:["float"],f:!1},{type:"node_in",name:"pY",qualifier:["vec3"],f:!1},{type:"node_in",name:"pZ",qualifier:["vec3"],f:!1},{type:"node_out",name:"p_",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( pX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; p_ = max ( pY . rgb , pZ . rgb * iL ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"p_ = clamp ( p_ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",j:[{type:"node_in",name:"qa",qualifier:["float"],f:!1},{type:"node_in",name:"qb",qualifier:["vec3"],f:!1},{type:"node_in",name:"qc",qualifier:["vec3"],f:!1},{type:"node_out",name:"qd",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( qa , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iZ = vec3 ( UNITY_VALUE_NODES - iL ) ; qd = mix ( qb * ( iZ + 2.0 * iL * qc ) , hS - ( iZ + 2.0 * iL * ( hS - qc ) ) * ( hS - qb ) , step ( 0.5 , qb ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"qd = clamp ( qd , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",j:[{type:"node_in",name:"qe",qualifier:["float"],f:!1},{type:"node_in",name:"qf",qualifier:["vec3"],f:!1},{type:"node_in",name:"qg",qualifier:["vec3"],f:!1},{type:"node_out",name:"qh",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( qe , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iZ = hS - iL * qg ; iY = clamp ( qf / iZ , 0.0 , 1.0 ) ; qh = mix ( mix ( iY , hS , step ( iZ , hR ) ) , qf , step ( qf , hR ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"qh = clamp ( qh , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",j:[{type:"node_in",name:"qi",qualifier:["float"],f:!1},{type:"node_in",name:"qj",qualifier:["vec3"],f:!1},{type:"node_in",name:"qk",qualifier:["vec3"],f:!1},{type:"node_out",name:"ql",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( qi , 0.0 , 1.0 ) ; iZ = vec3 ( 1.0 - iL ) ; iZ = iZ + iL * qk ; iY = clamp ( hS - ( hS - qj ) / iZ , 0.0 , 1.0 ) ; ql = mix ( iY , hR , step ( iZ , hR ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"ql = clamp ( ql , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",j:[{type:"node_in",name:"qm",qualifier:["float"],f:!1},{type:"node_in",name:"qn",qualifier:["vec3"],f:!1},{type:"node_in",name:"qo",qualifier:["vec3"],f:!1},{type:"node_out",name:"qp",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( qm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; qp = qn ; iY = ia ( qo ) ; if ( iY . y != ZERO_VALUE_NODES ) { iZ = ia ( qp ) ; iZ . x = iY . x ; i_ = ie ( iZ ) ; qp = mix ( qp , i_ , iL ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"qp = clamp ( qp , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",j:[{type:"node_in",name:"qq",qualifier:["float"],f:!1},{type:"node_in",name:"qr",qualifier:["vec3"],f:!1},{type:"node_in",name:"qs",qualifier:["vec3"],f:!1},{type:"node_out",name:"qt",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( qq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iK = UNITY_VALUE_NODES - iL ; qt = qr ; i_ = ia ( qt ) ; if ( i_ . y != ZERO_VALUE_NODES ) { iY = ia ( qs ) ; i_ . y = iK * i_ . y + iL * iY . y ; qt = ie ( i_ ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"qt = clamp ( qt , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",j:[{type:"node_in",name:"qu",qualifier:["float"],f:!1},{type:"node_in",name:"qv",qualifier:["vec3"],f:!1},{type:"node_in",name:"qw",qualifier:["vec3"],f:!1},{type:"node_out",name:"qx",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( qu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iK = UNITY_VALUE_NODES - iL ; iY = ia ( qv ) ; ja = ia ( qw ) ; iY . z = iK * iY . z + iL * ja . z ; qx = ie ( iY ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"qx = clamp ( qx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",j:[{type:"node_in",name:"qy",qualifier:["float"],f:!1},{type:"node_in",name:"qz",qualifier:["vec3"],f:!1},{type:"node_in",name:"qA",qualifier:["vec3"],f:!1},{type:"node_out",name:"qB",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( qy , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; qB = qz ; jb = ia ( qA ) ; if ( jb . y != ZERO_VALUE_NODES ) { ja = ia ( qB ) ; ja . x = jb . x ; ja . y = jb . y ; jc = ie ( ja ) ; qB = mix ( qB , jc , iL ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"qB = clamp ( qB , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",j:[{type:"node_in",name:"qC",qualifier:["float"],f:!1},{type:"node_in",name:"qD",qualifier:["vec3"],f:!1},{type:"node_in",name:"qE",qualifier:["vec3"],f:!1},{type:"node_out",name:"qF",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( qC , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iK = UNITY_VALUE_NODES - iL ; jc = qE + qD - qE * qD ; qF = qD * ( vec3 ( iK ) + vec3 ( iL ) * ( ( hS - qD ) * qE + jc ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"qF = clamp ( qF , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",j:[{type:"node_in",name:"qG",qualifier:["float"],f:!1},{type:"node_in",name:"qH",qualifier:["vec3"],f:!1},{type:"node_in",name:"qI",qualifier:["vec3"],f:!1},{type:"node_out",name:"qJ",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"iL = clamp ( qG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; qJ = qH + iL * ( 2.0 * qI - hS ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["MIX_RGB_USE_CLAMP"],h:[{type:"textline",b:"qJ = clamp ( qJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",j:[{type:"node_in",name:"qK",qualifier:["vec3"],f:!1},{type:"node_in",name:"qL",qualifier:["float"],f:!1}],h:[{type:"textline",b:"iB = qK ; iF = qL ;".split(" ")}]},{type:"node",name:"MATERIAL",j:[{type:"node_in",name:"qM",qualifier:["vec3"],f:!1},{type:"node_in",name:"qN",qualifier:["vec3"],f:!1},{type:"node_in",
name:"qO",qualifier:["float"],f:!1},{type:"node_in",name:"qP",qualifier:["vec3"],f:!0},{type:"node_out",name:"qQ",qualifier:["vec3"],f:!0},{type:"node_out",name:"qR",qualifier:["float"],f:!0},{type:"node_out",name:"qS",qualifier:["vec3"],f:!0},{type:"node_param",name:"iu",qualifier:["float"]},{type:"node_param",name:"iv",qualifier:["float"]},{type:"node_param",name:"iw",qualifier:["const","vec2"]},{type:"node_param",name:"ix",qualifier:["const","vec3"]}],h:[{type:"textline",b:"jc = clamp ( qM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},
{type:"textline",b:"jb = ix [ 0 ] * clamp ( qN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_MATERIAL_NORMAL"],h:[{type:"textline",b:"jd = normalize ( qP ) ;".split(" ")}]},{type:"node_else",h:[{type:"textline",b:["jd","=","iW",";"]}]}]},{type:"node_condition",a:[{type:"node_if",d:["SHADELESS_MAT",{type:"logic_negative_expr",e:1},"NODES_GLOW",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],h:[{type:"textline",b:"je = iI * jc ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],h:[{type:"textline",b:["jc","*=","qO",";"]}]}]},{type:"textline",b:"jf = iJ * u_environment_energy * hB ( jd ) ; iL = he ( jc ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],h:[{type:"textline",b:"iG = vec2 ( iw [ 0 ] , iw [ 1 ] ) ;".split(" ")},{type:"textline",b:"iH = vec2 ( ix [ 1 ] , ix [ 2 ] ) ; jk = cU ( je , jf , jc , jb , iV , jd , iA , iH , iG , iL , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , ZERO_VALUE_NODES , vec4 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},
{type:"node_else",h:[{type:"textline",b:"jk = cZ ( je , jf , jc ) ;".split(" ")}]}]},{type:"textline",b:["iE","=","iL",";"]}]},{type:"node_else",h:[{type:"textline",b:"jk . a = vec4 ( jc , ZERO_VALUE_NODES ) ; jk . b = hR ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_qQ"],h:[{type:"node_condition",a:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],h:[{type:"textline",b:"qQ = jk . a . rgb ;".split(" ")}]},{type:"node_else",h:[{type:"textline",b:["qQ","=","hR",";"]}]}]},{type:"node_condition",
a:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],h:[{type:"textline",b:"qQ += jk . b ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_qR"],h:[{type:"textline",b:"qR = clamp ( iu , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],h:[{type:"textline",b:"iK = max ( max ( jk . b . r , jk . b . g ) , jk . b . b ) * iv ; qR = iu * ( UNITY_VALUE_NODES - iK ) + iK ;".split(" ")}]}]}]}]},{type:"node_condition",
a:[{type:"node_if",d:["USE_OUT_qS"],h:[{type:"textline",b:["qS","=","jd",";"]}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],h:[{type:"textline",b:"iC = jk . b ;".split(" ")}]},{type:"node_else",h:[{type:"textline",b:["iC","=","hR",";"]}]}]},{type:"textline",b:["iD","=","jd",";"]}]},{type:"node",name:"MATERIAL_EXT",j:[{type:"node_in",name:"qT",qualifier:["vec3"],f:!1},{type:"node_in",name:"qU",qualifier:["vec3"],f:!1},{type:"node_in",name:"qV",qualifier:["float"],f:!1},
{type:"node_in",name:"qW",qualifier:["vec3"],f:!0},{type:"node_in",name:"qX",qualifier:["float"],f:!1},{type:"node_in",name:"qY",qualifier:["float"],f:!1},{type:"node_in",name:"qZ",qualifier:["vec4"],f:!1},{type:"node_in",name:"q_",qualifier:["float"],f:!1},{type:"node_in",name:"ra",qualifier:["float"],f:!1},{type:"node_in",name:"rb",qualifier:["float"],f:!1},{type:"node_out",name:"rc",qualifier:["vec3"],f:!0},{type:"node_out",name:"rd",qualifier:["float"],f:!0},{type:"node_out",name:"re",qualifier:["vec3"],
f:!0},{type:"node_out",name:"rf",qualifier:["vec3"],f:!0},{type:"node_out",name:"rg",qualifier:["vec3"],f:!0},{type:"node_param",name:"iy",qualifier:["const","vec2"]},{type:"node_param",name:"iz",qualifier:["const","vec3"]}],h:[{type:"textline",b:"jb = clamp ( qT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",b:"jg = iz [ 0 ] * clamp ( qU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_MATERIAL_NORMAL"],h:[{type:"textline",
b:"jh = normalize ( qW ) ;".split(" ")}]},{type:"node_else",h:[{type:"textline",b:["jh","=","iW",";"]}]}]},{type:"node_condition",a:[{type:"node_if",d:["SHADELESS_MAT",{type:"logic_negative_expr",e:1},"NODES_GLOW",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],h:[{type:"textline",b:"ji = qX * jb ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],h:[{type:"textline",b:["jb","*=","qV",";"]}]}]},{type:"textline",b:"iK = he ( jb ) ;".split(" ")},{type:"textline",
b:"jj = iJ * u_environment_energy * hB ( jh ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["NUM_LIGHTS",0,{type:"g_expr",e:2}],h:[{type:"textline",b:"iG = vec2 ( iy [ 0 ] , iy [ 1 ] ) ; iH = vec2 ( iz [ 1 ] , iz [ 2 ] ) ; jk = cU ( ji , jj , jb , jg , iV , jh , iA , iH , iG , iK , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , qY , qZ ) ;".split(" ")}]},{type:"node_else",h:[{type:"textline",b:"jk = cZ ( ji , jj , jb ) ;".split(" ")}]}]},{type:"textline",
b:["iE","=","iK",";"]}]},{type:"node_else",h:[{type:"textline",b:"jk . a = vec4 ( jb , ZERO_VALUE_NODES ) ; jk . b = hR ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rc"],h:[{type:"node_condition",a:[{type:"node_if",d:["USE_MATERIAL_DIFFUSE"],h:[{type:"textline",b:"rc = jk . a . rgb ;".split(" ")}]},{type:"node_else",h:[{type:"textline",b:["rc","=","hR",";"]}]}]},{type:"node_condition",a:[{type:"node_if",d:["REFLECTION_TYPE","REFL_NONE",{type:"non_equal_expr",e:2}],h:[{type:"textline",
b:"hy ( rc , iA , jh , q_ ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],h:[{type:"textline",b:"rc += jk . b ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rd"],h:[{type:"textline",b:"rd = clamp ( rb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],h:[{type:"textline",b:"iN = max ( max ( jk . b . r , jk . b . g ) , jk . b . b ) * ra ; rd = clamp ( rb * ( UNITY_VALUE_NODES - iN ) + iN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]},
{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_re"],h:[{type:"textline",b:["re","=","jh",";"]}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rf"],h:[{type:"textline",b:"rf = jk . a . rgb ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rg"],h:[{type:"textline",b:"rg = jk . b ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_MATERIAL_SPECULAR"],h:[{type:"textline",b:"iC = jk . b ;".split(" ")}]},{type:"node_else",h:[{type:"textline",b:["iC",
"=","hR",";"]}]}]},{type:"textline",b:["iD","=","jh",";"]}]},{type:"node",name:"RGB",j:[{type:"node_out",name:"rh",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"rh = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",j:[{type:"node_in",name:"ri",qualifier:["vec3"],f:!1},{type:"node_out",name:"rj",qualifier:["float"],f:!1}],h:[{type:"textline",b:"rj = dot ( ri , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{type:"node",name:"SEPRGB",j:[{type:"node_in",name:"rk",qualifier:["vec3"],
f:!1},{type:"node_out",name:"rl",qualifier:["float"],f:!0},{type:"node_out",name:"rm",qualifier:["float"],f:!0},{type:"node_out",name:"rn",qualifier:["float"],f:!0}],h:[{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rl"],h:[{type:"textline",b:"rl = rk . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rm"],h:[{type:"textline",b:"rm = rk . g ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rn"],h:[{type:"textline",b:"rn = rk . b ;".split(" ")}]}]}]},
{type:"node",name:"SEPHSV",j:[{type:"node_in",name:"ro",qualifier:["vec3"],f:!1},{type:"node_out",name:"rp",qualifier:["float"],f:!0},{type:"node_out",name:"rq",qualifier:["float"],f:!0},{type:"node_out",name:"rr",qualifier:["float"],f:!0}],h:[{type:"textline",b:"jg = ia ( ro ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rp"],h:[{type:"textline",b:"rp = jg . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rq"],h:[{type:"textline",b:"rq = jg . g ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rr"],h:[{type:"textline",b:"rr = jg . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",j:[{type:"node_in",name:"rs",qualifier:["float"],f:!1},{type:"node_in",name:"rt",qualifier:["float"],f:!1},{type:"node_in",name:"ru",qualifier:["float"],f:!1},{type:"node_out",name:"rv",qualifier:["float"],f:!1}],h:[{type:"textline",b:"rv = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( ( rs - ru ) * rt ) ) ) ;".split(" ")}]},{type:"node",
name:"GAMMA",j:[{type:"node_in",name:"rw",qualifier:["vec3"],f:!1},{type:"node_in",name:"rx",qualifier:["float"],f:!1},{type:"node_out",name:"ry",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"ry = max ( hR , rw ) ; ry = pow ( ry , vec3 ( rx ) ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",j:[{type:"node_in",name:"rz",qualifier:["vec3"],f:!1},{type:"node_out",name:"rA",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"rA = max ( hR , rz ) ; rA = pow ( rA , vec3 ( 2.2 ) ) ;".split(" ")}]},
{type:"node",name:"B4W_LINEAR_TO_SRGB",j:[{type:"node_in",name:"rB",qualifier:["vec3"],f:!1},{type:"node_out",name:"rC",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"rC = max ( hR , rB ) ; rC = pow ( rC , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",j:[{type:"node_out",name:"rD",qualifier:["vec3"],f:!1},{type:"node_out",name:"rE",qualifier:["vec3"],f:!1},{type:"node_out",name:"rF",qualifier:["float"],f:!1}],h:[{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rF"],
h:[{type:"textline",b:"rD [ 2 ] = rD [ 1 ] = rD [ 0 ] = 0.0 ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rF"],h:[{type:"textline",b:"rE [ 2 ] = rE [ 1 ] = rE [ 0 ] = 0.0 ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rF"],h:[{type:"textline",b:["rF","=","0.0",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",j:[{type:"node_in",name:"rG",qualifier:["vec3"],f:!1},{type:"node_out",name:"rH",qualifier:["vec3"],f:!0},{type:"node_out",name:"rI",qualifier:["float"],
f:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",qualifier:["uniform","samplerCube"]}],h:[{type:"textline",b:"iT = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , rG ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rH"],h:[{type:"textline",b:"rH = iT . xyz ; ek ( rH ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rI"],h:[{type:"textline",b:"rI = iT . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",j:[{type:"node_in",
name:"rJ",qualifier:["vec3"],f:!0},{type:"node_in",name:"rK",qualifier:["vec3"],f:!0},{type:"node_in",name:"rL",qualifier:["vec3"],f:!0},{type:"node_in",name:"rM",qualifier:["vec3"],f:!0},{type:"node_out",name:"rN",qualifier:["vec3"],f:!0},{type:"node_out",name:"rO",qualifier:["float"],f:!0},{type:"node_out",name:"rP",qualifier:["vec3"],f:!0},{type:"node_out",name:"rQ",qualifier:["float"],f:!0},{type:"node_out",name:"rR",qualifier:["vec3"],f:!0},{type:"node_out",name:"rS",qualifier:["float"],f:!0},
{type:"node_out",name:"rT",qualifier:["vec3"],f:!0},{type:"node_out",name:"rU",qualifier:["float"],f:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",qualifier:["uniform","sampler2D"]}],h:[{type:"textline",b:"iT = texture2D ( node_TEXTURE_COLOR_var_texture , ij ( rJ ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rN"],h:[{type:"textline",b:"rN = iT . xyz ; ek ( rN ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rO"],h:[{type:"textline",
b:"rO = iT . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_uv2"],h:[{type:"textline",b:"iT = texture2D ( node_TEXTURE_COLOR_var_texture , ij ( rK ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rP"],h:[{type:"textline",b:"rP = iT . xyz ; ek ( rP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rQ"],h:[{type:"textline",b:"rQ = iT . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_uv3"],h:[{type:"textline",
b:"iT = texture2D ( node_TEXTURE_COLOR_var_texture , ij ( rL ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rR"],h:[{type:"textline",b:"rR = iT . xyz ; ek ( rR ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rS"],h:[{type:"textline",b:"rS = iT . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_uv4"],h:[{type:"textline",b:"iT = texture2D ( node_TEXTURE_COLOR_var_texture , ij ( rM ) ) ;".split(" ")},{type:"node_condition",
a:[{type:"node_if",d:["USE_OUT_rT"],h:[{type:"textline",b:"rT = iT . xyz ; ek ( rT ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rU"],h:[{type:"textline",b:"rU = iT . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"TEXTURE_NORMAL",j:[{type:"node_in",name:"rV",qualifier:["vec3"],f:!0},{type:"node_in",name:"rW",qualifier:["vec3"],f:!0},{type:"node_in",name:"rX",qualifier:["vec3"],f:!0},{type:"node_in",name:"rY",qualifier:["vec3"],f:!0},{type:"node_out",name:"rZ",qualifier:["vec3"],
f:!0},{type:"node_out",name:"r_",qualifier:["float"],f:!0},{type:"node_out",name:"sa",qualifier:["vec3"],f:!0},{type:"node_out",name:"sb",qualifier:["float"],f:!0},{type:"node_out",name:"sc",qualifier:["vec3"],f:!0},{type:"node_out",name:"sd",qualifier:["float"],f:!0},{type:"node_out",name:"se",qualifier:["vec3"],f:!0},{type:"node_out",name:"sf",qualifier:["float"],f:!0},{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"]}],h:[{type:"textline",b:"iT = texture2D ( node_TEXTURE_NORMAL_var_texture , ij ( rV ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_rZ"],h:[{type:"textline",b:"rZ = normalize ( iU * ( iT . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_r_"],h:[{type:"textline",b:"r_ = iT . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_uv2"],h:[{type:"textline",b:"iT = texture2D ( node_TEXTURE_NORMAL_var_texture , ij ( rW ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sa"],h:[{type:"textline",b:"sa = normalize ( iU * ( iT . xyz - 0.5 ) ) ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sb"],h:[{type:"textline",b:"sb = iT . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_uv3"],h:[{type:"textline",b:"iT = texture2D ( node_TEXTURE_NORMAL_var_texture , ij ( rX ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sc"],h:[{type:"textline",b:"sc = normalize ( iU * ( iT . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sd"],h:[{type:"textline",b:"sd = iT . w ;".split(" ")}]}]}]}]},
{type:"node_condition",a:[{type:"node_if",d:["USE_uv4"],h:[{type:"textline",b:"iT = texture2D ( node_TEXTURE_NORMAL_var_texture , ij ( rY ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_se"],h:[{type:"textline",b:"se = normalize ( iU * ( iT . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sf"],h:[{type:"textline",b:"sf = iT . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"VALUE",j:[{type:"node_out",name:"sg",qualifier:["float"],f:!1}],
h:[{type:"textline",b:"sg = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",j:[{type:"node_in",name:"sh",qualifier:["vec3"],f:!1},{type:"node_in",name:"si",qualifier:["vec3"],f:!1},{type:"node_out",name:"sj",qualifier:["vec3"],f:!1},{type:"node_out",name:"sk",qualifier:["float"],f:!0}],h:[{type:"textline",b:"sj = sh + si ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sk"],h:[{type:"textline",b:"sk = ( abs ( sj [ 0 ] ) + abs ( sj [ 1 ] ) + abs ( sj [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_SUBTRACT",j:[{type:"node_in",name:"sl",qualifier:["vec3"],f:!1},{type:"node_in",name:"sm",qualifier:["vec3"],f:!1},{type:"node_out",name:"sn",qualifier:["vec3"],f:!1},{type:"node_out",name:"so",qualifier:["float"],f:!0}],h:[{type:"textline",b:"sn = sl - sm ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_so"],h:[{type:"textline",b:"so = ( abs ( sn [ 0 ] ) + abs ( sn [ 1 ] ) + abs ( sn [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_AVERAGE",
j:[{type:"node_in",name:"sp",qualifier:["vec3"],f:!1},{type:"node_in",name:"sq",qualifier:["vec3"],f:!1},{type:"node_out",name:"sr",qualifier:["vec3"],f:!1},{type:"node_out",name:"ss",qualifier:["float"],f:!0}],h:[{type:"textline",b:"sr = sp + sq ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_ss"],h:[{type:"textline",b:"ss = length ( sr ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sr"],h:[{type:"textline",b:"sr = normalize ( sr ) ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_DOT_PRODUCT",j:[{type:"node_in",name:"st",qualifier:["vec3"],f:!1},{type:"node_in",name:"su",qualifier:["vec3"],f:!1},{type:"node_out",name:"sv",qualifier:["vec3"],f:!1},{type:"node_out",name:"sw",qualifier:["float"],f:!0}],h:[{type:"textline",b:["sv","=","hR",";"]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sw"],h:[{type:"textline",b:"sw = dot ( st , su ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",j:[{type:"node_in",name:"sx",qualifier:["vec3"],
f:!1},{type:"node_in",name:"sy",qualifier:["vec3"],f:!1},{type:"node_out",name:"sz",qualifier:["vec3"],f:!1},{type:"node_out",name:"sA",qualifier:["float"],f:!0}],h:[{type:"textline",b:"sz = cross ( sx , sy ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sA"],h:[{type:"textline",b:"sA = length ( sz ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",j:[{type:"node_in",name:"sB",qualifier:["vec3"],f:!1},{type:"node_in",name:"sC",qualifier:["vec3"],f:!1},{type:"node_out",
name:"sD",qualifier:["vec3"],f:!1},{type:"node_out",name:"sE",qualifier:["float"],f:!0}],h:[{type:"textline",b:"sD = normalize ( sB ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sE"],h:[{type:"textline",b:"sE = length ( sB ) ;".split(" ")}]}]},{type:"textline",b:["sC",";"]}]},{type:"node",name:"B4W_REFLECT",j:[{type:"node_in",name:"sF",qualifier:["vec3"],f:!1},{type:"node_in",name:"sG",qualifier:["vec3"],f:!1},{type:"node_out",name:"sH",qualifier:["vec3"],f:!1}],h:[{type:"textline",
b:"sH = reflect ( - sF , sG ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",j:[{type:"node_in",name:"sI",qualifier:["vec3"],f:!1},{type:"node_in",name:"sJ",qualifier:["float"],f:!1},{type:"node_in",name:"sK",qualifier:["const","float"],f:!1},{type:"node_in",name:"sL",qualifier:["const","float"],f:!1},{type:"node_out",name:"sM",qualifier:["vec3"],f:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"]}],h:[{type:"textline",b:"iN = length ( iS ) ; if ( iN < sL ) { iG = ij ( sI ) ; iO = clamp ( 0.5 * ( sL - iN ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iO = sJ * iO ;".split(" ")},
{type:"textline",b:"jg = normalize ( iA * iU ) ;".split(" ")},{type:"textline",b:"iP = UNITY_VALUE_NODES / sK ;".split(" ")},{type:"textline",b:"iH = jg . xy * iO / ( sK * jg . z ) ; iQ = UNITY_VALUE_NODES ; iR = texture2D ( node_B4W_PARALLAX_var_texture , iG ) . a ;".split(" ")},{type:"textline",b:"for ( float sN = 1.0 ; sN <= sK ; sN ++ ) { if ( iR < iQ ) { iQ -= iP ; iG -= iH ; iR = texture2D ( node_B4W_PARALLAX_var_texture , iG ) . a ; } }".split(" ")},{type:"textline",b:"iH = iG + iH ; iP = texture2D ( node_B4W_PARALLAX_var_texture , iH ) . a - ( iQ + iP ) ; iQ = iR - iQ ; iP = iQ / ( iQ - iP ) ;".split(" ")},
{type:"textline",b:"iG = iP * iH + ( UNITY_VALUE_NODES - iP ) * iG ; sM = ih ( iG ) ; } else sM = sI ;".split(" ")}]},{type:"node",name:"B4W_CLAMP",j:[{type:"node_in",name:"sO",qualifier:["vec3"],f:!1},{type:"node_out",name:"sP",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"sP = clamp ( sO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"B4W_REFRACTION",j:[{type:"node_in",name:"sQ",qualifier:["vec3"],f:!1},{type:"node_in",name:"sR",qualifier:["float"],f:!1},{type:"node_out",
name:"sS",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"sS = hW ( sQ , sR ) ;".split(" ")}]},{type:"node",name:"B4W_TRANSLUCENCY",j:[{type:"node_in",name:"sT",qualifier:["float"],f:!1},{type:"node_in",name:"sU",qualifier:["float"],f:!1},{type:"node_in",name:"sV",qualifier:["float"],f:!1},{type:"node_in",name:"sW",qualifier:["float"],f:!1},{type:"node_in",name:"sX",qualifier:["float"],f:!1},{type:"node_out",name:"sY",qualifier:["float"],f:!0},{type:"node_out",name:"sZ",qualifier:["vec4"],f:!0}],
h:[{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sY"],h:[{type:"textline",b:["sY","=","sT",";"]}]}]},{type:"node_condition",a:[{type:"node_if",d:["USE_OUT_sZ"],h:[{type:"textline",b:"sZ = vec4 ( sU , sV , sW , sX ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",j:[{type:"node_out",name:"s_",qualifier:["float"],f:!1}],h:[{type:"textline",b:["s_","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",j:[{type:"node_in",name:"ta",qualifier:["float"],f:!1},{type:"node_in",name:"tb",qualifier:["float"],
f:!1},{type:"node_in",name:"tc",qualifier:["float"],f:!1},{type:"node_out",name:"td",qualifier:["float"],f:!1}],h:[{type:"textline",b:"td = smoothstep ( tb , tc , ta ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",j:[{type:"node_in",name:"te",qualifier:["vec3"],f:!1},{type:"node_in",name:"tf",qualifier:["float"],f:!1}],h:[{type:"textline",b:"iB = te ; iF = tf ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",j:[{type:"node_in",name:"tg",qualifier:["vec3"],f:!1},{type:"node_out",name:"th",
qualifier:["float"],f:!1}],h:[{type:"textline",b:"th = ( tg . r + tg . g + tg . b ) / 3.0 ;".split(" ")}]},{type:"node",name:"B4W_SCALTOVEC",j:[{type:"node_in",name:"ti",qualifier:["float"],f:!1},{type:"node_out",name:"tj",qualifier:["vec3"],f:!1}],h:[{type:"textline",b:"tj [ 0 ] = ti ; tj [ 1 ] = ti ; tj [ 2 ] = ti ;".split(" ")}]},{type:"nodes_global"},{type:"textline",b:"void tk ( in vec3 iA , out vec3 iB , out vec3 iC , out vec3 iD , out float iE , out float iF ) { vec2 iG , iH ; float iI , iJ , iK , iL , iM , iN , iO , iP , iQ , iR ; vec4 iS , iT ; mat3 iU ; vec3 iV , iW , iX , iY , iZ , i_ , ja , jb , jc , jd , je , jf , jg , jh , ji , jj ; iB = hR ; iC = hR ; iD = hR ; iE = ZERO_VALUE_NODES ; iF = ZERO_VALUE_NODES ;".split(" ")},
{type:"condition",a:[{type:"if",d:["USE_NODE_MATERIAL","USE_NODE_MATERIAL_EXT","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",e:6}],group:{type:"group",a:[{type:"textline",b:["iV","=","fc",";"]},{type:"condition",a:[{type:"if",d:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) iV = iV ; else iV = - iV ;".split(" ")}]}}]},{type:"textline",b:"iW = normalize ( iV ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
d:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"iX = cross ( iV , fd . xyz ) * fd . w ; iU = mat3 ( fd . xyz , iX , iV ) ; iU = iU ;".split(" ")}]}}]},{type:"textline",b:"iV = fa ; iS = fb ; iI = u_emit ; iJ = u_ambient ; am jk ;".split(" ")},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/to_world.glslv"]={type:"group",a:[{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"define",name:"MAX_BILLBOARD_ANGLE",b:["(","M_PI","/","4.0",")"]},{type:"textline",b:"const vec3 tl = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",e:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"mat4 tr ( vec3 tm , mat4 tn ) { vec3 to , tp , tq ; to = vec3 ( tn [ 0 ] [ 0 ] , tn [ 1 ] [ 0 ] , tn [ 2 ] [ 0 ] ) ; tp = vec3 ( tn [ 0 ] [ 1 ] , tn [ 1 ] [ 1 ] , tn [ 2 ] [ 1 ] ) ; tq = vec3 ( tn [ 0 ] [ 2 ] , tn [ 1 ] [ 2 ] , tn [ 2 ] [ 2 ] ) ; tp = cross ( tq , to ) ; to = normalize ( to ) ; tp = normalize ( tp ) ; tq = normalize ( tq ) ; return mat4 ( vec4 ( to , 0.0 ) , vec4 ( tp , 0.0 ) , vec4 ( tq , 0.0 ) , vec4 ( tm , 1.0 ) ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 tx ( vec3 ts , vec3 tt ) { vec3 tu , tv , tw ; tu = ts - tt ; tu . y = 0.0 ; tv = cross ( tl , tu ) ; tw = cross ( tu , tv ) ; tv = normalize ( tv ) ; tw = normalize ( tw ) ; tu = normalize ( tu ) ; return mat4 ( vec4 ( tv , 0.0 ) , vec4 ( tw , 0.0 ) , vec4 ( tu , 0.0 ) , vec4 ( tt , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"mat4 tF ( in vec3 ty , float tz , float tA , float tB , vec3 tC ) { float tD , tE ; tD = fract ( length ( tC ) / 0.17 ) ; tE = tB + tD / 10.0 ; tD = tD ; if ( tB != 0.0 ) tD /= tB ; ty *= 1.0 + 0.5 * sin ( tz ) ; tD = length ( ty ) * tA * sin ( 2.0 * 3.14 * tz * tE + tD ) ; return eS ( tD ) ; }".split(" ")}]}}]},
{type:"textline",b:"mat4 tN ( in vec3 tG , in vec3 tH , in mat4 tI ) { vec3 tJ ; float tK , tL ; mat4 tM ;".split(" ")},{type:"condition",a:[{type:"if",d:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",e:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",e:2},{type:"logical_and_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"tM = tr ( tH , tI ) ;".split(" ")}]}},{type:"elif",d:["BILLBOARD_RANDOM"],group:{type:"group",a:[{type:"textline",
b:"tK = fract ( ( tH . x * 1.43 + tH . y * 0.123 + tH . z * 6.1 ) ) ; tK = 2.0 * M_PI * tK ; tJ = normalize ( vec3 ( tI [ 0 ] [ 2 ] , 0.0 , tI [ 2 ] [ 2 ] ) ) ; tL = acos ( tJ [ 2 ] ) ; if ( tJ [ 0 ] < 0.0 ) tL = 2.0 * M_PI - tL ; tL = tL - tK ; if ( tL < 0.0 ) tL = 2.0 * M_PI + tL ; tK = tK ; if ( tL <= MAX_BILLBOARD_ANGLE ) tK += tL ; else if ( tL <= M_PI - MAX_BILLBOARD_ANGLE ) tK += MAX_BILLBOARD_ANGLE * ( 2.0 * tL - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( tL <= M_PI + MAX_BILLBOARD_ANGLE ) tK += tL - M_PI ; else if ( tL <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) tK += MAX_BILLBOARD_ANGLE * ( 2.0 * tL - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else tK += tL - 2.0 * M_PI ; tM = eQ ( tK ) ; tM [ 3 ] = vec4 ( tH , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"tM = tx ( tG , tH ) ;".split(" ")}]}}]},{type:"textline",b:["return","tM",";","}"]},{type:"condition",a:[{type:"if",d:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",e:1},{type:"logical_and_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"mat4 tT ( in vec3 tO , in vec3 tP , in mat4 tQ , mat4 tR ) { mat4 tS ; tS = tN ( tO , tP , tQ ) ; tR [ 3 ] = vec4 ( 0.0 , 0.0 , 0.0 , 1.0 ) ; tS = tS * tR ; return tS ; }".split(" ")}]}}]},
{type:"textline",b:"es t_ ( in vec3 tU , in vec3 tV , in vec3 tW , in vec3 tX , in vec3 tY , in mat4 tZ ) { tU = ( tZ * vec4 ( tU , 1.0 ) ) . xyz ; tV = ( tZ * vec4 ( tV , 1.0 ) ) . xyz ; tW = ( tZ * vec4 ( tW , 0.0 ) ) . xyz ; tX = ( tZ * vec4 ( tX , 0.0 ) ) . xyz ; tY = ( tZ * vec4 ( tY , 0.0 ) ) . xyz ; return eU ( es ( tU , tV , tW , tX , tY , vec3 ( 0.0 ) ) ) ; }".split(" ")}]};a["include/scale_texcoord.glslv"]={type:"group",a:[{type:"textline",b:"vec2 uc ( vec2 ua , vec3 ub ) { return ( ua + 0.5 ) * ub . xy - 0.5 ; }".split(" ")}]};
a["include/skin.glslv"]={type:"group",a:[{type:"define",name:"SKIN_SLERP",b:["0"]},{type:"condition",a:[{type:"if",d:["SKINNED"],group:{type:"group",a:[{type:"condition",a:[{type:"if",d:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"vec4 uj ( in vec4 ud , in vec4 ue , in float uf ) { float ug , uh , ui ; ug = ud [ 0 ] * ue [ 0 ] + ud [ 1 ] * ue [ 1 ] + ud [ 2 ] * ue [ 2 ] + ud [ 3 ] * ue [ 3 ] ; if ( ug < 0.0 ) { ue *= - 1.0 ; ug = - ug ; } if ( abs ( ug ) >= 1.0 ) return ud ; uh = acos ( ug ) ; ug = sqrt ( 1.0 - ug * ug ) ; if ( abs ( ug ) < 0.001 ) return vec4 ( ud * 0.5 + ue * 0.5 ) ; ui = sin ( ( 1.0 - uf ) * uh ) / ug ; ug = sin ( uf * uh ) / ug ; return ud * ui + ue * ug ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"vec3 uv ( in vec3 uk , in vec4 ul , in vec4 um , in vec4 un , in vec4 uo , in float up ) { vec4 uq , ur ; vec3 us , ut , uu ; us = eF ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uk , 1.0 ) ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"uq = uj ( ul , um , up ) ; ur = mix ( un , uo , up ) ; ut = ey ( uq , us ) ; ut = ut * ur . w + ur . xyz ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"uu = ey ( ul , us ) ; us = ey ( um , us ) ; uu = uu * un . w + un . xyz ; us = us * uo . w + uo . xyz ; ut = mix ( uu , us , up ) ;".split(" ")}]}}]},{type:"textline",b:"return eL ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( ut , 1.0 ) ) ; } vec3 uE ( in vec3 uw , in vec4 ux , in vec4 uy , in float uz ) { vec4 uA ; vec3 uB , uC , uD ; uB = eF ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uw , 0.0 ) ) ;".split(" ")},{type:"condition",a:[{type:"if",
d:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"uA = uj ( ux , uy , uz ) ; uC = ey ( uA , uB ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uD = ey ( ux , uB ) ; uB = ey ( uy , uB ) ; uC = mix ( uD , uB , uz ) ;".split(" ")}]}}]},{type:"textline",b:"return eL ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uC , 0.0 ) ) ; }".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 uv ( in vec3 uF , in vec4 uG , in vec4 uH ) { vec3 uI ; uI = eF ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uF , 1.0 ) ) ; uI = ey ( uG , uI ) ; uI = uI * uH . w + uH . xyz ; return eL ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uI , 1.0 ) ) ; } vec3 uE ( in vec3 uJ , in vec4 uK ) { vec3 uL ; uL = eF ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uJ , 0.0 ) ) ; uL = ey ( uK , uL ) ; return eL ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( uL , 0.0 ) ) ; }".split(" ")}]}}]},
{type:"textline",b:"void u_ ( inout vec3 uM , inout vec3 uN , inout vec3 uO , inout vec3 uP ) { int uQ , uR ; vec4 uS ; vec3 uT , uU , uV , uW ; float uX , uY ;".split(" ")},{type:"condition",a:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:["uX","=","u_frame_factor",";"]}]}}]},{type:"textline",b:"if ( a_influence . y > 0.0 ) { uT = vec3 ( 0.0 , 0.0 , 0.0 ) ; uU = vec3 ( 0.0 , 0.0 , 0.0 ) ; uV = vec3 ( 0.0 , 0.0 , 0.0 ) ; uW = vec3 ( 0.0 , 0.0 , 0.0 ) ; uS = a_influence ; for ( int uZ = 0 ; uZ < 4 ; uZ ++ ) { uQ = int ( uS [ uZ ] ) ; uY = fract ( uS [ uZ ] ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uT += uY * uv ( uM , u_quatsb [ uQ ] , u_quatsa [ uQ ] , u_transb [ uQ ] , u_transa [ uQ ] , uX ) ; uU += uY * uE ( uN , u_quatsb [ uQ ] , u_quatsa [ uQ ] , uX ) ; uV += uY * uE ( uO , u_quatsb [ uQ ] , u_quatsa [ uQ ] , uX ) ; uW += uY * uE ( uP , u_quatsb [ uQ ] , u_quatsa [ uQ ] , uX ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uT += uY * uv ( uM , u_quatsb [ uQ ] , u_transb [ uQ ] ) ; uU += uY * uE ( uN , u_quatsb [ uQ ] ) ; uV += uY * uE ( uO , u_quatsb [ uQ ] ) ; uW += uY * uE ( uP , u_quatsb [ uQ ] ) ;".split(" ")}]}}]},
{type:"textline",b:"} uM = uT ; uN = uU ; uO = uV ; uP = uW ; } if ( ! ( a_influence . y > 0.0 ) ) { uR = int ( a_influence [ 0 ] - 1.0 ) ; if ( uR > - 1 ) {".split(" ")},{type:"condition",a:[{type:"if",d:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uM = uv ( uM , u_quatsb [ uR ] , u_quatsa [ uR ] , u_transb [ uR ] , u_transa [ uR ] , uX ) ; uN = uE ( uN , u_quatsb [ uR ] , u_quatsa [ uR ] , uX ) ; uO = uE ( uO , u_quatsb [ uR ] , u_quatsa [ uR ] , uX ) ; uP = uE ( uP , u_quatsb [ uR ] , u_quatsa [ uR ] , uX ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"uM = uv ( uM , u_quatsb [ uR ] , u_transb [ uR ] ) ; uN = uE ( uN , u_quatsb [ uR ] ) ; uO = uE ( uO , u_quatsb [ uR ] ) ; uP = uE ( uP , u_quatsb [ uR ] ) ;".split(" ")}]}}]},{type:"textline",b:["}","}","}"]}]}}]}]};a["include/wind_bending.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",d:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"void vk ( inout vec3 va , in vec3 vb , in float vc , in float vd , in float ve , in vec3 vf , in float vg ) { vec3 vh ; float vi , vj ; vi = length ( vb ) ; vj = vd * ( 1.0 + 0.1 * fract ( vi ) ) ; vi = vc * vg * ( 1.0 + sin ( 2.0 * 3.14 * ve * vj + vi ) ) ; vj = ( va . y - vb . y ) * abs ( vi ) ; vj += 1.0 ; vj *= vj ; vj = vj * vj - vj ; vh = va ; vh . xz += vf . xz * vj * sign ( vi ) ; vh = vh - vb ; if ( all ( equal ( vh , vec3 ( 0.0 ) ) ) ) va = vb ; else { vi = length ( va - vb ) ; va = vb + normalize ( vh ) * vi ; } }".split(" ")},
{type:"condition",a:[{type:"if",d:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"vec4 vm ( vec4 vl ) { return vl * vl * ( 3.0 - 2.0 * vl ) ; } vec4 vo ( vec4 vn ) { return abs ( fract ( vn + 0.5 ) * 2.0 - 1.0 ) ; } vec4 vq ( vec4 vp ) { return vm ( vo ( vp ) ) ; } void vH ( inout vec3 vr , in float vs , in vec3 vt , in vec3 vu , in vec3 vv , in float vw , in float vx , in float vy , in vec3 vz ) { vec3 vA ; vec4 vB ; vec2 vC , vD ; float vE , vF , vG ; vE = dot ( vv , vec3 ( 1.0 ) ) ; vF = vE + vz . g ; vG = dot ( vr , vec3 ( vz . g ) ) ; vC = ( vs + vec2 ( vG , vF ) ) ; vB = ( ( fract ( ( vC . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( vu ) * vw ; vB = vq ( vB ) ; vD = vB . xz + vB . yw ; vD . y = 0.5 - vD . y ; vA = vD . xyx * vz . rbr * vec3 ( vx * vt . x , vy , vx * vt . z ) ; vr += vA ; }".split(" ")}]}}]},
{type:"textline",b:"void vO ( inout vec3 vI , inout vec3 vJ , in vec3 vK ) { vec3 vL , vM , vN ; vL = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{type:"condition",a:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"vM = vJ ; vN = a_emitter_center ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vM = vI ; vN = vJ ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
d:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"vH ( vM , u_time , vK , vL , vN , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail ) ;".split(" ")}]}}]},{type:"textline",b:"vk ( vM , vN , au_wind_bending_amp , au_wind_bending_freq , u_time , vL , a_bending_col_main ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vk ( vM , vN , au_wind_bending_amp , au_wind_bending_freq , u_time , vL , 1.0 ) ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",d:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"vI += vM - vJ ; vJ = vM ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vI = vM ; vJ = vN ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/nodes.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_orco_tex_coord ; varying vec3 hQ ;".split(" ")}]}}]},
{type:"node",name:"TEX_COORD_UV",j:[{type:"node_param",name:"node_TEX_COORD_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"is",qualifier:["varying","vec2"]}],h:[{type:"textline",b:["is","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{type:"node",name:"UV_MERGED",j:[{type:"node_param",name:"node_UV_MERGED_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"ir",qualifier:["varying","vec2"]}],h:[{type:"textline",b:["ir","=","node_UV_MERGED_var_a_uv",";"]}]},{type:"node",
name:"UVMAP",j:[{type:"node_param",name:"node_UVMAP_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"it",qualifier:["varying","vec2"]}],h:[{type:"textline",b:["it","=","node_UVMAP_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_UV",j:[{type:"node_param",name:"node_GEOMETRY_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"ik",qualifier:["varying","vec2"]}],h:[{type:"textline",b:["ik","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_VC",j:[{type:"node_param",
name:"node_GEOMETRY_VC_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"vP",qualifier:["varying","vec3"]}],h:[{type:"textline",b:["vP","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC1",j:[{type:"node_param",name:"node_GEOMETRY_VC1_var_a_vertex_color",qualifier:["attribute","float"]},{type:"node_param",name:"vQ",qualifier:["varying","float"]}],h:[{type:"textline",b:["vQ","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC2",
j:[{type:"node_param",name:"node_GEOMETRY_VC2_var_a_vertex_color",qualifier:["attribute","vec2"]},{type:"node_param",name:"vR",qualifier:["varying","vec2"]}],h:[{type:"textline",b:["vR","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC3",j:[{type:"node_param",name:"node_GEOMETRY_VC3_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"vS",qualifier:["varying","vec3"]}],h:[{type:"textline",b:["vS","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},
{type:"nodes_global"},{type:"textline",b:["void","vT","(",")","{"]},{type:"condition",a:[{type:"if",d:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:["hQ","=","a_orco_tex_coord",";"]}]}}]},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/dynamic_grass.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"condition",a:[{type:"if",d:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"vec2 vY ( vec3 vU , float vV , vec2 vW ) { vec2 vX ; vX = vec2 ( ( vU . x - vW . x ) / vV , - ( vU . z - vW . y ) / vV ) ; return fract ( vX ) ; } vec2 wb ( vec2 vZ , float v_ , vec2 wa ) { return vec2 ( vZ . x * v_ , - vZ . y * v_ ) + wa ; } es wc ( ) { return es ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } es wy ( vec3 wd , vec3 we , vec3 wf , vec3 wg , vec3 wh , PRECISION sampler2D wi , sampler2D wj , vec3 wk , float wl , vec3 wm , vec4 wn , mat4 wo ) { mat4 wp ; vec4 wq ; vec2 wr , ws , wt ; float wu , wv ; vec3 ww ; ww = ey ( wn , vec3 ( 0.0 , - 1.0 , 0.0 ) ) ; wu = - ww . x ; wv = - ww . z ; wr = vec2 ( wm . x + wl * ( - 1.0 - wu ) / 2.0 , wm . z + wl * ( 1.0 - wv ) / 2.0 ) ; ws = vY ( wh , wl , wr ) ; wv = wl / 2.0 ; wt = abs ( wb ( ws - vec2 ( 0.5 ) , wl , vec2 ( 0.0 ) ) ) ; wv = wv * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( wt ) > wv ) return wc ( ) ; wv = wl / wk . z ; wt = ( ws - vec2 ( 0.5 ) ) * wv + vec2 ( 0.5 ) ; ww = ww * ( wl / wk . z - 1.0 ) / 2.0 ; wt . x += ww . x ; wt . y -= ww . z ; wq = texture2D ( wj , wt ) ; wv = wq . r ; if ( wv < u_scale_threshold ) return wc ( ) ; wu = wk . y - wk . x ; wu = wk . y - texture2D ( wi , wt ) . r * wu ; wt = wd . xz - wh . xz ; wh . xz = wb ( ws , wl , wr ) ; wh . y = wu ; wd . xz = wh . xz + wt ; wd . y *= wv ; wd . y += wu ; ww = wq . gba ;".split(" ")},
{type:"condition",a:[{type:"if",d:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"wd -= wh ; wp = tN ( wm , wh , wo ) ; es wx = t_ ( wd , wh , we , wf , wg , wp ) ; wx . b = wh ; wx . f = ww ; return eU ( wx ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return eU ( es ( wd , wh , we , wf , wg , ww ) ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/shadow.glslv"]={type:"group",a:[{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"condition",
a:[{type:"if",d:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",e:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",e:2},{type:"logical_or_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"vec4 wE ( mat4 wz , vec4 wA ) { vec4 wB ; float wC ; vec2 wD ; wD = ( wz * u_v_light_matrix [ 3 ] ) . xy ; wC = SHADOW_TEX_RES / 2.0 ; wD = floor ( wD * wC + 0.5 ) / wC - wD ; wB = wz * wA ; wB . xy += wD ; wB = u_b_light_matrix * wB ; return wB ; } void wI ( vec3 wF , vec3 wG ) { vec4 wH ; wH = u_v_light_matrix * vec4 ( wF + u_normal_offset * wG , 1.0 ) ; fg = wE ( u_p_light_matrix0 , wH ) ;".split(" ")},
{type:"condition",a:[{type:"if",d:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"fh = wE ( u_p_light_matrix1 , wH ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"fi = wE ( u_p_light_matrix2 , wH ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"fj = wE ( u_p_light_matrix3 , wH ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/particles.glslv"]=
{type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"struct wQ { float a ; vec3 b ; float c ; vec3 d ; float e ; } ;".split(" ")},{type:"condition",a:[{type:"if",d:["SIZE_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"void wW ( inout float wR , float wS , vec2 wT , vec2 wU ) { float wV ; wV = wU . x - wT . x ; wV = ( wS - wT . x ) / wV ; wR = mix ( wR , wU . y , clamp ( wV , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",
d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"void xb ( inout vec3 wX , float wY , vec4 wZ , vec4 w_ ) { float xa ; xa = w_ . x - wZ . x ; xa = ( wY - wZ . x ) / xa ; wX = mix ( wX , w_ . yzw , clamp ( xa , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SIZE_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"float xh ( float xc , float xd , vec2 xe [ SIZE_RAMP_LENGTH ] ) { float xf , xg ; xf = xc / xd ; xg = xe [ 0 ] . y ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SIZE_RAMP_LENGTH",1,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wW ( xg , xf , xe [ 0 ] , xe [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SIZE_RAMP_LENGTH",2,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wW ( xg , xf , xe [ 1 ] , xe [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["SIZE_RAMP_LENGTH",3,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"wW ( xg , xf , xe [ 2 ] , xe [ 3 ] ) ;".split(" ")}]}}]},
{type:"textline",b:["return","xg",";","}"]}]}}]},{type:"condition",a:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"vec3 xn ( float xi , float xj , vec4 xk [ COLOR_RAMP_LENGTH ] ) { vec3 xl ; float xm ; xm = xi / xj ; xl = xk [ 0 ] . yzw ;".split(" ")},{type:"condition",a:[{type:"if",d:["COLOR_RAMP_LENGTH",1,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"xb ( xl , xm , xk [ 0 ] , xk [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",d:["COLOR_RAMP_LENGTH",2,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"xb ( xl , xm , xk [ 1 ] , xk [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["COLOR_RAMP_LENGTH",3,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"xb ( xl , xm , xk [ 2 ] , xk [ 3 ] ) ;".split(" ")}]}}]},{type:"textline",b:["return","xl",";","}"]}]}}]},{type:"textline",b:"float xv ( float xo , float xp , float xq , float xr ) { float xs , xt , xu ; xs = max ( 0.01 , min ( xp , xq ) ) ; xt = max ( 0.01 , min ( xp , xr ) ) ; xu = xp - xt ; xt = clamp ( xo / xs , 0.0 , 1.0 ) - step ( xu , xo ) * ( xo - xu ) / xt ; return xt ; } wQ xB ( ) { vec3 xw , xx ; float xy , xz ; wQ xA ; if ( u_p_cyclic == 1 ) { xy = mod ( u_p_time , u_p_length ) - a_p_delay ; if ( xy < 0.0 ) xy += u_p_length ; } if ( u_p_cyclic != 1 ) { xy = u_p_time - a_p_delay ; } if ( xy < 0.0 || xy >= a_p_lifetime ) { xA . a = 0.0001 ; xA . b = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( xy < 0.0 || xy >= a_p_lifetime ) ) {".split(" ")},
{type:"condition",a:[{type:"if",d:["WORLD_SPACE"],group:{type:"group",a:[{type:"textline",b:"xw = a_position ; xx = a_normal ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xw = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; xx = ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ;".split(" ")}]}}]},{type:"textline",b:"xw += u_p_nfactor * xy * xx ; xw += a_p_vels . xyz * xy ; xw . y -= u_p_gravity * xy * xy / 2.0 ; xz = max ( u_p_mass , EPSILON ) ; xw += ( u_p_wind / xz ) * xy * xy / 2.0 ; xA . b = xw ; xA . e = a_p_vels . w * xy ;".split(" ")},
{type:"condition",a:[{type:"if",d:["SIZE_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"xA . a = xh ( xy , u_p_max_lifetime , u_p_size_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xA . a = 1.0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",d:["COLOR_RAMP_LENGTH",0,{type:"g_expr",e:2}],group:{type:"group",a:[{type:"textline",b:"xA . d = xn ( xy , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"xA . d = vec3 ( 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"xA . c = xv ( xy , a_p_lifetime , u_p_fade_in , u_p_fade_out ) ; } return xA ; }".split(" ")}]};a["include/blending.glslf"]={type:"group",a:[{type:"textline",b:"float xD = 0.0 ; float xE = 1.0 ; vec3 xF = vec3 ( xD ) ; vec3 xG = vec3 ( xE ) ; vec3 xL ( vec3 xH ) { float xI , xJ ; vec4 xK ; xK = vec4 ( xD , - xE / 3.0 , 2.0 / 3.0 , - xE ) ; xK = mix ( vec4 ( xH . bg , xK . wz ) , vec4 ( xH . gb , xK . xy ) , step ( xH . b , xH . g ) ) ; xK = mix ( vec4 ( xK . xyw , xH . r ) , vec4 ( xH . r , xK . yzx ) , step ( xK . x , xH . r ) ) ; xI = xK . x - min ( xK . w , xK . y ) ; xJ = 1.0e-10 ; return vec3 ( abs ( xK . z + ( xK . w - xK . y ) / ( 6.0 * xI + xJ ) ) , xI / ( xK . x + xJ ) , xK . x ) ; } vec3 xP ( vec3 xM ) { vec3 xN ; vec4 xO ; xO = vec4 ( xE , 2.0 / 3.0 , xE / 3.0 , 3.0 ) ; xN = abs ( fract ( vec3 ( xM . r , xM . r , xM . r ) + xO . xyz ) * 6.0 - xO . www ) ; return xM . b * mix ( xO . xxx , clamp ( xN - xO . xxx , xD , xE ) , xM . g ) ; } vec3 xT ( vec3 xQ , vec3 xR , float xS ) { return mix ( xQ , xR , xS ) ; } vec3 xX ( vec3 xU , vec3 xV , float xW ) { return xW * xU + xV ; } vec3 ya ( vec3 xY , vec3 xZ , float x_ ) { return xZ - x_ * xY ; } vec3 yf ( vec3 yb , vec3 yc , float yd ) { float ye ; ye = xE - yd ; return ( vec3 ( ye ) + yd * yb ) * yc ; } vec3 yk ( vec3 yg , vec3 yh , float yi ) { vec3 yj ; yj = vec3 ( xE - yi ) ; return xG - ( yj + yi * ( xG - yg ) ) * ( xG - yh ) ; } vec3 yp ( vec3 yl , vec3 ym , float yn ) { vec3 yo ; yo = vec3 ( xE - yn ) ; return mix ( ym * ( yo + 2.0 * yn * yl ) , xG - ( yo + 2.0 * yn * ( xG - yl ) ) * ( xG - ym ) , step ( 0.5 , ym ) ) ; } vec3 yt ( vec3 yq , vec3 yr , float ys ) { return mix ( yr , abs ( yq - yr ) , ys ) ; } vec3 yx ( vec3 yu , vec3 yv , float yw ) { return mix ( yv , yv / ( yu + step ( yu , xF ) ) , yw ) ; } vec3 yB ( vec3 yy , vec3 yz , float yA ) { return mix ( yz , min ( yy , yz ) , yA ) ; } vec3 yF ( vec3 yC , vec3 yD , float yE ) { return max ( yE * yC , yD ) ; } vec3 yL ( vec3 yG , vec3 yH , float yI ) { vec3 yJ , yK ; yJ = xL ( yH ) ; if ( yJ . y != xD ) { yK = xL ( yG ) ; yK = xP ( vec3 ( yJ . x , yK . yz ) ) ; return mix ( yG , yK , yI ) ; } return yG ; } vec3 yR ( vec3 yM , vec3 yN , float yO ) { vec3 yP , yQ ; yP = xL ( yM ) ; if ( yP . y != xD ) { yQ = xL ( yN ) ; return xP ( vec3 ( yP . x , mix ( yP . y , yQ . y , yO ) , yP . z ) ) ; } return yM ; } vec3 yX ( vec3 yS , vec3 yT , float yU ) { vec3 yV , yW ; yV = xL ( yS ) ; yW = xL ( yT ) ; return xP ( vec3 ( yV . xy , mix ( yV . z , yW . z , yU ) ) ) ; } vec3 zc ( vec3 yY , vec3 yZ , float y_ ) { vec3 za , zb ; za = xL ( yZ ) ; if ( za . y != xD ) { zb = xL ( yY ) ; zb = xP ( vec3 ( za . xy , zb . z ) ) ; return mix ( yY , zb , y_ ) ; } return yY ; } vec3 zh ( vec3 zd , vec3 ze , float zf ) { vec3 zg ; zg = xG - ( xG - ze ) * ( xG - zd ) ; return mix ( zd , ( ( xG - zd ) * ze * zd ) + zd * zg , zf ) ; } vec3 zl ( vec3 zi , vec3 zj , float zk ) { return zi + zk * ( 2.0 * zj - xE ) ; } float zr ( float zm , float zn , float zo , float zp ) { float zq ; zq = xE - zp ; return ( zq + zo * zm ) * zn ; } float zx ( float zs , float zt , float zu , float zv ) { float zw ; zw = xE - zv ; return xE - ( zw + zu * ( xE - zs ) ) * ( xE - zt ) ; } float zD ( float zy , float zz , float zA , float zB ) { float zC ; zC = xE - zB ; return mix ( zz * ( zC + 2.0 * zA * zy ) , xE - ( zC + 2.0 * zA * ( xE - zy ) ) * ( xE - zz ) , step ( 0.5 , zz ) ) ; }".split(" ")}]};
a["include/depth_fetch.glslf"]={type:"group",a:[{type:"textline",b:"float zP ( in sampler2D zJ , in vec2 zK , in vec2 zL ) { float zM , zN , zO ; zM = texture2D ( zJ , zK ) . r ; zN = zL . x ; zO = zL . y ; zN = 2.0 * zN / ( zN + zO - ( 2.0 * zM - 1.0 ) * ( zO - zN ) ) ; return zN ; }".split(" ")}]}};b4w.module.animation=function(a,p){var c=p("__animation"),d=p("__constraints");p("__physics");var b=p("__print"),e=p("__util");a.SLOT_0=c.SLOT_0;a.SLOT_1=c.SLOT_1;a.SLOT_2=c.SLOT_2;a.SLOT_3=c.SLOT_3;a.SLOT_4=c.SLOT_4;a.SLOT_5=c.SLOT_5;a.SLOT_6=c.SLOT_6;a.SLOT_7=c.SLOT_7;a.SLOT_ALL=c.SLOT_ALL;a.OBJ_ANIM_TYPE_NONE=c.OBJ_ANIM_TYPE_NONE;a.OBJ_ANIM_TYPE_ARMATURE=c.OBJ_ANIM_TYPE_ARMATURE;a.OBJ_ANIM_TYPE_OBJECT=c.OBJ_ANIM_TYPE_OBJECT;a.OBJ_ANIM_TYPE_VERTEX=c.OBJ_ANIM_TYPE_VERTEX;a.OBJ_ANIM_TYPE_SOUND=c.OBJ_ANIM_TYPE_SOUND;
a.OBJ_ANIM_TYPE_PARTICLES=c.OBJ_ANIM_TYPE_PARTICLES;a.OBJ_ANIM_TYPE_MATERIAL=c.OBJ_ANIM_TYPE_MATERIAL;a.AB_CYCLIC=c.AB_CYCLIC;a.AB_FINISH_RESET=c.AB_FINISH_RESET;a.AB_FINISH_STOP=c.AB_FINISH_STOP;var l=new Float32Array(4);a.is_animated=function(a){return c.is_animated(a)};a.get_actions=function(){b.error("get_actions() deprecated, use get_anim_names() instead");for(var a=[],d=c.or(),e=0;e<d.length;e++)a.push(c.tC(d[e].name));return a};a.get_current_action=function(c,d){b.error("get_current_action() deprecated, use get_current_anim_name() instead");
return a.get_current_anim_name(c,d)};a.get_anim_names=function(a){return c.Cs(a)?c.get_anim_names(a):[]};a.get_current_anim_name=function(a,b){if(!c.is_animated(a))return null;b=b||c.SLOT_0;return c.ez(a,b)};a.apply=function(a,d,e){if(e>c.SLOT_7)b.error("Can't apply animation to slot "+e+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{e=e||c.SLOT_0;if(c.is_animated(a)){var f=c.get_slot_num_by_anim(a,d);if(-1!=f&&f!=e){b.error('Animation "'+d+'" is already applied to object "'+
a.name+'" (slot "'+f+'").');return}}c.wD(a,d)?c.apply(a,d,e):b.error('No fcurves in action "'+d+'"')}};a.remove=function(a){c.remove(a)};a.remove_slot_animation=function(a,b){c.is_animated(a)&&(b=b||c.SLOT_0,c.remove_slot_animation(a,b))};a.apply_def=function(a){c.apply_def(a)};a.play=function(a,d,e){c.is_animated(a)?(e=e||c.SLOT_0,c.play(a,d,e),c.update_object_animation(a,0,e,!0)):b.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){c.is_animated(a)&&(b=b||c.SLOT_0,c.stop(a,
b))};a.is_play=function(a,b){if(!c.is_animated(a))return!1;b=b||c.SLOT_0;return c.is_play(a,b)};a.set_current_frame_float=function(c,d,e){b.error("set_current_frame_float() deprecated, use set_frame() instead");a.set_frame(c,d,e)};a.get_current_frame_float=function(c,d){b.error("get_current_frame_float() deprecated, use get_frame() instead");return a.get_frame(c,d)};a.set_frame=function(a,b,d){c.is_animated(a)&&(d=d||c.SLOT_0,c.set_frame(a,b,d))};a.set_first_frame=function(a,b){if(c.is_animated(a)){b=
b||c.SLOT_0;var d=c.get_anim_start_frame(a,b);c.set_frame(a,d,b)}};a.set_last_frame=function(a,b){if(c.is_animated(a)){b=b||c.SLOT_0;var d=c.get_anim_start_frame(a,b),e=c.get_anim_length(a,b);c.set_frame(a,d+e-c.Nu,b)}};a.get_frame=function(a,b){if(!c.is_animated(a))return 0;b=b||c.SLOT_0;return c.get_current_frame_float(a,b)};a.set_speed=function(a,b,d){c.is_animated(a)&&(d=d||c.SLOT_0,c.set_speed(a,b||1,d))};a.get_speed=function(a,b){if(!c.is_animated(a))return 0;b=b||c.SLOT_0;return a.c.G[b]?c.get_speed(a,
b):0};a.get_frame_range=function(a,d){b.error("get_frame_range() deprecated, use get_anim_start_frame() and get_anim_length() instead");if(c.is_animated(a)){d=d||c.SLOT_0;var e=a.c.G[d];if(e)return[e.start,e.start+e.length]}return null};a.get_anim_start_frame=function(a,b){return c.is_animated(a)&&(b=b||c.SLOT_0,a.c.G[b])?c.get_anim_start_frame(a,b):-1};a.get_anim_length=function(a,b){return c.is_animated(a)&&(b=b||c.SLOT_0,a.c.G[b])?c.get_anim_length(a,b):-1};a.cyclic=function(d,e,l){b.error("cyclic() deprecated, use set_behavior() instead");
a.set_behavior(d,e?c.AB_CYCLIC:c.AB_FINISH_RESET,l)};a.is_cyclic=function(a,d){b.error("is_cyclic() deprecated, use get_behavior() instead");if(!c.is_animated(a))return!1;d=d||c.SLOT_0;return c.is_cyclic(a,d)};a.set_behavior=function(a,b,d){c.is_animated(a)&&(d=d||c.SLOT_0,c.set_behavior(a,b,d))};a.get_behavior=function(a,b){if(!c.is_animated(a))return null;b=b||c.SLOT_0;return c.get_behavior(a,b)};a.apply_smoothing=function(a,b,d,e){e=e||c.SLOT_0;c.is_animated(a)&&c.apply_smoothing(a,b,d,e)};a.update_object_animation=
function(a,b,d,e){c.is_animated(a)&&(d=d||c.SLOT_0,c.update_object_animation(a,b||0,d,e||!1))};a.frame_to_sec=function(a){return c.frame_to_sec(a)};a.get_bone_translation=function(a,b,c){if(!e.is_armature(a))return null;c||(c=new Float32Array(3));d.iz(a,b,!1,l,null);c[0]=l[0];c[1]=l[1];c[2]=l[2];return c};a.get_first_armature_object=function(a){return e.is_mesh(a)?c.get_first_armature_object(a):null};a.get_slot_num_by_anim=function(a,b){return c.is_animated(a)&&b?c.get_slot_num_by_anim(a,b):null};
a.get_anim_type=function(a,b){return c.is_animated(a)?c.get_anim_type(a,b):null};a.apply_to_first_empty_slot=function(a,b){return c.apply_to_first_empty_slot(a,b)};a.get_skel_mix_factor=function(a){return a.c.g.Oe};a.set_skel_mix_factor=function(a,d,l){e.is_armature(a)?(d=Math.min(Math.max(d,0),1),a.c.g.Oe!=d&&c.set_skel_mix_factor(a,d,l||0)):b.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.anchors=function(a,p){var c=p("__anchors");p("__print");a.attach_move_cb=c.attach_move_cb;a.detach_move_cb=c.detach_move_cb;a.is_anchor=c.is_anchor;a.get_element_id=c.get_element_id};b4w.module.assets=function(a,p){var c=p("__assets");a.AT_ARRAYBUFFER=c.AT_ARRAYBUFFER;a.AT_JSON=c.AT_JSON;a.AT_TEXT=c.AT_TEXT;a.AT_AUDIOBUFFER=c.AT_AUDIOBUFFER;a.AT_IMAGE_ELEMENT=c.AT_IMAGE_ELEMENT;a.AT_AUDIO_ELEMENT=c.AT_AUDIO_ELEMENT;a.enqueue=function(a,b,e){c.enqueue(a,b,e)}};b4w.module.camera=function(a,p){function c(a,c){if(b.is_camera(a))return c||(c=new Float32Array(3)),k.copy(a.c.g.i,c),c;m.error("get_eye(): Wrong object")}function d(a,c){b.is_target_camera(a)?(k.copy(c,a.c.g.Tb),n.A(a),l.sync_transform(a)):m.error("set_pivot(): Wrong object or camera move style")}var b=p("__camera");p("__config");var e=p("__container"),l=p("__physics"),m=p("__print"),h=p("__constraints"),n=p("__transform"),f=p("__util"),k=p("vec3"),r=p("vec4");p("quat");var y=p("mat3"),w=p("mat4"),
C=new Float32Array(2),D=new Float32Array(3),G=new Float32Array(3),t=new Float32Array(4),A=new Float32Array(9);a.MS_STATIC=b.MS_STATIC;a.MS_ANIMATION=b.MS_STATIC;a.MS_TARGET_CONTROLS=b.MS_TARGET_CONTROLS;a.MS_EYE_CONTROLS=b.MS_EYE_CONTROLS;a.MS_HOVER_CONTROLS=b.MS_HOVER_CONTROLS;a.is_camera=b.is_camera;a.is_target_camera=b.is_target_camera;a.is_eye_camera=b.is_eye_camera;a.is_hover_camera=b.is_hover_camera;a.set_move_style=function(a,d){if(!b.is_camera(a))return m.error("set_move_style(): Wrong object"),
!1;if(d!=b.MS_STATIC&&d!=b.MS_EYE_CONTROLS&&d!=b.MS_HOVER_CONTROLS&&d!=b.MS_TARGET_CONTROLS)return m.error("set_move_style(): Wrong camera move style"),!1;a.c.g.Aa=d;a.c.g.$b=null;a.c.g.fc=null;a.c.g.Db=null;a.c.g.eb=!1;b.Rz(a);switch(d){case b.MS_TARGET_CONTROLS:var e=c(a,D),h=f.quat_to_dir(a.c.g.quat,f.AXIS_MY,G),e=k.scaleAndAdd(e,h,10,h);k.copy(e,a.c.g.Tb)}n.A(a);l.sync_transform(a);return!0};a.get_move_style=function(a){return b.is_camera(a)?b.get_move_style(a):(m.error("get_move_style(): Wrong object"),
null)};a.set_velocity_params=function(a,c){if(!b.is_target_camera(a)&&!b.is_eye_camera(a)&&!b.is_hover_camera(a))return m.error("set_velocity_params(): Wrong object or camera move style"),null;var d=a.c.g;d.np=f.clamp(c[0],0,Infinity);d.mp=f.clamp(c[1],0,Infinity);d.op=f.clamp(c[2],0,1)};a.get_velocity_params=function(a,c){if(!b.is_target_camera(a)&&!b.is_eye_camera(a)&&!b.is_hover_camera(a))return m.error("get_velocity_params(): Wrong object or camera move style"),null;c||(c=new Float32Array(3));
var d=a.c.g;c[0]=d.np;c[1]=d.mp;c[2]=d.op;return c};a.set_look_at=function(a,c,d,e){var f=a.c.g;b.Dy(c,d,e,f.i,f.quat);n.A(a);l.sync_transform(a)};a.get_eye=c;a.set_pivot=d;a.set_trans_pivot=function(a,c,d){b.is_target_camera(a)?(k.copy(c,a.c.g.i),k.copy(d,a.c.g.Tb),n.A(a),l.sync_transform(a)):m.error("set_trans_pivot(): Wrong object or camera move style")};a.get_pivot=function(a,c){if(b.is_target_camera(a))return c||(c=new Float32Array(3)),k.copy(a.c.g.Tb,c),c;m.error("get_pivot(): Wrong object or camera move style")};
a.rotate_pivot=function(b,c,d){m.error("rotate_pivot() deprecated, use rotate_camera() or rotate_target_camera() instead");a.rotate_target_camera(b,c,d)};a.move_pivot=function(a,c,d){if(b.is_target_camera(a)){var e=a.c.g;if(e.eu){var f=y.fromMat4(e.Z,A),h=k.subtract(e.i,e.Tb,G);D[0]=c;D[1]=0;D[2]=d;k.scale(D,k.len(h),D);k.transformMat3(D,f,D);k.add(e.Tb,D,e.Tb);k.add(e.i,D,e.i);n.A(a);l.sync_transform(a)}}else m.error("move_pivot(): wrong object")};a.rotate_hover_cam=function(b,c){m.error("rotate_hover_cam() deprecated, use rotate_camera() or rotate_hover_camera() instead");
a.rotate_hover_camera(b,c,0)};a.get_hover_cam_angle=function(a){m.error("get_hover_cam_angle() deprecated, use get_camera_angles() instead");return b.is_hover_camera(a)?-b.get_camera_angles(a,C)[1]:(m.error("get_hover_cam_angle(): wrong object or camera move style"),null)};a.set_hover_cam_angle=function(a,c){m.error("set_hover_cam_angle() deprecated, use rotate_camera() or rotate_hover_camera() instead");if(b.is_hover_camera(a))if(a.c.g.eb){var d=b.get_camera_angles(a,C);(d=-c-d[1])&&b.rotate_hover_camera(a,
0,d);n.A(a);l.sync_transform(a)}else m.error("set_hover_cam_angle(): distance/hover_angle limits are not defined or disabled");else m.error("set_hover_cam_angle(): wrong object or camera move style")};a.get_hover_angle_limits=function(a,c){if(b.is_hover_camera(a))return a.c.g.Db?(c||(c=new Float32Array(2)),c[0]=a.c.g.Db.Qa,c[1]=a.c.g.Db.cb):m.error("get_hover_angle_limits(): camera hasn't angle limits"),c;m.error("get_hover_angle_limits(): wrong object")};a.get_cam_dist_limits=function(a,c){if(b.is_hover_camera(a)||
b.is_target_camera(a))return a.c.g.eb?(c||(c=new Float32Array(2)),c[0]=a.c.g.eg,c[1]=a.c.g.je):m.error("get_cam_dist_limits(): camera hasn't distance limits"),c;m.error("get_cam_dist_limits(): wrong object")};a.translate_hover_cam_v=function(b,c){m.error("translate_hover_cam_v() deprecated, use hover_cam_set_translation() instead");a.hover_cam_set_translation(b,c)};a.hover_cam_set_translation=function(a,c){if(b.is_hover_camera(a)){var d=a.c.g;if(d.eb){var e=k.subtract(c,d.i,D);k.add(e,d.ac,d.ac)}n.set_translation(a,
c);n.A(a);l.sync_transform(a)}else m.error("hover_cam_set_translation(): wrong object")};a.set_hover_pivot=function(a,c){if(b.is_hover_camera(a)){var d=a.c.g;if(d.eb&&d.Db){var e=k.subtract(c,d.ac,D),e=k.add(e,d.i,e);n.set_translation(a,e)}k.copy(c,d.ac);n.A(a);l.sync_transform(a)}else m.error("set_hover_pivot(): Wrong object or camera move style")};a.get_hover_cam_pivot=function(a,c){if(!b.is_hover_camera(a))return m.error("get_hover_cam_pivot(): wrong object"),null;c||(c=new Float32Array(3));k.copy(a.c.g.ac,
c);return c};a.has_distance_limits=function(a){return b.is_target_camera(a)||b.is_hover_camera(a)?a.c.g.eb:(m.error("has_distance_limits(): wrong object"),null)};a.apply_vertical_limits=function(a,c,d,e){switch(b.get_move_style(a)){case b.MS_TARGET_CONTROLS:case b.MS_EYE_CONTROLS:e|=n.SPACE_WORLD;break;case b.MS_HOVER_CONTROLS:if(c>d){m.error("apply_vertical_limits(): wrong vertical limits");return}break;default:m.error("apply_vertical_limits(): wrong object");return}a.c.g.fc={Qa:c,cb:d};b.YA(a,e==
n.SPACE_LOCAL);n.A(a);l.sync_transform(a)};a.clear_vertical_limits=function(a){a.c.g.fc=null};a.get_vertical_limits=function(a,c){if(!b.is_target_camera(a)&&!b.is_eye_camera(a)&&!b.is_hover_camera(a))return m.error("get_vertical_limits(): wrong object"),null;var d=a.c.g;c=c||new Float32Array(2);return d.fc?(c[0]=d.fc.Qa,c[1]=d.fc.cb,c):null};a.has_vertical_limits=function(a){if(b.is_target_camera(a)||b.is_eye_camera(a)||b.is_hover_camera(a))return Boolean(a.c.g.fc);m.error("has_vertical_limits(): wrong object")};
a.apply_horizontal_limits=function(a,c,d,e){switch(b.get_move_style(a)){case b.MS_TARGET_CONTROLS:case b.MS_EYE_CONTROLS:e|=n.SPACE_WORLD;break;case b.MS_HOVER_CONTROLS:if(c>d){m.error("apply_horizontal_limits(): wrong horizontal limits");return}break;default:m.error("apply_horizontal_limits(): wrong object");return}a.c.g.$b={left:c,right:d};b.UA(a,e==n.SPACE_LOCAL);n.A(a);l.sync_transform(a)};a.clear_horizontal_limits=function(a){a.c.g.$b=null};a.get_horizontal_limits=function(a,c){if(!b.is_target_camera(a)&&
!b.is_eye_camera(a)&&!b.is_hover_camera(a))return m.error("get_horizontal_limits(): wrong object"),null;var d=a.c.g;c=c||new Float32Array(2);return d.$b?(c[0]=d.$b.left,c[1]=d.$b.right,c):null};a.has_horizontal_limits=function(a){if(b.is_target_camera(a)||b.is_eye_camera(a)||b.is_hover_camera(a))return Boolean(a.c.g.$b);m.error("has_horizontal_limits(): wrong object")};a.apply_hover_angle_limits=function(a,c,d){b.is_hover_camera(a)?c<d?m.error("apply_hover_angle_limits(): wrong hover angle limits"):
(c=f.angle_wrap_periodic(c,-Math.PI,Math.PI),d=f.angle_wrap_periodic(d,-Math.PI,Math.PI),c=f.clamp(c,-Math.PI/2,0),d=f.clamp(d,-Math.PI/2,0),a.c.g.Db={Qa:c,cb:d},b.Qz(a),n.A(a),l.sync_transform(a)):m.error("apply_hover_angle_limits(): wrong object")};a.clear_hover_angle_limits=function(a){b.is_hover_camera(a)?a.c.g.Db=null:m.error("clear_hover_angle_limits(): wrong object")};a.apply_distance_limits=function(a,c,d){if(b.is_target_camera(a)||b.is_hover_camera(a))if(c>d)m.error("apply_distance_limits(): wrong distance limits");
else{var e=a.c.g;e.eb=!0;e.je=c;e.eg=d;n.A(a);l.sync_transform(a)}else m.error("apply_distance_limits(): wrong object")};a.clear_distance_limits=function(a){b.is_target_camera(a)||b.is_hover_camera(a)?a.c.g.eb=!1:m.error("clear_distance_limits(): wrong object")};a.set_eye_params=function(b,c,d){m.error("set_eye_params() deprecated, use rotate_camera() or rotate_eye_camera() instead");a.rotate_eye_camera(b,c,Math.PI/2-d)};a.is_look_up=function(a){f.quat_to_dir(a.c.g.quat,f.AXIS_MY,D);return 0<=D[1]?
!0:!1};a.rotate_camera=function(c,d,e,f,h){switch(a.get_move_style(c)){case b.MS_STATIC:break;case b.MS_TARGET_CONTROLS:b.rotate_target_camera(c,d,e,f,h);break;case b.MS_EYE_CONTROLS:b.rotate_eye_camera(c,d,e,f,h);break;case b.MS_HOVER_CONTROLS:b.rotate_hover_camera(c,d,e,f,h);break;default:m.error("rotate_camera(): Wrong object")}n.A(c);l.sync_transform(c)};a.rotate_target_camera=function(a,c,d,e,f){b.is_target_camera(a)?(b.rotate_target_camera(a,c,d,e,f),n.A(a),l.sync_transform(a)):m.error("rotate_target_camera(): wrong object")};
a.rotate_eye_camera=function(a,c,d,e,f){b.is_eye_camera(a)?(b.rotate_eye_camera(a,c,d,e,f),n.A(a),l.sync_transform(a)):m.error("rotate_eye_camera(): wrong object")};a.rotate_hover_camera=function(a,c,d,e,f){b.is_hover_camera(a)?(b.rotate_hover_camera(a,c,d,e,f),n.A(a),l.sync_transform(a)):m.error("rotate_hover_camera(): wrong object")};a.rotate=function(b,c,d){m.error("rotate() deprecated, use rotate_camera() or rotate_eye_camera() instead");a.rotate_eye_camera(b,c,-d)};a.get_camera_angles=function(a,
c){c||(c=new Float32Array(2));b.get_camera_angles(a,c);return c};a.get_camera_angles_char=function(a,c){c||(c=new Float32Array(2));b.get_camera_angles_char(a,c);return c};a.get_angles=function(a,c){m.error("get_angles() deprecated, use get_camera_angles() instead");c||(c=new Float32Array(2));b.get_angles(a,c);return c};a.set_stereo_distance=function(a,c){for(var d=a.c.g.M,e=0;e<d.length;e++){var f=d[e];f.type!=b.Ab&&f.type!=b.Gb||b.MB(f,c,f.Md)}};a.get_stereo_distance=function(a){a=a.c.g.M;for(var c=
0;c<a.length;c++){var d=a[c];if(d.type==b.Ab||d.type==b.Gb)return d.Pj}return 0};a.is_underwater=function(a){m.error("is_underwater() deprecated, always returns false");return a.c.g.Wt};a.translate_view=function(a,c,d,e){a=a.c.g.M;for(var f=0;f<a.length;f++){var h=a[f];h.cc||b.xf(h,h.Ea);var k=D;k[0]=-c;k[1]=-d;k[2]=0;w.translate(h.xa,k,h.xa);w.rotateZ(h.xa,e,h.xa);w.multiply(h.xa,h.va,h.Rd);b.oq(h);b.ym(h)}};a.get_fov=function(a){return f.wl(a.c.g.M[0].Ac)};a.set_fov=function(a,c){for(var d=a.c.g.M,
e=0;e<d.length;e++){var h=d[e];h.Ac=f.gy(c);h.cc||b.xf(h,h.Ea);w.multiply(h.xa,h.va,h.Rd);b.oq(h);b.ym(h)}};a.correct_up=function(a,b){b||(b=f.AXIS_Y);h.correct_up(a,b)};a.zoom_object=function(a,c){if(b.is_target_camera(a)){n.get_object_center(c,!1,D);d(a,D);n.A(a);var e=n.get_object_size(c),f=b.dz(a)/2,e=e/Math.sin(f),f=n.IA(a,D);n.move_local(a,0,e-f,0);n.A(a);l.sync_transform(a)}else m.error("zoom_object(): wrong object")};a.set_ortho_scale=function(c,d){if(b.is_camera(c)&&a.is_ortho_camera(c)){var e=
c.c.g;if(b.is_target_camera(c)){var f=k.dist(e.i,e.Tb);e.Hh=d/2*e.Gh/f}else b.is_hover_camera(c)&&a.has_distance_limits(c)?(f=k.distance(e.i,e.ac),e.Hh=d/2*e.Gh/f):c.c.g.M[0].top=d/2;b.bD(c)}else m.error("set_ortho_scale(): wrong object")};a.get_ortho_scale=function(c){if(b.is_camera(c)&&a.is_ortho_camera(c))return 2*c.c.g.M[0].top;m.error("get_ortho_scale(): wrong object")};a.is_ortho_camera=function(a){if(b.is_camera(a))return a.c.g.M[0].type==b.Rc;m.error("is_ortho_camera(): wrong object")};a.calc_ray=
function(a,c,d,f){f||(f=new Float32Array(3));var h=a.c.g.M[0];switch(h.type){case b.Pb:case b.Vd:case b.Ab:case b.Gb:var l=Math.tan(h.Ac*Math.PI/360),n=l*h.Ea;c=e.Am(c,d,C,h);t[0]=(2*c[0]/h.width-1)*n;t[1]=-1;t[2]=(2*c[1]/h.height-1)*l;t[3]=0;r.transformMat4(t,a.c.g.Z,t);f[0]=t[0];f[1]=t[1];f[2]=t[2];k.normalize(f,f);return f;default:return m.error("Non-compatible camera"),f}};a.project_point=function(a,c,d){d||(d=new Float32Array(2));return b.project_point(a,c,d)}};b4w.module.config=function(a,p){var c=p("__config");a.P_LOW=c.P_LOW;a.P_HIGH=c.P_HIGH;a.P_ULTRA=c.P_ULTRA;a.P_CUSTOM=c.P_CUSTOM;a.set=c.set;a.get=c.get;a.reset=c.reset;a.get_std_assets_path=c.get_std_assets_path};b4w.module.controls=function(a,p){var c=p("__controls"),d=p("__print");a.CT_CONTINUOUS=c.CT_CONTINUOUS;a.CT_TRIGGER=c.CT_TRIGGER;a.CT_SHOT=c.CT_SHOT;a.CT_LEVEL=c.CT_LEVEL;a.CT_CHANGE=c.CT_CHANGE;a.KEY_BACKSPACE=8;a.KEY_TAB=9;a.KEY_ENTER=13;a.KEY_SHIFT=16;a.KEY_CTRL=17;a.KEY_ALT=18;a.KEY_PAUSE=19;a.KEY_CAPSLOCK=20;a.KEY_ESC=27;a.KEY_SPACE=32;a.KEY_LEFT=37;a.KEY_UP=38;a.KEY_RIGHT=39;a.KEY_DOWN=40;a.KEY_1=49;a.KEY_2=50;a.KEY_3=51;a.KEY_4=52;a.KEY_5=53;a.KEY_6=54;a.KEY_7=55;a.KEY_8=56;a.KEY_9=57;a.KEY_A=
65;a.KEY_B=66;a.KEY_C=67;a.KEY_D=68;a.KEY_E=69;a.KEY_F=70;a.KEY_G=71;a.KEY_H=72;a.KEY_I=73;a.KEY_J=74;a.KEY_K=75;a.KEY_L=76;a.KEY_M=77;a.KEY_N=78;a.KEY_O=79;a.KEY_P=80;a.KEY_Q=81;a.KEY_R=82;a.KEY_S=83;a.KEY_T=84;a.KEY_U=85;a.KEY_V=86;a.KEY_W=87;a.KEY_X=88;a.KEY_Y=89;a.KEY_Z=90;a.KEY_NUM0=96;a.KEY_NUM1=97;a.KEY_NUM2=98;a.KEY_NUM3=99;a.KEY_NUM4=100;a.KEY_NUM5=101;a.KEY_NUM6=102;a.KEY_NUM7=103;a.KEY_NUM8=104;a.KEY_NUM9=105;a.KEY_DEC_POINT=110;a.KEY_SEMI_COLON=186;a.KEY_EQUAL_SIGN=187;a.KEY_COMMA=188;
a.KEY_DASH=189;a.KEY_PERIOD=190;a.KEY_FORWARD_SLASH=191;a.KEY_GRAVE_ACCENT=192;a.KEY_LEFT_SQ_BRACKET=219;a.KEY_BACK_SLASH=220;a.KEY_RIGHT_SQ_BRACKET=221;a.KEY_SINGLE_QUOTE=222;a.PL_SINGLE_TOUCH_MOVE=c.PL_SINGLE_TOUCH_MOVE;a.PL_MULTITOUCH_MOVE_ZOOM=c.PL_MULTITOUCH_MOVE_ZOOM;a.PL_MULTITOUCH_MOVE_PAN=c.PL_MULTITOUCH_MOVE_PAN;a.create_custom_sensor=c.create_custom_sensor;a.create_keyboard_sensor=c.create_keyboard_sensor;a.create_collision_sensor=function(a,d,l){return c.create_collision_sensor(a,d||"ANY",
l||!1)};a.create_collision_impulse_sensor=c.create_collision_impulse_sensor;a.create_ray_sensor=function(a,d,l,m,h,n,f){return c.create_ray_sensor(a,d,l,m||"ANY",h||!1,n||!1,f||!1)};a.create_mouse_click_sensor=c.create_mouse_click_sensor;a.create_mouse_wheel_sensor=c.create_mouse_wheel_sensor;a.create_mouse_move_sensor=c.create_mouse_move_sensor;a.create_touch_move_sensor=c.create_touch_move_sensor;a.create_touch_zoom_sensor=c.create_touch_zoom_sensor;a.create_motion_sensor=c.create_motion_sensor;
a.create_vertical_velocity_sensor=c.create_vertical_velocity_sensor;a.create_gyro_angles_sensor=c.create_gyro_angles_sensor;a.create_gyro_delta_sensor=c.create_gyro_delta_sensor;a.create_timer_sensor=function(a,d){return c.create_timer_sensor(a,d||!1)};a.reset_timer_sensor=c.reset_timer_sensor;a.create_elapsed_sensor=c.create_elapsed_sensor;a.create_timeline_sensor=c.create_timeline_sensor;a.create_selection_sensor=function(a,d){return c.create_selection_sensor(a,d||!1)};a.set_custom_sensor=function(a,
d){c.zB(a,d)};a.get_custom_sensor=function(a){return a.value};a.get_sensor_value=c.get_sensor_value;a.get_sensor_payload=c.get_sensor_payload;a.create_sensor_manifold=function(a,d,l,m,h,n,f){h=h||c.Tq;c.create_sensor_manifold(a,d,l,m,h,n,void 0===f?null:f)};a.create_kb_sensor_manifold=function(a,d,l,m,h,n){m=c.create_keyboard_sensor(m);c.create_sensor_manifold(a,d,l,[m],c.Tq,h,void 0===n?null:n)};a.check_sensor_manifolds=function(a){return c.check_sensor_manifold(a,null)};a.check_sensor_manifold=
c.check_sensor_manifold;a.remove_sensor_manifolds=function(a){d.error("remove_sensor_manifolds() deprecated, use remove_sensor_manifold() instead");c.remove_sensor_manifold(a,null)};a.remove_sensor_manifold=c.remove_sensor_manifold;a.reset=c.reset;a.register_keyboard_events=c.register_keyboard_events;a.register_mouse_events=function(a,d,l){c.register_mouse_events(a,d,!!l)};a.register_wheel_events=c.register_wheel_events;a.register_touch_events=c.register_touch_events;a.register_device_orientation=
c.register_device_orientation;a.unregister_keyboard_events=c.unregister_keyboard_events;a.unregister_mouse_events=c.unregister_mouse_events;a.unregister_wheel_events=c.unregister_wheel_events;a.unregister_touch_events=c.unregister_touch_events;a.unregister_device_orientation=c.unregister_device_orientation};b4w.module.constraints=function(a,p){var c=p("__camera"),d=p("__constraints"),b=p("__physics"),e=p("__print"),l=p("__transform");a.append_stiff=function(a,c,e,f,k){k=k||1;c instanceof Array&&2==c.length?d.Tp(a,c[0],c[1],e,f,k):d.gm(a,c,e,f,k);l.A(a);b.sync_transform(a)};a.append_semi_stiff=function(a,c,e,f){d.fw(a,c,e,f);l.A(a);b.sync_transform(a)};a.append_semi_stiff_cam=function(a,h,n,f,k,r,p,w){if(!c.is_eye_camera(a))return e.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented."),
null;d.ew(a,h,n,f,k,r,p,w);l.A(a);b.sync_transform(a)};a.append_semi_soft_cam=function(a,h,n,f){if(!c.is_eye_camera(a))return e.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented."),null;if(!f||0>f)f=.25;d.dw(a,h,n,f);l.A(a);b.sync_transform(a)};a.append_stiff_trans=function(a,c,e){d.gw(a,c,e);l.A(a);b.sync_transform(a)};a.append_copy_trans=function(a,c,e){d.$v(a,c,e);l.A(a);b.sync_transform(a)};a.append_stiff_trans_rot=function(a,c,e,f){d.hw(a,c,e,f);l.A(a);
b.sync_transform(a)};a.append_track=function(a,c){3==c.length?d.kw(a,c):d.jw(a,c);l.A(a);b.sync_transform(a)};a.append_follow=function(a,c,e,f){3==c.length?d.bw(a,c,e,f):d.aw(a,c,e,f);l.A(a);b.sync_transform(a)};a.append_stiff_viewport=function(a,c,e){d.append_stiff_viewport(a,c,e);l.A(a);b.sync_transform(a)};a.remove=function(a){a.c.Pa&&d.remove(a)};a.get_parent=d.get_parent};b4w.module.container=function(a,p){var c=p("__container"),d=p("__print");a.get_canvas=c.get_canvas;a.get_container=c.get_container;a.insert_to_container=function(a,e){2!=arguments.length?d.error("insert_to_container(): two arguments required"):a&&e&&c.insert_to_container(a,e)};a.set_canvas_offsets=c.set_canvas_offsets;a.update_canvas_offsets=c.update_canvas_offsets;a.client_to_canvas_coords=c.client_to_canvas_coords;a.force_offsets_updating=c.force_offsets_updating};b4w.module.data=function(a,p){var c=p("__data");p("__print");p("__util");a.load=c.load;a.unload=function(a){c.unload(a|0)};a.set_debug_resources_root=c.set_debug_resources_root;a.is_primary_loaded=c.is_primary_loaded;a.load_and_add_new=c.load;a.cleanup=a.unload};b4w.module.debug=function(a,p){function c(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ /))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];break;default:a+=b[e]}b.ALU_OPS=a;b.TEX_OPS=c;return b}function d(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);
if(200==c.status)return c.responseText;throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.nn.ALU_OPS-a.nn.ALU_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.nn,g=c.CD,h=e(c.Wx),h=h?"\t\t("+h.join(", ")+")":"\t\t(NA)";f.groupCollapsed("FRAG --\x3e","ALU",d.ALU_OPS,"TEX",d.TEX_OPS,"\t\tVERT --\x3e","ALU",g.ALU_OPS,"TEX",g.TEX_OPS,h);f.groupCollapsed("directives");for(var h=c.Eb.$e,k=0;k<h.length;k++){var l=h[k];f.log(l[0],l[1])}f.groupEnd();f.groupCollapsed("vert src");
f.log(c.BD);f.groupEnd();f.groupCollapsed("vert stats");for(var m in g)"ALU_OPS"!=m&&"TEX_OPS"!=m&&f.log(m,g[m]);f.groupEnd();f.groupCollapsed("frag src");f.log(c.Oy);f.groupEnd();f.groupCollapsed("frag stats");for(m in d)"ALU_OPS"!=m&&"TEX_OPS"!=m&&f.log(m,d[m]);f.groupEnd();f.groupEnd()}}function e(a){for(var b=k.jj(),c=0;c<b.length;c++)for(var d=k.$a(b[c],"MESH",k.DATA_ID_ALL),e=0;e<d.length;e++){var f=d[e];if(f.c.p)for(var h=0;h<f.c.p.length;h++){var l=f.c.p[h];if(l.ec==a&&l.$c.length)return l.$c}}return null}
p("__batch");p("__config");var l=p("__controls"),m=p("__debug"),h=p("__extensions"),n=p("__physics"),f=p("__print"),k=p("__scenes"),r=p("__scenegraph"),y=p("__shaders"),w=p("__sfx"),C=p("__textures"),D=p("__util"),G=p("vec3");a.physics_stats=function(){n.cy()};a.physics_id=function(a){f.log("O",n.Gy(a));for(var b=n.cz().pb.s,c=0;c<b.length;c++){var d=b[c];d.q.L==a&&f.log("B",d)}};a.visible_objects=function(){for(var a=k.get_active(),b=k.$a(a,"MESH",k.DATA_ID_ALL),a=[k.da(a,"MAIN_OPAQUE"),k.da(a,"MAIN_BLEND")],
c=0;c<a.length;c++){var d=a[c],e=d.s;if(e.length){f.group(d.type,"DYNAMIC");for(var h=0;h<b.length;h++){var l=b[h],m=l.c.g;if("DYNAMIC"==m.type)for(var n=0;n<e.length;n++){var r=e[n];if(r.Wa&&r.pd==m){f.Zn(l.name,l);break}}}f.groupEnd();f.groupCollapsed(d.type,"STATIC");for(h=0;h<b.length;h++)if(l=b[h],m=l.c.g,"DYNAMIC"!=m.type)for(n=0;n<e.length;n++)if(r=e[n],r.Wa&&r.pd==m){f.Zn(l.name,l);break}f.groupEnd()}}};a.object_info=function(a){for(var b=k.get_active(),c=k.$a(b,"MESH",k.DATA_ID_ALL),d=0;d<
c.length;d++){var e=c[d];if(e.name==a){f.log("Object",e);for(var h=k.rn(b),l=0;l<h.length;l++){for(var m=h[l],n=m.s,r=[],p=0;p<n.length;p++)n[p].pd==e.c.g&&r.push(n[p]);f.log("Subscene "+m.type,r)}}}};a.objects_stat=function(){var a=k.get_active();console.log("Armatures: "+k.$a(a,"ARMATURE",k.DATA_ID_ALL).length);console.log("Cameras: "+k.$a(a,"CAMERA",k.DATA_ID_ALL).length);console.log("Curves: "+k.$a(a,"CURVE",k.DATA_ID_ALL).length);console.log("Empties: "+k.$a(a,"EMPTY",k.DATA_ID_ALL).length);
console.log("Lamps: "+k.$a(a,"LAMP",k.DATA_ID_ALL).length);console.log("Meshes: "+k.$a(a,"MESH",k.DATA_ID_ALL).length);console.log("Speakers: "+k.$a(a,"SPEAKER",k.DATA_ID_ALL).length)};a.num_vertices=function(){for(var a=0,b=k.get_active(),b=[k.da(b,"MAIN_OPAQUE"),k.da(b,"MAIN_BLEND")],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.s,e=0;e<d.length;e++){var f=d[e].D;f&&(a+=f.num_vertices)}}return a};a.num_triangles=function(){for(var a=0,b=k.get_active(),b=[k.da(b,"MAIN_OPAQUE"),k.da(b,"MAIN_BLEND")],
c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.s,e=0;e<d.length;e++){var f=d[e].D;f&&(a+=f.num_triangles)}}return a};a.num_draw_calls=function(){var a=k.get_active(),a=[k.da(a,"MAIN_OPAQUE"),k.da(a,"MAIN_BLEND")];return a[0].s.length+a[1].s.length};a.num_shaders=function(){return D.Ed(y.rr())};a.geometry_stats=function(){for(var a=k.get_active(),b=k.rn(a),a={},c=0;c<b.length;c++){var d=b[c];if("SINK"!=d.type&&"WIREFRAME"!=d.type)for(var e=d.s,f=0;f<e.length;f++){var h=e[f].D,l=e[f].pd;h&&("COLOR_PICKING"!=
d.type&&"OUTLINE_MASK"!=d.type||l.ll||l.kl)&&(a[h.id]=h)}}var e=d=c=b=0,m;for(m in a)h=a[m],h=h.P,h.Ek&&(d++,e+=h.Ek/1048576),b++,c+=h.Sq/1048576;return{vbo_number:b,vbo_memory:c,ibo_number:d,ibo_memory:e}};a.num_textures=function(){for(var a=[],b=0,c=k.get_active(),c=[k.da(c,"MAIN_OPAQUE"),k.da(c,"MAIN_BLEND")],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.s,f=0;f<e.length;f++){var h=e[f].D;if(h)for(var h=h.S,l=0;l<h.length;l++){var m=h[l];if("IMAGE"===m.source||"ENVIRONMENT_MAP"===m.source){var n=
m.fb;-1===a.indexOf(n)&&(a.push(n),m=m.width*m.height*4/1048576/m.Jm,m*=1.3333,b+=m)}}}}return{number:a.length,memory:b}};a.num_render_targets=function(){for(var a=[],b=0,c=k.get_active(),c=k.rn(c),d=0;d<c.length;d++){var e=c[d];if("SINK"!=e.type){var f=e.k,h=[f.nb,f.Vc];h.push.apply(h,e.Nd);for(e=0;e<h.length;e++){var l=h[e];C.sj(l)&&-1==a.indexOf(l)&&(a.push(l),b+=f.width*f.height*C.Bz(l))}}}return{number:a.length,memory:b/1024/1024}};a.make_camera_frustum_shot=function(){var a=k.get_active();(a=
k.da(a,"MAIN_OPAQUE"))&&k.ls(a.k,a,[1,1,0])};a.make_light_frustum_shot=function(){var a=k.get_active(),b=k.da(a,"MAIN_OPAQUE"),a=k.yC(a,["SHADOW_CAST"]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=[1,0,1]}k.ls(d.k,b,e)}};a.scenegraph_to_dot=function(){for(var a=k.jj(),b=0;b<a.length;b++)f.log("\n"+r.ay(k.tn(a[b])))};a.scenes_to_dot=function(){};a.controls_info=l.debug;a.object_distance=function(a,b){return G.dist(a.c.g.i,
b.c.g.i)};a.msg=m.msg;a.fbmsg=m.fbmsg;a.print_telemetry=m.print_telemetry;a.plot_telemetry=m.plot_telemetry;a.fbres=function(a,b){function c(){m.fbmsg("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.assert_constants=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),h=new Float32Array([0,-1,0]),k=new Float32Array([0,0,-1]);if(!D.We(a,D.Lv))throw"Wrong VEC3_IDENT";if(!D.We(b,
D.Fv))throw"Wrong QUAT4_IDENT";if(!D.We(c,D.AXIS_X))throw"Wrong AXIS_X";if(!D.We(d,D.AXIS_Y))throw"Wrong AXIS_Y";if(!D.We(e,D.AXIS_Z))throw"Wrong AXIS_Z";if(!D.We(f,D.AXIS_MX))throw"Wrong AXIS_MX";if(!D.We(h,D.AXIS_MY))throw"Wrong AXIS_MY";if(!D.We(k,D.AXIS_MZ))throw"Wrong AXIS_MZ";};a.mute_music=function(){for(var a=w.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==w.wn(c)&&w.mute(c,!0)}};a.check_finite=function(a){m.check_finite(a)};a.set_debug_params=function(a){var b=
k.get_active();if(b=k.da(b,"WIREFRAME"))"string"==typeof a.wireframe_mode&&k.SB(b,a.wireframe_mode),"object"==typeof a.wireframe_edge_color&&k.RB(b,a.wireframe_edge_color);else throw"Wireframe subscene not found.";};a.get_error_quantity=function(){return f.pz()};a.get_warning_quantity=function(){return f.Gz()};a.clear_errors_warnings=function(){return f.clear_errors_warnings()};a.analyze_shaders=function(a){var e=y.rr(),k=0,l;for(l in e)a&&-1===l.indexOf(a)||k++;var k="of "+k+" analyzing...",g={};
for(l in e)if(!a||-1!==l.indexOf(a)){var m=e[l],n;var r=m.qp;n=m.jr;var p=h.sr();if(p){r=p.getTranslatedShaderSource(r);n=p.getTranslatedShaderSource(n);var p=d("/nvidia_vert",r),w=c(p),C=d("/nvidia_frag",n),D=c(C);n={BD:r,dG:p,CD:w,Oy:n,TE:C,nn:D}}else f.error("WEBGL_debug_shaders not found (run Chrome with --enable-privileged-webgl-extensions)"),n=void 0;p=m.Eb;r=p.Vj+" + "+p.ej;n.Wx=m;n.Eb=p;m=g[r]=g[r]||[];m.push(n);f.log(k)}for(r in g)f.group("%c"+r,"color: #800"),m=g[r],b(m),f.groupEnd()}};b4w.module.geometry=function(a,p){var c=p("__batch"),d=p("__geometry"),b=p("__print"),e=p("__renderer");a.extract_vertex_array=function(a,e,h){if(!d.Dh(a))return b.error("Wrong object:",a.name),null;if(a=c.qa(a,e,"MAIN")){if((e=a.P)&&e.Mb&&e.Mb[h])return d.zy(e,h);b.error("Attribute not found:"+h);return null}b.error("Wrong material:",e);return null};a.extract_index_array=function(a,e){if(!d.Dh(a))return b.error("Wrong object:",a.name),null;var h=c.qa(a,e,"MAIN");if(h){if((h=h.P)&&h.Mb)return h.gf;
b.error("Buffer data not found");return null}b.error("Wrong material:",e);return null};a.update_vertex_array=function(a,e,h,n){var f=["MAIN","DEPTH","COLOR_ID"];if(d.Dh(a))for(var k=0;k<f.length;k++){var r=c.qa(a,e,f[k]);r&&(r=r.P)&&r.Mb&&r.Mb[h]&&d.Ml(r,h,0,n)}else b.error("Wrong object:",a.name)};a.override_geometry=function(a,m,h,n,f){var k=["MAIN","DEPTH","COLOR_ID"];if(d.Dh(a))if(h instanceof Uint16Array||h instanceof Uint32Array)if(n instanceof Float32Array)for(var r=0;r<k.length;r++){var p=
c.qa(a,m,k[r]);if(p){var w=p.P;if(w){d.SC(w,p.le,h);var C=0,D;for(D in w.Mb)var G=w.Mb[D],C=C+n.length/3*G.Hd;w.Pc=new Float32Array(C);var C=w.Pc,t=0;for(D in w.Mb)switch(G=w.Mb[D],D){case "a_position":C.set(n,t);G.offset=t;G.length=n.length;t+=G.length;break;case "a_normal":var A;f&&(A=d.nq(h,n,n));var x=d.lq(h,n,A);C.set(x,t);G.offset=t;G.length=n.length;t+=G.length;break;case "a_tangent":G.offset=t;G.length=n.length/3*G.Hd;for(var x=new Float32Array(G.length),u=0;u<x.length;u+=4)x[u]=1,x[u+3]=
1;C.set(x,t);t+=G.length;break;default:G.offset=t,G.length=n.length/3*G.Hd,x=new Float32Array(G.length),C.set(x,t),t+=G.length}d.$t(w);e.Vp(p);(p=c.zc(a,p))&&p.P&&(p.P=w)}}}else b.error("Wrong positions_array type");else b.error("Wrong ibo_array type");else b.error("Wrong object:",a.name)};a.set_shape_key_value=function(a,c,e){if(!d.check_shape_keys(a))return b.error("Wrong object:",a.name),null;if(!d.Nr(a,c))return b.error("Wrong key name:",c),null;d.qw(a,c,parseFloat(e))};a.check_shape_keys=function(a){return d.check_shape_keys(a)};
a.get_shape_keys_names=function(a){return d.check_shape_keys(a)?d.get_shape_keys_names(a):(b.error("Wrong object:",a.name),null)};a.get_shape_key_value=function(a,c){return d.check_shape_keys(a)?d.Nr(a,c)?d.get_shape_key_value(a,c):(b.error("Wrong key name:",c),null):(b.error("Wrong object:",a.name),null)}};b4w.module.hud=function(a,p){var c=p("__hud");p("__print");a.draw_mixer_strip=c.draw_mixer_strip;a.plot_array=c.plot_array};b4w.module.lights=function(a,p){function c(a){for(var c=l.get_active(),d=l.$a(c,"LAMP",l.DATA_ID_ALL),k=0;k<d.length;k++){var r=d[k];if("SUN"==r.c.wa.type){var p=r;break}}if(!p)return b.error("There is no sun on the scene"),null;"number"==typeof a.hor_position&&"number"==typeof a.vert_position&&(d=(90-a.vert_position)/180*Math.PI,k=p.c.g,m.set_rotation_euler(p,[d,(180-a.hor_position)/180*Math.PI,0]),a=new Float32Array(3),h.quat_to_dir(k.quat,h.AXIS_Y,a),k=n.length(k.i),n.copy(a,f),n.scale(f,k,f),
m.set_translation(p,f),m.A(p),a=p.c.wa,a.Xq&&(r=p.data.energy,k=c.world.light_settings.environment_energy,d=Math.cos(Math.abs(d)),r*=Math.max(Math.min(3*d,1),0),d=Math.max(d,.1)*k,e.it(a,r),l.set_environment_colors(c,d,null,null)),l.Yg(p,c))}function d(a){if(e.al(a))return a.c.wa.type;b.error("get_light_type(): Wrong object");return!1}var b=p("__print"),e=p("__lights"),l=p("__scenes");p("__batch");var m=p("__transform"),h=p("__util"),n=p("vec3"),f=new Float32Array(3),k,r=60;a.get_lamps=function(a){var b=
l.get_active(),b=l.$a(b,"LAMP",l.DATA_ID_ALL);if(!a)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.c.wa.type===a&&c.push(e)}return c};a.get_sun_params=function(){for(var a=l.get_active(),a=l.$a(a,"LAMP",l.DATA_ID_ALL),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.c.wa.type){b=d;break}}return b?(b=b.c.wa.direction,a=180*Math.atan2(b[2],b[0])/Math.PI+90,180<a&&(a-=360),b=180*Math.atan2(b[1],Math.sqrt(b[0]*b[0]+b[2]*b[2]))/Math.PI,c={},c.hor_position=a,c.vert_position=b,c):null};a.set_sun_params=
c;a.set_day_time=function(a){for(var d=l.get_active(),d=l.$a(d,"LAMP",l.DATA_ID_ALL),e=0;e<d.length;e++){var f=d[e];if("SUN"==f.c.wa.type){var h=f;break}}if(!h)return b.error("There is no sun on the scene"),null;h=-Math.cos(a/12*Math.PI)*r;d={};d.hor_position=12>a?15*a:15*(a-24);d.vert_position=h;c(d)};a.set_date=function(a){(k=a.getDate())?1582==k&&10==a.FF&&4<a.$x&&15>a.$x&&b.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):b.error("There is no year 0 in the Julian system!")};
a.set_max_sun_angle=function(a){r=Math.min(Math.max(a,0),90)};a.get_light_params=function(a){if(e.al(a))var c=a.c.wa;else return b.error("get_light_params(): Wrong object"),!1;if(a=d(a))switch(a){case "SPOT":var f={light_type:a,light_color:c.color,light_energy:c.af,light_spot_blend:c.Wg,light_spot_size:c.ud,light_distance:c.distance};break;case "POINT":f={light_type:a,light_color:c.color,light_energy:c.af,light_distance:c.distance};break;default:f={light_type:a,light_color:c.color,light_energy:c.af}}return f?
f:!1};a.get_light_type=d;a.set_light_params=function(a,c){if(e.al(a))var d=a.c.wa;else return b.error("set_light_params(): Wrong object"),!1;var f=l.get_active();"number"==typeof c.light_energy&&(e.it(d,c.light_energy),l.Yg(a,f));"object"==typeof c.light_color&&(e.FB(d,c.light_color),l.Yg(a,f));"number"==typeof c.light_spot_blend&&(e.HB(d,c.light_spot_blend),l.Yg(a,f));"number"==typeof c.light_spot_size&&(e.IB(d,c.light_spot_size),l.Yg(a,f));"number"==typeof c.light_distance&&(e.GB(d,c.light_distance),
l.Yg(a,f));l.LC()}};b4w.module.material=function(a,p){function c(a,b){for(var c=a.c.p,d=0;d<c.length;d++){var e=c[d];if(-1<e.$c.indexOf(b))return"MAIN"==e.type}return!1}function d(a,b){var c=e.qa(a,b,"MAIN");return Boolean(c&&c.qc[0])}function b(a,b){var c=e.qa(a,b,"MAIN");return Boolean(c&&c.qc[1])}var e=p("__batch"),l=p("__config"),m=p("__print"),h=p("__obj_util"),n=p("__shaders");p("__util");p("vec4");var f=l.r,k="u_colormap0 u_colormap1 u_stencil0 u_specmap u_normalmap0 u_mirrormap".split(" ");a.inherit_material=
function(a,b,c,d){if(h.oj(c)&&h.oj(a)){for(var f=["MAIN","DEPTH","COLOR_ID"],l=!1,n=0;n<f.length;n++){var p=f[n],x=e.qa(a,b,p),u=e.qa(c,d,p);if(x&&u){var l=!0,g=e.zc(c,d,p);"MAIN"==p&&(e.jt(u,x),g&&e.jt(g,x));for(p=0;p<u.Nb.length;p++){var q=u.Nb[p];if(-1!==k.indexOf(q)){var L=x.Nb.indexOf(q);-1!==L&&(u.S[p]=x.S[L],g&&(q=g.Nb.indexOf(q),-1!==q&&(g.S[q]=x.S[L])))}}}}l||m.error("Wrong objects for inheriting material!")}else m.error("Wrong or batched object(s)")};a.get_materials_names=function(a){var b=
[];a=a.c.p;for(var c=0;c<a.length;c++)for(var d=0;d<a[c].$c.length;d++)-1==b.indexOf(a[c].$c[d])&&b.push(a[c].$c[d]);return b};a.set_diffuse_color=function(a,b,c){var d=e.qa(a,b,"MAIN");d?(d.Wc.set(c),(a=e.zc(a,b,"MAIN"))&&a.Wc.set(c)):m.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_color=function(a,b){var c=e.qa(a,b,"MAIN");if(c){var d=new Float32Array(4);d.set(c.Wc);return d}m.error('Couldn\'t get property "diffuse_color"!')};a.set_diffuse_intensity=function(a,b,c){var d=e.qa(a,
b,"MAIN");if(d){if(d.Ze=c,a=e.zc(a,b,"MAIN"))a.Ze=c}else m.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_intensity=function(a,b){var c=e.qa(a,b,"MAIN");if(c)return c.Ze;m.error('Couldn\'t get property "diffuse_intensity"!')};a.set_specular_color=function(a,b,c){var d=e.qa(a,b,"MAIN");d?(d.Kd.set(c),(a=e.zc(a,b,"MAIN"))&&a.Kd.set(c)):m.error('Couldn\'t set property "specular_color"!')};a.get_specular_color=function(a,b){var c=e.qa(a,b,"MAIN");if(c){var d=Array(3);d[0]=c.Kd[0];d[1]=
c.Kd[1];d[2]=c.Kd[2];return d}m.error('Couldn\'t get property "specular_color"!')};a.set_specular_intensity=function(a,b,c){d(a,b)||m.error('Property "specular_intensity" is missing!');e.qa(a,b,"MAIN").qc[0]=c;(a=e.zc(a,b,"MAIN"))&&(a.qc[0]=c)};a.get_specular_intensity=function(a,b){d(a,b)||m.error('Property "specular_intensity" is missing!');return e.qa(a,b,"MAIN").qc[0]};a.check_specular_intensity=d;a.set_specular_hardness=function(a,c,d){b(a,c)||m.error('Property "specular_hardness" is missing!');
e.qa(a,c,"MAIN").qc[1]=d;(a=e.zc(a,c,"MAIN"))&&(a.qc[1]=d)};a.get_specular_hardness=function(a,c){b(a,c)||m.error('Property "specular_hardness" is missing!');return e.qa(a,c,"MAIN").qc[1]};a.check_specular_hardness=b;a.set_emit_factor=function(a,b,c){var d=e.qa(a,b,"MAIN");if(d){if(d.me=c,a=e.zc(a,b,"MAIN"))a.me=c}else m.error('Couldn\'t set property "emit_factor"!')};a.get_emit_factor=function(a,b){var c=e.qa(a,b,"MAIN");if(c)return c.me;m.error('Couldn\'t get property "emit_factor"!')};a.set_ambient_factor=
function(a,b,c){var d=e.qa(a,b,"MAIN");if(d){if(d.Yd=c,a=e.zc(a,b,"MAIN"))a.Yd=c}else m.error('Couldn\'t set property "ambient_factor"!')};a.get_ambient_factor=function(a,b){var c=e.qa(a,b,"MAIN");if(c)return c.Yd;m.error('Couldn\'t get property "ambient_factor"!')};a.set_diffuse_color_factor=function(a,b,c){var d=e.qa(a,b,"MAIN");if(d){if(d.Ye=c,a=e.zc(a,b,"MAIN"))a.Ye=c}else m.error('Couldn\'t set property "diffuse_color_factor"!')};a.get_diffuse_color_factor=function(a,b){var c=e.qa(a,b,"MAIN");
if(c)return c.Ye;m.error('Couldn\'t get property "diffuse_color_factor"!')};a.set_alpha_factor=function(a,b,c){var d=e.qa(a,b,"MAIN");if(d){if(d.Ne=c,a=e.zc(a,b,"MAIN"))a.Ne=c}else m.error('Couldn\'t set property "alpha_factor"!')};a.get_alpha_factor=function(a,b){var c=e.qa(a,b,"MAIN");if(c)return c.Ne;m.error('Couldn\'t get property "alpha_factor"!')};a.get_material_extended_params=function(a,b){if(!a||!b)return m.error("missing arguments in get_material_params"),null;if(!c(a,b))return null;var d=
e.qa(a,b,"MAIN");if(!d)return null;var f={};"MAIN"==d.type&&(f.reflect_factor=d.reflect_factor,f.fresnel=d.nd[2],f.fresnel_factor=5*(1-d.nd[3]),f.parallax_scale=d.parallax_scale,f.parallax_steps=e.Cb(d,"PARALLAX_STEPS")[1]);return f};a.get_water_material_params=function(a,b){if(!a||!b)return m.error("missing arguments in get_water_material_params"),null;if(!c(a,b))return null;var d=e.qa(a,b,"MAIN");if(!d||!d.Lf)return null;if(!d)return m.error("material not found"),null;var h={};if("MAIN"==d.type){if(f.di){var k=
h.shallow_water_col=Array(3);k[0]=d.shallow_water_col[0];k[1]=d.shallow_water_col[1];k[2]=d.shallow_water_col[2];k=h.shore_water_col=Array(3);k[0]=d.shore_water_col[0];k[1]=d.shore_water_col[1];k[2]=d.shore_water_col[2];h.shallow_water_col_fac=d.shallow_water_col_fac;h.shore_water_col_fac=d.shore_water_col_fac}h.foam_factor=d.foam_factor;h.norm_uv_velocity=d.zi;h.absorb_factor=e.Cb(d,"ABSORB")[1];h.sss_strength=e.Cb(d,"SSS_STRENGTH")[1];h.sss_width=e.Cb(d,"SSS_WIDTH")[1];h.dst_noise_scale0=e.Cb(d,
"DST_NOISE_SCALE_0")[1];h.dst_noise_scale1=e.Cb(d,"DST_NOISE_SCALE_1")[1];h.dst_noise_freq0=e.Cb(d,"DST_NOISE_FREQ_0")[1];h.dst_noise_freq1=e.Cb(d,"DST_NOISE_FREQ_1")[1];h.dir_min_shore_fac=e.Cb(d,"DIR_MIN_SHR_FAC")[1];h.dir_freq=e.Cb(d,"DIR_FREQ")[1];h.dir_noise_scale=e.Cb(d,"DIR_NOISE_SCALE")[1];h.dir_noise_freq=e.Cb(d,"DIR_NOISE_FREQ")[1];h.dir_min_noise_fac=e.Cb(d,"DIR_MIN_NOISE_FAC")[1];h.dst_min_fac=e.Cb(d,"DST_MIN_FAC")[1];h.waves_hor_fac=e.Cb(d,"WAVES_HOR_FAC")[1]}return h};a.set_material_extended_params=
function(a,b,d){if(a&&b&&d){if(!c(a,b))return m.error("setting material params is not possible"),null;var f=e.qa(a,b,"MAIN");if(f){var h=[f];(f=e.zc(a,b,"MAIN"))&&h.push(f);for(a=0;a<h.length;a++)f=h[a],"number"==typeof d.material_reflectivity&&(f.reflect_factor=d.material_reflectivity),"number"==typeof d.material_fresnel&&(f.nd[2]=d.material_fresnel),"number"==typeof d.material_fresnel_factor&&(f.nd[3]=1-d.material_fresnel_factor/5),"number"==typeof d.material_parallax_scale&&(f.parallax_scale=d.material_parallax_scale),
"number"==typeof d.material_parallax_steps&&(b=n.v(parseFloat(d.material_parallax_steps)),e.ta(f,"PARALLAX_STEPS",b),e.ob(f,!0))}else m.error("material not found")}else m.error("missing arguments in set_material_params")};a.set_water_material_params=function(a,b,d){if(!a||!b||!d)return m.error("missing arguments in set_water_material_params"),null;if(!c(a,b))return m.error("setting water material params is not possible"),null;var h=e.qa(a,b,"MAIN");if(!h)return m.error("material not found"),null;
var k=[h];(h=e.zc(a,b,"MAIN"))&&k.push(h);for(a=0;a<k.length;a++)h=k[a],f.di&&("object"==typeof d.shallow_water_col&&h.shallow_water_col.set(d.shallow_water_col),"number"==typeof d.shallow_water_col_fac&&(h.shallow_water_col_fac=d.shallow_water_col_fac),"object"==typeof d.shore_water_col&&h.shore_water_col.set(d.shore_water_col),"number"==typeof d.shore_water_col_fac&&(h.shore_water_col_fac=d.shore_water_col_fac)),f.shore_smoothing&&h.Sl&&("boolean"==typeof d.shore_smoothing&&(d.shore_smoothing?e.ta(h,
"SHORE_SMOOTHING",1):e.ta(h,"SHORE_SMOOTHING",0)),"number"==typeof d.absorb_factor&&(b=n.v(parseFloat(d.absorb_factor)),e.ta(h,"ABSORB",b))),"number"==typeof d.foam_factor&&f.zh&&(h.foam_factor=d.foam_factor),"number"==typeof d.norm_uv_velocity&&(h.zi=d.norm_uv_velocity),f.water_dynamic&&h.water_dynamic&&("boolean"==typeof d.water_dynamic&&(d.water_dynamic?e.ta(h,"DYNAMIC",1):e.ta(h,"DYNAMIC",0)),"number"==typeof d.waves_height&&(b=n.v(parseFloat(d.waves_height)),e.ta(h,"WAVES_HEIGHT",b)),"number"==
typeof d.waves_length&&(b=n.v(parseFloat(d.waves_length)),e.ta(h,"WAVES_LENGTH",b)),"number"==typeof d.sss_strength&&(b=n.v(parseFloat(d.sss_strength)),e.ta(h,"SSS_STRENGTH",b)),"number"==typeof d.sss_width&&(b=n.v(parseFloat(d.sss_width)),e.ta(h,"SSS_WIDTH",b)),"number"==typeof d.dst_noise_scale0&&(b=n.v(parseFloat(d.dst_noise_scale0)),e.ta(h,"DST_NOISE_SCALE_0",b)),"number"==typeof d.dst_noise_scale1&&(b=n.v(parseFloat(d.dst_noise_scale1)),e.ta(h,"DST_NOISE_SCALE_1",b)),"number"==typeof d.dst_noise_freq0&&
(b=n.v(parseFloat(d.dst_noise_freq0)),e.ta(h,"DST_NOISE_FREQ_0",b)),"number"==typeof d.dst_noise_freq1&&(b=n.v(parseFloat(d.dst_noise_freq1)),e.ta(h,"DST_NOISE_FREQ_1",b)),"number"==typeof d.dir_min_shore_fac&&(b=n.v(parseFloat(d.dir_min_shore_fac)),e.ta(h,"DIR_MIN_SHR_FAC",b)),"number"==typeof d.dir_freq&&(b=n.v(parseFloat(d.dir_freq)),e.ta(h,"DIR_FREQ",b)),"number"==typeof d.dir_noise_scale&&(b=n.v(parseFloat(d.dir_noise_scale)),e.ta(h,"DIR_NOISE_SCALE",b)),"number"==typeof d.dir_noise_freq&&(b=
n.v(parseFloat(d.dir_noise_freq)),e.ta(h,"DIR_NOISE_FREQ",b)),"number"==typeof d.dir_min_noise_fac&&(b=n.v(parseFloat(d.dir_min_noise_fac)),e.ta(h,"DIR_MIN_NOISE_FAC",b)),"number"==typeof d.dst_min_fac&&(b=n.v(parseFloat(d.dst_min_fac)),e.ta(h,"DST_MIN_FAC",b)),"number"==typeof d.waves_hor_fac&&(b=n.v(parseFloat(d.waves_hor_fac)),e.ta(h,"WAVES_HOR_FAC",b))),e.ob(h,!0);return!0}};b4w.module.particles=function(a,p){var c=p("__particles"),d=p("__print");a.set_size=function(a,e,l){c.Vh(a)?c.set_size(a,e,l):d.error('"',a.name,'" has no particle systems')};a.set_normal_factor=function(a,e,l){c.Vh(a)?c.set_normal_factor(a,e,l):d.error('"',a.name,'" has no particle systems')};a.set_factor=function(a,e,l){c.Vh(a)?(l=Math.min(l,1),l=Math.max(l,0),c.set_factor(a,e,l)):d.error('"',a.name,'" has no particle systems')}};b4w.module.physics=function(a,p){var c=p("__physics"),d=p("__print"),b=p("__util");a.CM_WALK=0;a.CM_RUN=1;a.CM_CLIMB=2;a.CM_FLY=3;a.enable_simulation=function(a){c.K(a)?c.enable_simulation(a):d.error("No physics for object "+a.name)};a.disable_simulation=function(a){c.K(a)?c.disable_simulation(a):d.error("No physics for object "+a.name)};a.has_physics=function(a){return c.K(a)};a.has_simulated_physics=function(a){return c.has_simulated_physics(a)};a.has_dynamic_physics=function(a){return c.has_dynamic_physics(a)};
a.set_gravity=function(a,b){c.K(a)?c.set_gravity(a,b):d.error("No physics for object "+a.name)};a.set_damping=function(a,b,m){c.K(a)?c.B("set_damping",a.c.q.L,b,m):d.error("No physics for object "+a.name)};a.reset_damping=function(a){if(c.K(a)){var b=a.game;c.B("set_damping",a.c.q.L,b.damping,b.rotation_damping)}else d.error("No physics for object "+a.name)};a.set_transform=function(a,b,m){c.K(a)?c.set_transform.apply(this,arguments):d.error("No physics for object "+a.name)};a.sync_transform=function(a){c.K(a)?
c.sync_transform(a):d.error("No physics for object "+a.name)};a.apply_velocity=function(a){c.K(a)?c.apply_velocity.apply(this,arguments):d.error("No physics for object "+a.name)};a.apply_velocity_world=function(a){c.K(a)?c.apply_velocity_world.apply(this,arguments):d.error("No physics for object "+a.name)};a.apply_force=function(a,b,m,h){c.K(a)?c.apply_force.apply(this,arguments):d.error("No physics for object "+a.name)};a.apply_torque=function(a,b,m,h){c.K(a)?c.apply_torque.apply(this,arguments):
d.error("No physics for object "+a.name)};a.vehicle_throttle=function(a,l){c.K(a)?(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||d.error("Wrong object"),c.vehicle_throttle(a,b.clamp(l,-1,1))):d.error("No physics for object "+a.name)};a.vehicle_throttle_inc=function(a,l,m){if(c.K(a)){c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||d.error("Wrong object");l=b.clamp(l,0,1);var h=a.c.m.wh;-1==m||1==m?h=Math.max(-1,Math.min(h+m*l,1)):0==m&&0<=h?(h-=l,h=Math.max(0,h)):0==m&&0>h?(h+=l,h=Math.min(0,h)):d.error("Wrong steering direction");
c.vehicle_throttle(a,b.clamp(h,-1,1))}else d.error("No physics for object "+a.name)};a.vehicle_steer=function(a,l){c.K(a)?(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||d.error("Wrong object"),c.vehicle_steer(a,b.clamp(l,-1,1))):d.error("No physics for object "+a.name)};a.vehicle_steer_inc=function(a,l,m){if(c.K(a)){c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||d.error("Wrong object");l=b.clamp(l,0,1);var h=a.c.m.ji;-1==m||1==m?h=Math.max(-1,Math.min(h+m*l,1)):0==m&&0<=h?(h-=l,h=Math.max(0,h)):
0==m&&0>h?(h+=l,h=Math.min(0,h)):d.error("Wrong steering direction");c.vehicle_steer(a,b.clamp(h,-1,1))}else d.error("No physics for object "+a.name)};a.vehicle_brake=function(a,l){c.K(a)?(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||d.error("Wrong object"),c.vehicle_brake(a,b.clamp(l,0,1))):d.error("No physics for object "+a.name)};a.vehicle_brake_inc=function(a,l){if(c.K(a)){c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||d.error("Wrong object");l=b.clamp(l,-1,1);var m=a.c.m.Ki;c.vehicle_brake(a,
b.clamp(m+m*l,0,1))}else d.error("No physics for object "+a.name)};a.is_vehicle_chassis=function(a){return c.is_vehicle_chassis(a)};a.is_vehicle_hull=function(a){return c.is_vehicle_hull(a)};a.get_vehicle_name=function(a){if(!c.K(a))return d.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return a.c.rc.name;d.error("Wrong object");return null};a.get_vehicle_throttle=function(a){if(!c.K(a))return d.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||
c.is_vehicle_hull(a))return a.c.m.wh;d.error("Wrong object")};a.get_vehicle_steering=function(a){if(!c.K(a))return d.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return a.c.m.ji;d.error("Wrong object")};a.get_vehicle_brake=function(a){if(!c.K(a))return d.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return a.c.m.Ki;d.error("Wrong object")};a.get_vehicle_speed=function(a){if(!c.K(a))return d.error("No physics for object "+
a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return c.get_vehicle_speed(a);d.error("Wrong object")};a.is_character=function(a){return c.is_character(a)};a.set_character_move_dir=function(a,b,m){c.K(a)?c.set_character_move_dir(a,b,m):d.error("No physics for object "+a.name)};a.set_character_move_type=function(a,b){c.K(a)?c.set_character_move_type(a,b):d.error("No physics for object "+a.name)};a.set_character_walk_velocity=function(a,b){c.K(a)?c.set_character_walk_velocity(a,b):d.error("No physics for object "+
a.name)};a.set_character_run_velocity=function(a,b){c.K(a)?c.set_character_run_velocity(a,b):d.error("No physics for object "+a.name)};a.set_character_fly_velocity=function(a,b){c.K(a)?c.set_character_fly_velocity(a,b):d.error("No physics for object "+a.name)};a.character_jump=function(a){c.K(a)?c.character_jump(a):d.error("No physics for object "+a.name)};a.character_rotation_inc=function(a,b,m){c.K(a)?c.character_rotation_inc(a,b,m):d.error("No physics for object "+a.name)};a.set_character_rotation_quat=
function(a,b){c.K(a)?c.set_character_rotation_quat(a,b):d.error("No physics for object "+a.name)};a.set_character_rotation=function(a,b,m){c.K(a)?c.set_character_rotation(a,b,m):d.error("No physics for object "+a.name)};a.set_character_rotation_v=function(a,b){c.K(a)?c.set_character_rotation_v(a,b):d.error("No physics for object "+a.name)};a.set_character_rotation_h=function(a,b){c.K(a)?c.set_character_rotation_h(a,b):d.error("No physics for object "+a.name)};a.append_collision_test=function(a,b,
m,h){c.K(a)?c.append_collision_test(a,b,m,h||!1):d.error("No physics for object "+a.name)};a.remove_collision_test=function(a,b,m){c.K(a)?c.remove_collision_test(a,b||"ANY",m):d.error("No physics for object "+a.name)};a.apply_collision_impulse_test=function(a,b){c.K(a)?c.apply_collision_impulse_test(a,b):d.error("No physics for object "+a.name)};a.clear_collision_impulse_test=function(a){c.K(a)?c.clear_collision_impulse_test(a):d.error("No physics for object "+a.name)};a.append_ray_test=function(a,
b,d,h,n,f){return c.append_ray_test(a,b,d,h,n,f||!1,!1,!1,!1)};a.append_ray_test_ext=function(a,b,d,h,n,f,k,p,y){return c.append_ray_test(a,b,d,h,n,f||!1,k||!1,p||!1,y||!1)};a.remove_ray_test=function(a){c.Wr(a)?c.remove_ray_test(a):d.error("Wrong ray test ID")};a.change_ray_test_from_to=function(a,b,m){c.Wr(a)?c.change_ray_test_from_to(a,b,m):d.error("Wrong ray test ID")};a.apply_constraint=function(a,b,m,h,n,f,k,p,y,w){c.K(b)&&c.K(n)?c.apply_constraint(a,b,m,h,n,f,k,p,y,w):d.error("Wrong objects")};
a.clear_constraint=function(a){c.K(a)&&c.Mz(a)?c.clear_constraint(a):d.error("Wrong object")};a.pull_to_constraint_pivot=function(a,b,m,h,n,f){c.K(a)&&c.K(h)?c.pull_to_constraint_pivot(a,b,m,h,n,f):d.error("Wrong objects")}};b4w.module.rgb=function(a,p){p("__print");var c=p("__util"),d=new Float32Array(3);a.create=function(){return new Float32Array(3)};a.from_values=function(a,c,d){var m=new Float32Array(3);m[0]=a;m[1]=c;m[2]=d;return m};a.set=function(a,c,d,m){m[0]=a;m[1]=c;m[2]=d;return m};a.css_to_rgb=function(a,d,l,m){m=m||new Float32Array(3);m[0]=a/255;m[1]=d/255;m[2]=l/255;c.Ft(m,m);return m};a.rgb_to_css=function(a){a=c.Vn(a,d);return[Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])]};a.rgb_to_css_hex=
function(a){function e(a){a=Math.round(255*a).toString(16);return 1==a.length?"0"+a:a}a=c.Vn(a,d);return"#"+e(a[0])+e(a[1])+e(a[2])}};
b4w.module.rgba=function(a,p){p("__print");var c=p("__util"),d=new Float32Array(3);a.create=function(){var a=new Float32Array(4);a[3]=1;return a};a.from_values=function(a,c,d,m){var h=new Float32Array(4);h[0]=a;h[1]=c;h[2]=d;h[3]=m;return h};a.set=function(a,c,d,m,h){h[0]=a;h[1]=c;h[2]=d;h[3]=m;return h};a.css_to_rgba=function(a,d,l,m,h){h=h||new Float32Array(4);h[0]=a/255;h[1]=d/255;h[2]=l/255;h[3]=m;c.Ft(h,h);return h};a.rgba_to_css=function(a){var e=c.Vn(a,d);return[Math.round(255*e[0]),Math.round(255*
e[1]),Math.round(255*e[2]),a[3]]}};b4w.module.scenes=function(a,p){var c=p("__batch"),d=p("__camera"),b=p("__graph"),e=p("__obj_util"),l=p("__print"),m=p("__physics"),h=p("__scenes"),n=p("__util");a.DATA_ID_ALL=h.DATA_ID_ALL;a.set_active=function(a){var b=h.jj();h.set_active(n.keysearch("name",a,b))};a.get_active=function(){return h.ia()?h.get_active().name:""};a.get_scenes=function(){for(var a=h.jj(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.get_active_camera=function(){if(h.ia())return h.kj(h.get_active());l.error("No active scene");
return!1};a.get_object_by_name=function(a,b){var c=h.Fd(h.Qf,a,b|0);if(c)return c;l.error("get object "+a+": not found")};a.get_object_by_dupli_name=function(a,b,c){if(a=h.Fd(h.Vl,a,b,c|0))return a;l.error("get object "+b+": not found")};a.get_object_by_dupli_name_list=function(a,b){var c=h.Fd(h.Wl,a,b|0);if(c)return c;l.error("get object "+a+": not found")};a.get_object_data_id=function(a){return h.get_object_data_id(a)};a.pick_object=h.pick_object;a.outlining_is_enabled=function(a){return a&&a.c.g&&
a.c.g.Lb};a.set_outline_intensity=function(a,b){a&&a.c.g&&a.c.g.Lb?a.c.g.qd=b:l.error("set_outline_intensity(): wrong object")};a.get_outline_intensity=function(a){if(a&&a.c.g&&a.c.g.Lb)return a.c.g.qd;l.error("get_outline_intensity(): wrong object")};a.apply_outline_anim=function(a,b,c,d){a&&a.c.g&&a.c.g.Lb?h.apply_outline_anim(a,b,c,d):l.error("apply_outline_anim(): wrong object")};a.apply_outline_anim_def=function(a){if(a&&a.c.g&&a.c.g.Lb){var b=a.c.g.wj;h.apply_outline_anim(a,b.ml,b.nl,b.ol)}else l.error("apply_outline_anim_def(): wrong object")};
a.clear_outline_anim=function(a){a&&a.c.g&&a.c.g.Lb?h.clear_outline_anim(a):l.error("clear_outline_anim(): wrong object")};a.set_outline_color=h.set_outline_color;a.get_outline_color=function(a){var b=h.get_active();if(b=h.da(b,"OUTLINE"))return a=a||new Float32Array(3),a.set(b.pf),a};a.set_glow_intensity=function(b,c){l.error("set_glow_intensity() deprecated, use set_outline_intensity() instead");a.set_outline_intensity(b,c)};a.get_glow_intensity=function(b){l.error("get_glow_intensity() deprecated, use get_outline_intensity() instead");
a.get_outline_intensity(b)};a.apply_glow_anim=function(b,c,d,e){l.error("apply_glow_anim() deprecated, use apply_outline_anim() instead");a.apply_outline_anim(b,c,d,e)};a.apply_glow_anim_def=function(b){l.error("apply_glow_anim_def() deprecated, use apply_outline_anim_def() instead");a.apply_outline_anim_def(b)};a.clear_glow_anim=function(b){l.error("clear_glow_anim() deprecated, use clear_outline_anim() instead");a.clear_outline_anim(b)};a.set_glow_color=function(b){l.error("set_glow_color() deprecated, use set_outline_color() instead");
a.set_outline_color(b)};a.get_glow_color=function(b){l.error("get_glow_color() deprecated, use get_outline_color() instead");a.get_outline_color(b)};a.get_shadow_params=function(){if(!h.ia())return l.error("No active scene"),!1;var a=h.get_active(),b=h.da(a,"SHADOW_CAST");if(!b)return null;var c=a.l.Ae,d=h.da(a,"MAIN_OPAQUE"),e=h.da(a,"DEPTH"),m={};m.csm_resolution=c.csm_resolution;m.self_shadow_polygon_offset=b.self_shadow_polygon_offset;e&&(m.self_shadow_normal_offset=e.self_shadow_normal_offset);
m.enable_csm=c.enable_csm;m.csm_num=c.csm_num;m.csm_first_cascade_border=c.csm_first_cascade_border;m.first_cascade_blur_radius=c.first_cascade_blur_radius;m.csm_last_cascade_border=c.csm_last_cascade_border;m.last_cascade_blur_radius=c.last_cascade_blur_radius;m.fade_last_cascade=c.fade_last_cascade;m.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(m.csm_borders=h.mz(a,d.k),m.blur_radii=new Float32Array(c.csm_num),m.blur_radii.set(d.k.sl.subarray(0,c.csm_num))):(m.csm_borders=null,
m.blur_radii=null);return m};a.set_shadow_params=function(a){if(!h.ia())return l.error("No active scene"),!1;var e=h.get_active();"number"==typeof a.self_shadow_polygon_offset&&b.X(e.l.jb,function(b,c){"SHADOW_CAST"===c.type&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var m=h.da(e,"DEPTH");m&&("number"==typeof a.self_shadow_normal_offset&&(m.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(m.pcf_blur_radius=a.pcf_blur_radius));var n=h.da(e,
"MAIN_BLEND");n&&("number"==typeof a.self_shadow_normal_offset&&(n.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(n.pcf_blur_radius=a.pcf_blur_radius),n.sa=!0);n=e.l.Ae;"number"==typeof a.csm_first_cascade_border&&(n.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(n.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(n.csm_last_cascade_border=a.csm_last_cascade_border);
"number"==typeof a.last_cascade_blur_radius&&(n.last_cascade_blur_radius=a.last_cascade_blur_radius);if(m){for(var p=m.s,C=0;C<p.length;C++){var D=p[C];D.pd.pc&&(D=D.D,c.Wp(D,n),c.ob(D))}m.sa=!0}m=e.camera.c.g.M;for(C=0;C<m.length;C++)d.hp(m[C],n);h.Eo(e)};a.get_environment_colors=function(){if(!h.ia())return l.error("No active scene"),!1;var a=h.get_active();return h.get_environment_colors(a)};a.set_environment_colors=function(a,b,c){if(!h.ia())return l.error("No active scene"),!1;var d=h.get_active();
h.set_environment_colors(d,parseFloat(a),b,c)};a.get_fog_color_density=function(a){if(!h.ia())return l.error("No active scene"),!1;var b=h.get_active();return h.get_fog_color_density(b,a)};a.set_fog_color_density=function(a){if(!h.ia())return l.error("No active scene"),!1;var b=h.get_active();h.set_fog_color_density(b,a)};a.get_ssao_params=function(){if(!h.ia())return l.error("No active scene"),!1;var a=h.get_active();return h.get_ssao_params(a)};a.set_ssao_params=function(a){if(!h.ia())return l.error("No active scene"),
!1;var b=h.get_active();h.set_ssao_params(b,a)};a.get_color_correction_params=function(){if(!h.ia())return l.error("No active scene"),null;var a=h.get_active(),a=h.da(a,"COMPOSITING");if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.set_color_correction_params=function(a){if(!h.ia())return l.error("No active scene"),null;var b=h.get_active(),b=h.da(b,"COMPOSITING");if(!b)return null;"number"==typeof a.brightness&&
(b.brightness=a.brightness);"number"==typeof a.contrast&&(b.contrast=a.contrast);"number"==typeof a.exposure&&(b.exposure=a.exposure);"number"==typeof a.saturation&&(b.saturation=a.saturation);b.sa=!0};a.get_sky_params=function(){if(!h.ia())return l.error("No active scene"),!1;var a=h.get_active();return h.get_sky_params(a)};a.set_sky_params=function(a){if(!h.ia())return l.error("No active scene"),!1;var b=h.get_active();h.set_sky_params(b,a)};a.get_dof_params=function(){if(!h.ia())return l.error("No active scene"),
!1;var a=h.get_active();return h.da(a,"DOF")?h.get_dof_params(a):null};a.set_dof_params=function(a){if(!h.ia())return l.error("No active scene"),!1;var b=h.get_active();h.set_dof_params(b,a)};a.get_god_rays_params=function(){if(!h.ia())return l.error("No active scene"),!1;var a=h.get_active();return h.da(a,"GOD_RAYS")?h.get_god_rays_params(a):null};a.set_god_rays_params=function(a){if(!h.ia())return l.error("No active scene"),!1;var b=h.get_active();h.set_god_rays_params(b,a)};a.get_bloom_params=
function(){if(!h.ia())return l.error("No active scene"),!1;var a=h.get_active();return h.da(a,"BLOOM")?h.get_bloom_params(a):null};a.set_bloom_params=function(a){if(!h.ia())return l.error("No active scene"),!1;var b=h.get_active();h.set_bloom_params(b,a)};a.get_glow_material_params=function(){if(!h.ia())return l.error("No active scene"),!1;var a=h.get_active();return h.da(a,"GLOW_COMBINE")?h.get_glow_material_params(a):null};a.set_glow_material_params=function(a){if(!h.ia())return l.error("No active scene"),
!1;var b=h.get_active();h.set_glow_material_params(b,a)};a.get_wind_params=function(){return h.get_wind_params()};a.set_wind_params=function(a){if(!h.ia())return l.error("No active scene"),!1;var b=h.get_active();h.set_wind_params(b,a)};a.get_water_surface_level=h.get_water_surface_level;a.set_water_params=function(a){if(!h.ia())return l.error("No active scene"),!1;var b=h.get_active();h.set_water_params(b,a)};a.get_water_mat_params=function(a){if(!h.ia())return l.error("No active scene"),!1;var b=
h.get_active();h.get_water_mat_params(b,a)};a.update_scene_materials_params=function(){if(!h.ia())return l.error("No active scene"),!1;var a=h.get_active();h.cu(a)};a.hide_object=function(a){e.oj(a)||n.Yk(a)?h.hide_object(a):l.error("show/hide is only supported for dynamic meshes/empties")};a.show_object=function(a){e.oj(a)||n.Yk(a)?h.show_object(a):l.error("show/hide is only supported for dynamic meshes/empties")};a.is_hidden=function(a){if(e.oj(a)||n.Yk(a))return h.is_hidden(a);l.error("show/hide is only supported for dynamic meshes/empties");
return!1};a.is_visible=function(a){return a.c.g.is_visible};a.check_object=function(a){return h.ia()?h.check_object(a,h.get_active()):(l.error("No active scene"),!1)};a.check_object_by_name=function(a,b){return h.Fd(h.Qf,a,b|0)?!0:!1};a.check_object_by_dupli_name=function(a,b,c){return h.Fd(h.Vl,a,b,c|0)?!0:!1};a.check_object_by_dupli_name_list=function(a,b){return h.Fd(h.Wl,a,b|0)?!0:!1};a.get_all_objects=function(a,b){var c=h.get_active();a||(a="ALL");b||0===b||(b=h.DATA_ID_ALL);return h.$a(c,a,
b)};a.get_object_name=function(a){return a?a.name:(l.error("Wrong object name"),"")};a.get_object_type=function(a){return a&&a.type?a.type:(l.error("Wrong object"),"UNDEFINED")};a.get_object_dg_parent=function(a){return a.c.Ka};a.get_object_children=function(a){return a.c.kd.slice(0)};a.get_first_character=function(){for(var a=h.$a(h.get_active(),"MESH",h.DATA_ID_ALL),b=0;b<a.length;b++){var c=a[b];if(m.is_character(c))return c}return null};a.get_shore_dist=function(a,b){b||0===b||(b=1);return h.get_shore_dist(a,
b)};a.get_cam_water_depth=function(){return h.get_cam_water_depth()};a.get_type_mesh_object=function(a){return"MESH"==a.type?a.c.g.type:null};a.get_meta_tags=function(){if(!h.ia())return l.error("No active scene"),!1;var a=h.get_active();return h.get_meta_tags(a)};a.append_object=function(a){if(!a.c.g.Kn)return l.error('object "'+a.name+'" has been created not by coping.'),!1;var b=a.name;if(h.Fd(h.Qf,a.name,0))for(var c=1;;){b=a.name+(3>String(c).length?"."+("000"+String(c)).slice(-3):"."+String(c));
if(!h.Fd(h.Qf,b,0)){a.name=b;l.error('object "'+a.name+'" already exists. Name was replaced by "'+b+'".');break}c++}h.append_object(h.get_active(),a,!0)};a.remove_object=function(a){h.remove_object(a)||l.error('object "'+a.name+'" was not copied.')};a.marker_frame=function(a){var b=h.get_active();if(b.timeline_markers&&a in b.timeline_markers)return h.marker_frame(b,a);l.error('"'+a+'" marker not found.');return 0};a.get_mb_params=function(){var a=h.get_active();return(a=h.da(a,"MOTION_BLUR"))?{mb_factor:a.mb_factor,
mb_decay_threshold:a.mb_decay_threshold}:null};a.set_mb_params=function(a){var b=h.get_active();(b=h.da(b,"MOTION_BLUR"))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):l.error("The motion blur subscene doesn't exist.")}};b4w.module.sfx=function(a,p){var c=p("__scenes"),d=p("__sfx"),b=p("__print");a.play=function(a,b,c){d.play(a,b,c)};a.play_def=function(a){d.play_def(a)};a.is_play=function(a){return d.is_play(a)};a.speaker_play=function(a,c,m,h){b.error("speaker_play() deprecated, use play() or play_def() instead");d.cyclic(a,c);h&&d.playrate(a,h);d.play(a,0,m)};a.speaker_stop=function(a){b.error("speaker_stop() deprecated, use stop() instead");d.stop(a)};a.stop=function(a){d.stop(a)};a.pause=function(a){d.fC(a)};
a.resume=function(a){d.hC(a)};a.speaker_playback_rate=function(a,c){b.error("speaker_playback_rate() deprecated, use playrate() instead");d.playrate(a,c)};a.playrate=function(a,b){d.playrate(a,b)};a.get_playrate=function(a){return d.get_playrate(a)};a.cyclic=function(a,b){d.cyclic(a,b)};a.is_cyclic=function(a){return d.is_cyclic(a)};a.listener_reset_speed=function(a,b){d.listener_reset_speed(a,b)};a.speaker_reset_speed=function(a,b,c){d.speaker_reset_speed(a,b,c)};a.get_volume=function(a){return a&&
"object"===typeof a?d.get_volume(a):d.uz()};a.set_volume=function(a,b){a&&"object"===typeof a?d.set_volume(a,b):d.KB(b)};a.mute=function(a,b){a&&"object"===typeof a?d.mute(a,b):d.DA(b)};a.is_muted=function(a){return a&&"object"===typeof a?d.is_muted(a):d.bA()};a.get_speaker_objects=function(){return d.get_speaker_objects().slice(0)};a.get_speakers=function(){b.error("get_speakers() deprecated, use get_speaker_objects() instead");return a.get_speaker_objects()};a.check_active_speakers=d.check_active_speakers;
a.set_compressor_params=function(a){d.set_compressor_params(c.get_active(),a)};a.get_compressor_params=function(){return d.get_compressor_params(c.get_active())};a.duck=function(a,b,c){a&&"object"===typeof a?d.duck(a,b,c):d.oy(b,c)};a.unduck=function(a){a&&"object"===typeof a?d.unduck(a):d.KC()};a.apply_playlist=d.apply_playlist;a.clear_playlist=d.clear_playlist;a.detect_audio_container=d.detect_audio_container;a.detect_video_container=d.detect_video_container;a.set_positional_params=d.set_positional_params;
a.get_positional_params=d.get_positional_params;a.set_filter_params=d.set_filter_params;a.get_filter_params=d.get_filter_params;a.get_filter_freq_response=d.get_filter_freq_response;a.get_duration=function(a){if(a&&d.re(a))return d.get_duration(a);b.error('Object "'+(a?a.name:void 0)+'" is not a valid speaker')}};b4w.module.textures=function(a,p){var c=p("__textures"),d=p("__print");a.get_canvas_texture_context=function(a,e){e||(e=0);var l=c.jz(a,e);if(l)return l;d.error('Canvas texture with ID "'+a+'" not found!')};a.update_canvas_texture_context=function(a,e){e||(e=0);c.VC(a,e)||d.error('Canvas texture with ID "'+a+'" not found!')};a.play_video=function(a,e){e||(e=0);c.play_video(a,e)||d.error('Texture with name "'+a+'" not found!')};a.pause_video=function(a,e){e||(e=0);c.pause_video(a,e)||d.error('Texture with name "'+
a+'" not found!')};a.reset_video=function(a,e){e||(e=0);c.reset_video(a,e)||d.error('Texture with name "'+a+'" not found!')}};b4w.module.time=function(a,p){var c=p("__time");a.set_timeout=c.set_timeout;a.clear_timeout=c.clear_timeout;a.get_timeline=c.get_timeline;a.animate=c.animate;a.clear_animation=c.clear_animation};b4w.module.transform=function(a,p){var c=p("__print"),d=p("__physics"),b=p("__transform"),e=p("__util"),l=p("__obj_util"),m=new Float32Array(3),h=new Float32Array(4);a.SPACE_LOCAL=b.SPACE_LOCAL;a.SPACE_WORLD=b.SPACE_WORLD;a.set_translation=function(a,e,h,p){l.ab(a)?(m[0]=e,m[1]=h,m[2]=p,b.set_translation(a,m),b.A(a),d.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_v=function(a,e){l.ab(a)?(b.set_translation(a,e),b.A(a),d.sync_transform(a)):c.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.set_translation_rel=function(a,f,h,p,y){l.ab(a)?(m[0]=f,m[1]=h,m[2]=p,e.transform_vec3(m,1,y.c.g.quat,y.c.g.i,m),b.set_translation(a,m),b.A(a),d.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_translation=function(a,c){c||(c=new Float32Array(3));b.get_translation(a,c);return c};a.set_rotation=function(a,e,k,m,p){l.ab(a)?(h[0]=e,h[1]=k,h[2]=m,h[3]=p,b.set_rotation(a,h),b.A(a),d.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.set_rotation_quat=function(){c.error("set_rotation_quat() deprecated, use set_rotation() instead");return a.set_rotation};a.set_rotation_v=function(a,e){l.ab(a)?(b.set_rotation(a,e),b.A(a),d.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_quat_v=function(){c.error("set_rotation_quat_v() deprecated, use set_rotation_v() instead");return a.set_rotation_v};a.get_rotation=function(a,c){c||(c=new Float32Array(4));b.get_rotation(a,c);return c};a.get_rotation_quat=
function(){c.error("get_rotation_quat() deprecated, use get_rotation() instead");return a.get_rotation};a.set_rotation_euler=function(a,e,h,p){l.ab(a)?(m[0]=e,m[1]=h,m[2]=p,b.set_rotation_euler(a,m),b.A(a),d.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_v=function(a,e){l.ab(a)?(b.set_rotation_euler(a,e),b.A(a),d.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale=function(a,d){l.ab(a)?(b.set_scale(a,d),b.A(a)):c.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.get_scale=function(a){return b.get_scale(a)};a.empty_reset_transform=function(a){if("EMPTY"!=a.type)return c.error("Wrong object: "+a.name),!1;for(var e=0;e<a.c.kd.length;e++)if(!l.ab(a.c.kd[e])){c.error('Wrong object: "'+a.c.kd[e].name+'" is not dynamic.');return}b.set_translation(a,[0,0,0]);b.set_rotation(a,[0,0,0,1]);b.set_scale(a,1);b.A(a);d.sync_transform(a)};a.get_object_size=function(a){return e.is_mesh(a)?b.get_object_size(a):(c.error("Wrong object: "+a.name),
0)};a.get_object_center=function(a,d,h){return e.is_mesh(a)?b.get_object_center(a,d,h):(c.error("Wrong object: "+a.name),null)};a.move_local=function(a,e,h,m){l.ab(a)?(b.move_local(a,e,h,m),b.A(a),d.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_object_bounding_box=function(a){return b.get_object_bounding_box(a)};a.get_tsr=function(a,d){d||(d=new Float32Array(8));if(l.ab(a))return b.get_tsr(a,d),d;c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_tsr=function(a,
e){l.ab(a)?(b.set_tsr(a,e),b.A(a),d.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.distance=function(a,c){return b.distance(a,c)}};b4w.module.tsr=function(a,p){p("__print");var c=p("__tsr");a.create=c.create;a.from_values=c.from_values;a.copy=c.copy;a.identity=c.identity;a.create_sep=c.create_sep;a.set_sep=c.set_sep;a.set_trans=c.set_trans;a.set_scale=c.set_scale;a.set_transcale=c.set_transcale;a.set_quat=c.set_quat;a.get_trans_view=c.get_trans_view;a.get_scale=c.get_scale;a.get_quat_view=c.get_quat_view;a.invert=c.invert;a.to_mat4=function(a,b){b||(b=new Float32Array(16));c.to_mat4(a,b);return b};a.from_mat4=c.from_mat4;a.multiply=
c.multiply;a.transform_vec3=c.transform_vec3;a.transform_vec3_inv=c.transform_vec3_inv;a.transform_vectors=c.transform_vectors;a.transform_dir_vectors=c.transform_dir_vectors;a.transform_dir_vec3=c.transform_dir_vec3;a.transform_tangents=c.transform_tangents;a.translate=c.translate;a.interpolate=c.interpolate};b4w.module.util=function(a,p){var c=p("__print"),d=p("__util"),b=p("vec3");p("mat4");a.AXIS_X=new Float32Array([1,0,0]);a.AXIS_Y=new Float32Array([0,1,0]);a.AXIS_Z=new Float32Array([0,0,1]);a.AXIS_MX=new Float32Array([-1,0,0]);a.AXIS_MY=new Float32Array([0,-1,0]);a.AXIS_MZ=new Float32Array([0,0,-1]);a.f32=function(a){return new Float32Array(a||0)};a.assert=d.assert;a.keyfind=d.keyfind;a.keysearch=d.keysearch;a.matrix_to_quat=function(a){return d.matrix_to_quat(a)};a.euler_to_quat=function(a,b){b||
(b=new Float32Array(4));return d.euler_to_quat(a,b)};a.quat_to_euler=function(a,b){b||(b=new Float32Array(3));return d.quat_to_euler(a,b)};a.sign=d.sign;a.clamp=d.clamp;a.quat_to_dir=d.quat_to_dir;a.ground_project_quat=function(a,b){return d.quat_project(a,d.AXIS_MY,d.AXIS_Y,d.AXIS_MZ,b)};a.cam_quat_to_mesh_quat=function(a,b){return d.cam_quat_to_mesh_quat(a,b)};a.quat_project=function(a,l,m,h,n){return 0!=b.dot(m,h)?(c.error("Wrong in-plane direction"),null):d.quat_project(a,l,m,h,n)};a.hash_code=
d.hash_code;a.smooth=d.smooth;a.smooth_v=d.smooth_v;a.is_vector=d.is_vector;a.correct_cam_quat_up=d.correct_cam_quat_up;a.quat_to_angle_axis=d.quat_to_angle_axis;a.random_from_array=d.random_from_array;a.xz_direction=d.xz_direction;a.line_plane_intersect=d.line_plane_intersect;a.is_mesh=d.is_mesh;a.is_armature=d.is_armature;a.angle_wrap_0_2pi=d.angle_wrap_0_2pi;a.angle_wrap_periodic=d.angle_wrap_periodic;a.smooth_step=d.smooth_step;a.lerp=d.lerp};"object"==typeof module&&module.bn&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,p){var c=p("__version");a.version=c.version;a.version_str=c.version_str;a.type=c.type;a.date=c.date;a.date_str=c.date_str};"object"==typeof module&&module.bn&&b4w.module.version(exports);b4w.module.objects=function(a,p){var c=p("__objects"),d=p("__obj_util"),b=p("__print"),e=p("__util"),l=p("__scenes"),m=p("__geometry");a.get_meta_tags=function(a){if(a&&a.b4w_object_tags)return c.get_meta_tags(a)};a.copy=function(a,n,f){return e.is_mesh(a)?d.ab(a)?m.Dh(a)||m.check_shape_keys(a)||!f?-1==l.$a(l.get_active(),"MESH",l.DATA_ID_ALL).indexOf(a)?(b.error('object "'+a.name+'" does not belong to the active scene.'),!1):c.copy(a,n||"",f):(b.error('object "'+a.name+'" has not dynamic geometry for deep copying.'),
!1):(b.error('object "'+a.name+'" is not dynamic.'),!1):(b.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.set_nodemat_value=function(a,d,f){if(!e.is_mesh(a))return b.error('The type of the object "'+a.name+'" is not "MESH".'),null;d=d.join("%join%");var k=c.Cz(a,d);null!=k?a.c.g.ue[k]=f:b.error('The Value node "'+d+'" was not found in the object "'+a.name+'".')};a.set_nodemat_rgb=function(a,d,f,k,l){if(!e.is_mesh(a))return b.error('The type of the object "'+a.name+'" is not "MESH".'),
null;d=d.join("%join%");var m=c.xz(a,d);null!=m?(a.c.g.Cc[3*m]=f,a.c.g.Cc[3*m+1]=k,a.c.g.Cc[3*m+2]=l):b.error('The RGB node "'+d+'" was not found in the object "'+a.name+'".')};a.update_boundings=function(a){if(!e.is_mesh(a))return b.error('The type of the object "'+a.name+'" is not "MESH".'),!1;if(!m.Dh(a)&&!m.check_shape_keys(a))return b.error('object "'+a.name+'" has not dynamic geometry.'),!1;c.update_boundings(a)}};b4w.module.main=function(a,p){function c(){}function d(){}function b(){}function e(){window.performance||(G.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(G.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});P.kt(0)}function l(a,b){a.addEventListener("webglcontextlost",function(a){a.preventDefault();G.error("WebGL context lost");h()},!1);g.td(b);var c=g.xr();c&&G.log("%cRENDERER INFO:","color: #00a",
b.getParameter(c.UNMASKED_VENDOR_WEBGL)+", "+b.getParameter(c.UNMASKED_RENDERER_WEBGL));K.td(b);q.td(b);H.td(b);v.td(b);u.td(b);x.TB(a);t.init(a);Q.mt(a.width,a.height,1);I.init();d=r();f()}function m(){c=function(){}}function h(){n()||(oa=performance.now()/1E3,I.pause(),M.pause(),H.pause(),y.pause())}function n(){return X<oa}function f(){B(f);var a=performance.now()/1E3;S||(S=a);var b=a-S;if(!(b<1/ba.od)){for(var c=P.get_timeline(),e=0;e<da.length;e++)da[e](c,b);n()||(X>S&&(b-=X-Math.max(oa,S)),
c+=b,P.kt(c),u.update(),E.update(),x.update(),k(c,b),d(b));S=a}}function k(a,b){x.is_primary_loaded()&&(L.reset(),Z.update(b),J.update(a,b),I.update(a,b),b&&w.update(b),x.is_primary_loaded()&&(M.update(a,b),x.is_primary_loaded()&&(c(b,a),x.is_primary_loaded()&&(A.update(a,b),x.is_primary_loaded()&&(y.update(),Q.update(a,b),y.iD(),ea&&(ea(U.toDataURL()),ea=null))))))}function r(){var a=60,c=0,d=ba.hr,e=ba.Iy;return function(f){f<1/ba.od||(a=aa.smooth(1/f,a,f,d),f=M.rz(),c=(c+1)%e,0==c&&b(Math.round(a),
f))}}var y=p("__anchors"),w=p("__animation"),C=p("__compat"),D=p("__config"),G=p("__print"),t=p("__container"),A=p("__controls"),x=p("__data"),u=p("__debug"),g=p("__extensions"),q=p("__geometry"),L=p("__hud"),J=p("__nla"),E=p("__assets"),M=p("__physics"),K=p("__renderer"),Q=p("__scenes"),I=p("__sfx"),v=p("__shaders"),H=p("__textures"),P=p("__time"),Z=p("__transform"),aa=p("__util"),R=p("__version"),W=D.context,ba=D.r,U=null,ca=null,S=0,oa=0,X=0,da=[],ea=null,fa=["webgl","experimental-webgl"],ga=null,
B=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/ba.od)}}();a.init=function(a,b){D.LB();G.PB(ba.console_verbose);var c=R.version_str()+" "+R.type()+" ("+R.date_str()+")";G.log("%cINIT ENGINE","color: #00a",c);if(!window.WebGLRenderingContext)return null;e();U=a;C.nw();for(var c=null,d=0;d<fa.length;d++){var f=fa[d];try{c=a.getContext(f,
W)}catch(g){}if(c)break}c&&C.ky(c);if(!c)return null;ga=c;l(U,c);D.pw();C.EB(c);v.oA();ba.Fn&&(a.style["touch-action"]="none");G.log("%cSET PRECISION:","color: #00a",ba.precision);b?(L.init(b),ca=b):(D.r.show_hud_debug_info=!1,D.o.fl=!1);return c};a.set_check_gl_errors=function(a){u.set_check_gl_errors(a)};a.resize=function(a,b,c){!1!==c&&(U.style.width=a+"px",U.style.height=b+"px",ca&&(ca.style.width=a+"px",ca.style.height=b+"px"));ca&&(ca.width=a,ca.height=b,L.ti());if(navigator.userAgent.match(/iPhone/i)||
navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))ba.canvas_resolution_factor=1;c=Math.floor(a*ba.canvas_resolution_factor);b=Math.floor(b*ba.canvas_resolution_factor);ba.allow_hidpi&&1<window.devicePixelRatio&&(c*=window.devicePixelRatio,b*=window.devicePixelRatio);U.width=c;U.height=b;if(c>ga.drawingBufferWidth||b>ga.drawingBufferHeight){G.warn("Canvas size exceeds platform limits, downscaling");var d=Math.min(ga.drawingBufferWidth/c,ga.drawingBufferHeight/b);c*=d;b*=d;U.width=
c;U.height=b}Q.mt(c,b,c/a);Q.ia()&&Z.A(Q.get_active().camera);k(P.get_timeline(),0);x.ZC(U.width,U.height)};a.set_fps_callback=function(a){b=a};a.clear_fps_callback=function(){b=function(){}};a.set_render_callback=function(a){c=a};a.clear_render_callback=function(){m()};a.global_timeline=function(){return P.get_timeline()};a.redraw=function(){G.error("redraw() deprecated");k(P.get_timeline(),0)};a.pause=h;a.resume=function(){n()&&(X=performance.now()/1E3,I.resume(),M.resume(),H.play(!0),y.resume())};
a.is_paused=n;a.reset=function(){x.unload(0);ca=U=null;X=oa=S=0;b=function(){};d=function(){};c=function(){};da.length=0;ga=null;P.reset()};a.canvas_data_url=function(a){ea=a};a.get_canvas_elem=function(){return U};a.detect_mobile=function(){return C.detect_mobile()};a.append_loop_cb=function(a){for(var b=0;b<da.length;b++)if(da[b]==a)return;da.push(a)};a.remove_loop_cb=function(a){for(var b=0;b<da.length;b++)if(da[b]==a){da.splice(b,1);break}}};b4w.module.nla=function(a,p){var c=p("__nla"),d=p("__time"),b=p("__print"),e=p("__util");a.set_frame=function(a){a=e.clamp(a,c.get_frame_start(),c.get_frame_end());c.check_nla_scripts()?b.error("The active scene is using NLA script."):c.set_frame(a,d.get_timeline())};a.get_frame=function(){return c.get_frame(d.get_timeline())};a.stop=function(){c.check_nla_scripts()?b.error("The active scene is using NLA script."):c.sC()};a.play=function(a){c.check_nla_scripts()?b.error("The active scene is using NLA script."):
c.SA(a)};a.is_play=function(){return c.is_play()};a.get_frame_start=function(){return c.get_frame_start()};a.get_frame_end=function(){return c.get_frame_end()};a.check_nla=function(){return c.check_nla()};a.check_nla_scripts=function(){return c.check_nla_scripts()};a.set_range=function(a,d){c.check_nla_scripts()?b.error("The active scene is using NLA script."):(d=parseFloat(d)||c.get_frame_end(),a=parseFloat(a)||c.get_frame_end(),d=e.clamp(d,c.get_frame_start(),c.get_frame_end()),a=e.clamp(a,c.get_frame_start(),
d),c.set_range(a,d))};a.reset_range=function(){c.check_nla_scripts()?b.error("The active scene is using NLA script."):c.reset_range()};a.set_cyclic=function(a){c.check_nla_scripts()?b.error("The active scene is using NLA script."):c.set_cyclic(a)};a.clear_callback=function(){c.check_nla_scripts()?b.error("The active scene is using NLA script."):c.clear_callback()}};b4w.module.app=function(a,p){function c(){var a=J.is_paused();document.addEventListener("visibilitychange",function(){document.hidden?(a=J.is_paused(),J.pause()):a||J.resume()},!1)}function d(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(b=document.createElement("canvas"),
b.style.position="absolute",e.style.left=0,e.style.top=0,b.style.pointerEvents="none"):b=null;f||(M.error('Warning: canvas container "'+a+'" not found, appending to body'),f=document.body);f.appendChild(e);if(!J.init(e,b))return c&&D("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/troubleshooting",d),!1;b&&u.insert_to_container(b,"LAST");return!0}function b(a,b){a?(b&&(document.getElementById(b).style.display="block"),P=document.getElementById(a)):(P=document.createElement("div"),
P.innerHTML=0,P.style.cssText="position:absolute;top: 23px;right: 20px;font-size: 45px;line-height: 50px;font-weight: bold;color: #000;",u.insert_to_container(P,"JUST_AFTER_CANVAS"))}function e(a,b){var c=String(a);b&&(c+="/"+String(b));P.innerHTML=c}function l(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a);return b}function m(){var a=u.get_container();J.resize(a.clientWidth,a.clientHeight,!0)}function h(a,b,c){if(t.has_distance_limits(a))var d=Q.get_translation(a,
U),e=t.get_hover_cam_pivot(a,ca),d=v.subtract(d,e,U),d=Math.max(v.len(d),1);else d=10;e=Q.get_rotation(a,oa);b=I.quat_to_dir(e,b,U);b[1]=0;v.normalize(b,b);v.scale(b,d*c,b);d=Q.get_translation(a,ca);v.add(d,b,d);t.hover_cam_set_translation(a,d)}function n(a,b){if(t.has_distance_limits(a)){var c=t.get_hover_angle_limits(a,W);if(0>c[1]-c[0]){var d=t.get_camera_angles(a,ba)[1],c=(c[0]-d)/(c[0]-c[1]),d=t.get_cam_dist_limits(a),c=Math.max(c,2/d[0]);t.rotate_hover_camera(a,0,c*b)}}else c=Q.get_translation(a,
U),d=v.scale(I.AXIS_Y,-b,ca),v.add(c,d,c),t.hover_cam_set_translation(a,c)}function f(a,b,c,d){Q.move_local(a,5*b,5*c,5*d)}function k(a,b,c){var d=Q.get_translation(a,U),e=t.get_pivot(a,ca),d=v.dist(d,e),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));Q.move_local(a,0,0>b?.001<d?-d*c:0:c/(1-c)*d,0)}function r(a,b,c,d){for(var e=c*b;0<a;--a)c+=e,d+=e,e=c*b;return d}function y(a,b,c,d,e){e?(e=t.get_pivot(a,U),a=t.get_eye(a),a=v.dist(e,a)+d,d=0<b?r(b,-c,a,d):r(-b,c/(1-c),a,d)):d-=2*b*c;return d}function w(a,
b){function c(a,b,d,e){if(1==d){var f=r?.003*u[0]:.003*u[1];d=g.get_sensor_value(a,b,0);g.get_sensor_payload(a,b,0)===g.PL_SINGLE_TOUCH_MOVE?(ic+="X"==e?-d*f:0,Ba+="Y"==e?-d*f:0):g.get_sensor_payload(a,b,0)===g.PL_MULTITOUCH_MOVE_PAN&&(a=r?.003*u[1]:7.5E-4*u[0],ub+="X"==e?-d*a:0,Gb+="Y"==e?-d*a:0)}}function d(a,b,c,e){if(1==c){c=g.get_sensor_value(a,b,1);t.get_velocity_params(a,u);if(r)f=.003*u[0],h=7.5E-4*u[1];else var f=.003*u[1],h=7.5E-4*u[0];if(1===g.get_sensor_payload(a,b,0))Da+="X"==e?-c*f:
0,Rb+="Y"==e?-c*f:0;else if(2===g.get_sensor_payload(a,b,0)||3===g.get_sensor_payload(a,b,0))yc+="X"==e?-c*h:0,pc+="Y"==e?-c*h:0}}function e(a){return a[0]&&(a[1]||a[2])}function l(a,b,c){if(1==c)switch(c=g.get_sensor_value(a,b,0),t.get_velocity_params(a,u),b){case "FORWARD":q?D[0]=1:r?(b=t.get_camera_angles(a,ba)[1],b=Math.abs(b)>=Math.PI/4?I.AXIS_MZ:I.AXIS_MY,h(a,b,.5*u[0]*c)):p?k(a,-u[2],c):f(a,0,-u[0]*c,0);break;case "BACKWARD":q?D[0]=-1:r?(b=t.get_camera_angles(a,ba)[1],b=Math.abs(b)>=Math.PI/
4?I.AXIS_Z:I.AXIS_Y,h(a,b,.5*u[0]*c)):p?k(a,u[2],c):f(a,0,u[0]*c,0);break;case "UP":r?n(a,30*-u[2]*c):q||f(a,0,0,-u[0]*c);break;case "DOWN":r?n(a,30*u[2]*c):q||f(a,0,0,u[0]*c);break;case "LEFT":q?D[1]=1:r?h(a,I.AXIS_MX,.5*u[0]*c):f(a,-u[0]*c,0,0);break;case "RIGHT":q?D[1]=-1:r?h(a,I.AXIS_X,.5*u[0]*c):f(a,u[0]*c,0,0);break;case "ROT_LEFT":p?t.rotate_target_camera(a,2*-u[1]*c,0):t.rotate_eye_camera(a,2*u[1]*c,0);break;case "ROT_RIGHT":p?t.rotate_target_camera(a,2*u[1]*c,0):t.rotate_eye_camera(a,2*-u[1]*
c,0);break;case "ROT_UP":p?t.rotate_target_camera(a,0,2*-u[1]*c):t.rotate_eye_camera(a,0,2*u[1]*c);break;case "ROT_DOWN":p?t.rotate_target_camera(a,0,2*u[1]*c):t.rotate_eye_camera(a,0,2*-u[1]*c)}else switch(b){case "FORWARD":case "BACKWARD":q&&(D[0]=0);break;case "LEFT":case "RIGHT":q&&(D[1]=0)}q&&(E.set_character_move_dir(q,D[0],D[1]),a=t.get_camera_angles_char(a,W),E.set_character_rotation(q,a[0],a[1]))}Z=!0;aa=a;R=b;var m=K.get_active_camera(),p=!1,q=null,r=!1;switch(t.get_move_style(m)){case t.MS_TARGET_CONTROLS:p=
!a;break;case t.MS_EYE_CONTROLS:q=K.get_first_character();break;case t.MS_STATIC:return;case t.MS_HOVER_CONTROLS:r=!0}var u=t.get_velocity_params(m,X),w=g.create_elapsed_sensor();if(E.has_simulated_physics(m)){var A=g.create_collision_sensor(m,null,!0);g.create_sensor_manifold(m,"CAMERA_COLLISION",g.CT_CONTINUOUS,[A],null,function(a,b,c){if(1==c&&(c=g.get_sensor_payload(a,b,0).coll_dist,0>c)){var d=g.get_sensor_payload(a,b,0).coll_norm;b=U;v.scale(d,-.25*c,b);c=Q.get_translation(a,ca);v.add(c,b,c);
Q.set_translation_v(a,c)}})}if(q){var A=Q.get_translation(m),C=Q.get_rotation(m),C=I.cam_quat_to_mesh_quat(C);A[1]-=.5;E.set_transform(q,A,C);x.append_stiff_trans(m,q,[0,.5,0]);var D=new Float32Array(2),M=!0;E.set_character_move_type(q,E.CM_FLY);g.create_kb_sensor_manifold(m,"TOGGLE_CHAR_MOVE_TYPE",g.CT_SHOT,g.KEY_C,function(){M=!M;E.set_character_move_type(q,M?E.CM_FLY:E.CM_WALK)})}if(b)A=C=G=J=P=L=g.create_custom_sensor(0);else var A=g.create_keyboard_sensor(g.KEY_W),C=g.create_keyboard_sensor(g.KEY_S),
G=g.create_keyboard_sensor(g.KEY_A),J=g.create_keyboard_sensor(g.KEY_D),P=g.create_keyboard_sensor(g.KEY_R),L=g.create_keyboard_sensor(g.KEY_F);var oa=g.create_keyboard_sensor(g.KEY_UP),Pa=g.create_keyboard_sensor(g.KEY_DOWN),na=g.create_keyboard_sensor(g.KEY_LEFT),ua=g.create_keyboard_sensor(g.KEY_RIGHT);r||(g.create_sensor_manifold(m,"FORWARD",g.CT_CONTINUOUS,[w,A],null,l),g.create_sensor_manifold(m,"BACKWARD",g.CT_CONTINUOUS,[w,C],null,l));p?(g.create_sensor_manifold(m,"ROT_UP",g.CT_CONTINUOUS,
[w,oa,P],e,l),g.create_sensor_manifold(m,"ROT_DOWN",g.CT_CONTINUOUS,[w,Pa,L],e,l),g.create_sensor_manifold(m,"ROT_LEFT",g.CT_CONTINUOUS,[w,na,G],e,l),g.create_sensor_manifold(m,"ROT_RIGHT",g.CT_CONTINUOUS,[w,ua,J],e,l)):r?(g.create_sensor_manifold(m,"LEFT",g.CT_CONTINUOUS,[w,na,G],e,l),g.create_sensor_manifold(m,"RIGHT",g.CT_CONTINUOUS,[w,ua,J],e,l),g.create_sensor_manifold(m,"FORWARD",g.CT_CONTINUOUS,[w,oa,A],e,l),g.create_sensor_manifold(m,"BACKWARD",g.CT_CONTINUOUS,[w,Pa,C],e,l),g.create_sensor_manifold(m,
"UP",g.CT_CONTINUOUS,[w,L],e,l),g.create_sensor_manifold(m,"DOWN",g.CT_CONTINUOUS,[w,P],e,l)):(g.create_sensor_manifold(m,"UP",g.CT_CONTINUOUS,[w,P],e,l),g.create_sensor_manifold(m,"DOWN",g.CT_CONTINUOUS,[w,L],e,l),g.create_sensor_manifold(m,"LEFT",g.CT_CONTINUOUS,[w,G],e,l),g.create_sensor_manifold(m,"RIGHT",g.CT_CONTINUOUS,[w,J],e,l),g.create_sensor_manifold(m,"ROT_UP",g.CT_CONTINUOUS,[w,oa],e,l),g.create_sensor_manifold(m,"ROT_DOWN",g.CT_CONTINUOUS,[w,Pa],e,l),g.create_sensor_manifold(m,"ROT_LEFT",
g.CT_CONTINUOUS,[w,na],e,l),g.create_sensor_manifold(m,"ROT_RIGHT",g.CT_CONTINUOUS,[w,ua],e,l));var Oa=0,A=g.create_mouse_wheel_sensor(),cb=0,C=g.create_touch_zoom_sensor();g.create_sensor_manifold(m,"MOUSE_WHEEL",g.CT_LEVEL,[A],null,function(a,b,c){1==c&&(b=g.get_sensor_value(a,b,0),t.get_velocity_params(a,u),p||r?Oa=y(a,b,u[2],Oa,p):(u[0]*=1+b*u[2],t.set_velocity_params(a,u)))});g.create_sensor_manifold(m,"TOUCH_ZOOM",g.CT_LEVEL,[C],null,function(a,b,c){1==c&&(c=g.get_sensor_value(a,b,0),t.get_velocity_params(a,
u),g.get_sensor_payload(a,b,0)===g.PL_MULTITOUCH_MOVE_ZOOM&&(cb=y(a,c,.03*u[2],cb,p)))});g.create_sensor_manifold(m,"ZOOM_INTERPOL",g.CT_CONTINUOUS,[w],null,function(a,b,c){if(1==c&&(p||r))if(1E-5<Math.abs(Oa)||1E-5<Math.abs(cb)){b=g.get_sensor_value(a,b,0);c=I.smooth(Oa,0,b,.1*H);Oa-=c;var d=I.smooth(cb,0,b,.15*H);cb-=d;if(r)n(a,-(c+d));else{b=t.get_pivot(a,U);var e=t.get_eye(a,ca);.001<v.dist(b,e)+c+d?Q.move_local(a,0,c+d,0):(c=v.subtract(e,b,ca),d=v.normalize(c,S),v.scale(d,.001,d),v.add(b,d,c),
Q.set_translation_v(a,c),cb=Oa=0)}}else cb=Oa=0});var Da=0,Rb=0,yc=0,pc=0,A=g.create_mouse_move_sensor("X"),C=g.create_mouse_move_sensor("Y"),G=g.create_mouse_click_sensor();g.create_sensor_manifold(m,"MOUSE_X",g.CT_LEVEL,[G,A],null,d,"X");g.create_sensor_manifold(m,"MOUSE_Y",g.CT_LEVEL,[G,C],null,d,"Y");var ic=0,Ba=0,ub=0,Gb=0,A=g.create_touch_move_sensor("X"),C=g.create_touch_move_sensor("Y");g.create_sensor_manifold(m,"TOUCH_X",g.CT_LEVEL,[A],null,c,"X");g.create_sensor_manifold(m,"TOUCH_Y",g.CT_LEVEL,
[C],null,c,"Y");g.create_sensor_manifold(m,"ROT_TRANS_INTERPOL",g.CT_CONTINUOUS,[w],null,function(a,b,c){if(1==c&&(1E-5<Math.abs(Da)||1E-5<Math.abs(Rb)||1E-5<Math.abs(ic)||1E-5<Math.abs(Ba)||1E-5<Math.abs(yc)||1E-5<Math.abs(pc)||1E-5<Math.abs(ub)||1E-5<Math.abs(Gb))){var d=g.get_sensor_value(a,b,0),e=I.smooth(Da,0,d,.08*H);b=I.smooth(Rb,0,d,.08*H);Da-=e;Rb-=b;var f=I.smooth(ic,0,d,.12*H);c=I.smooth(Ba,0,d,.12*H);ic-=f;Ba-=c;var k=I.smooth(yc,0,d,.08*H),l=I.smooth(pc,0,d,.08*H);yc-=k;pc-=l;var m=I.smooth(ub,
0,d,.12*H),d=I.smooth(Gb,0,d,.12*H);ub-=m;Gb-=d;p?(t.rotate_target_camera(a,e+f,b+c),t.move_pivot(a,k+m,l+d)):r?(e+f&&h(a,I.AXIS_X,.2*(e+f)),b+c&&(e=t.get_camera_angles(a,ba)[1],h(a,Math.abs(e)>Math.PI/4?I.AXIS_Z:I.AXIS_Y,.2*(b+c))),t.rotate_hover_camera(a,k+m,0)):(t.rotate_eye_camera(a,.5*(e+f),.5*(b+c)),q&&(a=t.get_camera_angles_char(a,W),E.set_character_rotation(q,a[0],a[1])))}});g.create_kb_sensor_manifold(m,"DEC_STEREO_DIST",g.CT_SHOT,g.KEY_LEFT_SQ_BRACKET,function(a){var b=t.get_stereo_distance(a);
t.set_stereo_distance(a,.9*b)});g.create_kb_sensor_manifold(m,"INC_STEREO_DIST",g.CT_SHOT,g.KEY_RIGHT_SQ_BRACKET,function(a){var b=t.get_stereo_distance(a);t.set_stereo_distance(a,1.1*b)})}function C(){var a=K.get_active_camera();Z=!1;for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL".split(" "),c=0;c<b.length;c++)g.remove_sensor_manifold(a,b[c]);t.get_move_style(a)==t.MS_EYE_CONTROLS&&
K.get_first_character()&&x.remove(a)}function D(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;g.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+
c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function G(a,b,c,d){function e(){var g=performance.now()-f;d(a+g*(b-a)/c);g>=c&&J.remove_loop_cb(e)}var f=performance.now();J.append_loop_cb(e)}p("animation");var t=p("camera"),A=p("config"),x=p("constraints"),u=p("container"),g=p("controls"),q=p("data"),L=p("debug"),J=p("main"),E=p("physics"),M=p("print"),K=p("scenes"),Q=p("transform"),I=p("util"),v=p("vec3"),H=1,P=null,Z=!1,aa=!1,R=!1,W=new Float32Array(2),
ba=new Float32Array(2),U=new Float32Array(3),ca=new Float32Array(3),S=new Float32Array(3),oa=new Float32Array(4),X=new Float32Array(3);a.init=function(a){function f(){var a=d(n,M,I,p),g=u.get_canvas();if(a){var h=u.get_container();m();J.set_check_gl_errors(w);C&&(b(r,v),J.set_fps_callback(e));y&&c();t&&J.append_loop_cb(function(){h.style.height=h.clientWidth/t+"px"});l&&J.append_loop_cb(function(){var a=h.clientWidth,b=h.clientHeight;a==g.clientWidth&&b==g.clientHeight||J.resize(a,b,!0)});D&&J.append_loop_cb(function(){u.force_offsets_updating()});
k(g,!0)}else k(g,!1)}function h(a){a.keyCode==g.KEY_P&&(J.is_paused()?J.resume():J.pause())}function k(){}a=a||{};var l=!1,n=null,p=null,r=null,t=0,v=null,w=!1,x=!0,y=!0,I=!0,H=!1,C=!1,E=!1,D=!1,K;for(K in a)switch(K){case "canvas_container_id":n=a.canvas_container_id;break;case "callback":k=a.callback;break;case "autoresize":l=a.autoresize;break;case "do_not_use_onload":break;case "gl_debug":w=a.gl_debug;break;case "show_hud_debug_info":E=a.show_hud_debug_info;break;case "sfx_mix_mode":H=a.sfx_mix_mode;
break;case "show_fps":C=a.show_fps;break;case "track_container_position":D=a.track_container_position;break;case "fps_wrapper_id":v=a.fps_wrapper_id;break;case "fps_elem_id":r=a.fps_elem_id;break;case "error_purge_elements":p=a.error_purge_elements;break;case "report_init_failure":I=a.report_init_failure;break;case "pause_invisible":y=a.pause_invisible;break;case "key_pause_enabled":x=a.key_pause_enabled;break;case "force_container_ratio":t=a.force_container_ratio;break;default:A.set(K,a[K])}x&&document.addEventListener("keydown",
h,!1);A.set("show_hud_debug_info",E);A.set("sfx_mix_mode",H);var M=E||H||null;"complete"==document.readyState?window.setTimeout(f,0):window.addEventListener("load",f,!1);window.addEventListener("unload",function(){q.cleanup()},!1)};a.resize_to_container=m;a.set_onclick=function(a,b){var c=l(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.set_onchange=function(a,b){var c=l(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.set_onkeypress=function(a,
b){var c=l(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.enable_camera_controls=w;a.disable_camera_controls=C;a.set_camera_move_style=function(a){var b=Z;b&&C();var c=K.get_active_camera();t.set_move_style(c,a);b&&w(aa,R)};a.enable_object_controls=function(a){function b(a){return a[0]&&(a[1]||a[2])}function c(a,b,e){if(1==e)switch(e=g.get_sensor_value(a,b,0),b){case "FORWARD":d?E.vehicle_throttle(a,1):Q.move_local(a,0,0,1*e);break;case "BACKWARD":d?E.vehicle_throttle(a,
-1):Q.move_local(a,0,0,-1*e);break;case "LEFT":d?E.vehicle_steer(a,-1):Q.move_local(a,1*e,0,0);break;case "RIGHT":d?E.vehicle_steer(a,1):Q.move_local(a,-1*e,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&E.vehicle_throttle(a,0);break;case "LEFT":case "RIGHT":d&&E.vehicle_steer(a,0)}}var d=E.is_vehicle_chassis(a)||E.is_vehicle_hull(a),e=g.create_elapsed_sensor(),f=g.create_keyboard_sensor(g.KEY_W),h=g.create_keyboard_sensor(g.KEY_S),k=g.create_keyboard_sensor(g.KEY_A),l=g.create_keyboard_sensor(g.KEY_D),
m=g.create_keyboard_sensor(g.KEY_UP),n=g.create_keyboard_sensor(g.KEY_DOWN),p=g.create_keyboard_sensor(g.KEY_LEFT),q=g.create_keyboard_sensor(g.KEY_RIGHT);g.create_sensor_manifold(a,"FORWARD",g.CT_CONTINUOUS,[e,f,m],b,c);g.create_sensor_manifold(a,"BACKWARD",g.CT_CONTINUOUS,[e,h,n],b,c);g.create_sensor_manifold(a,"LEFT",g.CT_CONTINUOUS,[e,k,p],b,c);g.create_sensor_manifold(a,"RIGHT",g.CT_CONTINUOUS,[e,l,q],b,c)};a.disable_object_controls=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],
c=0;c<b.length;c++)g.remove_sensor_manifold(a,b[c])};a.enable_controls=function(a){var b=u.get_container();a=a||!1;g.register_keyboard_events(document,!1);g.register_mouse_events(b,!0,a);g.register_wheel_events(b,!0);g.register_touch_events(b,!0);g.register_device_orientation()};a.disable_controls=function(){var a=u.get_container();g.unregister_keyboard_events(document);g.unregister_mouse_events(a);g.unregister_wheel_events(a);g.unregister_touch_events(a);g.unregister_device_orientation()};a.enable_debug_controls=
function(){g.create_kb_sensor_manifold(null,"CAMERA_SHOT",g.CT_SHOT,g.KEY_K,function(){L.make_camera_frustum_shot()});g.create_kb_sensor_manifold(null,"LIGHT_SHOT",g.CT_SHOT,g.KEY_L,function(){L.make_light_frustum_shot()});g.create_kb_sensor_manifold(null,"TELEMETRY",g.CT_SHOT,g.KEY_T,function(){L.plot_telemetry()})};a.request_fullscreen=function(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||
document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",
d,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen==a.webkitRequestFullScreen?a.requestFullScreen(Element.ALLOW_KEYBOARD_INPUT):a.requestFullScreen()};a.exit_fullscreen=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;if("function"!=typeof a)throw"B4W App: exit fullscreen method is not supported";a.apply(document)};a.check_fullscreen=
function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.report_app_error=D;a.get_url_params=function(a){a=!!a;var b=location.href.toString();if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?(e=e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.css_animate=function(a,
b,c,d,e,f,g,h){function k(a){l[b]=f+a+g;if(c>d&&a<=d||c<d&&a>=d)l[b]=f+d+g,h()}if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=f||"";g=g||"";h=h||function(){};var l=a.style;a=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==l[b])if(void 0!=l["webkit"+a])b="webkit"+a;else if(void 0!=l["ms"+a])b="ms"+a;else if(void 0!=l["moz"+a])b="moz"+a;else return;G(c,d,e,k)}};a.attr_animate=function(a,b,c,d,e,f){function g(e){0<=e&&a.setAttribute(b,e);if(c>d&&e<=d||c<d&&e>=d)a.setAttribute(b,d),f()}a&&b&&isFinite(c)&&
isFinite(d)&&isFinite(e)&&(f=f||function(){},G(c,d,e,g))};a.set_camera_smooth_factor=function(a){H=a};a.get_camera_smooth_factor=function(){return H}};b4w.module.camera_anim=function(a,p){function c(a,b,c,d){b=f.angle_wrap_0_2pi(a-b);a=f.angle_wrap_0_2pi(c-a);if(1E-6>Math.abs(b)||1E-6>2*Math.PI-Math.abs(b))b=0;if(1E-6>Math.abs(a)||1E-6>2*Math.PI-Math.abs(a))a=0;d[0]=b;d[1]=a;return d}var d=p("camera"),b=p("controls"),e=p("print"),l=p("scenes"),m=p("time"),h=p("transform"),n=p("tsr"),f=p("util"),k=p("vec3"),r=p("quat"),y=new Float32Array(2),w=new Float32Array(2),C=new Float32Array(3),D=new Float32Array(3),G=new Float32Array(3),t=new Float32Array(4),
A=new Float32Array(2),x=new Float32Array(2),u=new Float32Array(8),g=new Float32Array(8),q=new Float32Array(8),L=!1,J=!1;a.track_to_target=function(a,c,g,l,m,n,p,q){if(!d.is_eye_camera(a))e.error("track_to_target(): wrong object");else if(a&&c){if(f.is_vector(c))var u=c;else u=G,h.get_object_center(c,!1,u);c=g||1;g=l||2;var w=m||1;m=n||1;D[0]=0;D[1]=-1;D[2]=0;var x=h.get_rotation(a);n=f.quat_to_dir(x,D);l=d.get_camera_angles(a,y);var A=h.get_translation(a);k.subtract(u,A,C);k.normalize(C,C);var J=
r.rotationTo(n,C,r.create());r.multiply(J,x,t);f.correct_cam_quat_up(t,!1);k.subtract(u,A,D);var L=k.length(D)*(1-1/g),u=Math.asin(C[1]);g=Math.acos(-C[2]/Math.abs(Math.cos(u)));0<C[0]&&(g=2*Math.PI-g);var ca=g-l[0],S=u-l[1];G[0]=0;G[1]=0;G[2]=-1;g=h.get_rotation(a);0>f.quat_to_dir(g,G)[1]?(S=0<n[1]?u-Math.PI+l[1]:u+Math.PI+l[1],ca=0<ca?-Math.PI+ca:Math.PI+ca):Math.abs(ca)>Math.PI&&(ca=0<ca?ca-2*Math.PI:ca+2*Math.PI);var oa=0,u=b.create_elapsed_sensor();n=Math.abs(ca/c);c=Math.abs(S/c);var X=n>c?
n:c,da=X+w,ea=da+m,fa=ea+w,ga=ca,B=S,N=L,ia=function(){b.remove_sensor_manifold(a,"TRACK_TO_TARGET");p&&p()};b.create_sensor_manifold(a,"TRACK_TO_TARGET",b.CT_CONTINUOUS,[u],null,function(a,c,e){if(e)if(d.is_eye_camera(a))if(e=b.get_sensor_value(a,c,0),oa+=e,oa<X){var f=ca/X*e;e*=S/X;c=oa/X;c=6*c*(1-c);f*=c;e*=c;ga-=f;B-=e;d.rotate_eye_camera(a,f,e)}else oa<da?(ga&&(d.rotate_eye_camera(a,ga,B),ga=0,q&&q()),c=(oa-X)/w,e=-L*e/w,N-=f,h.move_local(a,0,6*e*c*(1-c),0)):oa<ea?N&&(h.move_local(a,0,N,0),N=
0):oa<fa?(c=(oa-ea)/w,e=L*e/w,e=6*e*c*(1-c),h.move_local(a,0,e,0)):(h.set_translation_v(a,A),ia());else ia()})}};a.auto_rotate=function(a,g){function h(e,g,l){if(1==l)if(l=d.get_move_style(e),l==d.MS_STATIC)k();else if(l!=d.MS_HOVER_CONTROLS&&d.has_horizontal_limits(e)){l=d.get_horizontal_limits(e,x);if(null===n||l[0]!=n[0]||l[1]!=n[1]){n=n||A;n.set(l);p=Math.min(.2,f.angle_wrap_0_2pi(n[1]-n[0])/2);l=n;var r=d.get_camera_angles(m,y)[0];l=c(r,l[0],l[1],w);q=a*Math.min(1,l[0]/.2,l[1]/.2)}g=b.get_sensor_value(e,
g,0);l=d.get_camera_angles(e,y)[0];l=c(l,n[0],n[1],w);l[1]>p&&l[0]>p?q=f.sign(q)*a:l[1]<p?q-=Math.pow(a,2)/.4*g:l[0]<p&&(q+=Math.pow(a,2)/.4*g);d.rotate_camera(e,g*q,0)}else n=null,g=b.get_sensor_value(e,g,0),d.rotate_camera(e,g*a,0)}function k(){b.remove_sensor_manifold(m,"AUTO_ROTATE");b.remove_sensor_manifold(m,"DISABLE_AUTO_ROTATE");g()}g=g||function(){};var m=l.get_active_camera();if(d.get_move_style(m)==d.MS_STATIC)e.error("auto_rotate(): wrong camera type");else{var n=null,p=0,q=0;if(b.check_sensor_manifold(m,
"AUTO_ROTATE"))k();else{var r=b.create_mouse_move_sensor("X"),t=b.create_mouse_move_sensor("Y"),u=b.create_mouse_click_sensor(),C=b.create_touch_move_sensor(),D=b.create_touch_zoom_sensor(),G=b.create_elapsed_sensor();b.create_sensor_manifold(m,"DISABLE_AUTO_ROTATE",b.CT_LEVEL,[r,t,u,C,D],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]},k);b.create_sensor_manifold(m,"AUTO_ROTATE",b.CT_CONTINUOUS,[G],function(a){return a[0]},h)}}};a.is_auto_rotate=function(){var a=l.get_active_camera();return b.check_sensor_manifold(a,
"AUTO_ROTATE")};a.check_auto_rotate=function(){var a=l.get_active_camera();return d.get_move_style(a)==d.MS_STATIC?!1:!0};a.move_camera_to_point=function(a,b,c,l,p){if(d.get_move_style(a)!=d.MS_STATIC)e.error("move_camera_to_point(): wrong camera type");else if(!L)if(a)if(b){c=c||1;l=l||.01;var r=h.get_tsr(a,u),t=h.get_tsr(b,g);b=k.distance(n.get_trans_view(r),n.get_trans_view(t))/c;c=f.quat_to_dir(n.get_quat_view(r),f.AXIS_MY,C);var w=f.quat_to_dir(n.get_quat_view(t),f.AXIS_MY,D);c=Math.min(Math.abs(k.dot(c,
w)),1);l=1E3*Math.max(b,Math.acos(c)/l);L=!0;m.animate(0,1,l,function(b){var c=n.interpolate(r,t,f.smooth_step(b),q);h.set_tsr(a,c);1==b&&(L=!1,p&&p())})}else e.error("move_camera_to_point(): you mast specify point object");else e.error("move_camera_to_point(): you mast specify camera object")};a.rotate_camera=function(a,b,c,f,g){if(!J)if(a)if(b||c){J=!0;var h=0,k=0,l=0!=b?b:c;m.animate(0,l,f||1E3,function(e){h-=e;k-=e;c&&b?d.rotate_camera(a,h,k):c?d.rotate_camera(a,0,k):b&&d.rotate_camera(a,h,0);
k=h=e;e==l&&(J=!1,g&&g())})}else e.error("rotate_camera(): you mast specify rotation angle");else e.error("rotate_camera(): you mast specify camera object")};a.is_moving=function(){return L};a.is_rotating=function(){return J}};b4w.module.gyroscope=function(a,p){function c(a){var b=d.create_gyro_angles_sensor(),c=!0;d.create_sensor_manifold(a,"CAMERA_ROTATE_GYRO",d.CT_CONTINUOUS,[b],null,function(a,b,p){if(0<p){m=d.get_sensor_payload(a,b,0);c&&(l[0]=m[0],l[1]=m[1],l[2]=m[2],c=!1);p=b=0;0==window.orientation&&(b=m[1]-l[1],p=m[0]-l[0],m[1]>n&&m[1]<h&&(p=0));if(180==window.orientation){b=m[1]-l[1];0>m[1]&&(b=-b);p=l[0]-m[0];if(b>Math.PI/2||b<-Math.PI/2)b=0;m[1]>-h&&m[1]<-n&&(p=0)}if(-90==window.orientation){b=m[0]-l[0];if(b>
Math.PI/2||b<-Math.PI/2)b=0;p=l[1]-m[1];if(m[0]>f||m[0]<k)p=0}if(90==window.orientation){b=l[0]-m[0];if(b>Math.PI/2||b<-Math.PI/2)b=0;p=m[1]-l[1];if(m[0]>f||m[0]<k)p=0}e.rotate_camera(a,p,b);l[0]=m[0];l[1]=m[1];l[2]=m[2]}})}var d=p("controls"),b=p("scenes"),e=p("camera"),l=new Float32Array(3),m=new Float32Array(3),h=110*Math.PI/180,n=70*Math.PI/180,f=70*Math.PI/180,k=70*-Math.PI/180;a.enable_camera_rotation=function(){var a=b.get_active_camera();c(a)}};b4w.module.mixer=function(a,p){function c(){G=D.length=0;t=d();A=new Float32Array(t.length);x=new Float32Array(t.length);var a=w.get_speaker_objects();if(a.length){D.push(b());for(var c=0;c<a.length;c++)D.push(l(a[c]));D.sort(function(a,b){return"MASTER"==a.id?-1:"MASTER"==b.id?1:"COMPRESSOR"==a.id?-1:"COMPRESSOR"==b.id?1:a.id.toUpperCase()<b.id.toUpperCase()?-1:a.id.toUpperCase()>b.id.toUpperCase()?1:0})}}function d(){for(var a=new Float32Array(100),b=0,c=0;100>c;c++)a[c]=20*Math.pow(1E3,b),b+=1/
99;return a}function b(){var a=e("MASTER");a.T.push(["VOLUME",w.get_volume(null),0,1,50,!1]);var b=w.get_compressor_params();b&&(a.T.push(["THRESHOLD",b.threshold,-100,0,100,!1]),a.T.push(["KNEE",b.knee,0,40,40,!1]),a.T.push(["RATIO",b.ratio,1,20,20,!1]),a.T.push(["ATTACK",b.attack,0,1,1E3,!1]),a.T.push(["RELEASE",b.release,0,1,1E3,!1]));a.mute=w.is_muted(null)?1:0;a.dd=-1;return a}function e(a){return{id:a,T:[],Sf:0,mute:-1,dd:-1,Ca:null}}function l(a){var b=e(y.get_object_name(a));b.mute=w.is_muted(a)?
1:0;b.dd=0;b.Ca=a;return b}function m(a){if(a.Ca){a.T.length=0;a.T.push(["VOLUME",w.get_volume(a.Ca),0,1,50,!1]);var b=w.get_positional_params(a.Ca);b&&(a.T.push(["DIST_REF",b.dist_ref,0,1E3,1E4,!1]),a.T.push(["ATTENUATION",b.attenuation,0,50,1E3,!1]),a.T.push(["DIST_MAX",b.dist_max,0,1E4,1E4,!1]));if(b=w.get_filter_params(a.Ca))a.T.push(["EQ_FREQ",b.freq,20,2E4,100,!0]),a.T.push(["EQ_Q",b.Q,0,10,100,!1]),a.T.push(["EQ_GAIN",b.gain,-70,30,100,!1]);C.clamp(a.Sf,0,a.T.length-1)}}function h(a){for(var b=
0;b<D.length;b++){var c=D[b];if(c!=a&&1==c.dd)return!0}return!1}function n(a){for(var b=0;b<D.length;b++){var c=D[b];c!=a&&0==c.mute&&0==c.dd&&w.mute(c.Ca,!1)}}function f(){if(0==D.length)return[0,-1];var a=8*Math.floor(G/8),b=a+7,a=C.clamp(a,0,D.length-1),b=C.clamp(b,0,D.length-1);return[a,b]}var k=p("controls");p("debug");var r=p("hud"),y=p("scenes"),w=p("sfx"),C=p("util"),D=[],G=0,t=null,A=null,x=null;a.enable_mixer_controls=function(){function a(b,c,d){if(1==d){var e=Boolean(k.get_sensor_value(b,
c,2))?-1:1,f=D[G];if(f)switch(d=f.T[f.Sf],d[1]=d[5]?d[1]*Math.pow(d[3]/d[2],e/d[4]):d[1]+(d[3]-d[2])/d[4]*e,d[1]=C.clamp(d[1],d[2],d[3]),d[0]){case "VOLUME":"MASTER"!=f.id?w.set_volume(f.Ca,d[1]):w.set_volume(null,d[1]);break;case "DIST_REF":e=w.get_positional_params(f.Ca);e.dist_ref=d[1];w.set_positional_params(f.Ca,e);break;case "ATTENUATION":e=w.get_positional_params(f.Ca);e.attenuation=d[1];w.set_positional_params(f.Ca,e);break;case "DIST_MAX":e=w.get_positional_params(f.Ca);e.dist_max=d[1];w.set_positional_params(f.Ca,
e);break;case "EQ_FREQ":e=w.get_filter_params(f.Ca);e.freq=d[1];w.set_filter_params(f.Ca,e);break;case "EQ_Q":e=w.get_filter_params(f.Ca);e.Q=d[1];w.set_filter_params(f.Ca,e);break;case "EQ_GAIN":e=w.get_filter_params(f.Ca);e.gain=d[1];w.set_filter_params(f.Ca,e);break;case "THRESHOLD":f=w.get_compressor_params();f.threshold=d[1];w.set_compressor_params(f);break;case "KNEE":f=w.get_compressor_params();f.knee=d[1];w.set_compressor_params(f);break;case "RATIO":f=w.get_compressor_params();f.ratio=d[1];
w.set_compressor_params(f);break;case "ATTACK":f=w.get_compressor_params();f.attack=d[1];w.set_compressor_params(f);break;case "RELEASE":f=w.get_compressor_params();f.release=d[1];w.set_compressor_params(f);break;default:throw"Unknown strip param";}"INC_DEC"==c?k.reset_timer_sensor(b,c,6,.35):k.reset_timer_sensor(b,c,6,.05)}else k.reset_timer_sensor(b,c,6,10)}function b(a,c,d){if(1==d){d=Boolean(k.get_sensor_value(a,c,0))?-1:1;if(D.length){1==d&&G<D.length-1?G++:-1==d&&0<G&&G--;d=f();for(var e=d[0];e<=
d[1];e++)m(D[e])}"SWITCH_STRIP"==c?k.reset_timer_sensor(a,c,5,.15+.3):k.reset_timer_sensor(a,c,5,.15)}else k.reset_timer_sensor(a,c,5,10)}c();var d=k.create_keyboard_sensor(k.KEY_LEFT_SQ_BRACKET),e=k.create_keyboard_sensor(k.KEY_RIGHT_SQ_BRACKET),l=k.create_keyboard_sensor(k.KEY_SEMI_COLON),p=k.create_keyboard_sensor(k.KEY_SINGLE_QUOTE),y=k.create_keyboard_sensor(k.KEY_SHIFT),K=k.create_timer_sensor(.15,!0),Q=k.create_timer_sensor(.05,!0),d=[d,e,l,p,y,K,Q];k.create_sensor_manifold(null,"SWITCH_STRIP",
k.CT_TRIGGER,d,function(a){return(a[0]||a[1])&&!a[4]},b);k.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",k.CT_SHOT,d,function(a){return(a[0]||a[1])&&!a[4]&&a[5]},b);k.create_sensor_manifold(null,"SWITCH_PARAM",k.CT_SHOT,d,function(a){return(a[0]||a[1])&&a[4]},function(a,b){var c=Boolean(k.get_sensor_value(a,b,0))?-1:1,d=D[G];d&&(1==c&&d.Sf<d.T.length-1?d.Sf++:-1==c&&0<d.Sf&&d.Sf--)});k.create_sensor_manifold(null,"INC_DEC",k.CT_TRIGGER,d,function(a){return(a[2]||a[3])&&!a[4]},a);k.create_sensor_manifold(null,
"INC_DEC_HOLD",k.CT_SHOT,d,function(a){return(a[2]||a[3])&&!a[4]&&a[6]},a);k.create_sensor_manifold(null,"MUTE_SOLO",k.CT_SHOT,d,function(a){return(a[2]||a[3])&&a[4]},function(a,b){if(Boolean(k.get_sensor_value(a,b,2))){var c=D[G];c&&0<=c.mute&&("MASTER"!=c.id?0==c.mute?(c.mute=1,w.mute(c.Ca,!0),1==c.dd&&(c.dd=0,h(c)||n(c))):(c.mute=0,h(c)||w.mute(c.Ca,!1)):0==c.mute?(c.mute=1,w.mute(null,!0)):(c.mute=0,w.mute(null,!1)))}else if((c=D[G])&&0<=c.dd)if(0==c.dd){c.dd=1;w.mute(c.Ca,!1);1==c.mute&&(c.mute=
0);for(var d=0;d<D.length;d++){var e=D[d];e!=c&&0==e.mute&&0==e.dd&&w.mute(e.Ca,!0)}}else c.dd=0,h(c)?w.mute(c.Ca,!0):n(c)});d=k.create_elapsed_sensor();k.create_sensor_manifold(null,"MIXER_DRAW",k.CT_CONTINUOUS,[d],null,function(){if(D[G])for(var a=f(),b=a[0];b<=a[1];b++){var c=D[b];r.draw_mixer_strip(c.id,b==G,b%8,c.T,c.Sf,c.mute,c.dd);if(c.Ca&&w.get_filter_params(c.Ca)){w.get_filter_freq_response(c.Ca,t,A,x);for(c=0;c<A.length;c++)A[c]=20*Math.log(A[c])/Math.LN10;r.plot_array("EQ",b%8,A,20,2E4,
-10,10)}}});d=k.create_timer_sensor(1,!0);k.create_sensor_manifold(null,"MIXER_UPDATE",k.CT_TRIGGER,[d],null,function(){for(var a=f(),b=a[0];b<=a[1];b++)m(D[b])})}};b4w.module.npc_ai=function(a,p){function c(a,b){var c=b.destination,d=G;C.get_translation(b.empty,d);var e=t;C.get_translation(b.collider,e);var k=0;b.Ai?k=b.Ai:b.Je&&(k=b.Je,b.type==L&&(k*=.5),b.type==E&&(k*=a));switch(b.type){case L:if(b.random&&b.tf){c[0]=(12*Math.random()-6)*b.speed+d[0];c[2]=(12*Math.random()-6)*b.speed+d[2];var l=g,d=A,p=b.speed,w=b.rot_speed;C.get_rotation(b.collider,l);h.transformQuat(r.AXIS_Z,l,d);d[1]=0;h.normalize(d,d);l=.5*p/Math.sin(w/2);p=h.dist(c,e);p<2*l&&h.scaleAndAdd(c,
d,2*l-p,c);b.tf=!1}c[1]=e[1];k&&(c[1]+=k);break;case J:case E:b.random&&b.tf&&(b.type==E?(b.speed=Math.random()+.1,l=b.wA-b.BA):l=b.max_height-b.min_height,c[0]=10*Math.random()-5+d[0],c[1]=e[1]+(Math.random()*l-.5*l),c[2]=10*Math.random()-5+d[2],b.tf=!1),k&&(c[1]=e[1]+k)}var c=G,d=t,p=A,e=q,y=b.rig,l=b.collider,k=b.destination,D=b.speed,ba=b.actions,U=f.get_current_anim_name(y);if(!f.is_play(y)||!ba.mj||-1==ba.mj.indexOf(U)){C.get_translation(l,c);var w=k[0]-c[0],ca=k[2]-c[2],w=Math.sqrt(w*w+ca*
ca);if(w>2*D*a)b.state=20,r.xz_direction(k,c,p),ba=b.rig,f.is_animated(ba)&&(y=b.speed,D=f.get_frame(ba),ba=f.get_anim_length(ba),y*=ba/24*(1-D/ba),.9>w/y&&h.scaleAndAdd(k,p,y-w,k)),w=g,y=x,C.get_rotation(b.collider,w),h.transformQuat(r.AXIS_Z,w,d),y[0]=d[0],y[1]=0,y[2]=d[2],h.normalize(y,y),D=h.dot(y,p),ba=a/(Math.abs(Math.acos(D))/Math.PI)*b.rot_speed*b.Do,n.rotationTo(y,p,e),n.rotationTo(r.AXIS_Z,y,w),1<=Math.abs(D)?n.copy(w,e):(n.multiply(e,w,e),n.slerp(w,e,Math.min(ba,1),e)),p=a,b.type!=J&&(p=
Math.max(p,1/60),w=u,y=g,n.setAxisAngle(r.AXIS_X,-Math.asin(d[1]),y),n.setAxisAngle(r.AXIS_X,-Math.atan(b.Je/(b.speed*p)),w),n.slerp(y,w,p,w),n.multiply(e,w,e)),C.set_rotation_v(l,e),d=A,l=x,r.quat_to_dir(e,r.AXIS_Z,d),h.scale(d,b.speed*a,l),h.add(l,c,l),l[1]=b.type!=L?(k[1]-c[1])*a*.1+c[1]:k[1],C.set_translation_v(b.collider,l);else if(b.type==L)ba.move?U&&-1!=ba.move.indexOf(U)&&f.is_play(y)?b.state=20:(b.state=10,b.tf=!0):(b.state=10,b.tf=!0);else if(b.type==E||b.type==J)b.tf=!0;if(m(b)&&(c=b.rig,
!f.is_play(c))){e=null;switch(b.state){case 10:e=b.actions;e=e.mj?r.random_from_array(e.mj):null;break;case 20:e=f.get_current_anim_name(b.rig),d=k=b.actions,d.we&&-1==d.we.indexOf(e)&&d.move&&-1!=d.move.indexOf(e)&&.33<Math.random()?(k=b.actions,e=k.we[k.move.indexOf(e)]):(d=b.actions,d.move&&(-1!=d.move.indexOf(e)||!d.we&&!d.mf||!d.mf&&!e||d.we&&-1!=d.we.indexOf(e)||d.mf&&-1!=d.mf.indexOf(e))?(k=b.actions,k.we?(d=k.we.indexOf(e),-1!=d?(e=d+1,e=e<k.move.length?e:0,e=k.move[e]):e=-1!=k.move.indexOf(e)?
e:r.random_from_array(k.move)):e=r.random_from_array(k.move)):(d=b.actions,e=d.mf&&-1==d.mf.indexOf(e)&&d.move&&-1==d.move.indexOf(e)?r.random_from_array(k.mf):null))}e&&(f.apply(c,e),f.set_behavior(c,f.AB_FINISH_RESET),f.set_frame(c,0),f.play(c))}}}function d(a,b,c,d){if(d)if(1==c)switch(d.type){case J:a:{for(c=0;3>c;c++){var e=k.get_sensor_payload(a,b,c).hit_fract;if(e){b=e;break a}}b=void 0}a=100*b;d.Je=a<d.min_height?10:a>d.max_height?-10:0;break;case L:a=k.get_sensor_payload(a,b,0).hit_fract;
d.Je=d.Os==a?0:1-100*a;d.Os=a;break;case E:a=k.get_sensor_payload(a,b,0).hit_fract,"CLOSE_GROUND"==b?(d.Je=100*a-1,d.Je=.1>d.Je?.05:0):"CLOSE_WATER"==b&&(d.Ai=100*a,d.Ai=d.Ai<d.BA?-.02:d.Ai>d.wA?.02:0)}else d.Je=0}function b(){for(var a=0;a<D.length;a++){var b=D[a];e(b);l(b);b.rig&&f.get_current_anim_name(b.rig)&&f.play(b.rig)}}function e(a){var b=h.create(),c=a.collider;switch(a.type){case J:var e=k.create_ray_sensor(c,b,[0,-100,0],"TERRAIN",!0),f=k.create_ray_sensor(c,b,[0,-100,0],"STONE",!0),b=
k.create_ray_sensor(c,b,[0,-100,0],"WATER",!0),e=[e,f,b];k.create_sensor_manifold(c,"CLOSE_GROUND",k.CT_CONTINUOUS,e,function(a){return a[0]||a[1]||a[2]},d,a);break;case L:e=k.create_ray_sensor(c,[0,1,0],[0,-99,0],"TERRAIN",!0);e=[e];k.create_sensor_manifold(c,"CLOSE_GROUND",k.CT_CONTINUOUS,e,null,d,a);break;case E:e=k.create_ray_sensor(c,[0,1,0],[0,-99,0],"TERRAIN",!0),b=k.create_ray_sensor(c,b,[0,100,0],"WATER",!0),e=[e],k.create_sensor_manifold(c,"CLOSE_WATER",k.CT_CONTINUOUS,[b],null,d,a),k.create_sensor_manifold(c,
"CLOSE_GROUND",k.CT_CONTINUOUS,e,null,d,a)}}function l(a){function b(c,d,e){1==e?(C.get_translation(a.empty,a.destination),a.Do=4):a.Do=1}var c=a.collider;if(a.type==L){var d=k.create_collision_sensor(c,"CONSTRUCTION",!1);k.create_sensor_manifold(c,"CONSTRUCTION_COLL",k.CT_CONTINUOUS,[d],null,b)}}function m(a){var b=a.rig;if(!f.is_play(b))return!0;b=f.get_current_anim_name(b);if(!b)return!0;var c=a.actions;switch(a.state){case 10:if(!c.mj)return!1;if(-1==c.mj.indexOf(b))break;break;case 20:if(!c.move||
-1!=c.move.indexOf(b)||c.mf&&-1!=c.mf.indexOf(b)||c.we&&-1!=c.we.indexOf(b))return!1;break;default:return!1}return!0}var h=p("vec3"),n=p("quat"),f=p("animation"),k=p("controls"),r=p("util"),y=p("scenes"),w=p("main"),C=p("transform"),D=[];new Float32Array(9);var G=new Float32Array(3),t=new Float32Array(3),A=new Float32Array(3),x=new Float32Array(3),u=new Float32Array(4),g=new Float32Array(4),q=new Float32Array(4),L=a.NT_WALKING=10,J=a.NT_FLYING=20,E=a.NT_SWIMMING=30;a.new_event_track=function(a){a.destination=
new Float32Array(3);a.start=[];a.ended=[];a.Kk=[];a.Je=null;a.Os=null;a.Ai=null;a.tf=!0;a.Do=1;if(!a.random)for(var b=0;b<a.path.length;b++)a.start[b]=-1,a.ended[b]=!1,a.Kk[b]=!1;D.push(a)};a.enable_animation=function(){if(D.length){b();var a=k.create_elapsed_sensor();k.create_sensor_manifold(D[0].collider,"ELAPSED",k.CT_CONTINUOUS,[a],function(a){return a[0]},function(a,b,d){if(1==d)for(a=k.get_sensor_value(a,b,0),b=0;b<D.length;b++){d=D[b];var e=a;if(y.is_visible(d.obj))if(d.random)c(e,d);else{for(var f=
w.global_timeline(),g=0;g<d.path.length;g++)if(!d.ended[g]){d.Kk[g]||(d.Kk[g]=!0,d.destination[0]=d.path[g][0],d.destination[1]=d.path[g][1],d.destination[2]=d.path[g][2],d.start[g]=f+d.delay[g]);if(f<d.start[g])break;c(e,d);d.ended[g]=d.tf;break}a:{for(e=0;e<d.path.length;e++)if(0==d.ended[e]){e=!1;break a}e=!0}if(e)for(e=0;e<d.path.length;e++)d.Kk[e]=!1,d.ended[e]=!1}}})}};a.disable_animation=function(){if(!(0>=D.length))for(var a=0;a<D.length;a++){var b=D[a];k.check_sensor_manifolds(b.collider)&&
k.remove_sensor_manifold(b.collider);f.is_play(b.rig)&&f.stop(b.rig)}}};b4w.module.mouse=function(a,p){function c(){1==E&&(E=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);y.remove_sensor_manifold(D.get_active_camera(),"SMOOTH_PL")}function d(a){2==E&&(E=0);a.removeEventListener("mousedown",e,!1);a.removeEventListener("mouseup",l,!1);a.removeEventListener("mousemove",b,!1);y.remove_sensor_manifold(D.get_active_camera(),"SMOOTH_DRAG")}function b(a){L()&&(g[0]+=2*(a.clientX-x),g[1]+=
2*(a.clientY-u),x=a.clientX,u=a.clientY);a.preventDefault()}function e(a){x=a.clientX;u=a.clientY;a.currentTarget.addEventListener("mousemove",b,!1);a.preventDefault()}function l(a){a.currentTarget.removeEventListener("mousemove",b,!1);a.preventDefault()}function m(a,b){if(.01<Math.abs(g[0])||.01<Math.abs(g[1])){var c=y.get_sensor_value(a,b,0),d=G.smooth(g[0],0,c,.1*A),e=G.smooth(g[1],0,c,.1*A),c=D.get_first_character(),f=D.get_active_camera();k.rotate_eye_camera(f,4E-4*-d,4E-4*-e);g[0]-=d;g[1]-=
e;c&&(d=k.get_camera_angles_char(f,q),w.set_character_rotation(c,d[0],d[1]))}}function h(){t.detect_mobile()||t.get_canvas_elem().addEventListener("mousemove",f)}function n(){t.detect_mobile()||(t.get_canvas_elem().removeEventListener("mousemove",f),J&&D.set_outline_intensity(J,0))}function f(a){a=r.client_to_canvas_coords(a.clientX,a.clientY,q);(a=D.pick_object(a[0],a[1]))?(D.outlining_is_enabled(a)&&D.set_outline_intensity(a,1),D.outlining_is_enabled(J)&&a!=J&&D.set_outline_intensity(J,0)):D.outlining_is_enabled(J)&&
D.set_outline_intensity(J,0);J=a}var k=p("camera"),r=p("container"),y=p("controls"),w=p("physics"),C=p("print"),D=p("scenes"),G=p("util"),t=p("main"),A=1,x=0,u=0,g=new Float32Array(2),q=new Float32Array(2),L=null,J=null,E=0;a.request_pointerlock=function(a,b,c,e,f){function h(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){d(a);a.addEventListener("mousemove",e,!1);var f=D.get_active_camera();if(!y.check_sensor_manifold(f,"SMOOTH_PL")){var g=
y.create_elapsed_sensor();y.create_sensor_manifold(f,"SMOOTH_PL",y.CT_CONTINUOUS,[g],null,m)}b()}else a.removeEventListener("mousemove",e,!1),E=0,document.removeEventListener("pointerlockchange",h,!1),document.removeEventListener("webkitpointerlockchange",h,!1),document.removeEventListener("mozpointerlockchange",h,!1),c()}if(1!=E){E=1;b=b||function(){};c=c||function(){};f=f||function(){return!0};e=e||function(a){if(f()){if("number"==typeof a.movementX){var b=a.movementX;a=a.movementY}else"number"==
typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;g[0]+=b;g[1]+=a}};document.addEventListener("pointerlockchange",h,!1);document.addEventListener("webkitpointerlockchange",h,!1);document.addEventListener("mozpointerlockchange",h,!1);var k=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof k?k.apply(a):C.error("Pointer lock is not available")}};a.exit_pointerlock=c;
a.check_pointerlock=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)?!0:!1};a.request_mouse_drag=function(a,b){if(2!=E){E=2;c();L=b||function(){return!0};a.addEventListener("mousedown",e,!1);a.addEventListener("mouseup",l,!1);var d=D.get_active_camera();if(!y.check_sensor_manifold(d,"SMOOTH_DRAG")){var f=y.create_elapsed_sensor();y.create_sensor_manifold(d,"SMOOTH_DRAG",y.CT_CONTINUOUS,[f],null,m)}}};a.exit_mouse_drag=d;a.enable_mouse_hover_outline=
h;a.enable_mouse_hover_glow=function(){C.error("enable_mouse_hover_glow() deprecated, use enable_mouse_hover_outline() instead");h()};a.disable_mouse_hover_outline=n;a.disable_mouse_hover_glow=function(){C.error("disable_mouse_hover_glow() deprecated, use disable_mouse_hover_outline() instead");n()};a.get_coords_x=function(a){return"clientX"in a?a.clientX:a.touches&&"clientX"in a.touches[0]?a.touches[0].clientX:-1};a.get_coords_y=function(a){return"clientY"in a?a.clientY:a.touches&&"clientY"in a.touches[0]?
a.touches[0].clientY:-1};a.set_plock_smooth_factor=function(a){A=a};a.get_plock_smooth_factor=function(){return A}};b4w.module.preloader=function(a,p){var c=p("app"),d,b,e,l,m,h,n,f,k,r=null;a.create_simple_preloader=function(a){var c=null,f=null,k="#bf9221",n="#000",p;for(p in a)switch(p){case "canvas_container_id":c=a.canvas_container_id;break;case "background_container_id":f=a.background_container_id;break;case "bg_color":n=a.bg_color;break;case "bar_color":k=a.bar_color;break;case "preloader_fadeout":d=a.preloader_fadeout}a=document.createElement("div");p=document.createElement("div");a.id="simple_preloader_container";
var A=document.createElement("div"),x=document.createElement("div"),f=document.getElementById(f);r=document.getElementById(c);a.style.cssText="z-index: 4;background-color: "+n+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";p.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";A.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+
k+";border-radius: 0px;";x.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+p.appendChild(A);p.appendChild(x);a.appendChild(p);document.body.appendChild(a);b="SIMPLE";e=a;l=A;m=x;h=f};a.create_rotation_preloader=function(a){var c=null,d=null,f="rgba(0,0,0,0)",k="",l="",p="rgba(0,0,0,0)",x;for(x in a)switch(x){case "canvas_container_id":c=a.canvas_container_id;
break;case "background_container_id":d=a.background_container_id;break;case "frame_bg_color":f=a.frame_bg_color;break;case "bg_color":p=a.bg_color;break;case "frame_class":k=a.frame_class;break;case "anim_elem_class":l=a.anim_elem_class}a=document.createElement("div");x=document.createElement("div");var u=document.createElement("div"),g=document.createElement("div"),d=document.getElementById(d);r=document.getElementById(c);a.style.cssText="z-index: 4;background-color: "+p+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";
x.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+f+";";u.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";g.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";u.className=l;x.appendChild(u);x.className=k;x.appendChild(g);
a.appendChild(x);r.appendChild(a);b="ROTATION";e=a;n=u;m=g;h=d};a.create_advanced_preloader=function(a){var c=a.preloader_width,c=c/(c-a.img_width),d=document.getElementById(a.preloader_bar_id),n=document.getElementById(a.fill_band_id),p=document.getElementById(a.preloader_caption_id),t=document.getElementById(a.preloader_container_id),A=document.getElementById(a.background_container_id);r=document.getElementById(a.canvas_container_id);b="ADVANCED";l=d;f=n;k=c;m=p;e=t;h=A};a.update_preloader=function(a){m.innerHTML=
a+"%";"SIMPLE"==b&&(l.style.width=a+"%");"ADVANCED"==b&&(l.style.width=a/k+"%",f.style.width=100-a+"%");"ROTATION"==b&&(n.style.transform="rotate("+a+"deg)");100==a&&(d?(c.css_animate(h,"opacity",1,0,1500,null,null,function(){h.parentNode.removeChild(h)}),c.css_animate(e,"opacity",1,0,1E3,null,null,function(){e.parentNode.removeChild(e)})):(e.parentNode.removeChild(e),h&&h.parentNode.removeChild(h)))}};b4w.module.storage=function(a,p){function c(a){e=a;try{l=window.localStorage}catch(c){b.warn("Applying chrome localStorage bug workaround"),l=null}l||(b.warn("localStorage is not available, initializing temporary storage"),l={})}function d(){return l[e]?JSON.parse(l[e]):{}}var b=p("__print"),e="",l=null;a.init=c;a.set=function(a,b){var c=d();c[a]=String(b);l[e]=JSON.stringify(c)};a.cleanup=function(){delete l[e]};a.get=function(a){var b=d();return b[a]?b[a]:""};a.debug=function(){b.log(d())};c("b4w")};b4w.module.screenshooter=function(a,p){var c=p("main");a.shot=function(){c.canvas_data_url(function(a){var b=window.document.createElement("a");document.body.appendChild(b);b.style.display="none";b.href=a;b.download="screenshot.png";b.click();document.body.removeChild(b)})}};
